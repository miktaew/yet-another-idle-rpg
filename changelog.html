
<!DOCTYPE html>
<html>
<body>
    <head>
        <script type="module" src = "src/game_version.js"> </script>

        <style>
            body {
                font-family: Arial, Helvetica, sans-serif;
            }
            .collapsible {
                background-color: #eee;
                color: #444;
                cursor: pointer;
                padding: 18px;
                width: 100%;
                border: none;
                text-align: left;
                outline: none;
                font-weight: bold;
                font-size: 16px;
                border-top: 1px solid gray;
            }
            .collapsible:hover, .collapsible.active {
                background-color: #ccc;
            }
            .content {
                padding: 0 18px;
                display: none;
                overflow: hidden;
                background-color: #f1f1f1;
            }

            #header {
                background-color: #eee;
                color: #444;
                font-size: 20px;
                padding: 18px;
                width: fit-content;
                border: none;
                text-align: left;
                outline: none;
                font-weight: bold;
                margin-bottom: 20px;
                font-family: sans-serif;
            }

            .spoiler {
                color: rgb(17, 17, 17);
                background-color: rgb(17, 17, 17);
                width: fit-content;
                height: fit-content;
                margin: 0px;
                padding: 0px;
                height: fit-content;
            }
            .spoiler:hover {
                color: white;
            }
        </style>
    </head>

<div id="header">Click on blocks to unfold their content</div>


<button type="button" class="collapsible">v0.5.0 - The Whimsy Edition: Quests, Weather, kemonomimi, and a lot of other things  [testing release: 28/11/2025] </button>
<div class="content"><pre>
v0.5.0
    - implemented a Quest system
    - implemented a simple weather system (temperature and rain), effects are mostly some penalties of varying degree if you get too cold; clothing now provides cold protection
    - the game is now slightly more fluffy; if you dislike kemonomimi, you can disable it in options
    - added a small reward (xp-increasing active effect) for exporting the game; when it's available, the export button will be visually marked by bold text and changing colors
    - travelling now moves the in-game timer forward, affecting durations of all active effects except the one from export reward; travel times scale with skills (mostly 'running')
    - added foreground animations for rain and for snow, and a background animation of stars for clear sky night; <b>they are disabled by default and can be enabled in the options panel</b>
    - market saturation system now covers everything except consumables; it has a harsher scaling for equipment and components
    - market saturation has been split into regions (currently: Village and Slums), with saturation slowly trickling between all regions until it balances out; for existing saves, saturations were equally split between the regions
    - added some (one, to be precise) actions started from dialogue level
    - added a new equipment category, capes; they are rather expensive in terms of material cost, but provide the most cold protection out of all item types and allow you to feel fancy
    - added two new combat zones available from <span class="spoiler">'Forest road'</span>, offering new enemies and a new armor crafting material 
    - added some actions and related combat zones in <span class="spoiler">'Town farms', after you deal with the boars, completing it unlocks another combat zone from 'Forest road'; enemies in these don't have any drops yet</span>
    - added another stance, available from <span class="spoiler">'Suspicious man' after helping out in the 'Slums' (it technically existed before, but was impossible to unlock);
        as usual with new unlocks, if you already used the textline that's supposed to unlock it then you can get it from the repeatable one instead</span>
    - added a new skill <span class="spoiler">'Regeneration' which increases effectiveness of passive healing (sleeping/resting)</span>
    - added a new skill <span class="spoiler">'Gluttony'  to complement 'medicine' by increasing the effects of the food items (unlike medicine, this one doesn't get xp from crafting)</span>
    - added a new skill and training: <span class="spoiler">'Swimming'</span>, available at <span class="spoiler">'Village', after meeting some special conditions (hint: train)</span>
    - added a new skill <span class="spoiler">'Fortitude' which increases max health and gains xp when you take damage, similarly to 'Tough Skin', however it scales with damage taken and not with enemy xp value</span>
    - added a new skill and related items: <span class="spoiler">"Digging" and 2 shovels, used for gathering sand (see: glassmaking, at the bottom of this version's changelog)</span>
    - added a new skill <span class="spoiler">'Cold resistance' which increases cold tolerance by 0.5 per level and gains xp passively at low rate when character is in cold environment</span>
    - renamed 'Crafting' to 'Tinkering', added a new parent skill: <span class="spoiler">"Crafting mastery" which encompasses 'Tinkering', 'Butchering', and 'Woodworking' (for more on the latter 2, see: bottom of this version's changelog)</span>
    - added a new spot for training 'Equilibrium' at <span class="spoiler">'Mountain path' and 'Mountain camp'</span>
    - added a new spot for training 'Climbing' at <span class="spoiler">'Mountain camp'</span>
    - added another book <span class="spoiler">'Ode to Whimsy, and other poems', available at any trader but with a low chance to appear</span>
    - added a new consumable <span class="spoiler">'Bread kwas', made from 2 pieces of any bread and a glass bottle (made from 3 pieces of glass), which gives additional stamina regeneration; while not higher than on bread, it's a different effect meaning it can stack</span>
    - added reputation to display in 'Data' tab (it still does nothing)
    - added an amulet so that you can finally fill that one equipment slot, obtained <span class="spoiler">as a drop for first clear of one of new combat zones</span>
    - getting killed now gives a debuff that reduces xp gains to 1/5th for 5 in-game minutes, as a probably-unnecessary exploit prevention

    - 'Persistence' skill's xp gains are now doubled when under 20% hp (you still need to be out of stamina); they are also increased when under any cold effect, the stronger the more, up to x2 at 'Hypothermia' (although there's also a massive xp reduction from later cold effects, so it's far from being worth it)
    - 'Unarmed' skill now provides additional +0.1 base dmg to unarmed attacks (original base was 1, this means by lvl 10 dmg will be doubled)
    - 'Tough skin' skill is now back to only receiving xp when you wear no armor
    - 'Tough skin' skill received some changes to when the name changes (duh)
    - 'Sleeping' skill provides a bit less of hp
    - 'Meditation' skill now provides some 'Strength of mind' xp multipliers
    - 'Meditation' skill now provides a small intuition multiplier
    - 'Strength of Mind' skill now requires 120->400 xp for first level, but cost scaling was reduced x1.9->x1.7
    - 'Breathing' skill now requires 300->400xp for first level
    - "Wolf trophy" now gives flat armor penetration instead of attack speed
    - hero level xp cost scaling was reduced x1.7->x1.6
    - exponent on crafting xp has been reduced ^1.2->^1.1
    - condition to unlock first combat task in 'Town farms' was changed from clearing a specific location to clearing one of a three (each in a different region)
    - equippables unaffected by quality will no longer display it (trinkets, tools, artifacts, etc)
    - increased defense on a bunch of enemies
    - increased value of trinkets
    - slightly nerfed active effects from food, as more of them are now available
    - some location type penalties now scale up to certain level instead of up to skill max level; scaling information was removed from skill descriptions
    - fieldwork in Village / Town Farms is now unavailable during winters
    - removed defense on wool items
    - for multi-target attacks, xp gains are now divided by target count to provide similar xp gains as with single-target attacks
    - for fighting against a group, xp gains for skills that gain xp when enemy attacks are now divided by target count ^ (2/3) (fighting 8 enemies will only give 2x xp of one)
    - for multi-target attacks, loot drop chances are now divided by target count ^ (2/3) (killing 8 enemies with 1 attack should only give 2x loot instead of 8x)
    - recipes requiring enemy drops are now slightly cheaper to make
    - xp gains for skills are now capped based on what's required for a level up, at 1/10th for general skills and at 1/4th for crafting skill; this generally won't have much impact on gameplay and will only affect some rare cases of extreme gains connected with very low skill level
    - hp bar, stamina bar, and xp bar, now have basic tooltips with breakdows (max health, max stamina and stamina efficiency, global/hero/all_skill xp multiplier)
    - updated 'Sleeping' skill's tooltip so that it mentions the increase to sleeping health restoration (mechanic already existed, but was missing from tooltip)
    - message log will now only scroll down for messages that belong to displayed categories, stuff that is hidden will not cause a scrolling to happen
    - work payments have been increased
    - trader profit margins were increased
    - increased trade price recovery per day (it's still very low and shouldn't be relied on)
    - increased duration of both types of 'Healing Powder'
    - slightly buffed xp gains for gathering tier 3 wood/metal
    - in dialogues, name of the one being talked to is now displayed above the answers
    - added very simple click effects to some buttons
    - added simple animations to enemies when hit
    - added color change on hover to some elements
    - dialogue descriptions and textline answers now have a basic fade-in animation
    - notifications for unlocking a gathering activity now only appear if gathering is globally unlocked
    - reduced 'Wall Rat' agility from 20 to 2 (where are they gonna go? they are stuck in place)
    - increased 'Wall Rat' health 1000->2000 and dexterity 90->120
    - increased 'Elite wolf rat guardian' health 250->400, attack 50->60, agility 40->50, dexterity 40->50, xp value 10->15
    - increased 'Young wolf' health 120->150
    - increased 'Starving wolf' health 150->200
    - increased 'Wolf' health 200->250, attack 32->40, agility 42->50, dexterity 42->50, intuition 32->40, xp value 4->6
    - increase 'Boar' health 300->600, xp value 8->10

    - implemented dialogue branching (clicking a textline can show more textlines that are a continuation of the topic), not yet in use
    - implemented content stack that holds information on what's currently shown and what it originated from, 
        realistically serves just for aforementioned starting actions from dialogue level and for branching,
        but handles everything that's not a location display (which is the default state for when stack is empty)
    - updated enemy lineup creation code to allow using predefined groups in their order (instead of choosing one randomly),
    and to allow using a predefined group every N clears while remaining fights use random enemies
    - jobs can now be made available only in selected seasons; overall time-based limitation was extended to cover training actions as well
    - actions can now have conditions for being displayed
    - textlines can now have conditions for being displayed, using same template as actions do
    - conditions can now include global flags and equipped tools
    - locations can now include rewards provided for simply entering them (obviously meant for unlocks only)
    - item names can now be skipped in item creation, which will default them to same as item's id
    - made it possible for activities to apply active effects
    - made it possible for active effects to affect xp gains
    - changed color of checkboxes to blue, instead of using browser's default colors
    - slightly changed display style of crafting category buttons to hopefully make it a little bit less messy
    - removed some unused location types related to temperatures as those were implemented as a part of weather instead
    
    - fixed component/equipment crafting xp formulas, they now work as described on help page, with scaling starting at 8*tier delayed by sqrt of rarity multiplier (earlier it scaled at every point)
    - fixed a mistake in enemy lineup creation code that resulted in enemy group size capping at 1 less than intended
    - fixed an issue with incorrect display of some of game settings after reloading
    - fixed a minor bug where book bonuses needed save+reload to be properly applied
    - fixed an error on beating a challenge zone that was in favourites
    - fixed a minor multi-crafting bug where if the result was not an integer, the chance for the fraction to be turned into 1 additional item was calculated incorrectly
    - fixed a minor display bug where traded items always ended up at the bottom of respective container, even moving the entire stack down if they were already present there

    courtesy of OnonokiNonon:
        - glassmaking module, including 1 new book, 1 new activity, 3 new items and 3 new recipes
        - added 2 new crafting skills: <span class="spoiler"> 'Butchering' and 'Woodworking', with the former also affecting some drop rates; moved relevant recipes from 'Crafting'; 'Butchering and you' now unlocks the skill instead of recipes </span>
        - skill categories can now be reordered
        - a new dialogue that unlocks 2 more food items with their recipes, and a gathering activity for one of their ingredients
        - tweaks to recipe listing code, to make future categories easier to add (a bit of WIP)
        - the recipe window now remembers the last open tab
        - fixed display issues with inventory and fast travel on Firefox
        - maxed out skills are now displayed with a darker shade of green
        - skill categories now persist their open/closed state
        - skills can now be sorted by progress (how close they are to next level, with maxed out skills always displayed last)
        - inventory can now by sorted by type: components/materials of the same type are grouped together, equipment is sorted by slot, etc.
        - harvesting actions can now have their own ambience (BGM) messages
        - actions that give experience now show time to level up in realtime hours
        - larger xp numbers now display with separators and switch to scientific notation at a much higher threshold
        - added a new category to the journal, listing all the books Hero has read and their effects

v0.5.0.1
    - fixed a bug where having environmental skill at high enough level turned the penalty into a positive effect
    - fixed a bug with health loss stat working the opposite of how it was intended to
    - increased material cost of 'Rat pelt cape' by half (wolf rats are kinda small)
    - fixed rounding in 'Unarmed' skill description
v0.5.0.2
    - fixed a bug that made digging activity impossible
    - removed quest progress notifications for progress awarded automatically on loading pre-quests saves
v0.5.0.3
    - backwards compatibility for having cleared one of locations with newly added rewards-that-require-certain-clearcount
v0.5.0.4
    - now that previous fix actually works
    - removed some repeating messages on loading
    - fixed a typo
v0.5.0.5
    - fixed a bug with "Bears' den" not being connected to its parent location
v0.5.0.6
    - fixed a bug with 'Gluttony' skill effect not working due to missing tags on effects
    - fixed a bug with defense being ignored and with armor penetration sometimes providing more bonus than it should
    - fixed bugs with skill xp gains formula (global bonus applied twice, skill-specific bonus not applied at all)
    - fixed a bug where books and non-consumables were unaffected by trader profit margins
    - fixed a bug with total earnings (and time to reach them) not being displayed while working
    - fixed a display issue when too many quests were expanded
    - fixed a bug with 'Meditation' intuition bonus being a flat increase instead of a multiplier
    - fixed a display bug with celsius and cahrenheit temperatures being displayed with same value (celsius) in roofed locations
    - fixed bug with 'Processed weak monster bone' not being available for crafting
    - fixed a bug where selling a stack of certain item types and then doing save/load would result in trader only having 1 of it

    - buffed 'Forest bear': health 3000->6000, attack 300->600, intuition 100->200, attack speed 0.7->0.8, defense 300->500, xp 30->50
    - buffed 'Wall rat': hewalth 2000->4000, attack 70->100, intuition 90->200, attack count 3->4
    - increased some of the travel times
v0.5.0.7
    - fixed a bug that made it possible to be unable to properly access later stage of the farm quest (incorrect conditions in backwards compatibility)
    - fixed a display issue with crafting components extending over the 'Exit' button
    - fixed a display issue with certain crafting tooltips upon closing and re-opening the crafting window
    - 'Broad arc' now reduces attack speed to x0.8
v0.5.0.8
    - fixed an issue with enemy stat display not fitting in one line
    - hopefully fixed an issue with enemy onhit animation not running on subsequent hits; changed how they appear after enemy group gets defeated
    - fixed a display issue with anthology tooltips not updating skill names and keeping them as "???"
    - skill xp gains in combat against a group are multiplied by enemy count to 1/3 (fighting 8 enemies will give double xp), just like it already was for hero xp
v0.5.0.9
    - fixed a bug with crafting display that, when triggered, resulted in a serious error and inability to do anything that would load the main display of 'Village'
    - added normal iron items to village trader; slightly reduced chances for steel weapons to appear in pre-hideout slums trader
v0.5.0.10
    - fixed a bug with xp gain caps not working
    - moved a textline unlock in 'Suspicious guy' from clearing a location to instead informing him after clearing it
    - added regeneration breakdowns to health bar and stamina bar; these do not include passive non-combat regeneration
    - undid the change to enemy animation handling upon group defeat from v0.5.0.8, added a separate animation for new enemies instead
    - doing a hard reset on dev release should no longer result in still importing a main release savefile but instead allow you to start from scratch
    - increased base xp cost for "Regeneration" 600->1000, increased scaling x1.4->x1.5
    - action to climb up the mountain now rewards some "Climbing" xp on success
    - beating the 'Gang hideout' now rewards a bit of money (as an implied loot)
    - updated evasion/blocking skill tooltips to clarify that it's either one or another and that you cannot do both simultanously
    - tweaked one of 'Village guard' textlines
    - slightly tweaked some descriptions, mostly removing '.' from items to make them more consistent
v0.5.0.11
    - added a training shield that doesn't scale with skill and stays at 0.5 block
    - [hopefully] fixed a bug with price slightly dropping when adding a different item of same trade group to selling
    - lowered xp reward for farm quest from 100k to 50k
    - tweaked some more descriptions in same way as in v0.5.0.10
    - tweaked unlock text and trade text for village trader to give vibes more fitting of a supposedly "medium-sized village", increased the count of some items there for same reason
    - fixed a display issue with bestiary content going outside the box
    - tweaked display of some tooltips to better match the size of their content
    - slightly changed display of enemy attack power in combat for multi-attack enemies, to remove confusion on which is the damage and which is the count 
v0.5.0.12
    - fixed: 'Bear hide cape should now be craftable
    - 'Iron shovel' can now be found in slums trader
    - 'Bear hide cape' can now be found in slums trader post-gang
    - removed even more periods from descriptions
    
</pre></div>
<button type="button" class="collapsible">v0.4.6 - Actions (and some other things too) [testing release: 01/04/2025 / main release: 18/05/2025] </button>
<div class="content"><pre>
v0.4.6
    - implemented new feature, location actions. Unlike trainings, they are generally a one-time thing that provides unlocks and other rewards.
        They can take different time to complete; have different conditions that are not fully specified but will be hinted at by descriptions; 
        might check if conditions are met either before or after the attempt and may either be guaranteed to succeed if so or just have a chance for it,
        with the latter case having different messages for when you failed due to not meeting requirements vs when you were just unlucky and could succeed next time
    
    - made it possible to craft multiple items/components/equips at once (x5/x10/all)
    - added a mechanic of bonus skill levels (e.g. from better tools); these only apply to the basic effects and do not affect milestones
    - implemented personal storage, available at any place with bed, with shared content
    - added fast travel button, allowing quick moving between locations with unlocked beds and/or last combat location (move here from the normal travel category)

    - added multiple new locations and combat areas: <span class="spoiler">
    * bandit hideout in slums
    * two locations (one normal, one combat) after opening the 'mysterious gate' (The Rat Saga continues)
    * multiple mountain locations (one boss, one combat, a few normal + a camp) after climbing up (unlocked by beating one of cave locations)</span>
    - added better tools for gathering materials
    - added a new crafting material, coal, which is now used in all smelting recipes
        It's own recipe is named "charcoal", don't be confused
        It is crafted with any "raw" wood, using cheapest first. 
        Multicrafting will only use one material type on each click, to avoid accidentally burning higher tiers (ha, got it?)
    - added new metal of tier 3, steel, which requires iron + a new ore to craft; added corresponding weapon components; steel unlocked by:<span class="spoiler">
        Reaching level 15 in Forging skill; needed ore unlocked by beating 'mysterious gate'</span>
    - added ash wood and ash wood components, added weak monster bone components; both are tier 3
    - new activity: climbing
    - new skills: Climbing, Breathing, Medicine. Breathing gains xp passively at a low rate (which increases x5 when in any training)
    - two new books, both unlock "new" recipes (lots of them already existed and simply got locked behind this) + one of them unlocks Medicine skill
    - slightly buffed 'weak healing powder' and 'weak healing potion', added stronger versions of both
    - added some other new ingredients and consumables
    - added miscellaneous items 'coil of rope' and 'camping supplies', each is currently only used for a singular action
    - new spot for meditation + another milestone for the skill
    - skills for gathering materials now belong to a separate skill category (instead of 'Activity skills')
    - 'high quality wolf fang' and 'high quality boar tusk' can now be crafted from 50 normal versions each
    - location navigation now uses similar structure as skill display, that is they are grouped together and expand on click
    - made it possible for xp multipliers to affect entire skill categories (e.g. all 'Activity' skills)
    - item rarity rank is now directly displayed in tooltip (before that you had to guess from the color/quality)
    - tooltips for relevant crafting skills now show quality caps
    - activities (job, training, resource gathering) now display the time needed to level up their related skill 
        (with in-game time format, e.g. 24 hours mean 24 irl minutes at standard tickrate)
    - slightly expanded some skill milestones
    - added a Ko-fi icon with link to my page on the right side of the bottom bar

    - equipment qualities are now rounded to nearest even value to reduce inventory cluttering (similarly to how components already had it rounded to nearest multiple of 4) 
    - made attack speed penalties from shields harsher; they are now also present on light shields (but much weaker than on heavy shields)
    - reduced value of crafting components to ~80%, but increased full equipment prices to ~125% (components are cheaper, but equipment prices stay mostly the same)
    - crafting recipes now show their xp values in tooltips
    - reduced the crafting quality cap to 100 + 2.8 * skill_lvl for equips and 100 + 2 * skill_lvl for components
    - buffed success rates of first 2 woodcutting and mining spots
    - buffed success rates of some recipes
    - updated some xp displays to show both the percentage and the raw numbers
    - bottom panel remains visible on loading screen, to allow importing savefile if something breaks and it gets stuck
    - buffed starting health/stamina from 40 to 50
    - slightly nerfed 'starving wolf rats' and 'wolf rats'
    - slightly nerfed 'starving wolfs' and 'wolves'
    - reduced hero level xp cost scaling from 1.8 to 1.7 (this is a buff)
    - location with boars is now not unlocked directly through dialogue, it instead unlocks an action in the "forest road" to search for the area with them
        If you already went through that dialogue, you will just keep the area unlocked and the action should never appear
    - increased reward for dealing with boars to 4 S

    - slightly rewrote the code for location type penalties, allowing for flat effects (e.g. static hp loss every tick)
    - rewrote combat location N-th clear rewards to a form that allows any reward to have such restriction instead of just location unlocks
    - implemented partial reputation system, doesn't really do anything yet and is not currently displayed anywhere (will be expanded in future)
    - slightly changed display settings of the bottom bar

    - fixed a bug where some activities were stopped on reload with a warning in console, due to mismatch in keys
    - fixed a bug in crafting, where some equipments would end up with a different component than was chosen
    - fixed a bug with market saturation not working properly (item sold count wasn't being updated, leading to situation where item price reduction only applied in bulk trading)
    - fixed a bug where additional stats on componentless equipment (clothing) didn't scale with rarity
    - fixed a bug in crafting equipment, where component quality was ignored in tooltips
    - fixed a bug where if skill changed name on levelup, the level increase message would use the new one 
        (it was "skill Y leveled up, skill X was upgraded to Y", instead of "skill X leveled up, skill X was upgraded to Y")
    - fixed a bug with display of unlocked skill milestones, where descriptions sometimes included ", ,"
    - fixed a bug where clicking dropdown icons on skill categories wouldn't expand the content
    - fixed issues with compatibility for saves from some older versions
v0.4.6.1
    - fixed a broken unlock in mountains
    - fixed a bug with clicked items being moved to storage when it wasn't open
    - time to next level now takes skill xp bonuses into account
v0.4.6.2
    - added missing tools to trader inventories
v0.4.6.3
    - fixed a bug with wrong tool type on sickles, which made herb gathering impossible
v0.4.6.4
    - fixed typo in breathing skill's description
    - fixed typo in atratan ore unlock
    - fixed descriptions of some books
    - fixed a bug that allowed reading books while in combat
    - fixed wrong name order in message about skill name change, hopefuly this time for real
    - reduced agility multipliers on short blades
v0.4.6.5
    - fixed typo in alchemy skill description
    - fixed bug with reputation rewards breaking the game
v0.4.6.6
    - increased 'strength of mind' max level from 10 to 40, slightly reduced xp cost scaling
    - fixed missing steel chainmail component recipes
    - fixed minor errors when clicking wrong spots on the crafting list for components/equipments
v0.4.6.7
    - changed level scaling of tier 3 material recipes from 7/17 to 10/20
    - moved steel unlock from forging 15 to forging 10
    - raised crafting xp gains to ^1.2
    - fixed town being unlocked (there was literally nothing there, just an empty town square)
    - fixed eldritch effect restoring health instead of taking it
v0.4.6.8
    - tweaked crafting xp exponent for components to be applied before the material count multiplier
    - implemented multi-attacks for enemies; it makes multiple hits in same attack, all under singular dodge/block/crit calculation
    - buffed Wall Rats by giving them x3 multi-attacks (but slightly reduced their damage)
    - changed font on the help page and changelog to the one used in game
    - increased mountain goat horn droprate to match boar tusks'
v0.4.6.9
    - added short explanation of quality/xp caps in crafting section of help page, updated some other sections as they were slightly outdated
    - slightly changed crafting quality formulas (reduced difference per tier, slightly changed base value param)
v0.4.6.10
    - fixed wrong crafting quality caps in skill tooltips
v0.4.6.11
    - moved 'strength of mind' bonuses in 'persistence' milestones to slightly higher levels
    - fixed minor bug where it was impossible to unequip shield by clicking its slot in 'Equipment' tab
    - attempted to optimize game by removing some probably-unneeded stat updates, will be reversed if they turn out to be in fact needed
v0.4.6.12
    - replaced 'coal' with 'charcoal'; swapped coal-using recipes to use material type 'coal' instead of specific item
    - fixed 'forging' skill tooltip to only show quality cap for components, as that skill has no full eq items
    - reduced minimum dmg getting through armor from 10% to 5%
v0.4.6.13
    - slightly changed hit/dodge formula to allow an actual 0% chance of being hit; due to this, changed modifiers from enemy group count and enemy size (via skill) to be applied to AP/EP instead (since multiplying 0 by them would be meaningless), which might change how much impact they have
    - fixed a bug on equipping better tools if the related skill was not unlocked
v0.4.6.14
    - fixed 'hard reset' only working for non-dev save (doing that even if you were on dev, whoops)
    - options panel can now be closed with 'Escape' key
    - added options to log gathering gains per gathering period and to log total gathering gains when it's finished, both checked by default
    - increased max message count for some categories
    - added bug-related section to help page
v0.4.6.15
    - 'hard reset' might not have been fixed properly
    - fixed minor bug where 'Meditation', and possibly some other skills, appeared in tooltips with their full name instead of '?????' despite not being unlocked
    - fixed occasional bug where switching to .14 while in gathering action would cause an error due to .gathered_materials being undefined
v0.4.6.16
    - fixed displayed enemy hit/dodge not reflecting actual chances
v0.4.6.17
    - fixed wrong condition where BGM that was supposed to be used in "Slums" while the gang was not defeated, was instead used AFTER it was defeated
    - 'Slums thug' now appears in bestiary
v0.4.6.18
    - fixed issue with 'Gang hideout' not locking properly
    - fixed version comparing function not working properly if there was a different number of positions (e.g. comparing 0.4.6 and 0.4.6.1)
    - fixed a serious error on loading if trying to award some past missed location unlocks
v0.4.6.19
    - fixed a bug where visiting two traders would result in the latter displaying former's prices for some items (despite different profit margins); this wasn't affecting actual trade prices, just display
    - fixed a bug where displayed prices of equipment were incorrect
v0.4.6.20
    - fixed a bug where effects of medicines weren't updating properly with skill level
v0.4.6.21
    - fixed a bug where prices of armor were being displayed as "nothing"
    - slightly changed code for displaying dialogue answers, made it possible to set an initial description
v0.4.6.22
    - fixed a bug with in-game date increasing incorrectly
v0.4.6.23
    - another fix for in-game date
    - fixed a display issue of active effects tooltip extending out of view if there were too many effects, now it wraps into additional columns
v0.4.6.24
    - expanded fast travel system to allow favouriting any location (by clicking a star icon next to its name)
v0.4.6.25
    - fixed a bug with location locking (i.e. beating challenges / the gang hideout)
v0.4.6.26
    - fixed a bug on unfavouriting a location you're in
    - content of location choices is now automatically scrolled into view if it would go out of display
v0.4.6.27
    - fixed that thing with all active effects getting activated at once
v0.4.6.28
    - added an auto-use option for consumables; it only triggers in combat and is "forgotten" once item runs out
    - replaced "atk pwr" with "atk" in hero combat tab to free some space, changed rounding a bit (values greater/equal to 100 are now rounded to integer)
    - fixed a bug where meditation was still occasionally displayed as '?????' in some tooltips despite being unlocked
v0.4.6.29
    - fixed a bug where some displayed components in equipment tab of crafting stayed visible after switching to another recipe
v0.4.6.30
    - fixed a bug with auto-use with a serious error if item ran out in combat
v0.4.6.31
    - fixed absurdly high sleeping xp gain in mountain camp
v0.4.6.32
    - rewrote character attack loop to use setTimeout instead of setInterval, in consistency with how enemy attack loops work; this should mitigate a cooldown discrepancy on Firefox, which seems to result from differences in implementations
    - fixed a serious game loading bug if you had 'Sleeping' on level 5 (higher/lower levels were fine, it was just an issue with game trying to update display of related skills when act of unlocking another skill was not enough to register the unlocker as related)
    - skill level progress % is now rounded down in display 
v0.4.6.33
    - fixed another bug with combat loop
v0.4.6.34
    - fixed minor bug where stamina efficiency was displaying wrong value
v0.4.6.35
    - fixed a bug where negative health regen behaved incorrectly in combat if it was the cause of health reaching 0 (instead of enemy attacks causing it)
v0.4.6.36
    - code is now bundled
v0.4.6.37
    - fixed a bug with additional attack power of heavier weapon handles not being included in calculations (therefore doing nothing)

======= released to main

v0.4.6.38
    - fixed a bug where newly unlocked beds were not automatically added to fast travel and required save+reload to appear there
    - fixed a bug where for older saves 'Shack' was initially not in the fast travel list and required save+reload to appear there
    - fixed skill names not updating properly in some situations
    - breathing xp is now also gained in all combat locations, at the same rate as outside of training ('thin air'-type locations still gain xp to it from location type on top of that)
    - reduced rat tails required to produce rat meat from 8 to 3
    - 'medicine for dummies' now provides x1.2 Medicine skill xp gain instead of a small flat bonus
v0.4.6.39
    - fixed a minor display bug where switching from a favourited to a not-favourited stance would result in the hoverable fav stance list still displaying the previous selection as active
    - fixed a bug where gathering skill being lower than the required minimum caused gathering efficiency to be maxxed out
    - fixed a display bug where changing a tool (and possibly some other triggers) caused the tooltip of current activity to
    - weapons that used to provide agility, now provide EP; armors weren't changed in this aspect
    - swords now provide small AP bonus
    - unarmed skill gained an EP bonus
</pre>
</div>
<button type="button" class="collapsible">v0.4.3/v0.4.4 - GUI remake and Crafting</button>
<div class="content"><pre>
v0.4.3
    - remade GUI to be a single tab
    - implemented a crafting system
    - added 3rd type of passive activity, resource gathering; if you are not starting a new game, for both this and crafting talk with the village elder
    - changed some action icons
    - expanded the breakdowns of hero stats
    - new equipment slot, currently with 1 craftable thingy that can go there
    - minimum damage getting through armor is now 10% of original value, instead of 1
    - weapon skills (and unarmed) now increase hit chance
    - 2 new combat locations: the rat saga continues + 3rd combat location in forest (beat 2nd, then talk with certain someone)
    - changed scaling of location type penalties with skill level (it now has constant rate of change with levels, meaning first few levels won't reduce it as drastically as they used to)
    - skill descriptions now have their id displayed
    - skill names in books and in skill rewards now match what's displayed in other places (e.g. a multiplier to a not yet unlocked skill will have its name shown as "????")
    - slightly reduced frequency of background 'noises'
    - slightly nerfed: attack power of tier 2 equipment, stances (heavy/quick), xp values of some enemies, attack speed from unarmed skill, some skill milestone rewards
    - fixed an issue where tooltips tended to lag a lot on chrome while devtools were open
    - fixed the bug with messages about reaching level 0 in skill (maybe this time it will finally work, eh?)
    - fixed a bug where enemy size kept being defaulted to "small"
    - increased xp requirements for 'iron skin' and further reduced its xp gain if wearing any armor
    - fixed a bug with tooltip refresh for multi-target stances
    - tooltips of location types now show the penalties (both current and base values)
    - restructured some of the code for updating character stats, for easier future use
    - added a simple loading screen
    - rewrote some ugly code to a more manageable form
v0.4.3a
    - fixed bug that broke combat when using shield
v0.4.3b
    - fixed crafting tooltips
    - fixed some unlocks that didn't work
    - fixed bug with consumables resulting in max health/stamina becoming NaN
    - fixed bug on trying to trade some of new equipment
v0.4.3c
    - fixed bug with one of unlocks
    - fixed wrong recipe name in crafting
    - fixed bug on trying to trade some of new equipment (again)
    - fixed quality rounding
v0.4.3d
    - fixed bug with crafting quality defaulting to 100%
    - fixed bug where some of unlocked activities could become locked again after reloading
v0.4.3d2
    - fixed wrong chances on resource gathering (instead of being X, they were 1 minus X)
v0.4.3e
    - fixed wrong success chance on item crafting
    - fixed unavailable unlock
    - fixed bug where new clothing was unequippable without a reload
    - fixed bug where unarmed dmg bonus was applied twice
    - tweaked the autoscrolling of recipes to no longer happen when it's unnecessary
v0.4.3f
    - fixed trade bug
v0.4.3f2
    - fixed a broken unlock when talking to "Farm supervisor"
v0.4.3g
    - fixed bug where light level multiplier and unarmed attack speed were not being properly removed
    - fixed scaling of some gathering actions (now they start from 0 instead of 1)
    - wool now gets properly crafted into wool cloth instead of wolf leather
    - fixed issue with time adjustment for attack loops
v0.4.3h
    - added drops to elite wolf rat guardians, incl. new item that currently has no crafting usage but might get it somewhere later
    - fixed bug where loot from resource gathering was displayed in event category instead of loot category
    - fixed bug where it was impossible to trade iron chainmail torso armor
v0.4.3h2
    - fixed trade bug when dealing with 3+ pieces of same unstackable item
v0.4.3h3
    - fixed the terrible issues caused by the previous "fix"
    - crafting 'Iron Chainmail' now gives xp to the proper skill
v0.4.3i
    - fixed bug with tool equipping
    - fixed bug with combat timers
v0.4.3i2
    - fixed another trade bug (this better be the last of them...)
v0.4.3j
    - updated descriptions of environmental skills to reflect formula change
    - fixed some more bugs with crafting
v0.4.3j2
    - fixed another trade bug
v0.4.3k
    - fixed formulas for scaling of gathering/crafting chances
    - defense now works the same way for enemies as it does for the hero (not blocking more than 90%)
v0.4.3k2
    - fixed a broken unlock for clearing 3rd forest location and increased area type xp gain from it
v0.4.3l
    - fixed an issue where state of BGM filter for message log wasn't being saved
    - fixed a bug with message log where wrong message type was being removed
    - fixed bug where drop chances were appearing in wrong places in bestiary tooltips
v0.4.3m
    - displayed skills are now grouped in categories
    - hero levels now increase skill xp gain
    - some minor rebalances and fixes
    - fixed healing bug
    - fixed bug with environmental penalties where only one effect would apply to a given stat
v0.4.3n
    - component value now scales with quality
    - fixed another healing bug
    - fixed bug with leather hats
    - fixed a bug where weapon type related bonuses weren't applied on skill levelup

v0.4.4
    - all items now stack (for those with quality, it's only when quality is the same)
    - completely rewrote how active effects work and updated their display
    - xp value of crafted components now scales with their material cost (you don't have to solely craft dagger blades anymore)
    - increased material cost of some crafting recipes
    - increased minimum crafting xp value
    - slowed down resource gathering activities
    - crafting xp is now reduced when skill is above requirements: -20% per level for item recipes, while for components/equipment soft cap is 8*tier and hard cap 8*tier*sqrt(quality_multiplier)
    - mentions of skills should now update properly, no more "?????" in descriptions
    - item quality is now used as an additional sorting param if names/prices are the same
    - for equipment crafting, available components are now sorted (by tier -> name -> quality)
    - fixed visual bug where stance list would slightly change in width on hover, resulting in awkward flickering
    - separated saves between main and dev releases
    - fixed some bugs with item values
    - tweaked item price rounding
    - updated some display elements to a form that hopefully will be much easier to manage
    - rewrote item quality from fractions to integers (no more floating point errors, yay)
v0.4.4a
    - fixed bug when selling more than 1 of an item
    - fixed bug with item recipe tooltips not updating when needed
v0.4.4b
    - fixed bug when buying more than 1 of an item
v0.4.4c
    - fixed bug with crafting xp cap
    - fixed bug where material count for clothing recipes was always at 0
    - fixed bug that made it impossible to read books
v0.4.4d
    - crafting when skill is past hardcap now provides 1 xp instead of 0
    - fixed component sorting in crafting
v0.4.4e
    - quick fix to importing saves
v0.4.4f
    - implemented additional separate autosave every 60 minutes, which can be loaded from options panel
    - added a button to import a save from the other release (main if you are on dev, dev if you are on main) in options panel
    - fixed lack of recipe display refresh on failed crafting (for 'items' category)
    - fixed wrong month numbering in exported files
    - fixed broken names of %-based effects
v0.4.4g
    - fixed xp gains for some resource gathering activities
    - fixed bug with prices of component-less equipment
v0.4.4h
    - fixed displayed money not updating after obtaining cash via dialogue
    - fix for a bug with saves not loading on dev in some circumstances
v0.4.4i
    - fixed bug with additional stats of components
</pre>
</div>
<button type="button" class="collapsible">v0.4 - Combat Stances</button>
<div class="content"><pre>
v0.4.0
    - introduced combat stances, talk with village guard to unlock (ask him for tips if you already met him earlier); lots of names were suggested by Varian on our discord channel
    - some combat related skills now gain xp even if their original condition (e.g. succeeding in some action) is not fulfilled, although at half the efficiency
    - the rat saga continues
    - a bit more content after leaving the village
    - added some background "sounds"
    - new skills and activities (check training options in village and cave, they might be instantly unlocked if you are far enough)
    - rebalance; changes to some displayed texts
    - modified changelog and help page to a form easier to navigate
    - regeneration when sleeping now scales with "Sleeping" skill
    - trade all button + another trade bugfix (plz let it be the last one)
v0.4.0a
    - balance changes
    - switching weapons now won't make dead enemies suddenly start attacking again
    - CSS fixes
    - dialogue text fixes
    - level bonuses from "Presence sensing" skill, expanded bonuses for some other skills
v0.4.0b
    - more balance changes
    - changed some background 'sounds'
    - bugfixes
v0.4.0c
    - fixed bug with doubled stamina usage when some attacks would one-shot an enemy wave
    - reduced frequency of background 'sounds'
    - raised max level of presence sensing but reduced initial xp cost
    - fixed rounding of displayed health
    - fixed doubling of some skill bars
    - fixed a bug where if reading a book inventory would get sorted every irl second
    - 'broad arc' stamina cost raised to 4
v0.4.0d
    - hitcount of multi-target stances now properly updates in their descriptions when needed
    - 'suspicious wall', 'village guard' and 'suspicious man' are no longer 'small' targets
    - 'broad arc' dmg multiplier reduced to 0.4
    - 'cave depths' location is now a tiny bit harder
    - location types now how their stage displayed (e.g 'dark III')
    - fixed 'quick steps' skill's too low xp cost
v0.4.0e
    - stabilized enemy attack timers (based on expected time vs actual time) to hopefully fix the issue with enemy attacks firing slower than expected
v0.4.0f
    - fixed issue with xp multiplier rewards from skill levels not working properly after reloading the game
v0.4.0g
    - fixed stance skills having no effect
    - stamina efficiency in 'Data' is now shown with 2 decimal places
    - minor CSS fix
v0.4.0h
    - fixed wrong stance names in some skill descriptions
    - crit rate / crit power breakdown is now shown with 2 decimal places
v0.4.0i
    - fixed a bug where when entering activity with a maxxed out skill, xp% would be NaN
    - CSS fixes for inventory
v0.4.0j
    - fixed multi-trade buttons that were broken by previous patch
v0.4.0k
    - simplified some code
v0.4.0l
    - CSS fixes for inventory
v0.4.0m
    - fixed skill-specific xp bonuses not working
    - added a few more skill level rewards
    - slightly reduced xp multipliers and crit rate from skill levels
v0.4.0n
    - another CSS fix for inventory
    - another bugfix for trade (displayed value vs actual value sometimes differed)
v0.4.0o
    - equalized base xp costs for stance skills at 60, modified how they gain xp
    - added parent skill for stance skills
    - added some more names to existing skills
</pre>
</div>

<button type="button" class="collapsible">v0.3.5 - Economy Rework</button>
<div class="content"><pre>
v0.3.5
    - reworked economy (drop rates no longer go down, instead price of enemy loot goes down as more and more is sold, they also slowly recover over time; solution suggested by 10mart10 on our discord channel)
    - added quick travel to [last combat location] and to [last location where player slept]
    - xp multipliers are now displayed - for skills in their onhover tooltip, for hero in data tab
    - shield blocking skill now increases max dmg than can be blocked; block chance reduced by 5% points (goes from 75% to 95%)
      it also has 30 levels instead of 20 now
    - combat areas now have their descriptions available as tooltips when hovering over their name
    - added more entries to the "help" section
    - nerfed xp rewards for clearing both cave areas, added xp rewards for both forest areas
    - buffed wolves (probably not enough, you guys are too strong)
    - some other balance changes for skills, hero and items
    - enemies in combat now display their chance to hit hero and to dodge hero's attack, instead of AP/EP
    - some style fixes, styling for money
    - fixed parent skill xp gain (now they will keep up in xp with their most leveled child)
    - added skill sorting (by name and by level); fixed inventory sorting; you can now also click button again to reverse sort direction (switch between ascending and descending)
v0.3.5a
    - minor CSS fix
v0.3.5b
    - equipment display fix
    - trade bug fix
v0.3.5c
    - fixed skill rewards being added twice
v0.3.5d
    - some values wouldn't refresh properly
    - added consolelogging of some warnings in case of unexpected results
    - fixed some rounding issues
    - some balance changes
    - another trade fix
v0.3.5e
    - xp bonus from parent skill is now included in xp gains in skill tooltip
    - minor balance change
    - fixed some styling
v0.3.5f
    - (hopefully) fixed issue with attack speed
v0.3.5g
    - fixed unarmed attack speed bonus not being added
v0.3.5h
    - fixed minor bug with loading older saves
v0.3.5i
    - fixed attacks getting faster on 0 stamina
</pre>
</div>
<button type="button" class="collapsible">v0.3.4</button>
<div class="content"><pre>
v0.3.4
    - implemented books (only 2 available for now); both provide small bonuses to xp gains upon finish
v0.3.4e
    - huge buff to shield block chance, other balance changes
    - bugfixes (trade, loading, wrong values in bestiary)
    - added console message on auto save
    - added visual distinction to the book that is being read
    - travel options in locations now don't get grouped if there's nothing other than travel available (e.g. the cave)
    - modified function for inventory display so it can now not only refresh all items but also a single one
    - compatibility for saves from older versions
    - fixed that ugly display of "def" in combat
v0.3.4f
    - fixed reward of "tight manouvers" skill
    - fixed display of "stamina efficiency" reward
    - fixed issue with area unlocks (didnt work if it was supposed to be unlocked by clearing some combat zone)
    - minor balance changes
v0.3.4g
    - fixed wrong rounding of dropchances in bestiary
    - fixed lack of rounding in reading time
    - fixed xp gains from harder areas
    - removed underscores from some descriptions
    - slightly nerfed some xp bonuses
v0.3.4h
    - fixed shield block chance reaching 100% way too soon
    - fixed block chance display in combat
    - added game version to save file, for future usage
v0.3.4i
    - now can take less than 1 dmg from an attack, if using a shield
    - rounded some dmg numbers
v0.3.4i-2
    - minor fix to CSS
</pre></div>

<button type="button" class="collapsible">v0.3.3</button>
<div class="content"><pre>
v0.3.3
    - rebalanced stat gains from skill milestones
    - added another combat location between infested field and cave depths, to smooth the progression
    - skill groups replaced with parent skills; now they only provide xp bonus and their child skills have their own milestones
    - refactored calculations of stats from skills/milestones/equipment/level to a more manageable form
    - refactored equipment stat calculations
    - implemented xp bonuses (for now only from skill milestones)
</pre></div>
<button type="button" class="collapsible">v0.3</button>
<div class="content"><pre>
v0.3
    - drop chance now scales with how many of specific enemy were killed, down to 1/10th at 999+
    - fixed minor bugs when trading stackable items
    - changed the starting year to 1000
    - location choices now get foldered only when there's more than two (used to be at more than one)
    - equipment prices increased by ~50%
    - introduced bestiary with list of all killed enemies (killcount, description, stats, drops their chances)
    - rebalanced "sleeping" skill rewards
v0.3b
    - fixed wrong milestone levels on weapon skills after loading game
    - changed xp scaling of some skills
    - fixed wrong calculations on shield blocking skill
v0.3c
    - fixed a minor error when loading save with any skill having less xp than needed to be visible
    - changed the way savefiles are loaded to avoid a bunch of issues
</pre></div>
<button type="button" class="collapsible">v0.2.9</button>
<div class="content"><pre>
v0.2.9
    - added "iron skin" skill that provides a tiny bit of def, xp is gained for fighting with no armour equipped
    - evasion xp is increased by 50% when fighting with no armor equipped (let's call it an adrenaline bonus)
    - changed the hit-chance formula to non-linear
v0.2.9b
    - "iron skin" now works
    - minor fixes to some formulas
</pre></div>
<button type="button" class="collapsible">v0.2.8</button>
<div class="content"><pre>
v0.2.8
    - message log can now be filtered for stuff related to combat/levelups&unlocks/events/loot
    - now if there's more than 1 option in any category (work, train, travel, talk, trade), 
      it's available via separate list of choices instead of all being crammed together
    - rounded displayed values for some skill effects
</pre></div>
<button type="button" class="collapsible">v0.2.7</button>
<div class="content"><pre>
v0.2.7
    - reworked the location type system
    - payments for some jobs are now affected by related skill
    - moved dialogue answers to dialouge box (instead of message log)
</pre></div>
<button type="button" class="collapsible">v0.2.5</button>
<div class="content"><pre>
v0.2.5
    - modified tooltip positioning so that they don't leave the screen
    - rounded some displayed numbers
    - slightly weakened first enemy type
    - some minor bugfixes
</pre></div>
<button type="button" class="collapsible">v0.2.4</button>
<div class="content"><pre>
v0.2.4
    - introduced location types (for combat zones), that bring some additional penalties to hit/evasion chance
    - added a new job, unlocked after clearing 2nd combat zone
</pre></div>
<button type="button" class="collapsible">v0.2.2</button>
<div class="content"><pre>
v0.2.2
    - fixed issue where multi-enemy locations required killing X enemies, instead of killing X enemy groups
    - implemented stamina effects on character's attack speed and attack power
    - number of [alive] enemies now has negative impact on character's hit chance
    - number of enemies multiplies gained character xp by sqrt of group size
    - new training activity
</pre></div>
<button type="button" class="collapsible">v0.2.1</button>
<div class="content"><pre>
v0.2.1
    - fixed two small problems when importing file
    - fixed issue with combat being paused when area page is hidden
    - rewrote the combat loops, made it work properly when tab is not focused
</pre></div>
<button type="button" class="collapsible">v0.2</button>
<div class="content"><pre>
v0.2.0
    - fixed all the bugs I managed to find; 
    fighting against groups now should work without any issues (other than balance)

    - restructured a lot of code, mostly moved stuff to new places,
    but also created some new methods for updating the display

    - moved the page selection buttons to the top
    - switched from fontawesome to google icons
</pre></div>
    <script>
        const btns = document.getElementsByClassName("collapsible");
        //const content = document.getElementById("content");
    
        for(let i = 0; i < btns.length; i++) {
            btns[i].addEventListener("click", () => {
                btns[i].classList.toggle("active");
                const content = btns[i].nextElementSibling;
                if (content.style.display !== "block"){
                    content.style.display = "block";
                } else {
                    content.style.display = "none";
                }
            });
        }
        
    </script>
    
</body>
</html>
