{
  "version": 3,
  "sources": ["../src/game_time.js", "../src/misc.js", "../src/market_saturation.js", "../src/inventory.js", "../src/crafting_recipes.js", "../src/skills.js", "../src/traders.js", "../src/trade.js", "../src/conditions.js", "../src/actions.js", "../src/dialogues.js", "../src/activities.js", "../src/enemies.js", "../src/locations.js", "../src/active_effects.js", "../src/storage.js", "../src/quests.js", "../src/weather.js", "../src/particles.js", "../src/game_version.js", "../src/translation.js", "../src/display.js", "../src/character.js", "../src/items.js", "../src/combat_stances.js", "../src/verifier.js", "../src/reputation.js", "../src/pathfinding.js", "../src/main.js"],
  "sourcesContent": ["\"use strict\";\r\n\r\nfunction Game_Time(new_time) {\r\n    this.year = new_time.year;\r\n    this.month = new_time.month;\r\n    this.day = new_time.day;\r\n    this.hour = new_time.hour;\r\n    this.minute = new_time.minute;\r\n    this.day_count = new_time.day_count ?? 1;\r\n    //only hours and minutes should be allowed to be 0\r\n    //day_count is purely for calculating day of the week, by default it always start at monday (so day_count = 1)\r\n\r\n    this.goUp = function(how_much) {\r\n        this.minute += how_much ?? 1;\r\n        if(this.minute >= 60) {\r\n            const m = this.minute % 60;\r\n            const h = Math.floor(this.minute/60);\r\n            this.minute = m;\r\n            this.hour += h;\r\n        }\r\n    \r\n        if(this.hour >= 24) {\r\n            const h = this.hour % 24;\r\n            const d = Math.floor(this.hour/24);\r\n            this.hour = h;\r\n            this.day += d;\r\n            this.day_count += d;\r\n        }\r\n    \r\n        if(this.day > 30) {\r\n            const d = this.day % 30;\r\n            const m = Math.floor(this.day/30);\r\n            this.day = d;\r\n            this.month += m;\r\n        }\r\n    \r\n        if(this.month > 12) {\r\n            const m = this.month % 12;\r\n            const y = Math.floor(this.month/12);\r\n            this.month = m;\r\n            this.year += y;\r\n        }\r\n    }\r\n\r\n    this.goUp(0); \r\n    //just in case someone passes a value that's not exactly correct, in a situation where it won't ever get incremented so it won't automatically fix\r\n    //e.g. in weather when grabbing date for next weather, as a change in month would not be reflected and adding a manual recalculation there would be just stupid\r\n\r\n    this.loadTime = function(new_time) {\r\n        this.year = new_time.year;\r\n        this.month = new_time.month;\r\n        this.day = new_time.day;\r\n        this.hour = new_time.hour;\r\n        this.minute = new_time.minute;\r\n        this.day_count = new_time.day_count;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {Number} day_count for how far in future to check, leaving at 0 will just return the current season\r\n     * @returns \r\n     */\r\n    this.getSeason = function(day_count) {\r\n        let month;\r\n        if(day_count) {\r\n            month = this.month + Math.floor((this.day + day_count)/30);\r\n        } else {\r\n            month = this.month;\r\n        }\r\n\r\n        if(month > 9) return seasons[3];\r\n        else if(month > 6) return seasons[2];\r\n        else if(month > 3) return seasons[1];\r\n        else return seasons[0];\r\n    }\r\n\r\n    this.getTimeOfDay = function() {\r\n        if (this.hour >= 21 || this.hour < 4) return \"Night\";\r\n        else if(this.hour >= 4 && this.hour < 8) return \"Dawn\";\r\n        else if(this.hour >= 8 && this.hour < 18) return \"Day\";\r\n        else return \"Dusk\";\r\n    }\r\n    \r\n    this.getTimeOfDaySimple = function() {\r\n        //changing this also requires changing values in get_current_temperature_smoothed() in weather.js\r\n        if (this.hour >= 21 || this.hour < 4) return \"Night\";\r\n        else return \"Day\";\r\n    }\r\n\r\n    this.getDayOfTheWeek = function() {\r\n        switch(this.day_count % 7) {\r\n            case 0:\r\n                return \"Sun\";\r\n            case 1: \r\n                return \"Mon\";\r\n            case 2:\r\n                return \"Tue\";\r\n            case 3: \r\n                return \"Wed\";\r\n            case 4:\r\n                return \"Thu\";\r\n            case 5:\r\n                return \"Fri\";\r\n            case 6:\r\n                return \"Sat\";\r\n        }\r\n    }\t\r\n}\r\n\r\nGame_Time.prototype.toString = function() {\r\n    let date_string = ((this.day>9?this.day:`0${this.day}`) + \"/\");\r\n    date_string += ((this.month>9?this.month:`0${this.month}`) + \"/\");\r\n    date_string += (this.year + \" \");\r\n    date_string += ((this.hour>9?this.hour:`0${this.hour}`) + \":\");\r\n    date_string += (this.minute>9?this.minute:`0${this.minute}`) + \", \";\r\n    date_string += this.getSeason() + \", \" + this.getDayOfTheWeek();\r\n    return date_string;\r\n}\r\n\r\n/**\r\n * \r\n * @param {Object} data \r\n * @param {Object} data.time {minutes, hours, days, months, years}\r\n * @param {Boolean} [data.long_names] if it should use \"minutes\", \"hours\", etc instead of \"m\",\"h\"\r\n * @returns \r\n */\r\nfunction format_time({time, long_names, round=true}) { //{time, long_names?}\r\n    if(!time) {\r\n        throw \"No time passed in arguments!\";\r\n    }\r\n\r\n    time.minutes = Math.ceil(time.minutes);\r\n\r\n    if(round) {\r\n        if(time.minutes >= 60) {\r\n            time.hours = time.hours + Math.floor(time.minutes/60) || Math.floor(time.minutes/60);\r\n            time.minutes = time.minutes % 60;\r\n        }\r\n        if(time.hours >= 24) {\r\n            time.days = time.days + Math.floor(time.hours/24) || Math.floor(time.hours/24);\r\n            time.hours = time.hours % 24;\r\n        }\r\n        if(time.days > 30) {\r\n            time.months = time.months + Math.floor(time.days/30) || Math.floor(time.days/30);\r\n            time.days = time.days % 30;\r\n        }\r\n        if(time.months > 12) {\r\n            time.years = time.years + Math.floor(time.months/12) || Math.floor(time.months/12);\r\n            time.months = time.months % 12;\r\n        }\r\n    }\r\n\r\n    let formatted_time = '';\r\n    if(time.years > 0) {\r\n        const used_term = time.years == 1?\"year\":\"years\";\r\n        formatted_time += long_names? `${time.year} ${used_term} ` : `${time.year}Y`;\r\n    }\r\n    if(time.months > 0) {\r\n        const used_term = time.months == 1?\"month\":\"months\";\r\n        formatted_time += long_names? `${time.months} ${used_term} ` : `${time.months}M`;\r\n    }\r\n    if(time.days > 0) {\r\n        const used_term = time.days == 1?\"day\":\"days\";\r\n        formatted_time += long_names? `${time.days} ${used_term} ` : `${time.days}D`;\r\n    }\r\n    if(time.hours > 0) {\r\n        const used_term = time.hours == 1?\"hour\":\"hours\";\r\n        formatted_time += long_names? `${time.hours} ${used_term} ` : `${time.hours}h`;\r\n    }\r\n    if(time.minutes > 0) {\r\n        const used_term = time.minutes == 1?\"minute\":\"minutes\";\r\n        formatted_time += long_names? `${time.minutes} ${used_term} ` : `${time.minutes}m`;\r\n    }\r\n\r\n    return formatted_time;\r\n}\r\n\r\nfunction is_night(time) {\r\n    time = time || current_game_time;\r\n    return (time.hour >= 20 || time.hour < 4);\r\n}\r\n\r\nconst seasons = [\"Spring\",\"Summer\",\"Autumn\",\"Winter\"];\r\n\r\nconst current_game_time = new Game_Time({year: 999, month: 4, day: 1, hour: 8, minute: 0, day_count: 1});\r\n\r\nexport {current_game_time, format_time, is_night, seasons, Game_Time};", "\"use strict\";\r\n\r\nimport { options } from \"./main.js\"\r\n\r\nconst stat_names = {\r\n    \"strength\": \"str\",\r\n    \"health\": \"hp\",\r\n    \"max_health\": \"hp\", //same as for \"health\"\r\n    \"health_regeneration_flat\": \"hp regen\",\r\n    \"health_regeneration_percent\": \"hp % regen\",\r\n    \"health_loss_flat\": \"hp loss\",\r\n    \"health_loss_percent\": \"hp % loss\",\r\n    \"stamina_regeneration_flat\": \"stam regen\",\r\n    \"stamina_regeneration_percent\": \"stam % regen\",\r\n    \"max_stamina\": \"stamina\",\r\n    \"agility\": \"agl\",\r\n    \"dexterity\": \"dex\",\r\n    \"magic\": \"magic\",\r\n    \"attack_speed\": \"attack speed\",\r\n    \"attack_power\": \"attack power\",\r\n    \"crit_rate\": \"crit rate\",\r\n    \"crit_multiplier\": \"crit dmg\",\r\n    \"stamina_efficiency\": \"stamina efficiency\",\r\n    \"intuition\": \"int\",\r\n    \"block_strength\": \"shield strength\",\r\n    \"hit_chance\": \"hit chance\",\r\n    \"evasion\": \"EP\",\r\n    \"evasion_points\": \"EP\",\r\n    \"attack_points\": \"AP\",\r\n    \"heat_tolerance\": \"heat resistance\",\r\n    \"cold_tolerance\": \"cold resistance\",\r\n    \"unarmed_power\": \"unarmed base dmg\",\r\n    \"armor_penetration\": \"armor pen\",\r\n    \"defense\": \"defense\",\r\n};\r\n\r\nconst task_type_names = {\r\n    \"kill\": \"kill\",\r\n    \"kill_any\": \"kill\",\r\n    \"clear\": \"clear\",\r\n}\r\n\r\n//skill-tag mapping for when consumables are used\r\nconst skill_consumable_tags = {\r\n    \"Medicine\": \"medicine\",\r\n    \"Gluttony\": \"food\"\r\n}\r\n\r\n//additional skill-tag mapping for crafting\r\nconst crafting_tags_to_skills = {\r\n    \"medicine\": \"Medicine\",\r\n}\r\n\r\nfunction expo(number, precision = 3)\r\n{\r\n    number = Number.parseFloat(number);\r\n\r\n    if(number == 0) {\r\n        return 0;\r\n    } else if(number >= 10**options.expo_threshold || number < 0.01) {\r\n        return number.toExponential(precision).replace(/[+-]/g,\"\");\r\n    } else if(number > 10) {\r\n        return Math.round(number).toLocaleString();\r\n    } else if(number > 1) {\r\n        return (Math.round(number * 10) / 10).toLocaleString();\r\n    } else {\r\n        return (Math.round(number * 100) / 100).toLocaleString();\r\n    }\r\n}\r\n\r\nfunction round_item_price(price) {\r\n    if(price > 19999) {\r\n        return Math.ceil(price/1000)*1000;\r\n    } else if(price > 1999) {\r\n        return Math.ceil(price/100)*100;\r\n    } else if(price > 199){\r\n        return Math.ceil(price/10)*10;\r\n    } else {\r\n        return Math.ceil(price);\r\n    }\r\n}\r\n\r\nfunction format_reading_time(time) {\r\n    if(time >= 120) {\r\n        return `${Math.floor(time/60)} hours`;\r\n    } else if(time >= 60) {\r\n        return '1 hour';\r\n    } else {\r\n        return `${Math.round(time)} minutes`;\r\n    }\r\n}\r\n\r\nfunction format_working_time(time) {\r\n    let formatted = \"\";\r\n    const hours = Math.floor(time/60);\r\n    const minutes = time%60;\r\n\r\n    if(hours > 0) {\r\n        if(hours > 1) {\r\n            formatted += hours + \" hours\";\r\n        } else {\r\n            formatted += hours + \" hour\";\r\n        }\r\n    }\r\n    if(minutes > 0) {\r\n        if(hours > 0) {\r\n            formatted += \" \";\r\n        }\r\n        if(minutes > 1) {\r\n            formatted += minutes + \" minutes\";\r\n        } else {\r\n            formatted += minutes + \" minute\";\r\n        }\r\n    }\r\n    return formatted;\r\n}\r\n\r\nfunction get_hit_chance(attack_points, evasion_points) {\r\n    let result = attack_points/(attack_points+evasion_points);\r\n\r\n    if(result >= 0.80) {\r\n        result = 0.971+(result-0.8)**1.4;\r\n    } else if(result >= 0.70) {\r\n        result = 0.846+(result-0.7)**0.9;\r\n    } else if(result >= 0.6) {\r\n        result = 0.688+(result-0.6)**0.8;\r\n    } else if(result >= 0.50) {\r\n        result = 0.53+(result-0.5)**0.8;\r\n    } else if(result >= 0.40) {\r\n        result = 0.331+(result-0.4)**0.7;\r\n    } else if(result >= 0.3) {\r\n        result = 0.173 + (result-0.3)**0.8;\r\n    } else if(result >= 0.20) {\r\n        result = 0.073 + (result-0.2);\r\n    } else if(result >= 0.10) {\r\n        result = 0.01 + (result-0.1)**1.2;\r\n    } else {\r\n        result = 0;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * \r\n * @returns {String} 1 if a is newer, 0 if both are same, -1 if b is newer\r\n */\r\nfunction compare_game_version(version_a, version_b) {\r\n    let a = version_a.replace(\"v\",\"\").split(\".\");\r\n    let b = version_b.replace(\"v\",\"\").split(\".\");\r\n\r\n    //if length differs, fill shorter with additional zeroes; could just do additional condition in comparison, but this is more fancy\r\n    if(a.length > b.length) {\r\n        b.push(...Array(a.length-b.length).fill(\"0\"));\r\n    } else if(b.length > a.length) {\r\n        a.push(...Array(b.length-a.length).fill(\"0\"));\r\n    }\r\n\r\n    //go through the entire length, comparing values until they differ (or until reaching the end, in which case it will return a 0 after the loop)\r\n    for(let i = 0; i < a.length; i++) {\r\n        let temp;\r\n        if(Number.parseInt(a[i]) && Number.parseInt(b[i])) {\r\n            temp = [Number.parseInt(a[i]), Number.parseInt(b[i])] \r\n        } else {\r\n            temp = [a[i] || 0, b[i] || 0];\r\n        }\r\n        if(temp[0] === temp[1]) {\r\n            continue;\r\n        } else if(temp[0] > temp[1]) {\r\n            return 1;\r\n        } else {\r\n            return -1;\r\n        }\r\n    }\r\n\r\n    return 0;\r\n}\r\n\r\nfunction is_a_older_than_b(version1, version2) {\r\n    return compare_game_version(version1, version2) < 0;\r\n}\r\n\r\nfunction celsius_to_fahrenheit(num) {\r\n    return 32 + Math.round(10*num*9/5)/10;\r\n}\r\n\r\nfunction hex_to_rgb(hex) {\r\n    let result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    return result ? {\r\n        r: parseInt(result[1], 16),\r\n        g: parseInt(result[2], 16),\r\n        b: parseInt(result[3], 16)\r\n    } : {};\r\n}\r\n\r\nfunction calculate_luminance({r, g, b}) {\r\n    const red = 0.2126;\r\n    const green = 0.7152;\r\n    const blue = 0.0722;\r\n    const gamma = 2.4;\r\n\r\n    let a = [r, g, b].map((v) => {\r\n            v /= 255;\r\n            return v <= 0.03928\r\n            ? v / 12.92\r\n            : Math.pow((v + 0.055) / 1.055, gamma);\r\n        }\r\n    );\r\n    return a[0] * red + a[1] * green + a[2] * blue;\r\n}\r\n\r\nfunction calculate_contrast(color_a, color_b) {\r\n    let luminance_1 = calculate_luminance(hex_to_rgb(color_a));\r\n    let luminance_2 = calculate_luminance(hex_to_rgb(color_b));\r\n    let brightest = Math.max(luminance_1, luminance_2);\r\n    let darkest = Math.min(luminance_1, luminance_2);\r\n    return (brightest + 0.05) / (darkest + 0.05);\r\n}\r\n\r\nfunction select_outline_class(color_hex) {\r\n    const black_outline_class = \"outline_black\";\r\n    const white_outline_class = \"outline_white\";\r\n\r\n    const contrast_with_black = calculate_contrast(color_hex, \"#000000\");\r\n    const contrast_with_white = calculate_contrast(color_hex, \"#ffffff\");\r\n    if(contrast_with_black > contrast_with_white) {\r\n        return black_outline_class;\r\n    } else {\r\n        return white_outline_class;\r\n    }\r\n}\r\n\r\nexport { expo, format_reading_time, format_working_time, \r\n        get_hit_chance, round_item_price,\r\n        compare_game_version, is_a_older_than_b,\r\n        stat_names, task_type_names, skill_consumable_tags, crafting_tags_to_skills,\r\n        celsius_to_fahrenheit,\r\n        select_outline_class\r\n    };\r\n", "\"use strict\";\r\nimport {round_item_price } from \"./items.js\";\r\n\r\nconst loot_sold_count = {};\r\n\r\nconst group_key_prefix = \"type_\";\r\n\r\n//direct connections for resource trickle\r\nconst market_regions = {};\r\nconst market_region_mapping = {\r\n    \"Village\": [\"Slums\", \"Swamp\"],\r\n};\r\n\r\n//different caps for normal items and for equipment/components, with the first reaching 1/10th around 1000 sold and latter around 200 sold\r\nconst capped_at = 500;\r\nconst item_saturation_cap = capped_at - 1;\r\nconst item_saturation_param = Math.round(capped_at/9);\r\n\r\nconst equipment_capped_at = 200;\r\nconst equipment_saturation_cap = equipment_capped_at - 1;\r\nconst equipment_saturation_param = Math.round(equipment_capped_at/9);\r\n\r\n\r\n//for easier management, make it symmetrical\r\nObject.keys(market_region_mapping).forEach(region => {\r\n\r\n    loot_sold_count[region] = {}; //also do this\r\n\r\n    for(let i = 0; i < market_region_mapping[region].length; i++) {\r\n        if(!market_region_mapping[market_region_mapping[region][i]]) {\r\n            market_region_mapping[market_region_mapping[region][i]] = [region];\r\n        } else {\r\n            if(!market_region_mapping[market_region_mapping[region][i]].includes(region)) {\r\n                market_region_mapping[market_region_mapping[region][i]].push(region);\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n/**\r\n * fills loot_sold_count with keys from market_regions (added in locations which have regions assigned)\r\n */\r\nfunction fill_market_regions() {\r\n    Object.keys(market_regions).forEach(region => {\r\n        loot_sold_count[region] = {};\r\n    })\r\n}\r\n\r\n/**\r\n * sets the sold count, used for loading and for inter-region trickling\r\n * @param {*} data \r\n */\r\nfunction set_loot_sold_count(data) {\r\n    Object.keys(data).forEach(market_region_key => {\r\n        loot_sold_count[market_region_key] = {};\r\n        Object.keys(data[market_region_key]).forEach(item_key => {\r\n            loot_sold_count[market_region_key][item_key] = [];\r\n            for(let i = 0; i < data[market_region_key][item_key].length; i++) {\r\n                if(data[market_region_key][item_key][i].sold < 1e13) {\r\n                    if(data[market_region_key][item_key][i].recovered == null) {\r\n                        data[market_region_key][item_key][i].recovered = 0;\r\n                    }\r\n                    loot_sold_count[market_region_key][item_key].push({...data[market_region_key][item_key][i]});\r\n                } else {\r\n                    const sold = 1000;\r\n                    const recovered = Math.min(1000, Math.round(1000 * (data[market_region_key][item_key][i].recovered/data[market_region_key][item_key][i].sold))) ?? 0;\r\n                    loot_sold_count[market_region_key][item_key].push({sold, recovered});\r\n                    console.warn(`Encountered a suspiciously large sold count of a trade group \"${item_key}\" at tier ${i} (${data[market_region_key][item_key][i].sold}).`\r\n                        +` It has been reduced to a 1000, and it's recovered_count was lowered in proportion to it.`);\r\n                }\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\nfunction recover_item_prices(flat_recovery=1, ratio_recovery = 0) {\r\n    Object.keys(loot_sold_count).forEach(region_key => {\r\n        Object.keys(loot_sold_count[region_key]).forEach(item_group_key => {\r\n            for(let i = 0; i < loot_sold_count[region_key][item_group_key].length; i++) {\r\n\r\n                //recovered stored as a separate value that cannot be larger than sold count;\r\n                loot_sold_count[region_key][item_group_key][i].recovered += Math.max(ratio_recovery*(loot_sold_count[region_key][item_group_key][i].sold-loot_sold_count[region_key][item_group_key][i].recovered), flat_recovery);\r\n                \r\n                if(loot_sold_count[region_key][item_group_key][i].recovered > loot_sold_count[region_key][item_group_key][i].sold) {\r\n                    loot_sold_count[region_key][item_group_key][i].recovered = loot_sold_count[region_key][item_group_key][i].sold;\r\n                }                \r\n            }\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Goes through all market regions, trickling their saturations at low rate from any region to all that are directly connected to it\r\n * @param {*} trickle_rate \r\n */\r\nfunction trickle_market_saturations(trickle_rate) {\r\n    const new_sold_count = {};\r\n\r\n    Object.keys(market_region_mapping).forEach(trade_region => {\r\n        //go through regions\r\n\r\n        const connections_count = market_region_mapping[trade_region].length;\r\n        for(let i = 0; i < connections_count; i++) {\r\n            //iterate through connected regions\r\n            const connected_region = market_region_mapping[trade_region][i];\r\n            new_sold_count[connected_region] = new_sold_count[connected_region] || {};\r\n            new_sold_count[trade_region] = new_sold_count[trade_region] || {};\r\n\r\n            Object.keys(loot_sold_count[trade_region] || {}).forEach(group_key => {\r\n                //go through saturation groups\r\n\r\n                new_sold_count[connected_region][group_key] = new_sold_count[connected_region][group_key] || [];\r\n                new_sold_count[trade_region][group_key] = new_sold_count[trade_region][group_key] || [];\r\n                //new_sold_count[trade_region][group_key] = [];\r\n                for(let group_tier = 0; group_tier < loot_sold_count[trade_region][group_key].length; group_tier++) {\r\n                    //go through saturation groups' tier\r\n        \r\n                    \r\n                    const saturation_level = loot_sold_count[trade_region][group_key][group_tier].sold - loot_sold_count[trade_region][group_key][group_tier].recovered;\r\n                    //saturation level, basis for what to move, calculated as a simple difference between sold and recovered\r\n\r\n                    const total_value_to_move = Math.floor(saturation_level * trickle_rate);\r\n                    loot_sold_count[trade_region][group_key][group_tier].sold -= total_value_to_move;\r\n                    //reducing sold count in current by trickle rate (some fraction) * saturation level\r\n\r\n                    const value_to_move = Math.floor(total_value_to_move / connections_count);\r\n                    //and dividing by connection count, to distribute evenly\r\n\r\n                    if(!new_sold_count[trade_region][group_key][group_tier]) {\r\n                        new_sold_count[trade_region][group_key][group_tier] = {...loot_sold_count[trade_region][group_key][group_tier]};\r\n                    } else {\r\n                        new_sold_count[trade_region][group_key][group_tier].sold -= total_value_to_move;\r\n                    }\r\n\r\n                    if(!new_sold_count[connected_region][group_key][group_tier]) {\r\n                        if(loot_sold_count[connected_region]?.[group_key]?.[group_tier]) {\r\n                            new_sold_count[connected_region][group_key][group_tier] = {...loot_sold_count[connected_region][group_key][group_tier]};\r\n                        } else {\r\n                            new_sold_count[connected_region][group_key][group_tier] = {sold: 0, recovered: 0};\r\n                        }\r\n                    }\r\n                    \r\n                    new_sold_count[connected_region][group_key][group_tier].sold += value_to_move;\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    set_loot_sold_count(new_sold_count);\r\n    //actually assign the newly calculated values\r\n}\r\n\r\n/**\r\n * To be called with sold count already calculated elsewhere and just passed as an argument\r\n * @param {*} value only for rounding\r\n * @param {*} how_many_sold \r\n * @returns \r\n */\r\nfunction get_loot_price_modifier({is_group, value, how_many_sold}) {\r\n    let modifier = 1;\r\n    let modifier_caps_at;\r\n    let param;\r\n    if(is_group) {\r\n        modifier_caps_at = equipment_saturation_cap;\r\n        param = equipment_saturation_param;\r\n    } else {\r\n        modifier_caps_at = item_saturation_cap;\r\n        param = item_saturation_param;\r\n    }\r\n\r\n    if(how_many_sold >= modifier_caps_at) {\r\n        modifier = 0.1;\r\n    } else if(how_many_sold > 0) {\r\n        modifier = modifier * param/(param+how_many_sold);\r\n    }\r\n    //no case for negatives, prices don't go above the starting values\r\n\r\n    return Math.round(value*modifier)/value;\r\n}\r\n\r\n/**\r\n * calculates total saturation of group in a provided region, including items of both lower and higher tier\r\n * @param {*} param0 \r\n * @returns \r\n */\r\nfunction get_total_tier_saturation({ region, group_key, group_tier }) {\r\n    if(!loot_sold_count[region][group_key]) {\r\n        return 0;\r\n    }\r\n\r\n    const sold_by_tier = [];\r\n    for(let i = 0; i < loot_sold_count[region][group_key]?.length; i++) {\r\n        sold_by_tier[i] = Math.max(0,loot_sold_count[region][group_key][i].sold - loot_sold_count[region][group_key][i].recovered);\r\n    }\r\n\r\n    const cap = group_key.startsWith(group_key_prefix)?equipment_capped_at:capped_at;\r\n    return calculate_total_saturation({sold_by_tier, target_tier:group_tier, cap});\r\n}\r\n\r\n/**\r\n * calculates saturation for provided sold counts\r\n * @param {} param0 \r\n * @returns \r\n */\r\nfunction calculate_total_saturation({sold_by_tier, target_tier, cap}) {\r\n    if(!sold_by_tier) {\r\n        return 0;\r\n    }\r\n    let count = 0;\r\n    for(let i = target_tier - 1; i >= 0; i--) {\r\n        //x0.25 for each tier going down\r\n        count += Math.max(sold_by_tier[i] ?? 0)*0.1**(target_tier-i);\r\n    }\r\n    \r\n    //lower tier impact capped at eight of the cap\r\n    count = Math.min(cap/8, count);\r\n    count += (sold_by_tier[target_tier] ?? 0);\r\n\r\n    for(let i = target_tier + 1 ; i < sold_by_tier.length; i++) {\r\n        //x1 for each tier going down\r\n        count += Math.max(sold_by_tier[i] ?? 0);\r\n    }\r\n    return count;\r\n}\r\n\r\n/**\r\n * @param {Object} data\r\n * @param {Number} data.value\r\n * @param {Number} data.start_count\r\n * @param {Number} data.how_many_to_sell\r\n * @returns \r\n */\r\nfunction get_loot_price_multiple({value, start_count, how_many_to_trade, is_group, is_selling = true, stop_multiplier_at}) {\r\n    let sum = 0;\r\n    if(is_selling) {\r\n        /*\r\n        for(let i = start_count; i < start_count+how_many_to_trade; i++) {\r\n            sum += round_item_price(value*get_loot_price_modifier({value, how_many_sold: Math.min(start_count+stop_multiplier_at,i), is_group}));\r\n        }\r\n        */\r\n        for(let i = 0; i < how_many_to_trade; i++) {\r\n            sum += round_item_price(value*get_loot_price_modifier({value, how_many_sold: Math.min(start_count+stop_multiplier_at,i+start_count), is_group}));\r\n        }\r\n    } else {\r\n        /*\r\n        for(let i = start_count; i > start_count-how_many_to_trade; i--) {\r\n            sum += round_item_price(value*get_loot_price_modifier({value, how_many_sold: Math.min(start_count+stop_multiplier_at,Math.max(i,0)), is_group}));\r\n        }\r\n        */\r\n        for(let i = 0; i > -how_many_to_trade; i--) {\r\n            sum += round_item_price(value*get_loot_price_modifier({value, how_many_sold: Math.min(start_count+stop_multiplier_at,Math.max(i+start_count,0)), is_group}));\r\n        }\r\n    }\r\n    \r\n    return sum;\r\n}\r\n\r\nfunction get_item_value_with_market_saturation({value, group_key, group_tier, region}) {\r\n\r\n    const how_many_sold = get_total_tier_saturation({region, group_key, group_tier});\r\n    return Math.max(\r\n            1, round_item_price(\r\n                    value * get_loot_price_modifier({value: value, how_many_sold, is_group: group_key.startsWith(group_key_prefix)})\r\n            )\r\n        );\r\n}\r\n\r\n/**\r\n * i.e. when selling\r\n */\r\nfunction add_to_sold({group_key, group_tier, count, region}) {\r\n    if(!loot_sold_count[region][group_key]) {\r\n        loot_sold_count[region][group_key] = new Array(group_tier+1).fill().map(() => ({sold: 0, recovered: 0}));\r\n    }\r\n    if(!loot_sold_count[region][group_key][group_tier]) {\r\n        loot_sold_count[region][group_key].push(...new Array(group_tier+1-loot_sold_count[region][group_key].length).fill().map(() => ({sold: 0, recovered: 0})));\r\n    }\r\n\r\n    loot_sold_count[region][group_key][group_tier].sold += (count || 1);\r\n}\r\n\r\n/**\r\n * i.e. when buying\r\n */\r\nfunction remove_from_sold({group_key, group_tier, count, region}) {\r\n    if(!loot_sold_count[region][group_key] || !loot_sold_count[region][group_key][group_tier]) {\r\n        //since prices cannot increase, there's no point in getting negative values\r\n        return;\r\n    }\r\n    loot_sold_count[region][group_key][group_tier].sold = Math.max(loot_sold_count[region][group_key][group_tier].sold - (count || 1),0);\r\n    loot_sold_count[region][group_key][group_tier].recovered = Math.min(loot_sold_count[region][group_key][group_tier].recovered, loot_sold_count[region][group_key][group_tier].sold);\r\n}\r\n\r\nexport {\r\n    loot_sold_count, group_key_prefix,\r\n    recover_item_prices, trickle_market_saturations, market_region_mapping,\r\n    set_loot_sold_count,\r\n    get_loot_price_modifier, get_loot_price_multiple,\r\n    get_item_value_with_market_saturation,\r\n    add_to_sold, remove_from_sold,\r\n    get_total_tier_saturation, calculate_total_saturation,\r\n    capped_at, equipment_capped_at,\r\n    market_regions, fill_market_regions\r\n};", "\"use strict\";\r\n\r\nimport { getItem, getItemFromKey, item_templates } from \"./items.js\";\r\n\r\n//extended by character and traders, as their inventories are supposed to work the same way\r\nclass InventoryHaver {\r\n    \r\n    constructor() {\r\n        this.inventory = {}; //currently items are stored separately and are re-added on load\r\n    }\r\n\r\n    /**\r\n     * @description adds items from the list to inventory; don't use this method directly, there are other methods that call this one and take care of display\r\n     * @param {Array} items - [{item_key, count, item_id (if no key), quality (optional if no key)},...]\r\n     */\r\n    add_to_inventory(items) {\r\n        let anything_new = false;\r\n        \r\n        for(let i = 0; i < items.length; i++){\r\n            let item_key;\r\n            if(items[i].item_key){\r\n                item_key = items[i].item_key;\r\n            } else {\r\n                //this part is so stupid (recreating item just to grab it's key)\r\n                //but at least it wont break if code for creating inventory keys changes\r\n                let item;\r\n                if(items[i].quality) {\r\n                    item = getItem({...item_templates[items[i].item_id], quality:items[i].quality});\r\n                } else {\r\n                    item = getItem({...item_templates[items[i].item_id]});\r\n                }\r\n                item_key = item.getInventoryKey();\r\n            } \r\n\r\n            if(!(item_key in this.inventory)) {//not in inventory\r\n                if(!items[i].count) {\r\n                    items[i].count = 1;\r\n                }\r\n                const item = getItemFromKey(item_key);\r\n                this.inventory[item_key] = {item, count: items[i].count};\r\n                anything_new = true;\r\n            } else { //in inventory\r\n                if(items[i].count === undefined) {\r\n                    this.inventory[item_key].count += 1;\r\n                } else if(typeof items[i].count === \"number\" && !isNaN(items[i].count)){\r\n                    this.inventory[item_key].count += items[i].count;\r\n                } else {\r\n                    throw new TypeError(`Tried to add \"${items[i].count}\" items, which is not a valid number!`);\r\n                }\r\n            }\r\n        }\r\n        return anything_new;\r\n    }\r\n\r\n    /**\r\n     * @description removes specified items (array of {item_key, count}) from the inventory; don't use this method directly, there are other methods that call this one and take care of display\r\n     * @param {Array} items [{item_key, item_count}]\r\n     **/\r\n    remove_from_inventory(items) {\r\n        for(let i = 0; i < items.length; i++){       \r\n            if(items[i].item_key in this.inventory) { //check if its in inventory, just in case, probably not needed\r\n\r\n                if(typeof items[i].item_count === \"number\" && Number.isInteger(items[i].item_count) && items[i].item_count >= 1)  {\r\n                    this.inventory[items[i].item_key].count -= items[i].item_count;\r\n                }  else {\r\n                    this.inventory[items[i].item_key].count -= 1; //remove one if count was not passed\r\n                }\r\n    \r\n                if(this.inventory[items[i].item_key].count == 0) {\r\n                    delete this.inventory[items[i].item_key]; \r\n                    //removes item from inventory if it's county is 0\r\n                } else if(this.inventory[items[i].item_key].count < 0 || isNaN(this.inventory[items[i].item_key].count)) {\r\n                    throw new Error(`Item count for key \"${items[i].item_key}\" reached an illegal value of \"${this.inventory[items[i].item_key].count}\"`);\r\n                }\r\n                \r\n            } else { \r\n                    throw new Error(\"Tried to remove item that was not present in inventory\");\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport {InventoryHaver};", "\"use strict\";\r\n\r\nimport { character, get_total_skill_level } from \"./character.js\";\r\nimport { Armor, ArmorComponent, Cape, Shield, ShieldComponent, Weapon, WeaponComponent, item_templates } from \"./items.js\";\r\nimport { skills } from \"./skills.js\";\r\n\r\nconst crafting_recipes = {items: {}, components: {}, equipment: {}};\r\nconst cooking_recipes = {items: {}};\r\nconst smelting_recipes = {items: {}};\r\nconst forging_recipes = {items: {}, components: {}};\r\nconst alchemy_recipes = {items: {}};\r\nconst butchering_recipes = { items: {} };\r\nconst woodworking_recipes = {items: {}, components: {}};\r\n\r\n/*\r\n    recipes can be treated differently for display based on if they are in items/components/equipment category\r\n\r\n    non-equipment recipes have a success rate (presented with min-max value, where max should be 1) that shall scale with skill level and with crafting station level\r\n    for equipment recipes, there is no success rate in favor of equipment's \"quality\" property\r\n\r\n    resulting quality of equipment is based on component quality, result tier, crafting station tier and relevant skill level\r\n    \r\n    overal max quality achievable scales with related skills\r\n*/\r\n\r\nfunction get_crafting_quality_caps(skill_name) {\r\n    return {\r\n        components: Math.min(Math.round(100+2*get_total_skill_level(skill_name)),200),\r\n        equipment: Math.min(Math.round(100+2.8*get_total_skill_level(skill_name)),250),\r\n    }\r\n}\r\n\r\nclass Recipe {\r\n    constructor({\r\n        name,\r\n        id,\r\n        is_unlocked = true,\r\n        recipe_type,\r\n        result, //{name, count}\r\n        getResult,\r\n        recipe_level = [1,1],\r\n        recipe_skill,\r\n    }) {\r\n        this.name = name;\r\n        this.id = id;\r\n        this.is_unlocked = is_unlocked;\r\n        this.recipe_type = recipe_type;\r\n        this.result = result;\r\n        this.getResult = getResult || function(){return this.result};\r\n        this.recipe_level = recipe_level;\r\n        this.recipe_skill = recipe_skill;\r\n    }\r\n}\r\n\r\nclass ItemRecipe extends Recipe {\r\n    constructor({\r\n        name,\r\n        id,\r\n        materials = [], //{name, count}\r\n        is_unlocked = true,\r\n        recipe_type,\r\n        result, //{name, count}\r\n        getResult,\r\n        recipe_level,\r\n        recipe_skill,\r\n        success_chance = [1,1],\r\n    }) {\r\n        super({name, id, is_unlocked, recipe_type, result, getResult, recipe_level, recipe_skill});\r\n        this.materials = materials;\r\n        this.success_chance = success_chance;\r\n        if(this.success_chance[0]==0){\r\n            this.success_chance[0] = 0.1;\r\n        }\r\n    }\r\n\r\n    get_success_chance(station_tier=1) {\r\n        const level = Math.min(this.recipe_level[1]-this.recipe_level[0]+1, Math.max(0,get_total_skill_level(this.recipe_skill)-this.recipe_level[0]+1));\r\n        const skill_modifier = Math.min(1,(0||(level+(station_tier-1))/(this.recipe_level[1]-this.recipe_level[0]+1)));\r\n        return this.success_chance[0]*(this.success_chance[1]/this.success_chance[0])**skill_modifier;\r\n    }\r\n\r\n    get_availability() {\r\n        let ammount = Infinity;\r\n        let materials = [];\r\n        for(let i = 0; i < this.materials.length; i++) {\r\n            if(this.materials[i].material_id) {\r\n                const key = item_templates[this.materials[i].material_id].getInventoryKey();\r\n                if(!character.inventory[key]) {\r\n                    return 0;\r\n                }\r\n                ammount = Math.floor(Math.min(character.inventory[key].count / this.materials[i].count, ammount));\r\n            } else if (this.materials[i].material_type) {\r\n                let mats = [];\r\n\r\n                //going through possible items and checking for their presence would surely be faster\r\n                Object.keys(character.inventory).forEach(key => {\r\n                    if(character.inventory[key].item.material_type === this.materials[i].material_type && character.inventory[key].count >= this.materials[i].count) {\r\n                        mats.push(character.inventory[key]);\r\n                    }\r\n                });\r\n                if(mats.length == 0) {\r\n                    return 0;\r\n                }\r\n\r\n                mats = mats.sort((a,b) => a.item.getBaseValue()-b.item.getBaseValue());\r\n                ammount = Math.floor(Math.min(mats[0].count / this.materials[i].count, ammount));\r\n                materials.push(mats[0].item.id);\r\n            }\r\n        }\r\n        \r\n        return {available_ammount: ammount, materials};\r\n    }\r\n}\r\n\r\nclass ComponentRecipe extends ItemRecipe{\r\n    constructor({\r\n        name,\r\n        id,\r\n        materials = [], \r\n        is_unlocked = true,\r\n        result, //{item, count, result_name} where result_name is an item_templates key\r\n        component_type,\r\n        recipe_skill,\r\n        item_type,\r\n    }) {\r\n        super({name, id, materials, is_unlocked, recipe_type: \"component\", result, recipe_level: [1,1], recipe_skill, getResult: null, success_rate: [1,1]})\r\n        this.component_type = component_type;\r\n        this.item_type = item_type;\r\n        this.getResult = function(material, station_tier = 1){\r\n            const result = item_templates[this.materials.filter(x => x.material_id===material.id)[0].result_id];\r\n            //return based on material used\r\n            let quality = this.get_quality((station_tier-result.component_tier) || 0);\r\n            if(result.tags[\"clothing\"]) {\r\n                //means its a clothing (wearable internal part of armor)\r\n                return new Armor({...item_templates[result.id], quality: quality});\r\n            } else if(result.tags[\"armor component\"]) {\r\n\r\n                return new ArmorComponent({...item_templates[result.id], quality: quality});\r\n            } else if(result.tags[\"weapon component\"]) {\r\n\r\n                return new WeaponComponent({...item_templates[result.id], quality: quality});\r\n            } else if(result.tags[\"shield component\"]) {\r\n\r\n                return new ShieldComponent({...item_templates[result.id], quality: quality});\r\n            } else {\r\n                throw new Error(`Component recipe ${this.name} does not produce a valid result!`);\r\n            }\r\n        }\r\n    }\r\n\r\n    get_quality_range(tier = 0) {\r\n        const skill = skills[this.recipe_skill];\r\n        const quality = (130+(3*get_total_skill_level(this.recipe_skill) - skill.max_level)+(15*tier))/100;\r\n        return [Math.max(10,Math.min(this.get_quality_cap(),Math.round(25*(quality-0.15))*4)), Math.max(10,Math.min(this.get_quality_cap(), Math.round(25*(quality+0.1))*4))];\r\n    }\r\n\r\n    get_quality_cap() {\r\n        if(this.item_type === \"Armor\") {\r\n            return get_crafting_quality_caps(this.recipe_skill).equipment;\r\n        } else {\r\n            return get_crafting_quality_caps(this.recipe_skill).components;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * checks if quality is completely capped, that is every created item will have the exact same value\r\n     * @returns {Boolean}\r\n     */\r\n    get_is_quality_capped() {\r\n        return this.get_quality_range()[0] >= this.get_quality_cap();\r\n    }\r\n\r\n    get_quality(tier = 0) {\r\n        const quality_range = this.get_quality_range(tier);\r\n        return Math.round(((quality_range[1]-quality_range[0])*Math.random()+quality_range[0])/4)*4;\r\n    }\r\n}\r\n\r\nclass ComponentlessEquipRecipe extends ItemRecipe{\r\n    constructor({\r\n        name,\r\n        id,\r\n        materials = [], \r\n        is_unlocked = true,\r\n        result, //{item, count, result_name} where result_name is an item_templates key\r\n        recipe_skill,\r\n        item_type,\r\n    }) {\r\n        super({name, id, materials, is_unlocked, recipe_type: \"componentless\", result, recipe_level: [1,1], recipe_skill, getResult: null, success_rate: [1,1]})\r\n        this.item_type = item_type;\r\n        this.getResult = function(material, station_tier = 1){\r\n            const result = item_templates[this.materials.filter(x => x.material_id===material.id)[0].result_id];\r\n            //return based on material used\r\n            let quality = this.get_quality((station_tier-result.item_tier) || 0);\r\n            return new Cape({...item_templates[result.id], quality: quality});\r\n        }\r\n    }\r\n\r\n    get_quality_range(tier = 0) {\r\n        const skill = skills[this.recipe_skill];\r\n        const quality = (130+(3*get_total_skill_level(this.recipe_skill) - skill.max_level)+(15*tier))/100;\r\n        return [Math.max(10,Math.min(this.get_quality_cap(),Math.round(25*(quality-0.15))*4)), Math.max(10,Math.min(this.get_quality_cap(), Math.round(25*(quality+0.1))*4))];\r\n    }\r\n\r\n    get_quality_cap() {\r\n        return get_crafting_quality_caps(this.recipe_skill).equipment;\r\n    }\r\n\r\n    /**\r\n     * checks if quality is completely capped, that is every created item will have the exact same value\r\n     * @returns {Boolean}\r\n     */\r\n    get_is_quality_capped() {\r\n        return this.get_quality_range()[0] >= this.get_quality_cap();\r\n    }\r\n\r\n    get_quality(tier = 0) {\r\n        const quality_range = this.get_quality_range(tier);\r\n        return Math.round(((quality_range[1]-quality_range[0])*Math.random()+quality_range[0])/4)*4;\r\n    }\r\n}\r\n\r\nclass EquipmentRecipe extends Recipe {\r\n    constructor({\r\n        name,\r\n        id,\r\n        components = [], //pair of component types; first letter not capitalized; blade-handle or internal-external\r\n        is_unlocked = true,\r\n        result = null,\r\n        recipe_skill = \"Crafting\",\r\n        item_type, //Weapon/Armor/Shield\r\n        //no recipe level, difficulty based on selected components\r\n    }) {\r\n        super({name, id, is_unlocked, recipe_type: \"equipment\", result, getResult: null, recipe_level: [1,1], recipe_skill, success_rate: [1,1]})\r\n        this.components = components;\r\n        this.item_type = item_type;\r\n        this.getResult = function(component_1, component_2, station_tier = 1){\r\n            const comp_quality_weighted = this.get_component_quality_weighted(component_1, component_2);\r\n            let quality = this.get_quality(comp_quality_weighted, (station_tier-Math.max(component_1.component_tier, component_2.component_tier)) || 0);\r\n            \r\n            //return based on components used\r\n            if(this.item_type === \"Weapon\") {\r\n                return new Weapon(\r\n                    {\r\n                        components: {\r\n                            head: component_1.id,\r\n                            handle: component_2.id,\r\n                        },\r\n                        quality: quality,\r\n                    }\r\n                );\r\n            } else if(this.item_type === \"Armor\") {\r\n                return new Armor(\r\n                    {\r\n                        components: {\r\n                            internal: component_1.id,\r\n                            external: component_2.id,\r\n                        },\r\n                        quality: quality,\r\n                    }\r\n                );\r\n            } else if(this.item_type === \"Shield\") {\r\n                return new Shield(\r\n                    {\r\n                        components: {\r\n                            shield_base: component_1.id,\r\n                            handle: component_2.id,\r\n                        },\r\n                        quality: quality,\r\n                    }\r\n                );\r\n            } else {\r\n                throw new Error(`Recipe \"${this.name}\" has an incorrect item_type provided (\"${this.item_type}\")`);\r\n            }\r\n        }\r\n    }\r\n\r\n    get_quality_range(component_quality, tier = 0) {\r\n        const skill = skills[this.recipe_skill];\r\n        const quality = (50+component_quality+(3*get_total_skill_level(this.recipe_skill)-skill.max_level)+10*(tier));\r\n        return [Math.max(10,Math.min(this.get_quality_cap(),Math.round(quality-15))), Math.max(10,Math.min(this.get_quality_cap(), Math.round(quality+15)))];\r\n    }\r\n\r\n    get_quality_cap() {\r\n        return get_crafting_quality_caps(this.recipe_skill).equipment;\r\n    }\r\n\r\n    get_quality(component_quality, tier = 0) {\r\n        const quality_range = this.get_quality_range(component_quality, tier);\r\n        return Math.round(((quality_range[1]-quality_range[0])*Math.random()+quality_range[0])/2)*2;\r\n    }\r\n\r\n    get_component_quality_weighted(component_1, component_2) {\r\n        return (component_1.quality*component_1.component_tier + component_2.quality*component_2.component_tier)/(component_1.component_tier+component_2.component_tier);\r\n    }\r\n}\r\n\r\nfunction get_recipe_xp_value({category, subcategory, recipe_id, material_count, result_tier, selected_components, rarity_multiplier}) {\r\n    //\r\n    //for components: multiplied by material count (so every component of same tier is equally profitable to craft)\r\n    //for equipment: based on component tier average\r\n    if(!category || !subcategory || !recipe_id) {\r\n        //shouldn't be possible to reach this\r\n        throw new Error(`Tried to use a recipe but either category, subcategory, or recipe id was not passed: ${category} - ${subcategory} - ${recipe_id}`);\r\n    }\r\n    let exp_value = 4;\r\n    const selected_recipe = recipes[category][subcategory][recipe_id];\r\n    const skill_level = skills[selected_recipe.recipe_skill].current_level; //don't use buffed level as that would only result in reduced xp gain, which is not desired here\r\n    if(!selected_recipe) {\r\n        throw new Error(`Tried to use a recipe that doesn't exist: ${category} -> ${subcategory} -> ${recipe_id}`);\r\n    }\r\n    if(subcategory === \"items\") {\r\n        exp_value = Math.max(exp_value,1.5*selected_recipe.recipe_level[1])**1.1;\r\n        //maybe scale with materials needed?\r\n        \r\n        if(selected_recipe.recipe_level[1] < skill_level) {\r\n            exp_value = Math.max(1,exp_value * Math.max(0,Math.min(5,(selected_recipe.recipe_level[1]+6-skill_level))/5));\r\n            //penalty kicks in when more than 5 levels more than needed, goes down to 0 within further 5 levels\r\n        }\r\n    } else if (subcategory === \"components\" || selected_recipe.recipe_type === \"component\" || selected_recipe.recipe_type === \"componentless\") {\r\n        const result_level = 8*result_tier;\r\n        exp_value = Math.max(exp_value**1.2,((result_tier * 4)**1.1) * material_count);\r\n\r\n        if(result_level > skill_level*rarity_multiplier**0.5) {\r\n            //full value\r\n            exp_value = Math.max(0.5*material_count,exp_value*rarity_multiplier);\r\n        } else {\r\n            //scaled value\r\n            exp_value = Math.max(0.5*material_count,exp_value*rarity_multiplier*Math.max(0,Math.min(5,result_level*rarity_multiplier**0.5+5-skill_level))/5);\r\n        }\r\n        //penalty kicks in when skill level is more than 8*item_tier, but is delayed by sqrt of rarity multiplier\r\n    } else {\r\n        const result_level = 8*Math.max(selected_components[0].component_tier,selected_components[1].component_tier);\r\n        exp_value = Math.max(exp_value,(selected_components[0].component_tier+selected_components[1].component_tier) * 4)**1.1;\r\n\r\n        if(result_level > skill_level*rarity_multiplier**0.5) {\r\n            //full value\r\n            exp_value = Math.max(1,exp_value*rarity_multiplier);\r\n        } else {\r\n            //scaled value\r\n            exp_value = Math.max(1,exp_value*rarity_multiplier*Math.max(0,Math.min(5,result_level*rarity_multiplier**0.5+5-skill_level))/5);\r\n        }\r\n        //penalty kicks in when skill level is more than 8*item_tier, but is delayed by sqrt of rarity multiplier\r\n    }\r\n    return Math.round(10*exp_value)/10;\r\n}\r\n\r\n//weapon components\r\n(()=>{\r\n    forging_recipes.components[\"Short blade\"] = new ComponentRecipe({\r\n        name: \"Short blade\",\r\n        materials: [\r\n            {material_id: \"Low quality iron ingot\", count: 2, result_id: \"Cheap short iron blade\"}, \r\n            {material_id: \"Iron ingot\", count: 2, result_id: \"Short iron blade\"},\r\n            {material_id: \"Steel ingot\", count: 2, result_id: \"Short steel blade\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Forging\"\r\n    });\r\n    forging_recipes.components[\"Long blade\"] = new ComponentRecipe({\r\n        name: \"Long blade\",\r\n        materials: [\r\n            {material_id: \"Low quality iron ingot\", count: 3, result_id: \"Cheap long iron blade\"}, \r\n            {material_id: \"Iron ingot\", count: 3, result_id: \"Long iron blade\"},\r\n            {material_id: \"Steel ingot\", count: 3, result_id: \"Long steel blade\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Forging\",\r\n    });\r\n    forging_recipes.components[\"Axe head\"] = new ComponentRecipe({\r\n        name: \"Axe head\",\r\n        materials: [\r\n            {material_id: \"Low quality iron ingot\", count: 4, result_id: \"Cheap iron axe head\"}, \r\n            {material_id: \"Iron ingot\", count: 4, result_id: \"Iron axe head\"},\r\n            {material_id: \"Steel ingot\", count: 4, result_id: \"Steel axe head\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Forging\"\r\n    });\r\n    forging_recipes.components[\"Hammer head\"] = new ComponentRecipe({\r\n        name: \"Hammer head\",\r\n        materials: [\r\n            {material_id: \"Low quality iron ingot\", count: 4, result_id: \"Cheap iron hammer head\"}, \r\n            {material_id: \"Iron ingot\", count: 4, result_id: \"Iron hammer head\"},\r\n            {material_id: \"Steel ingot\", count: 4, result_id: \"Steel hammer head\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Forging\",\r\n    });\r\n\r\n    forging_recipes.components[\"Short hilt\"] = new ComponentRecipe({\r\n        name: \"Short hilt\",\r\n        materials: [\r\n            {material_id: \"Low quality iron ingot\", count: 1, result_id: \"Cheap short iron hilt\"},\r\n            {material_id: \"Iron ingot\", count: 1, result_id: \"Short iron hilt\"},\r\n            {material_id: \"Steel ingot\", count: 1, result_id: \"Short steel hilt\"},\r\n            {material_id: \"Turtle shellplate\", count: 2, result_id: \"Turtleshell hilt\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Forging\",\r\n    });\r\n    forging_recipes.components[\"Medium handle\"] = new ComponentRecipe({\r\n        name: \"Medium handle\",\r\n        materials: [\r\n            {material_id: \"Low quality iron ingot\", count: 2, result_id: \"Cheap medium iron handle\"},\r\n            {material_id: \"Iron ingot\", count: 2, result_id: \"Medium iron handle\"},\r\n            {material_id: \"Steel ingot\", count: 2, result_id: \"Medium steel handle\"},\r\n            {material_id: \"Turtle shellplate\", count: 4, result_id: \"Turtleshell handle\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Forging\",\r\n    });\r\n    forging_recipes.components[\"Long shaft\"] = new ComponentRecipe({\r\n        name: \"Long shaft\",\r\n        materials: [\r\n            {material_id: \"Low quality iron ingot\", count: 4, result_id: \"Cheap long iron shaft\"},\r\n            {material_id: \"Iron ingot\", count: 4, result_id: \"Long iron shaft\"},\r\n            {material_id: \"Steel ingot\", count: 4, result_id: \"Long steel shaft\"},\r\n            {material_id: \"Turtle shellplate\", count: 8, result_id: \"Turtleshell shaft\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Forging\",\r\n    });\r\n\r\n    crafting_recipes.components[\"Short hilt\"] = new ComponentRecipe({\r\n        name: \"Short hilt\",\r\n        materials: [\r\n            {material_id: \"Processed weak monster bone\", count: 1, result_id: \"Short weak bone hilt\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n    crafting_recipes.components[\"Medium handle\"] = new ComponentRecipe({\r\n        name: \"Medium handle\",\r\n        materials: [\r\n            {material_id: \"Processed weak monster bone\", count: 2, result_id: \"Medium weak bone handle\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n    crafting_recipes.components[\"Long shaft\"] = new ComponentRecipe({\r\n        name: \"Long shaft\",\r\n        materials: [\r\n            {material_id: \"Processed weak monster bone\", count: 4, result_id: \"Long weak bone shaft\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n\r\n    woodworking_recipes.components[\"Short hilt\"] = new ComponentRecipe({\r\n        name: \"Short hilt\",\r\n        materials: [\r\n            {material_id: \"Processed rough wood\", count: 1, result_id: \"Simple short wooden hilt\"},\r\n            {material_id: \"Processed wood\", count: 1, result_id: \"Short wooden hilt\"},\r\n            {material_id: \"Processed ash wood\", count: 1, result_id: \"Short ash wood hilt\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Woodworking\",\r\n    });\r\n    woodworking_recipes.components[\"Medium handle\"] = new ComponentRecipe({\r\n        name: \"Medium handle\",\r\n        materials: [\r\n            {material_id: \"Processed rough wood\", count: 2, result_id: \"Simple medium wooden handle\"},\r\n            {material_id: \"Processed wood\", count: 2, result_id: \"Medium wooden handle\"},\r\n            {material_id: \"Processed ash wood\", count: 2, result_id: \"Medium ash wood handle\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Woodworking\",\r\n    });\r\n    woodworking_recipes.components[\"Long shaft\"] = new ComponentRecipe({\r\n        name: \"Long shaft\",\r\n        materials: [\r\n            {material_id: \"Processed rough wood\", count: 4, result_id: \"Simple long wooden shaft\"},\r\n            {material_id: \"Processed wood\", count: 4, result_id: \"Long wooden shaft\"},\r\n            {material_id: \"Processed ash wood\", count: 4, result_id: \"Long ash wood shaft\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Woodworking\",\r\n    });\r\n})();\r\n\r\n//shield components\r\n(()=>{\r\n    woodworking_recipes.components[\"Shield base\"] = new ComponentRecipe({\r\n        name: \"Shield base\",\r\n        materials: [\r\n            {material_id: \"Processed rough wood\", count: 6, result_id: \"Crude wooden shield base\"}, \r\n            {material_id: \"Processed wood\", count: 6, result_id: \"Wooden shield base\"},\r\n            {material_id: \"Processed ash wood\", count: 6, result_id: \"Ash wood shield base\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Woodworking\",\r\n        component_type: \"shield base\",\r\n    });\r\n\r\n    woodworking_recipes.components[\"Shield handle\"] = new ComponentRecipe({\r\n        name: \"Shield handle\",\r\n        materials: [\r\n            {material_id: \"Processed rough wood\", count: 4, result_id: \"Basic shield handle\"}, \r\n            {material_id: \"Processed wood\", count: 4, result_id: \"Wooden shield handle\"},\r\n            {material_id: \"Processed ash wood\", count: 4, result_id: \"Ash wood shield handle\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Woodworking\",\r\n        component_type: \"shield handle\",\r\n    });\r\n\r\n    forging_recipes.components[\"Shield base\"] = new ComponentRecipe({\r\n        name: \"Shield base\",\r\n        materials: [\r\n            {material_id: \"Low quality iron ingot\", count: 5, result_id: \"Crude iron shield base\"},\r\n            {material_id: \"Iron ingot\", count: 5, result_id: \"Iron shield base\"},\r\n            {material_id: \"Steel ingot\", count: 5, result_id: \"Steel shield base\"},\r\n            {material_id: \"Turtle shellplate\", count: 10, result_id: \"Turtleshell shield base\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Forging\",\r\n        component_type: \"shield base\",\r\n    });\r\n\r\n})();\r\n\r\n//armor components\r\n(()=>{\r\n    crafting_recipes.components[\"Helmet exterior\"] = new ComponentRecipe({\r\n        name: \"Helmet exterior\",\r\n        materials: [\r\n            {material_id: \"Piece of wolf leather\", count: 3, result_id: \"Wolf leather helmet armor\"}, \r\n            {material_id: \"Piece of boar leather\", count: 3, result_id: \"Boar leather helmet armor\"},\r\n            {material_id: \"Piece of bear leather\", count: 3, result_id: \"Bear leather helmet armor\"},\r\n            {material_id: \"Piece of alligator leather\", count: 3, result_id: \"Alligator leather helmet armor\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Crafting\",\r\n        component_type: \"helmet exterior\",\r\n    });\r\n\r\n    forging_recipes.components[\"Helmet exterior\"] = new ComponentRecipe({\r\n        name: \"Helmet exterior\",\r\n        materials: [\r\n            {material_id: \"Iron chainmail\", count: 3, result_id: \"Iron chainmail helmet armor\"},\r\n            {material_id: \"Steel chainmail\", count: 3, result_id: \"Steel chainmail helmet armor\"},\r\n            {material_id: \"Turtle shellplate\", count: 6, result_id: \"Turtleshell helmet armor\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Forging\",\r\n        component_type: \"helmet exterior\",\r\n    });\r\n    \r\n    crafting_recipes.components[\"Chestplate exterior\"] = new ComponentRecipe({\r\n        name: \"Chestplate exterior\",\r\n        materials: [\r\n            {material_id: \"Piece of wolf leather\", count: 5, result_id: \"Wolf leather chestplate armor\"}, \r\n            {material_id: \"Piece of boar leather\", count: 5, result_id: \"Boar leather chestplate armor\"},\r\n            {material_id: \"Piece of bear leather\", count: 5, result_id: \"Bear leather chestplate armor\"},\r\n            {material_id: \"Piece of alligator leather\", count: 5, result_id: \"Alligator leather chestplate armor\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Crafting\",\r\n        component_type: \"chestplate exterior\",\r\n    });\r\n\r\n    forging_recipes.components[\"Chestplate exterior\"] = new ComponentRecipe({\r\n        name: \"Chestplate exterior\",\r\n        materials: [\r\n            {material_id: \"Iron chainmail\", count: 5, result_id: \"Iron chainmail vest\"},\r\n            {material_id: \"Steel chainmail\", count: 5, result_id: \"Steel chainmail vest\"},\r\n            {material_id: \"Turtle shellplate\", count: 10, result_id: \"Turtleshell chestplate\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Forging\",\r\n        component_type: \"chestplate exterior\",\r\n    });\r\n\r\n    crafting_recipes.components[\"Leg armor exterior\"] = new ComponentRecipe({\r\n        name: \"Leg armor exterior\",\r\n        materials: [\r\n            {material_id: \"Piece of wolf leather\", count: 4, result_id: \"Wolf leather greaves\"}, \r\n            {material_id: \"Piece of boar leather\", count: 4, result_id: \"Boar leather greaves\"},\r\n            {material_id: \"Piece of bear leather\", count: 4, result_id: \"Bear leather greaves\"},\r\n            {material_id: \"Piece of alligator leather\", count: 4, result_id: \"Alligator leather greaves\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Crafting\",\r\n        component_type: \"leg armor exterior\",\r\n    });\r\n\r\n    forging_recipes.components[\"Leg armor exterior\"] = new ComponentRecipe({\r\n        name: \"Leg armor exterior\",\r\n        materials: [\r\n            {material_id: \"Iron chainmail\", count: 4, result_id: \"Iron chainmail greaves\"},\r\n            {material_id: \"Steel chainmail\", count: 4, result_id: \"Steel chainmail greaves\"},\r\n            {material_id: \"Turtle shellplate\", count: 8, result_id: \"Turtleshell greaves\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Forging\",\r\n        component_type: \"leg armor exterior\",\r\n    });\r\n\r\n    crafting_recipes.components[\"Glove exterior\"] = new ComponentRecipe({\r\n        name: \"Glove exterior\",\r\n        materials: [\r\n            {material_id: \"Piece of wolf leather\", count: 3, result_id: \"Wolf leather glove armor\"}, \r\n            {material_id: \"Piece of boar leather\", count: 3, result_id: \"Boar leather glove armor\"},\r\n            {material_id: \"Piece of bear leather\", count: 3, result_id: \"Bear leather glove armor\"},\r\n            {material_id: \"Piece of alligator leather\", count: 3, result_id: \"Alligator leather glove armor\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Crafting\",\r\n        component_type: \"glove exterior\",\r\n    });\r\n\r\n    forging_recipes.components[\"Glove exterior\"] = new ComponentRecipe({\r\n        name: \"Glove exterior\",\r\n        materials: [\r\n            {material_id: \"Iron chainmail\", count: 3, result_id: \"Iron chainmail glove\"},\r\n            {material_id: \"Steel chainmail\", count: 3, result_id: \"Steel chainmail glove\"},\r\n            {material_id: \"Turtle shellplate\", count: 6, result_id: \"Turtleshell glove\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Forging\",\r\n        component_type: \"Glove exterior\",\r\n    });\r\n\r\n    crafting_recipes.components[\"Shoes exterior\"] = new ComponentRecipe({\r\n        name: \"Shoes exterior\",\r\n        materials: [\r\n            {material_id: \"Piece of wolf leather\", count: 3, result_id: \"Wolf leather shoe armor\"}, \r\n            {material_id: \"Piece of boar leather\", count: 3, result_id: \"Boar leather shoe armor\"},\r\n            {material_id: \"Piece of bear leather\", count: 3, result_id: \"Bear leather shoe armor\"},\r\n            {material_id: \"Piece of alligator leather\", count: 3, result_id: \"Alligator leather shoe armor\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Crafting\",\r\n        component_type: \"shoes exterior\",\r\n    });\r\n\r\n    forging_recipes.components[\"Shoes exterior\"] = new ComponentRecipe({\r\n        name: \"Shoes exterior\",\r\n        materials: [\r\n            {material_id: \"Iron chainmail\", count: 3, result_id: \"Iron chainmail shoes\"},\r\n            {material_id: \"Steel chainmail\", count: 3, result_id: \"Steel chainmail shoes\"},\r\n            {material_id: \"Turtle shellplate\", count: 6, result_id: \"Turtleshell shoes\"},\r\n        ],\r\n        item_type: \"Component\",\r\n        recipe_skill: \"Forging\",\r\n        component_type: \"shoes exterior\",\r\n    });\r\n\r\n\r\n})();\r\n\r\n//equipment\r\n(()=>{\r\n    //full weapons\r\n    crafting_recipes.equipment[\"Axe\"] = new EquipmentRecipe({\r\n        name: \"Axe\",\r\n        components: [\"axe head\", \"medium handle\"],\r\n        item_type: \"Weapon\",\r\n    });\r\n    crafting_recipes.equipment[\"Dagger\"] = new EquipmentRecipe({\r\n        name: \"Dagger\",\r\n        components: [\"short blade\", \"short handle\"],\r\n        item_type: \"Weapon\",\r\n    });\r\n    crafting_recipes.equipment[\"Hammer\"] = new EquipmentRecipe({\r\n        name: \"Hammer\",\r\n        components: [\"hammer head\", \"medium handle\"],\r\n        item_type: \"Weapon\",\r\n    });\r\n    crafting_recipes.equipment[\"Spear\"] = new EquipmentRecipe({\r\n        name: \"Spear\",\r\n        components: [\"short blade\", \"long handle\"],\r\n        item_type: \"Weapon\",\r\n    });\r\n    crafting_recipes.equipment[\"Sword\"] = new EquipmentRecipe({\r\n        name: \"Sword\",\r\n        components: [\"long blade\", \"short handle\"],\r\n        item_type: \"Weapon\",\r\n    });\r\n\r\n    //full shields\r\n    crafting_recipes.equipment[\"Shield\"] = new EquipmentRecipe({\r\n        name: \"Shield\",\r\n        components: [\"shield base\",\"shield handle\"],\r\n        item_type: \"Shield\",\r\n    });\r\n\r\n    //full armor\r\n    crafting_recipes.equipment[\"Helmet\"] = new EquipmentRecipe({\r\n        name: \"Helmet\",\r\n        components: [\"helmet interior\", \"helmet exterior\"],\r\n        item_type: \"Armor\",\r\n    });\r\n    crafting_recipes.equipment[\"Chestplate\"] = new EquipmentRecipe({\r\n        name: \"Chestplate\",\r\n        components: [\"chestplate interior\", \"chestplate exterior\"],\r\n        item_type: \"Armor\",\r\n    });\r\n    crafting_recipes.equipment[\"Leg armor\"] = new EquipmentRecipe({\r\n        name: \"Leg armor\",\r\n        components: [\"leg armor interior\", \"leg armor exterior\"],\r\n        item_type: \"Armor\",\r\n    });\r\n    crafting_recipes.equipment[\"Gauntlets\"] = new EquipmentRecipe({\r\n        name: \"Gauntlets\",\r\n        components: [\"glove interior\", \"glove exterior\"],\r\n        item_type: \"Armor\",\r\n    });\r\n    crafting_recipes.equipment[\"Armored shoes\"] = new EquipmentRecipe({\r\n        name: \"Armored shoes\",\r\n        components: [\"shoes interior\", \"shoes exterior\"],\r\n        item_type: \"Armor\",\r\n    });\r\n})();\r\n    \r\n//clothes (which is also equipment, but also components, therefore separate)\r\n(()=>{\r\n    crafting_recipes.equipment[\"Hat\"] = new ComponentRecipe({\r\n        name: \"Hat\",\r\n        materials: [\r\n            {material_id: \"Piece of wolf leather\", count: 3, result_id: \"Leather hat\"},\r\n            {material_id: \"Wool cloth\", count: 3, result_id: \"Wool hat\"},\r\n            {material_id: \"Piece of goat leather\", count: 3, result_id: \"Goat leather hat\"},\r\n            {material_id: \"Linen cloth\", count: 3, result_id: \"Linen bandanna\"},\r\n            {material_id: \"Piece of snakeskin leather\", count: 3, result_id: \"Snakeskin hat\"},\r\n            {material_id: \"Piece of frog leather\", count: 3, result_id: \"Batrachian hat\"}\r\n        ],\r\n        item_type: \"Armor\",\r\n        component_type: \"helmet interior\",\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n\r\n    crafting_recipes.equipment[\"Shirt\"] = new ComponentRecipe({\r\n        name: \"Shirt\",\r\n        materials: [\r\n            {material_id: \"Piece of wolf rat leather\", count: 5, result_id: \"Cheap leather vest\"},\r\n            {material_id: \"Piece of wolf leather\", count: 5, result_id: \"Leather vest\"},\r\n            {material_id: \"Wool cloth\", count: 5, result_id: \"Wool shirt\"},\r\n            {material_id: \"Piece of goat leather\", count: 5, result_id: \"Goat leather vest\"},\r\n            {material_id: \"Linen cloth\", count: 5, result_id: \"Linen vest\"},\r\n            {material_id: \"Piece of snakeskin leather\", count: 5, result_id: \"Snakeskin vest\"},\r\n            {material_id: \"Piece of frog leather\", count: 5, result_id: \"Batrachian vest\"}\r\n        ],\r\n        item_type: \"Armor\",\r\n        component_type: \"chestplate interior\",\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n\r\n    crafting_recipes.equipment[\"Pants\"] = new ComponentRecipe({\r\n        name: \"Pants\",\r\n        materials: [\r\n            {material_id: \"Piece of wolf rat leather\", count: 3, result_id: \"Cheap leather pants\"},\r\n            {material_id: \"Piece of wolf leather\", count: 3, result_id: \"Leather pants\"},\r\n            {material_id: \"Wool cloth\", count: 3, result_id: \"Wool pants\"},\r\n            {material_id: \"Piece of goat leather\", count: 3, result_id: \"Goat leather pants\"},\r\n            {material_id: \"Linen cloth\", count: 3, result_id: \"Linen leggings\"},\r\n            {material_id: \"Piece of snakeskin leather\", count: 3, result_id: \"Snakeskin leggings\"},\r\n            {material_id: \"Piece of frog leather\", count: 3, result_id: \"Batrachian pants\"}\r\n        ],\r\n        item_type: \"Armor\",\r\n        component_type: \"leg armor interior\",\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n\r\n    crafting_recipes.equipment[\"Gloves\"] = new ComponentRecipe({\r\n        name: \"Gloves\",\r\n        materials: [\r\n            {material_id: \"Piece of wolf leather\", count: 2, result_id: \"Leather gloves\"},\r\n            {material_id: \"Wool cloth\", count: 2, result_id: \"Wool gloves\"},\r\n            {material_id: \"Piece of goat leather\", count: 2, result_id: \"Goat leather gloves\"},\r\n            {material_id: \"Linen cloth\", count: 2, result_id: \"Linen gloves\"},\r\n            {material_id: \"Piece of snakeskin leather\", count: 2, result_id: \"Snakeskin gloves\"},\r\n            {material_id: \"Piece of frog leather\", count: 2, result_id: \"Batrachian gloves\"}\r\n        ],\r\n        item_type: \"Armor\",\r\n        component_type: \"glove interior\",\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n\r\n    crafting_recipes.equipment[\"Shoes\"] = new ComponentRecipe({\r\n        name: \"Shoes\",\r\n        materials: [\r\n            {material_id: \"Piece of wolf rat leather\", count: 2, result_id: \"Cheap leather shoes\"},\r\n            {material_id: \"Piece of wolf leather\", count: 2, result_id: \"Leather shoes\"},\r\n            {material_id: \"Piece of goat leather\", count: 2, result_id: \"Goat leather shoes\"},\r\n            {material_id: \"Piece of snakeskin leather\", count: 2, result_id: \"Snakeskin boots\"},\r\n            {material_id: \"Piece of frog leather\", count: 2, result_id: \"Batrachian shoes\" }\r\n        ],\r\n        item_type: \"Armor\",\r\n        component_type: \"shoes interior\",\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n    \r\n})();\r\n\r\n//componentless equipment (currently just capes)\r\n(()=>{\r\n    crafting_recipes.equipment[\"Cape\"] = new ComponentlessEquipRecipe({\r\n        name: \"Cape\",\r\n        materials: [\r\n            {material_id: \"Processed rat pelt\", count: 12, result_id: \"Rat pelt cape\"},\r\n            {material_id: \"Processed wolf pelt\", count: 8, result_id: \"Wolf pelt cape\"},\r\n            {material_id: \"Processed boar hide\", count: 8, result_id: \"Boar hide cape\"},\r\n            {material_id: \"Processed goat hide\", count: 8, result_id: \"Goat hide cape\"},\r\n            {material_id: \"Processed bear hide\", count: 8, result_id: \"Bear hide cape\"},\r\n            {material_id: \"Piece of frog leather\", count: 8, result_id: \"Batrachian cape\"}\r\n        ],\r\n        item_type: \"Cape\",\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n})();\r\n\r\n//materials\r\n(function(){\r\n    butchering_recipes.items[\"Piece of wolf rat leather\"] = new ItemRecipe({\r\n        name: \"Piece of wolf rat leather\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Rat pelt\", count: 6}], \r\n        result: {result_id: \"Piece of wolf rat leather\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [1,5],\r\n        recipe_skill: \"Butchering\",\r\n    });\r\n    butchering_recipes.items[\"Piece of wolf leather\"] = new ItemRecipe({\r\n        name: \"Piece of wolf leather\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Wolf pelt\", count: 6}], \r\n        result: {result_id: \"Piece of wolf leather\", count: 1},\r\n        success_chance: [0.2,1],\r\n        recipe_skill: \"Butchering\",\r\n        recipe_level: [1,10],\r\n    });\r\n    butchering_recipes.items[\"Piece of boar leather\"] = new ItemRecipe({\r\n        name: \"Piece of boar leather\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Boar hide\", count: 6}],\r\n        result: {result_id: \"Piece of boar leather\", count: 1},\r\n        success_chance: [0.2,1],\r\n        recipe_skill: \"Butchering\",\r\n        recipe_level: [5,15],\r\n    });\r\n    butchering_recipes.items[\"Piece of goat leather\"] = new ItemRecipe({\r\n        name: \"Piece of goat leather\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Mountain goat hide\", count: 6}],\r\n        result: {result_id: \"Piece of goat leather\", count: 1},\r\n        success_chance: [0.2,1],\r\n        recipe_skill: \"Butchering\",\r\n        recipe_level: [5,15],\r\n    });\r\n    butchering_recipes.items[\"Piece of bear leather\"] = new ItemRecipe({\r\n        name: \"Piece of bear leather\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Bear hide\", count: 6}],\r\n        result: {result_id: \"Piece of bear leather\", count: 1},\r\n        success_chance: [0.2,1],\r\n        recipe_skill: \"Butchering\",\r\n        recipe_level: [12,25],\r\n    });\r\n    butchering_recipes.items[\"Piece of frog leather\"] = new ItemRecipe({\r\n        name: \"Piece of frog leather\",\r\n        recipe_type: \"material\",\r\n        materials: [{ material_id: \"Frog hide\", count: 4 },\r\n                    { material_id: \"Belmart leaf\", count: 4 }],\r\n        result: {result_id: \"Piece of frog leather\", count: 1},\r\n        success_chance: [0.2,1],\r\n        recipe_level: [12,25],\r\n        recipe_skill: \"Butchering\",\r\n    });\r\n    butchering_recipes.items[\"Piece of alligator leather\"] = new ItemRecipe({\r\n        name: \"Piece of alligator leather\",\r\n        is_unlocked: false,\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Alligator skin\", count: 6}],\r\n        result: {result_id: \"Piece of alligator leather\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_skill: \"Butchering\",\r\n        recipe_level: [25,35],\r\n    });\r\n    butchering_recipes.items[\"Piece of snakeskin leather\"] = new ItemRecipe({\r\n        name: \"Piece of snakeskin leather\",\r\n        is_unlocked: false,\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Giant snake skin\", count: 6}],\r\n        result: {result_id: \"Piece of snakeskin leather\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_skill: \"Butchering\",\r\n        recipe_level: [25,35],\r\n    });\r\n    butchering_recipes.items[\"Turtle shellplate\"] = new ItemRecipe({\r\n        name: \"Turtle shellplate\",\r\n        is_unlocked: false,\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Turtle shell\", count: 10}],\r\n        result: {result_id: \"Turtle shellplate\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_skill: \"Butchering\",\r\n        recipe_level: [27,37],\r\n    });\r\n\r\n    butchering_recipes.items[\"Processed rat pelt\"] = new ItemRecipe({\r\n        name: \"Processed rat pelt\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Rat pelt\", count: 6}],\r\n        result: {result_id: \"Processed rat pelt\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [1,5],\r\n        recipe_skill: \"Butchering\",\r\n    });\r\n    butchering_recipes.items[\"Processed wolf pelt\"] = new ItemRecipe({\r\n        name: \"Processed wolf pelt\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Wolf pelt\", count: 6}],\r\n        result: {result_id: \"Processed wolf pelt\", count: 1},\r\n        success_chance: [0.2,1],\r\n        recipe_level: [1,10],\r\n        recipe_skill: \"Butchering\",\r\n    });\r\n    butchering_recipes.items[\"Processed boar hide\"] = new ItemRecipe({\r\n        name: \"Processed boar hide\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Boar hide\", count: 6}],\r\n        result: {result_id: \"Processed boar hide\", count: 1},\r\n        success_chance: [0.2,1],\r\n        recipe_level: [5,15],\r\n        recipe_skill: \"Butchering\",\r\n    });\r\n    butchering_recipes.items[\"Processed goat hide\"] = new ItemRecipe({\r\n        name: \"Processed goat hide\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Mountain goat hide\", count: 6}],\r\n        result: {result_id: \"Processed goat hide\", count: 1},\r\n        success_chance: [0.2,1],\r\n        recipe_level: [5,15],\r\n        recipe_skill: \"Butchering\",\r\n    });\r\n    butchering_recipes.items[\"Processed bear hide\"] = new ItemRecipe({\r\n        name: \"Processed bear hide\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Bear hide\", count: 6}],\r\n        result: {result_id: \"Processed bear hide\", count: 1},\r\n        success_chance: [0.2,1],\r\n        recipe_level: [12,25],\r\n        recipe_skill: \"Butchering\",\r\n    });\r\n    crafting_recipes.items[\"Wool cloth\"] = new ItemRecipe({\r\n        name: \"Wool cloth\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Wool\", count: 5}], \r\n        result: {result_id: \"Wool cloth\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_skill: \"Crafting\",\r\n        recipe_level: [5,15],\r\n    });\r\n    crafting_recipes.items[\"Linen cloth\"] = new ItemRecipe({\r\n        name: \"Linen cloth\",\r\n        is_unlocked: false,\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Flax\", count: 10}], \r\n        result: {result_id: \"Linen cloth\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_skill: \"Crafting\",\r\n        recipe_level: [20,30],\r\n    });\r\n    crafting_recipes.items[\"Glass phial\"] = new ItemRecipe({\r\n        name: \"Glass phial\",\r\n        is_unlocked: false,\r\n        recipe_type: \"material\",\r\n        materials: [{ material_id: \"Raw Glass\", count: 1}], \r\n        result: {result_id: \"Glass phial\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_level: [15,25],\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n\r\n    crafting_recipes.items[\"Glass bottle\"] = new ItemRecipe({\r\n        name: \"Glass bottle\",\r\n        is_unlocked: false,\r\n        recipe_type: \"material\",\r\n        materials: [{ material_id: \"Raw Glass\", count: 3}], \r\n        result: {result_id: \"Glass bottle\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_level: [15,25],\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n\r\n    forging_recipes.items[\"Iron chainmail\"] = new ItemRecipe({\r\n        name: \"Iron chainmail\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Iron ingot\", count: 5}], \r\n        result: {result_id: \"Iron chainmail\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_skill: \"Forging\",\r\n        recipe_level: [5,15],\r\n    });\r\n    forging_recipes.items[\"Steel chainmail\"] = new ItemRecipe({\r\n        name: \"Steel chainmail\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Steel ingot\", count: 5}], \r\n        result: {result_id: \"Steel chainmail\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_skill: \"Forging\",\r\n        recipe_level: [10,20],\r\n    });\r\n\r\n    butchering_recipes.items[\"Rat meat chunks\"] = new ItemRecipe({\r\n        name: \"Rat meat chunks\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Rat tail\", count: 3}],\r\n        result: {result_id: \"Rat meat chunks\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [1,5],\r\n        recipe_skill: \"Butchering\",\r\n    });\r\n\r\n    butchering_recipes.items[\"Fish fillet\"] = new ItemRecipe({\r\n        name: \"Fish fillet\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_type: \"large fish\", count: 1}],\r\n        result: {result_id: \"Fish fillet\", count: 3},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [10,15],\r\n        recipe_skill: \"Butchering\",\r\n    });\r\n\r\n    smelting_recipes.items[\"Low quality iron ingot\"] = new ItemRecipe({\r\n        name: \"Low quality iron ingot\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Low quality iron ore\", count: 5}, {material_type: \"coal\", count: 1}], \r\n        result: {result_id: \"Low quality iron ingot\", count: 1},\r\n        success_chance: [0.6,1],\r\n        recipe_level: [1,5],\r\n        recipe_skill: \"Smelting\",\r\n    });\r\n    smelting_recipes.items[\"Iron ingot\"] = new ItemRecipe({\r\n        name: \"Iron ingot\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Iron ore\", count: 5}, {material_type: \"coal\", count: 1}], \r\n        result: {result_id: \"Iron ingot\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [5,15],\r\n        recipe_skill: \"Smelting\",\r\n    });\r\n    smelting_recipes.items[\"Silver ingot\"] = new ItemRecipe({\r\n        name: \"Silver ingot\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Silver ore\", count: 5}, {material_type: \"coal\", count: 1}], \r\n        result: {result_id: \"Silver ingot\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [7,17],\r\n        recipe_skill: \"Smelting\",\r\n    });\r\n    smelting_recipes.items[\"Steel ingot (inefficient)\"] = new ItemRecipe({\r\n        name: \"Steel ingot (inefficient)\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Iron ore\", count: 5}, {material_id: \"Atratan ore\", count: 4}, {material_type: \"coal\", count: 2}],\r\n        result: {result_id: \"Steel ingot\", count: 1},\r\n        success_chance: [0.3,1],\r\n        recipe_level: [10,20],\r\n        recipe_skill: \"Smelting\",\r\n        is_unlocked: false,\r\n    });\r\n\r\n    smelting_recipes.items[\"Raw Glass\"] = new ItemRecipe({\r\n        name: \"Raw Glass\",\r\n        is_unlocked: false,\r\n        recipe_type: \"material\",\r\n        materials: [{ material_id: \"Silica Sand\", count: 2},\r\n                    { material_id: \"Potash\", count: 1}], \r\n        result: {result_id: \"Raw Glass\", count: 1},\r\n        success_chance: [0.2,1],\r\n        recipe_level: [10,20],\r\n        recipe_skill: \"Smelting\",\r\n    });\r\n\r\n    woodworking_recipes.items[\"Processed rough wood\"] = new ItemRecipe({\r\n        name: \"Processed rough wood\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Piece of rough wood\", count: 5}], \r\n        result: {result_id: \"Processed rough wood\", count: 1},\r\n        success_chance: [0.6,1],\r\n        recipe_level: [1,5],\r\n        recipe_skill: \"Woodworking\",\r\n    });\r\n    woodworking_recipes.items[\"Processed wood\"] = new ItemRecipe({\r\n        name: \"Processed wood\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Piece of wood\", count: 5}], \r\n        result: {result_id: \"Processed wood\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [5,15],\r\n        recipe_skill: \"Woodworking\",\r\n    });\r\n    woodworking_recipes.items[\"Processed ash wood\"] = new ItemRecipe({\r\n        name: \"Processed ash wood\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Piece of ash wood\", count: 5}], \r\n        result: {result_id: \"Processed ash wood\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [10,20],\r\n        recipe_skill: \"Woodworking\",\r\n    });\r\n    butchering_recipes.items[\"Processed weak monster bone\"] = new ItemRecipe({\r\n        name: \"Processed weak monster bone\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Weak monster bone\", count: 5}], \r\n        result: {result_id: \"Processed weak monster bone\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_level: [10,20],\r\n        recipe_skill: \"Butchering\",\r\n    });\r\n    smelting_recipes.items[\"Charcoal\"] = new ItemRecipe({\r\n        name: \"Charcoal\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_type: \"raw wood\", count: 5}],\r\n        result: {result_id: \"Charcoal\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [1,10],\r\n        recipe_skill: \"Smelting\",\r\n    });\r\n    cooking_recipes.items[\"Animal fat\"] = new ItemRecipe({\r\n        name: \"Animal fat\",\r\n        is_unlocked: false,\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Boar meat\", count: 3}], \r\n        result: {result_id: \"Animal fat\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_level: [7,20],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n\r\n    butchering_recipes.items[\"High quality wolf fang\"] = new ItemRecipe({\r\n        name: \"High quality wolf fang\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Wolf fang\", count: 50}],\r\n        result: {result_id: \"High quality wolf fang\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [1,7],\r\n        recipe_skill: \"Butchering\",\r\n    });\r\n    butchering_recipes.items[\"High quality boar tusk\"] = new ItemRecipe({\r\n        name: \"High quality boar tusk\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Boar tusk\", count: 50}], \r\n        result: {result_id: \"High quality boar tusk\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [5,12],\r\n        recipe_skill: \"Butchering\",\r\n    }); \r\n    butchering_recipes.items[\"Pristine mountain goat horn\"] = new ItemRecipe({\r\n        name: \"Pristine mountain goat horn\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Mountain goat horn\", count: 50}], \r\n        result: {result_id: \"Pristine mountain goat horn\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [10,17],\r\n        recipe_skill: \"Butchering\",\r\n    });\r\n    butchering_recipes.items[\"Sharp bear claw\"] = new ItemRecipe({\r\n        name: \"Sharp bear claw\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Bear claw\", count: 50}], \r\n        result: {result_id: \"Sharp bear claw\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [13,20],\r\n        recipe_skill: \"Butchering\",\r\n    }); \r\n    butchering_recipes.items[\"Giant crab claw\"] = new ItemRecipe({\r\n        name: \"Giant crab claw\",\r\n        recipe_type: \"material\",\r\n        materials: [{material_id: \"Crab claw\", count: 50}], \r\n        result: {result_id: \"Giant crab claw\", count: 1},\r\n        success_chance: [0.3,1],\r\n        recipe_level: [18,25],\r\n        recipe_skill: \"Butchering\",\r\n    }); \r\n\r\n    alchemy_recipes.items[\"Potash\"] = new ItemRecipe({\r\n        name: \"Potash\",\r\n        is_unlocked: false,\r\n        recipe_type: \"material\",\r\n        materials: [{ material_id: \"Charcoal\", count: 10}], \r\n        result: {result_id: \"Potash\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [10,20],\r\n        recipe_skill: \"Alchemy\",\r\n    });\r\n})();\r\n\r\n//misc\r\n(function(){\r\n    crafting_recipes.items[\"Bonemeal\"] = new ItemRecipe({\r\n        name: \"Bonemeal\",\r\n        is_unlocked: true,\r\n        recipe_type: \"material\",\r\n        materials: [{material_type: \"animal tooth\", count: 20}],\r\n        result: {result_id: \"Bonemeal\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_level: [1,12],\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n\r\n    woodworking_recipes.items[\"Makeshift fishing pole\"] = new ItemRecipe({\r\n        name: \"Makeshift fishing pole\",\r\n        recipe_type: \"equipment\",\r\n        is_unlocked: true,\r\n        materials: [\r\n            { material_id: \"Processed rough wood\", count: 4 },\r\n            //{ material_id: \"Simple long wooden shaft\", count: 1 },    //TODO\r\n            { material_id: \"Wool\", count: 1 },\r\n        ],\r\n        result: { result_id: \"Makeshift fishing pole\", count: 1 },\r\n        success_chance: [0.5, 1],\r\n        recipe_level: [1, 10],\r\n        recipe_skill: \"Woodworking\",\r\n    });\r\n})();\r\n\r\n//consumables\r\n(function(){\r\n    cooking_recipes.items[\"Roasted rat meat\"] = new ItemRecipe({\r\n        name: \"Roasted rat meat\",\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Rat meat chunks\", count: 2}], \r\n        result: {result_id: \"Roasted rat meat\", count: 1},\r\n        success_chance: [0.7,1],\r\n        recipe_level: [1,5],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Roasted purified rat meat\"] = new ItemRecipe({\r\n        name: \"Roasted purified rat meat\",\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Rat meat chunks\", count: 2},\r\n                    {material_id: \"Belmart leaf\", count: 1},\r\n        ],\r\n        result: {result_id: \"Roasted purified rat meat\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [1,10],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Fried pork\"] = new ItemRecipe({\r\n        name: \"Fried pork\",\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Boar meat\", count: 2}], \r\n        result: {result_id: \"Fried pork\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [7,15],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Fried goat meat\"] = new ItemRecipe({\r\n        name: \"Fried goat meat\",\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Goat meat\", count: 2}], \r\n        result: {result_id: \"Fried goat meat\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [10,15],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Pork roast\"] = new ItemRecipe({\r\n        name: \"Pork roast\",\r\n        recipe_type: \"usable\",\r\n        materials: [{ material_id: \"Boar meat\", count: 2},\r\n                    { material_id: \"Cooking herbs\", count: 3}], \r\n        result: {result_id: \"Pork roast\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [10,20],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Goat stew\"] = new ItemRecipe({\r\n        name: \"Goat stew\",\r\n        recipe_type: \"usable\",\r\n        materials: [{ material_id: \"Goat meat\", count: 2},\r\n                    { material_id: \"Cooking herbs\", count: 2}], \r\n        result: {result_id: \"Goat stew\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [15,25],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Bread kwas\"] = new ItemRecipe({\r\n        name: \"Bread kwas\",\r\n        recipe_type: \"usable\",\r\n        materials: [{material_type: \"bread\", count: 2}, \r\n                    {material_id: \"Glass bottle\", count: 1}\r\n                ], \r\n        result: {result_id: \"Bread kwas\", count: 1},\r\n        success_chance: [0.3,1],\r\n        recipe_level: [10,15],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Fish skewer\"] = new ItemRecipe({\r\n        name: \"Fish skewer\",\r\n        recipe_type: \"usable\",\r\n        materials: [{material_type: \"small fish\", count: 5}], \r\n        result: {result_id: \"Fish skewer\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [1,10],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Fried fish\"] = new ItemRecipe({\r\n        name: \"Fried fish\",\r\n        recipe_type: \"usable\",\r\n        materials: [{material_type: \"medium fish\", count: 1}], \r\n        result: {result_id: \"Fried fish\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [7,15],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Fish steak\"] = new ItemRecipe({\r\n        name: \"Fish steak\",\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Fish fillet\", count: 1},\r\n                    {material_id: \"Cooking herbs\", count: 1}], \r\n        result: {result_id: \"Fish steak\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [7,15],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Fried frog meat\"] = new ItemRecipe({\r\n        name: \"Fried frog meat\",\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Frog meat\", count: 2}], \r\n        result: {result_id: \"Fried frog meat\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [12,20],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Kingsized frog legs\"] = new ItemRecipe({\r\n        name: \"Kingsized frog legs\",\r\n        recipe_type: \"usable\",\r\n        materials: [{ material_id: \"Frog meat\", count: 2},\r\n                    { material_id: \"Cooking herbs\", count: 2}], \r\n        result: {result_id: \"Kingsized frog legs\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [15,25],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Alligator jerky\"] = new ItemRecipe({\r\n        name: \"Alligator jerky\",\r\n        is_unlocked: false,\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Alligator meat\", count: 2}],\r\n        result: {result_id: \"Alligator jerky\", count: 1},\r\n        success_chance: [0.3,1],\r\n        recipe_level: [25,35],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Snake jerky\"] = new ItemRecipe({\r\n        name: \"Snake jerky\",\r\n        is_unlocked: false,\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Giant snake meat\", count: 2}],\r\n        result: {result_id: \"Snake jerky\", count: 1},\r\n        success_chance: [0.3,1],\r\n        recipe_level: [25,35],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Turtle jerky\"] = new ItemRecipe({\r\n        name: \"Turtle jerky\",\r\n        is_unlocked: false,\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Turtle meat\", count: 2}],\r\n        result: {result_id: \"Turtle jerky\", count: 1},\r\n        success_chance: [0.3,1],\r\n        recipe_level: [25,35],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Swampland skewer\"] = new ItemRecipe({\r\n        name: \"Swampland skewer\",\r\n        is_unlocked: false,\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Alligator meat\", count: 1},\r\n                    {material_id: \"Giant snake meat\", count: 1},\r\n                    {material_id: \"Turtle meat\", count: 1},\r\n                    {material_id: \"Wild garlic\", count: 1},\r\n                    {material_id: \"Wild onion\", count: 1},\r\n                    {material_id: \"Cooking herbs\", count: 1}\r\n                ], \r\n        result: {result_id: \"Swampland skewer\", count: 1},\r\n        success_chance: [0.3,1],\r\n        recipe_level: [27,37],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Crab bisque\"] = new ItemRecipe({\r\n        name: \"Crab bisque\",\r\n        is_unlocked: false,\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Crab meat\", count: 3},\r\n                    {material_id: \"Cooking herbs\", count: 1},\r\n                    {material_id: \"Wild potato\", count: 2},\r\n                    {material_id: \"Wild onion\", count: 1},\r\n                    {material_id: \"Glass bottle\", count: 1}\r\n                ], \r\n        result: {result_id: \"Crab bisque\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [20,30],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Clam broth\"] = new ItemRecipe({\r\n        name: \"Clam broth\",\r\n        is_unlocked: false,\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Clam\", count: 3},\r\n                    {material_id: \"Cooking herbs\", count: 1},\r\n                    {material_id: \"Wild garlic\", count: 1},\r\n                    {material_id: \"Glass bottle\", count: 1}\r\n                ], \r\n        result: {result_id: \"Clam broth\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [20,30],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Turtle soup\"] = new ItemRecipe({\r\n        name: \"Turtle soup\",\r\n        is_unlocked: false,\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Turtle meat\", count: 1},\r\n                    {material_id: \"Cooking herbs\", count: 1},\r\n                    {material_id: \"Wild potato\", count: 1},\r\n                    {material_id: \"Glass bottle\", count: 1}\r\n                ], \r\n        result: {result_id: \"Turtle soup\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [20,30],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    cooking_recipes.items[\"Basin gumbo\"] = new ItemRecipe({\r\n        name: \"Basin gumbo\",\r\n        is_unlocked: false,\r\n        recipe_type: \"usable\",\r\n        materials: [{material_id: \"Alligator meat\", count: 3},\r\n                    {material_id: \"Turtle meat\", count: 3},\r\n                    {material_id: \"Crab meat\", count: 6},\r\n                    {material_id: \"Clam\", count: 6},\r\n                    {material_id: \"Wild potato\", count: 6},\r\n                    {material_id: \"Wild garlic\", count: 4},\r\n                    {material_id: \"Wild onion\", count: 4},\r\n                    {material_id: \"Animal fat\", count: 3},\r\n                    {material_id: \"Cooking herbs\", count: 3},\r\n                    {material_id: \"Belmart leaf\", count: 2},\r\n                    {material_id: \"Glass bottle\", count: 1}\r\n                ], \r\n        result: {result_id: \"Basin gumbo\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_level: [35,60],\r\n        recipe_skill: \"Cooking\",\r\n    });\r\n    \r\n    alchemy_recipes.items[\"Weak healing powder\"] = new ItemRecipe({\r\n        name: \"Weak healing powder\",\r\n        recipe_type: \"usable\",\r\n        is_unlocked: false,\r\n        materials: [{material_id: \"Golmoon leaf\", count: 5}],\r\n        result: {result_id: \"Weak healing powder\", count: 1},\r\n        success_chance: [0.4,1],\r\n        recipe_level: [1,10],\r\n        recipe_skill: \"Alchemy\",\r\n    });\r\n    alchemy_recipes.items[\"Healing powder\"] = new ItemRecipe({\r\n        name: \"Healing powder\",\r\n        recipe_type: \"usable\",\r\n        is_unlocked: false,\r\n        materials: [{material_id: \"Golmoon leaf\", count: 3}, {material_id: \"Silver thistle\", count: 3}],\r\n        result: {result_id: \"Healing powder\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_level: [5,15],\r\n        recipe_skill: \"Alchemy\",\r\n    });\r\n    alchemy_recipes.items[\"Oneberry juice\"] = new ItemRecipe({\r\n        name: \"Oneberry juice\",\r\n        recipe_type: \"usable\",\r\n        is_unlocked: false,\r\n        materials: [{material_id: \"Oneberry\", count: 10},\r\n                    {material_id: \"Glass phial\", count: 1},\r\n        ],\r\n        result: {result_id: \"Oneberry juice\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [2,12],\r\n        recipe_skill: \"Alchemy\",\r\n    });\r\n    alchemy_recipes.items[\"Healing potion\"] = new ItemRecipe({\r\n        name: \"Healing potion\",\r\n        recipe_type: \"usable\",\r\n        is_unlocked: false,\r\n        materials: [{material_id: \"Oneberry\", count: 8},\r\n                    {material_id: \"Silver thistle\", count: 4},\r\n                    {material_id: \"Glass phial\", count: 1},\r\n        ],\r\n        result: {result_id: \"Healing potion\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_level: [7,17],\r\n        recipe_skill: \"Alchemy\",\r\n    });\r\n    alchemy_recipes.items[\"Healing balm\"] = new ItemRecipe({\r\n        name: \"Healing balm\",\r\n        recipe_type: \"usable\",\r\n        is_unlocked: false,\r\n        materials: [{material_id: \"Oneberry\", count: 10},\r\n                    {material_id: \"Golmoon leaf\", count: 5},\r\n                    {material_id: \"Animal fat\", count: 1},\r\n        ],\r\n        result: {result_id: \"Healing balm\", count: 1},\r\n        success_chance: [0.1,1],\r\n        recipe_level: [7,15],\r\n        recipe_skill: \"Alchemy\",\r\n    });\r\n})();\r\n\r\n//trinkets\r\n(function(){\r\n    crafting_recipes.items[\"Wolf trophy\"] = new ItemRecipe({\r\n        name: \"Wolf trophy\",\r\n        recipe_type: \"equipment\",\r\n        materials: [{material_id: \"High quality wolf fang\", count: 4}],\r\n        result: {result_id: \"Wolf trophy\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [1,10],\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n    crafting_recipes.items[\"Boar trophy\"] = new ItemRecipe({\r\n        name: \"Boar trophy\",\r\n        recipe_type: \"equipment\",\r\n        materials: [{material_id: \"High quality boar tusk\", count: 4}],\r\n        result: {result_id: \"Boar trophy\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [5,15],\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n    crafting_recipes.items[\"Mountain goat trophy\"] = new ItemRecipe({\r\n        name: \"Mountain goat trophy\",\r\n        recipe_type: \"equipment\",\r\n        materials: [{material_id: \"Pristine mountain goat horn\", count: 4}],\r\n        result: {result_id: \"Mountain goat trophy\", count: 1},\r\n        success_chance: [0.5,1],\r\n        recipe_level: [10,20],\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n    crafting_recipes.items[\"Bear trophy\"] = new ItemRecipe({\r\n        name: \"Bear trophy\",\r\n        recipe_type: \"equipment\",\r\n        materials: [{material_id: \"Sharp bear claw\", count: 4}],\r\n        result: {result_id: \"Bear trophy\", count: 1},\r\n        success_chance: [0.3,1],\r\n        recipe_level: [15,25],\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n    crafting_recipes.items[\"Crab trophy\"] = new ItemRecipe({\r\n        name: \"Crab trophy\",\r\n        recipe_type: \"equipment\",\r\n        materials: [{material_id: \"Giant crab claw\", count: 4}],\r\n        result: {result_id: \"Crab trophy\", count: 1},\r\n        success_chance: [0.3,1],\r\n        recipe_level: [20,30],\r\n        recipe_skill: \"Crafting\",\r\n    });\r\n})();\r\n\r\nconst recipes = {\r\n    crafting: crafting_recipes, \r\n    cooking: cooking_recipes, \r\n    smelting: smelting_recipes, \r\n    forging: forging_recipes, \r\n    alchemy: alchemy_recipes,\r\n    butchering: butchering_recipes,\r\n    woodworking: woodworking_recipes,\r\n}\r\n\r\n\r\nObject.keys(recipes).forEach(recipe_category => {\r\n    Object.keys(recipes[recipe_category]).forEach(recipe_subcategory => {\r\n        Object.keys(recipes[recipe_category][recipe_subcategory]).forEach(recipe_key => {\r\n            recipes[recipe_category][recipe_subcategory][recipe_key].id = recipe_key;\r\n        });\r\n    });\r\n});\r\n\r\nexport { recipes, get_recipe_xp_value, get_crafting_quality_caps, ItemRecipe }\r\n", "\"use strict\";\r\n\r\nconst skills = {};\r\nconst skill_categories = {};\r\n\r\nimport { get_total_level_bonus, get_total_skill_coefficient, get_total_skill_level } from \"./character.js\";\r\nimport { get_crafting_quality_caps } from \"./crafting_recipes.js\";\r\nimport {stat_names} from \"./misc.js\";\r\n\r\nconst weapon_type_to_skill = {\r\n    \"axe\": \"Axes\",\r\n    \"dagger\": \"Daggers\",\r\n    \"hammer\": \"Hammers\",\r\n    \"sword\": \"Swords\",\r\n    \"spear\": \"Spears\",\r\n    \"staff\": \"Staffs\",\r\n    \"wand\": \"Wands\"\r\n};\r\n\r\n//for display foldering and for different treatment when it comes to xp gain caps\r\nconst skill_category_crafting = \"Crafting\";\r\n\r\nconst skill_xp_gains_cap = 0.1; //limits xp per single gain, as a relation of xp needed to next level (0.1 = need to gain it at least 10 times)\r\nconst crafting_skill_xp_gains_cap = 0.25; //same but for crafting skills\r\n\r\nlet unknown_skill_name = \"?????\";\r\n\r\nconst which_skills_affect_skill = {};\r\n\r\nclass Skill {\r\n    constructor({skill_id, \r\n                  names, \r\n                  description, \r\n                  flavour_text, \r\n                  max_level = 60, \r\n                  max_level_coefficient = 1, \r\n                  max_level_bonus = 0, \r\n                  base_xp_cost = 40, \r\n                  visibility_treshold = 10,\r\n                  get_effect_description = () => { return ''; }, \r\n                  parent_skill = null, \r\n                  milestones = {},\r\n                  xp_scaling = 1.8,\r\n                  is_unlocked = true,\r\n                  category,\r\n                  get_stat_modifiers = () => {return {}},\r\n                }) \r\n    {\r\n        if(skill_id === \"all\" || skill_id === \"hero\" || skill_id === \"all_skill\") {\r\n            //would cause problem with how xp_bonuses are implemented\r\n            throw new Error(`Id \"${skill_id}\" is not allowed for skills`);\r\n        }\r\n\r\n        this.skill_id = skill_id;\r\n        this.names = names; // put only {0: name} to have skill always named the same, no matter the level\r\n        this.description = description;\r\n        this.flavour_text = flavour_text;\r\n        this.current_level = 0; //initial lvl\r\n        this.max_level = max_level; //max possible lvl, dont make it too high\r\n        this.max_level_coefficient = max_level_coefficient; //multiplicative bonus for levels\r\n        this.max_level_bonus = max_level_bonus; //other type bonus for levels\r\n        this.current_xp = 0; // how much of xp_to_next_lvl there is currently\r\n        this.total_xp = 0; // total collected xp, on loading calculate lvl based on this (so to not break skills if scaling ever changes)\r\n        this.base_xp_cost = base_xp_cost; //xp to go from lvl 1 to lvl 2\r\n        if(base_xp_cost < 1/skill_xp_gains_cap) {\r\n            console.warn(`Skill \"${this.skill_id}\" has base xp cost lower than what would be needed due to skill xp gains cap!`);\r\n        }\r\n        this.visibility_treshold = visibility_treshold < base_xp_cost ? visibility_treshold : base_xp_cost; \r\n        this.is_unlocked = is_unlocked;\r\n        //xp needed for skill to become visible and to get \"unlock\" message; try to keep it less than xp needed for lvl\r\n        this.xp_to_next_lvl = base_xp_cost; //for display only\r\n        this.total_xp_to_next_lvl = base_xp_cost; //total xp needed to lvl up\r\n        this.get_effect_description = get_effect_description;\r\n        this.is_parent = false;\r\n        if(!category) {\r\n            console.warn(`Skill \"${this.skill_id}\" has no category defined and was defaulted to miscellaneous`);\r\n            this.category = \"Miscellaneous\";\r\n        } else {\r\n            this.category = category;\r\n        }\r\n        skill_categories[this.category] = true;\r\n        \r\n        if(parent_skill) {\r\n            if(skills[parent_skill]) {\r\n                this.parent_skill = parent_skill;\r\n                skills[parent_skill].is_parent = true;\r\n            } else {\r\n                throw new Error(`Skill \"${parent_skill}\" doesn't exist, so it can't be set as a parent skill`)\r\n            }\r\n        }\r\n\r\n        this.milestones = milestones;\r\n\r\n        this.xp_scaling = xp_scaling > 1 ? xp_scaling : 1.6;\r\n        //how many times more xp needed for next level\r\n\r\n        this.get_stat_modifiers = get_stat_modifiers;\r\n        //refer to how it's used in \"Pest killer\"/\"Giant slayer\"\r\n    }\r\n\r\n    name() {\r\n        if(this.visibility_treshold > this.total_xp || !this.is_unlocked) {\r\n            return unknown_skill_name;\r\n        }\r\n \r\n        const keys = Object.keys(this.names);\r\n        if (keys.length == 1) {\r\n            return (this.names[keys[0]]);\r\n        }\r\n        else {\r\n            let rank_name;\r\n            for (var i = 0; i <= keys.length; i++) {\r\n                if (this.current_level >= parseInt(keys[i])) {\r\n                    rank_name = this.names[keys[i]];\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n            return rank_name;\r\n        }\r\n    }\r\n\r\n    add_xp({xp_to_add = 0}) {\r\n        if(xp_to_add == 0 || !this.is_unlocked) {\r\n            return {};\r\n        }\r\n        xp_to_add = Math.round(xp_to_add*100)/100;\r\n        let skill_name = this.name();\r\n        //grab name beforehand, in case it changes after levelup (levelup message should appear BEFORE skill name change message, so this is necessary)\r\n\r\n        this.total_xp = Math.round(100*(this.total_xp + xp_to_add))/100;\r\n        if(this.current_level < this.max_level) { //not max lvl\r\n\r\n            if(Math.round(100*(xp_to_add + this.current_xp))/100 < this.xp_to_next_lvl) { // no levelup\r\n                this.current_xp = Math.round(100*(this.current_xp + xp_to_add))/100;\r\n            } else { //levelup\r\n                \r\n                let level_after_xp = 0;\r\n                let unlocks = {skills: [], recipes: [], quests: []};\r\n\r\n                //its alright if this goes over max level, it will be overwritten in a if-else below that\r\n                while(this.total_xp >= this.total_xp_to_next_lvl) {\r\n\r\n                    level_after_xp += 1;\r\n                    this.total_xp_to_next_lvl = Math.round(100*this.base_xp_cost * (1 - this.xp_scaling ** (level_after_xp + 1)) / (1 - this.xp_scaling))/100;\r\n\r\n                    if(this.milestones[level_after_xp]?.unlocks?.skills) {\r\n                        unlocks.skills.push(...this.milestones[level_after_xp].unlocks.skills);\r\n                    }\r\n                    if(this.milestones[level_after_xp]?.unlocks?.recipes) {\r\n                        unlocks.recipes.push(...this.milestones[level_after_xp].unlocks.recipes);\r\n                    }\r\n                    if(this.milestones[level_after_xp]?.unlocks?.quests) {\r\n                        unlocks.quests.push(...this.milestones[level_after_xp].unlocks.quests);\r\n                    }\r\n                } //calculates lvl reached after adding xp\r\n                //probably could be done much more efficiently, but it shouldn't be a problem anyway\r\n\r\n                \r\n                let total_xp_to_previous_lvl = Math.round(100*this.base_xp_cost * (1 - this.xp_scaling ** level_after_xp) / (1 - this.xp_scaling))/100;\r\n                //xp needed for current lvl, same formula but for n-1\r\n\r\n                if(level_after_xp == 0) { //this was for an older issue that seems to have been long fixed\r\n                    console.warn(`Something went wrong, calculated level of skill \"${this.skill_id}\" after a levelup was 0.`\r\n                    +`\\nxp_added: ${xp_to_add};\\nprevious level: ${this.current_level};\\ntotal xp: ${this.total_xp};`\r\n                    +`\\ntotal xp for that level: ${total_xp_to_previous_lvl};\\ntotal xp for next level: ${this.total_xp_to_next_lvl}`);\r\n                }\r\n\r\n                let gains;\r\n                if(level_after_xp < this.max_level) { //wont reach max lvl\r\n                    gains = this.get_bonus_stats(level_after_xp);\r\n                    this.xp_to_next_lvl = Math.round(100*(this.total_xp_to_next_lvl - total_xp_to_previous_lvl))/100;\r\n                    this.current_level = level_after_xp;\r\n                    this.current_xp = Math.round(100*(this.total_xp - total_xp_to_previous_lvl))/100;\r\n                } else { //will reach max lvl\r\n                    gains = this.get_bonus_stats(this.max_level);\r\n                    this.current_level = this.max_level;\r\n                    this.total_xp_to_next_lvl = \"Already reached max lvl\";\r\n                    this.current_xp = \"Max\";\r\n                    this.xp_to_next_lvl = \"Max\";\r\n                }\r\n\r\n                skill_name = skill_name===unknown_skill_name?this.name():skill_name;\r\n                //swap name if it was unknown, otherwise leave it as it was (for properly messaging skill name change)\r\n                let message = `${skill_name} has reached level ${this.current_level}`;\r\n\r\n                if (Object.keys(gains.stats).length > 0 || Object.keys(gains.xp_multipliers).length > 0) { \r\n                    message += `<br><br> Thanks to ${skill_name} reaching new milestone, %HeroName% gained: `;\r\n\r\n                    if (gains.stats) {\r\n                        Object.keys(gains.stats).forEach(stat => {\r\n                            if(gains.stats[stat].flat) {\r\n                                message += `<br> +${gains.stats[stat].flat} ${stat_names[stat].replace(\"_\",\" \")}`;\r\n                            }\r\n                            if(gains.stats[stat].multiplier) {\r\n                                message += `<br> x${Math.round(100*gains.stats[stat].multiplier)/100} ${stat_names[stat].replace(\"_\",\" \")}`;\r\n                            }   \r\n                        });\r\n                    }\r\n\r\n                    if (gains.xp_multipliers) {\r\n                        Object.keys(gains.xp_multipliers).forEach(xp_multiplier => {\r\n                            let name;\r\n                            if(xp_multiplier !== \"all\" && xp_multiplier !== \"hero\" && xp_multiplier !== \"all_skill\" && !xp_multiplier.includes(\"category_\")) {\r\n                                name = skills[xp_multiplier].name();\r\n                                if(!skills[xp_multiplier]) {\r\n                                    console.warn(`Skill ${this.skill_id} tried to reward an xp multiplier for something that doesn't exist: ${xp_multiplier}. I could be a misspelled skill name`);\r\n                                }\r\n                            } else {\r\n                                name = xp_multiplier.replace(\"_\",\" \");\r\n                            }\r\n\r\n                            if(xp_multiplier.includes(\"category_\")) {\r\n                                message += `<br> x${Math.round(100*gains.xp_multipliers[xp_multiplier])/100} ${name.replace(\"category_\", \"\")} skills xp gain`;\r\n                            } else {\r\n                                message += `<br> x${Math.round(100*gains.xp_multipliers[xp_multiplier])/100} ${name} xp gain`;\r\n\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n\r\n                return {message, gains, unlocks};\r\n            }\r\n        }\r\n        return {};\r\n    }\r\n\r\n    /**\r\n     * @description only called on leveling; calculates all the bonuses gained, so they can be added to hero and logged in message log\r\n     * @param {*} level \r\n     * @returns bonuses from milestones\r\n     */\r\n    get_bonus_stats(level) {\r\n        //probably should rename, since it's not just stats anymore\r\n        const gains = {stats: {}, xp_multipliers: {}};\r\n\r\n        let stats;\r\n        let xp_multipliers;\r\n\r\n        for (let i = this.current_level + 1; i <= level; i++) {\r\n            if (this.milestones[i]) {\r\n                stats = this.milestones[i].stats;\r\n                xp_multipliers = this.milestones[i].xp_multipliers;\r\n                \r\n                if(stats) {\r\n                    Object.keys(stats).forEach(stat => {\r\n                        if(!gains.stats[stat]) {\r\n                            gains.stats[stat] = {};\r\n                        }\r\n                        if(stats[stat].flat) {\r\n                            gains.stats[stat].flat = (gains.stats[stat].flat || 0) + stats[stat].flat;\r\n                        }\r\n                        if(stats[stat].multiplier) {\r\n                            gains.stats[stat].multiplier =  (gains.stats[stat].multiplier || 1) * stats[stat].multiplier;\r\n                        }\r\n                        \r\n                    });\r\n                }\r\n\r\n                if(xp_multipliers) {\r\n                    Object.keys(xp_multipliers).forEach(multiplier_key => {\r\n                        gains.xp_multipliers[multiplier_key] = (gains.xp_multipliers[multiplier_key] || 1) * xp_multipliers[multiplier_key];\r\n                        if(which_skills_affect_skill[multiplier_key]) {\r\n                            if(!which_skills_affect_skill[multiplier_key].includes(this.skill_id)) {\r\n                                which_skills_affect_skill[multiplier_key].push(this.skill_id);\r\n                            }\r\n                        } else {\r\n                            which_skills_affect_skill[multiplier_key] = [this.skill_id];\r\n                        }\r\n                       \r\n                    });\r\n                }\r\n            }\r\n        }\r\n        \r\n        Object.keys(gains.stats).forEach((stat) => {\r\n            if(gains.stats[stat].multiplier) {\r\n                gains.stats[stat].multiplier = Math.round(100 * gains.stats[stat].multiplier) / 100;\r\n            }\r\n        });\r\n        \r\n        return gains;\r\n    }\r\n    get_coefficient({scaling_type, skill_level}) { //starts from 1\r\n        //maybe lvl as param, with current lvl being used if it's undefined?\r\n\r\n        switch (scaling_type) {\r\n            case \"flat\":\r\n                return 1 + Math.round((this.max_level_coefficient - 1) * (skill_level || this.current_level) / this.max_level * 1000) / 1000;\r\n            case \"multiplicative\":\r\n                return Math.round(Math.pow(this.max_level_coefficient, (skill_level || this.current_level) / this.max_level) * 1000) / 1000;\r\n            default: //same as on multiplicative\r\n                return Math.round(Math.pow(this.max_level_coefficient, (skill_level || this.current_level) / this.max_level) * 1000) / 1000;\r\n        }\r\n    }\r\n    get_level_bonus(level) { //starts from 0\r\n        return this.max_level_bonus * (level || this.current_level) / this.max_level;\r\n    }\r\n    get_parent_xp_multiplier() {\r\n        if(this.parent_skill) {\r\n            return (1.1**Math.max(0,skills[this.parent_skill].current_level-this.current_level));\r\n        } else {\r\n            return 1;\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @param {String} skill_id key from skills object\r\n * @returns all unlocked leveling rewards, formatted to string\r\n */\r\nfunction get_unlocked_skill_rewards(skill_id) {\r\n    let unlocked_rewards = '';\r\n    const skill = skills[skill_id];\r\n    \r\n        const milestones = Object.keys(skill.milestones).filter(level => level <= skill.current_level);\r\n        if(milestones.length > 0) {\r\n            unlocked_rewards = `lvl ${milestones[0]}: ${format_skill_rewards(skill.milestones[milestones[0]])}`;\r\n            for(let i = 1; i < milestones.length; i++) {\r\n                unlocked_rewards += `<br>\\n\\nlvl ${milestones[i]}: ${format_skill_rewards(skill.milestones[milestones[i]])}`;\r\n            }\r\n        } else { //no rewards\r\n            return '';\r\n        }\r\n\r\n    return unlocked_rewards;\r\n}\r\n\r\n/**\r\n * \r\n * @param {*} skill_id key used in skills object\r\n * @returns next lvl at which skill has any rewards\r\n */\r\nfunction get_next_skill_milestone(skill_id){\r\n\r\n    return Object.keys(skills[skill_id].milestones).find(\r\n        level => level > skills[skill_id].current_level);\r\n}\r\n\r\n/**\r\n * @param milestone milestone from object rewards - {stats: {stat1, stat2... }} \r\n * @returns rewards formatted to a nice string\r\n */\r\nfunction format_skill_rewards(milestone){\r\n    let formatted = '';\r\n    if(milestone.stats) {\r\n        let temp = '';\r\n        Object.keys(milestone.stats).forEach(stat => {\r\n            if(milestone.stats[stat].flat) {\r\n                if(formatted) {\r\n                    formatted += `, +${milestone.stats[stat].flat} ${stat_names[stat]}`;\r\n                } else {\r\n                    formatted = `+${milestone.stats[stat].flat} ${stat_names[stat]}`;\r\n                }\r\n            }\r\n            if(milestone.stats[stat].multiplier) {\r\n                if(temp) {\r\n                    temp += `, x${milestone.stats[stat].multiplier} ${stat_names[stat]}`;\r\n                } else {\r\n                    temp = `x${milestone.stats[stat].multiplier} ${stat_names[stat]}`;\r\n                }\r\n            }\r\n        });\r\n\r\n        if(formatted) {\r\n            if(temp) {\r\n                formatted += \", \" + temp;\r\n            }\r\n        } else {\r\n            formatted = temp;\r\n        }\r\n    }\r\n\r\n    if(milestone.xp_multipliers) {\r\n        const xp_multipliers = Object.keys(milestone.xp_multipliers);\r\n        let name;\r\n        if(xp_multipliers[0] !== \"all\" && xp_multipliers[0] !== \"hero\" && xp_multipliers[0] !== \"all_skill\") {\r\n            if(xp_multipliers[0].includes(\"category_\")) {\r\n                name = xp_multipliers[0].replace(\"category_\", \"\") + \" skills\";\r\n            } else {\r\n                name = skills[xp_multipliers[0]].name();\r\n            }\r\n        } else {\r\n            name = xp_multipliers[0].replace(\"_\",\" \");\r\n        }\r\n        if(formatted) {\r\n            formatted += `, x${milestone.xp_multipliers[xp_multipliers[0]]} ${name} xp gain`;\r\n        } else {\r\n            formatted = `x${milestone.xp_multipliers[xp_multipliers[0]]} ${name} xp gain`;\r\n        }\r\n        for(let i = 1; i < xp_multipliers.length; i++) {\r\n            let name;\r\n            if(xp_multipliers[i] !== \"all\" && xp_multipliers[i] !== \"hero\" && xp_multipliers[i] !== \"all_skill\") {\r\n                if(xp_multipliers[i].includes(\"category_\")) {\r\n                    name = xp_multipliers[i].replace(\"category_\", \"\") + \" skills\";\r\n                } else {\r\n                    name = skills[xp_multipliers[i]].name();\r\n                }\r\n            } else {\r\n                name = xp_multipliers[i].replace(\"_\",\" \");\r\n            }\r\n            formatted += `, x${milestone.xp_multipliers[xp_multipliers[i]]} ${name} xp gain`;\r\n        }\r\n    }\r\n    if(milestone.unlocks) {\r\n        if(milestone.unlocks.skills) {\r\n            const unlocked_skills = milestone.unlocks.skills;\r\n            if(formatted) {\r\n                formatted += `, <br> Unlocked skill \"${milestone.unlocks.skills[0]}\"`;\r\n            } else {\r\n                formatted = `Unlocked skill \"${milestone.unlocks.skills[0]}\"`;\r\n            }\r\n            for(let i = 1; i < unlocked_skills.length; i++) {\r\n                formatted += `, \"${milestone.unlocks.skills[i]}\"`;\r\n            }\r\n        }\r\n        if(milestone.unlocks.recipes) {\r\n            const phrasing = milestone.unlocks.recipes.length > 1?\"new recipes\":\"a new recipe\";\r\n            if(formatted) {\r\n                formatted += `, <br> Unlocked ${phrasing}`;\r\n            } else {\r\n                formatted = `Unlocked ${phrasing}`;\r\n            }\r\n        }\r\n        \r\n    }\r\n    return formatted;\r\n}\r\n\r\n//basic combat skills\r\n(function(){\r\n    skills[\"Combat\"] = new Skill({\r\n                                names: {0: \"Combat\"}, \r\n                                category: \"Combat\",\r\n                                description: \"Overall combat ability\", \r\n                                max_level_coefficient: 2,\r\n                                base_xp_cost: 60,\r\n                                get_effect_description: ()=> {\r\n                                    return `Multiplies AP by ${Math.round(get_total_skill_coefficient({skill_id:\"Combat\",scaling_type:\"multiplicative\"})*1000)/1000}`;\r\n                                }});\r\n    \r\n    skills[\"Pest killer\"] = new Skill({\r\n                                names: {0: \"Pest killer\", 15: \"Pest slayer\"}, \r\n                                description: \"Small enemies might not seem very dangerous, but it's not that easy to hit them!\", \r\n                                max_level_coefficient: 2,\r\n                                category: \"Combat\",\r\n                                base_xp_cost: 100,\r\n                                get_effect_description: ()=> {\r\n                                    return `Multiplies AP against small-type enemies by ${Math.round(get_total_skill_coefficient({skill_id:\"Pest killer\",scaling_type:\"multiplicative\"})*1000)/1000}`;\r\n                                },\r\n                                milestones: {\r\n                                    1: {\r\n                                        xp_multipliers: {\r\n                                            Combat: 1.05,\r\n                                        },\r\n                                    },\r\n                                    2: {\r\n                                        xp_multipliers: {\r\n                                            category_Combat: 1.05,\r\n                                        },\r\n                                    },\r\n                                    3: {\r\n                                        stats: {\r\n                                            dexterity: {flat: 1},\r\n                                        },\r\n                                    },\r\n                                    5: {\r\n                                        stats: {\r\n                                            dexterity: {multiplier: 1.05},\r\n                                        },\r\n                                        xp_multipliers: {\r\n                                            Evasion: 1.05,\r\n                                            \"Shield blocking\": 1.05,\r\n                                        }\r\n                                    },\r\n                                    7: {\r\n                                        stats: {\r\n                                            dexterity: {flat: 1},\r\n                                        },\r\n                                        xp_multipliers: {\r\n                                            Combat: 1.05,\r\n                                        }\r\n                                    },\r\n                                    10: {\r\n                                        stats: {\r\n                                            dexterity: {multiplier: 1.05},\r\n                                        },\r\n                                        xp_multipliers: {\r\n                                            category_Combat: 1.05,\r\n                                            Perception: 1.1,\r\n                                        }\r\n                                    },\r\n                                    12: {\r\n                                        stats: {\r\n                                            dexterity: {flat: 2},\r\n                                        },\r\n                                        xp_multipliers: {\r\n                                            Combat: 1.05,\r\n                                        }\r\n                                    },\r\n                                    \r\n                                },\r\n                                get_stat_modifiers: () => {\r\n                                    return {\r\n                                       modifier_to_hit_chance: get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Pest killer\"})\r\n                                    };\r\n                                }\r\n                            });    \r\n                                \r\n    skills[\"Giant slayer\"] = new Skill({\r\n                                names: {0: \"Giant killer\", 15: \"Giant slayer\"}, \r\n                                description: \"Large opponents might seem scary, but just don't get hit and you should be fine!\", \r\n                                max_level_coefficient: 2,\r\n                                category: \"Combat\",\r\n                                get_effect_description: ()=> {\r\n                                    return `Multiplies EP against large-type enemies by ${Math.round(get_total_skill_coefficient({skill_id:\"Giant slayer\",scaling_type:\"multiplicative\"})*1000)/1000}`;\r\n                                },\r\n                                get_stat_modifiers: () => {\r\n                                    return {\r\n                                       modifier_to_evasion: get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Giant slayer\"}) \r\n                                    };\r\n                                }\r\n                            });\r\n                                \r\n\r\n    skills[\"Evasion\"] = new Skill({\r\n                                names: {0: \"Evasion\"},                                \r\n                                description:\"Ability to evade attacks. You cannot do it while using a shield\",\r\n                                max_level_coefficient: 2,\r\n                                base_xp_cost: 20,\r\n                                category: \"Combat\",\r\n                                get_effect_description: ()=> {\r\n                                    return `Multiplies EP by ${Math.round(get_total_skill_coefficient({skill_id:\"Evasion\",scaling_type:\"multiplicative\"})*1000)/1000}`;\r\n                                },\r\n                                milestones: {\r\n                                    1: {\r\n                                        stats: {\r\n                                            \"agility\": {flat: 1},\r\n                                        }\r\n                                    },\r\n                                    3: {\r\n                                        stats: {\r\n                                            \"agility\": {flat: 1},\r\n                                        },\r\n                                        xp_multipliers: {\r\n                                            Equilibrium: 1.05,\r\n                                        }\r\n                                    },\r\n                                    5: {\r\n                                        stats: {\r\n                                            \"agility\": {\r\n                                                flat: 1,\r\n                                                multiplier: 1.05,\r\n                                            }\r\n                                        },\r\n                                    },\r\n                                    7: {\r\n                                        stats: {\r\n                                            \"agility\": {flat: 2},\r\n                                        },\r\n                                        xp_multipliers: {\r\n                                            Equilibrium: 1.05,\r\n                                        }\r\n                                    },\r\n                                    10: {\r\n                                        stats: {\r\n                                            \"agility\": {\r\n                                                flat: 1,\r\n                                                multiplier: 1.05,\r\n                                            }\r\n                                        },\r\n                                    },\r\n                                    12: {\r\n                                        stats: {\r\n                                            \"agility\": {flat: 2},\r\n                                        },\r\n                                        xp_multipliers: {\r\n                                            Equilibrium: 1.05,\r\n                                        }\r\n                                    },\r\n                                    15: {\r\n                                        stats: {\r\n                                            \"agility\": {flat: 5},\r\n                                        },\r\n                                    },\r\n                                    20: {\r\n                                        xp_multipliers: {\r\n                                            Climbing: 1.2,\r\n                                            Swimming: 1.2,\r\n                                            Running: 1.2,\r\n                                        }\r\n                                    }\r\n                                }\r\n                            });\r\n    skills[\"Shield blocking\"] = new Skill({\r\n                                    names: {0: \"Shield blocking\"}, \r\n                                    description: \"Ability to block attacks with shield. You cannot evade while using one\",\r\n                                    max_level: 30, \r\n                                    max_level_bonus: 0.2,\r\n                                    category: \"Combat\",\r\n                                    get_effect_description: ()=> {\r\n                                        return `Increases block chance by flat ${Math.round(get_total_level_bonus(\"Shield blocking\")*1000)/10}%. Increases blocked damage by ${Math.round(get_total_level_bonus(\"Shield blocking\")*5000)/10}%, and blocks ${get_total_skill_level(\"Shield blocking\")}% of attack damage before other calculations.`;\r\n                                    }});\r\n    \r\n     skills[\"Unarmed\"] = new Skill({ \r\n                                    names: {0: \"Unarmed\", 10: \"Brawling\", 20: \"Martial arts\"}, \r\n                                    description: \"It's definitely, unquestionably, undoubtedly better to just use a weapon instead of doing this. But sure, why not?\",\r\n                                    category: \"Combat\",\r\n                                    get_effect_description: ()=> {\r\n                                        return `Multiplies damage dealt in unarmed combat by ${Math.round(get_total_skill_coefficient({skill_id:\"Unarmed\",scaling_type:\"multiplicative\"})*1000)/1000}. \r\nMultiplies attack speed, EP and AP in unarmed combat by ${Math.round((get_total_skill_coefficient({skill_id:\"Unarmed\",scaling_type:\"multiplicative\"})**0.3333)*1000)/1000}.\r\nAdds ${skills[\"Unarmed\"].current_level/10} base damage to unarmed attacks`;\r\n                                    },\r\n                                    max_level_coefficient: 64, //even with 8x more it's still gonna be worse than just using a weapon lol\r\n                                    milestones: {\r\n                                        2: {\r\n                                            stats: {\r\n                                                \"strength\": {flat: 1},\r\n                                            },\r\n                                            xp_multipliers: {\r\n                                                Weightlifting: 1.05,\r\n                                            }\r\n                                        },\r\n                                        4: {\r\n                                            stats: {\r\n                                                \"strength\": {flat: 1},\r\n                                                \"dexterity\": {flat: 1},\r\n                                            }\r\n                                        },\r\n                                        6: {\r\n                                            stats: {\r\n                                                \"strength\": {flat: 1},\r\n                                                \"dexterity\": {flat: 1},\r\n                                                \"agility\": {flat: 1},\r\n                                            },\r\n                                            xp_multipliers: {\r\n                                                Weightlifting: 1.1,\r\n                                            }\r\n                                        },\r\n                                        8: {\r\n                                            stats: {\r\n                                                \"strength\": {flat: 1},\r\n                                                \"dexterity\": {flat: 1},\r\n                                                \"agility\": {flat: 1},\r\n                                            }\r\n                                        },\r\n                                        10: {\r\n                                            stats: {\r\n                                                \"strength\": {flat: 2},\r\n                                                \"dexterity\": {flat: 1},\r\n                                                \"agility\": {flat: 1},\r\n                                            },\r\n                                            xp_multipliers: {\r\n                                                Running: 1.2,\r\n                                            }\r\n                                        },\r\n                                        12: {\r\n                                            stats: {\r\n                                                \"strength\": {flat: 2},\r\n                                                \"dexterity\": {flat: 2},\r\n                                                \"agility\": {flat: 2},\r\n                                            }\r\n                                        },\r\n                                        15: {\r\n                                            stats: {\r\n                                                \"strength\": {flat: 5},\r\n                                                \"dexterity\": {flat: 5},\r\n                                                \"agility\": {flat: 5},\r\n                                            }\r\n                                        },\r\n                                        20: {\r\n                                            xp_multipliers: {\r\n                                                Breathing: 1.1,\r\n                                                Equilibrium: 1.1,\r\n                                                Weightlifting: 1.1,\r\n                                                Running: 1.1,\r\n                                            },\r\n                                        },\r\n                                    }});\r\n})();\r\n\r\n//combat stances\r\n(function(){\r\n    skills[\"Stance mastery\"] = new Skill({\r\n                                    names: {0: \"Stance proficiency\", 10: \"Stance mastery\"}, \r\n                                    description: \"Knowledge on how to apply different stances in combat\",\r\n                                    base_xp_cost: 60,\r\n                                    category: \"Stance\",\r\n                                    max_level: 30,\r\n                                    get_effect_description: ()=> {\r\n                                        return `Increases xp gains of all combat stance skills of level lower than this, x1.1 per level of difference`;\r\n                                    },\r\n                                });\r\n    skills[\"Quick steps\"] = new Skill({\r\n                                names: {0: \"Quick steps\"}, \r\n                                parent_skill: \"Stance mastery\",\r\n                                description: \"A swift and precise technique that abandons strength in favor of greater speed\", \r\n                                max_level_coefficient: 2,\r\n                                base_xp_cost: 60,\r\n                                category: \"Stance\",\r\n                                max_level: 30,\r\n                                get_effect_description: ()=> {\r\n                                    return `Improves efficiency of the 'Quick Steps' stance`;\r\n                                }});\r\n    skills[\"Heavy strike\"] = new Skill({\r\n                                names: {0: \"Crushing force\"}, \r\n                                parent_skill: \"Stance mastery\",\r\n                                description: \"A powerful and dangerous technique that abandons speed in favor of overwhelmingly strong attacks\",\r\n                                max_level_coefficient: 2,\r\n                                base_xp_cost: 60,\r\n                                category: \"Stance\",\r\n                                max_level: 30,\r\n                                get_effect_description: ()=> {\r\n                                    return `Improves efficiency of the \"Crushing force\" stance`;\r\n                                }});\r\n    skills[\"Wide swing\"] = new Skill({ \r\n                                names: {0: \"Broad arc\"}, \r\n                                parent_skill: \"Stance mastery\",\r\n                                description: \"A special technique that allows striking multiple enemies at once, although at a cost of lower overall efficiency.\" \r\n                                            +\" Slightly reduces xp and loot.\",\r\n                                max_level_coefficient: 2,\r\n                                base_xp_cost: 60,\r\n                                category: \"Stance\",\r\n                                max_level: 30,\r\n                                get_effect_description: ()=> {\r\n                                    return `Improves efficiency of the \"Broad arc\" stance`;\r\n                                }});\r\n    skills[\"Defensive measures\"] = new Skill({\r\n                                names: {0: \"Defensive measures\"}, \r\n                                parent_skill: \"Stance mastery\",\r\n                                description: \"A careful technique focused much more on defense than on attacking\",\r\n                                max_level_coefficient: 2,\r\n                                base_xp_cost: 60,\r\n                                category: \"Stance\",\r\n                                max_level: 30,\r\n                                get_effect_description: ()=> {\r\n                                    return `Improves efficiency of the 'Defensive Measures' stance`;\r\n                                }});\r\n    skills[\"Berserker's stride\"] = new Skill({ \r\n                                names: {0: \"Berserker's stride\"}, \r\n                                parent_skill: \"Stance mastery\",\r\n                                description: \"A wild and dangerous technique that focuses on dealing as much damage as possible, while completely ignoring own defense\",\r\n                                max_level_coefficient: 2,\r\n                                base_xp_cost: 60,\r\n                                category: \"Stance\",\r\n                                max_level: 30,\r\n                                get_effect_description: ()=> {\r\n                                    return `Improves efficiency of the 'Berserker's Stride' stance`;\r\n                                }});                  \r\n    skills[\"Flowing water\"] = new Skill({\r\n                                names: {0: \"Flowing water\"}, \r\n                                parent_skill: \"Stance mastery\",\r\n                                description: \"A wild and dangerous technique that focuses on dealing as much damage as possible, while completely ignoring own defense\",\r\n                                max_level_coefficient: 2,\r\n                                base_xp_cost: 60,\r\n                                category: \"Stance\",\r\n                                max_level: 30,\r\n                                get_effect_description: ()=> {\r\n                                    return `Improves efficiency of the 'Flowing Water' stance`;\r\n                                }});         \r\n                               \r\n})();\r\n\r\n//environment related skills\r\n(function(){\r\n    skills[\"Spatial awareness\"] = new Skill({\r\n                                            names: {0: \"Spatial awareness\"}, \r\n                                            description: \"Understanding where you are in relation to other creatures and objects\", \r\n                                            get_effect_description: ()=> {\r\n                                                return `Reduces environmental penalty in open areas`;\r\n                                            },\r\n                                            category: \"Environmental\",\r\n                                            milestones: {\r\n                                                1: {\r\n                                                    xp_multipliers:{ \r\n                                                        Evasion: 1.1,\r\n                                                        \"Shield blocking\": 1.1,\r\n                                                    },\r\n                                                },\r\n                                                3: {\r\n                                                    xp_multipliers: {\r\n                                                        Combat: 1.1,\r\n                                                    }\r\n                                                },\r\n                                                5: {\r\n                                                    xp_multipliers: {\r\n                                                        category_Combat: 1.1,\r\n                                                    },\r\n                                                    stats: {\r\n                                                        intuition: {flat: 1},\r\n                                                    }\r\n                                                },\r\n                                                8: {\r\n                                                    xp_multipliers: {\r\n                                                        all_skill: 1.1,\r\n                                                    }\r\n                                                },\r\n                                                10: {\r\n                                                    xp_multipliers:{ \r\n                                                        Evasion: 1.1,\r\n                                                        \"Shield blocking\": 1.1,\r\n                                                        Combat: 1.1,\r\n                                                        Perception: 1.1,\r\n                                                    },\r\n                                                    stats: {\r\n                                                        intuition: {flat: 1},\r\n                                                    }\r\n                                                },\r\n                                                15: {\r\n                                                    xp_multipliers: {\r\n                                                        category_Combat: 1.1,\r\n                                                    },\r\n                                                    stats: {\r\n                                                        intuition: {flat: 3},\r\n                                                    }\r\n                                                },\r\n                                                20: {\r\n                                                    xp_multipliers: {\r\n                                                        all_skill: 1.2,\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        });\r\n    skills[\"Tight maneuvers\"] = new Skill({\r\n                                        names: {0: \"Tight maneuvers\"}, \r\n                                        description: \"Learn how to fight in narrow environment, where there's not much space for dodging attacks\", \r\n                                        category: \"Environmental\",\r\n                                        get_effect_description: ()=> {\r\n                                            return `Reduces environmental penalty in narrow areas`;\r\n                                        },\r\n                                        milestones: {\r\n                                            3: {\r\n                                                xp_multipliers: {\r\n                                                    Evasion: 1.1,\r\n                                                    \"Shield blocking\": 1.1,\r\n                                                }\r\n                                            },\r\n                                            5: {\r\n                                                xp_multipliers: {\r\n                                                    Combat: 1.1,\r\n                                                }\r\n                                            },\r\n                                            7: {\r\n                                                xp_multipliers: {\r\n                                                    Evasion: 1.1,\r\n                                                    \"Shield blocking\": 1.1,\r\n                                                }\r\n                                            },\r\n                                            10: {\r\n                                                xp_multipliers: {\r\n                                                    Evasion: 1.1,\r\n                                                    \"Shield blocking\": 1.1,\r\n                                                    Combat: 1.1,\r\n                                                }\r\n                                            },\r\n                                            15: {\r\n                                                xp_multipliers: {\r\n                                                    Equilibrium: 1.1,\r\n                                                },\r\n                                                stats: {\r\n                                                    agility: {flat: 5},\r\n                                                }\r\n                                            },\r\n                                            20: {\r\n                                                xp_multipliers: {\r\n                                                    Evasion: 1.2,\r\n                                                    \"Shield blocking\": 1.2,\r\n                                                    Combat: 1.2,\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    });\r\n    skills[\"Night vision\"] = new Skill({\r\n                                    names: {0: \"Night vision\"},\r\n                                    description: \"Ability to see in darkness\",\r\n                                    base_xp_cost: 600,\r\n                                    xp_scaling: 1.9,\r\n                                    max_level: 10,\r\n                                    category: \"Environmental\",\r\n                                    get_effect_description: () => {\r\n                                        return `Reduces environmental penalty in dark areas (except for 'pure darkness')`;\r\n                                    },\r\n                                    milestones: {\r\n                                        2: {\r\n                                            stats: {\r\n                                                intuition: {flat: 1},\r\n                                            }\r\n                                        },\r\n                                        3: {\r\n                                            xp_multipliers: {\r\n                                                Evasion: 1.05,\r\n                                                \"Shield blocking\": 1.05,\r\n                                            }\r\n                                        },\r\n                                        5: {\r\n                                            stats: {\r\n                                                intuition: {flat: 1},\r\n                                            },\r\n                                            xp_multipliers: {\r\n                                                \"Presence sensing\": 1.05,\r\n                                                Perception: 1.1,\r\n                                            }\r\n\r\n                                            },\r\n                                        7: {    \r\n                                            xp_multipliers: \r\n                                            {\r\n                                                Combat: 1.1,\r\n                                            },\r\n                                            stats: {\r\n                                                intuition: {multiplier: 1.05},\r\n                                            }\r\n                                        },\r\n                                        8: {\r\n                                            xp_multipliers: {\r\n                                                \"Presence sensing\": 1.1,\r\n                                            }\r\n                                        },\r\n                                        10: {\r\n                                            xp_multipliers: {\r\n                                                \"Presence sensing\": 1.2,\r\n                                                Evasion: 1.05,\r\n                                                \"Shield blocking\": 1.05,\r\n                                                Perception: 1.1,\r\n                                            },\r\n                                            stats: {\r\n                                                intuition: {multiplier: 1.05},\r\n                                            }\r\n                                        }\r\n                                    }\r\n                            });\r\n    skills[\"Presence sensing\"] = new Skill({\r\n                names: {0: \"Presence sensing\"},\r\n                description: \"Ability to sense a presence without using your eyes\",\r\n                base_xp_cost: 60,\r\n                xp_scaling: 2,\r\n                max_level: 20,\r\n                category: \"Environmental\",\r\n                get_effect_description: () => {\r\n                    return `Reduces environmental penalty in extremly dark areas`;\r\n                },\r\n                milestones: {\r\n                    1: {\r\n                        stats: {\r\n                            intuition: {flat: 1},\r\n                        },\r\n                        xp_multipliers: {\r\n                            \"Night vision\": 1.2,\r\n                        }\r\n                    },\r\n                    \r\n                    2: {\r\n                        xp_multipliers: {\r\n                            Evasion: 1.1,\r\n                            \"Shield blocking\": 1.2,\r\n                        }\r\n                    },\r\n                    4: {\r\n                        stats: {\r\n                            intuition: {flat: 1},\r\n                        },\r\n                        xp_multipliers: {\r\n                            \"Combat\": 1.1,\r\n                            Perception: 1.1,\r\n                        }\r\n\r\n                        },\r\n                    5: {    \r\n                        xp_multipliers: \r\n                        {\r\n                            all_skill: 1.05,\r\n                            \"Night vision\": 1.2,\r\n                        },\r\n                        stats: {\r\n                            intuition: {multiplier: 1.1},\r\n                        }\r\n                    },\r\n                    7: {\r\n                        stats: {\r\n                            intuition: {flat: 2},\r\n                        },\r\n                        xp_multipliers: {\r\n                            hero: 1.05,\r\n                            \"Night vision\": 1.2,\r\n                            Perception: 1.1,\r\n                        }\r\n                    },\r\n                    10: {\r\n                        xp_multipliers: {\r\n                            all_skill: 1.05,\r\n                            \"Night vision\": 1.2,\r\n                            Perception: 1.2,\r\n                        }\r\n                    },\r\n                    12: {\r\n                        xp_multipliers: {\r\n                            all: 1.05,\r\n                            Perception: 1.1,\r\n                        },\r\n                        stats: {\r\n                            intuition: {\r\n                                flat: 5,\r\n                                multiplier: 1.05,\r\n                            },\r\n                        }\r\n                    },\r\n                    15: {\r\n                        xp_multipliers: {\r\n                            all_skill: 1.05,\r\n                            \"Night vision\": 1.2, //if it's somehow not maxxed out by this point\r\n                            Perception: 1.1,\r\n                        },\r\n                    },\r\n                    20: {\r\n                        xp_multipliers: {\r\n                            all: 1.1,\r\n                            Perception: 1.1,\r\n                            Combat: 1.1,\r\n                            \"Spatial awareness\": 1.1,\r\n                        },\r\n                        stats: {\r\n                            intuition: {multiplier: 1.1},\r\n                        }\r\n                    },\r\n                }\r\n    });\r\n\r\n    skills[\"Strength of mind\"] = new Skill({\r\n        names: {0: \"Strength of mind\"}, \r\n        description: \"Resist and reject the unnatural influence. Turn your psyche into an iron fortress\",\r\n        category: \"Environmental\",\r\n        base_xp_cost: 400,\r\n        max_level: 40,\r\n        xp_scaling: 1.7,\r\n        get_effect_description: ()=> {\r\n            return `Reduces eldritch effects`;\r\n        },\r\n        milestones: {\r\n            1: {\r\n                xp_multipliers: {\r\n                    all_skill: 1.05,\r\n                }\r\n            },\r\n            2: {    \r\n                stats: {\r\n                    intuition: {flat: 1},\r\n                },\r\n                xp_multipliers: {\r\n                    \"Literacy\": 1.05,\r\n                    \"Persistence\": 1.05,\r\n                    \"Fortitude\": 1.05,\r\n                    Perception: 1.1,\r\n                }\r\n            },\r\n            3: {\r\n                xp_multipliers: {\r\n                    hero: 1.05,\r\n                }\r\n            },\r\n            5: {\r\n                xp_multipliers: {\r\n                    all_skill: 1.05,\r\n                }\r\n            },\r\n            7: {    \r\n                stats: {\r\n                    intuition: {flat: 1},\r\n                },\r\n                xp_multipliers: {\r\n                    \"Literacy\": 1.05,\r\n                    \"Persistence\": 1.05,\r\n                    \"Fortitude\": 1.05,\r\n                }\r\n            },\r\n            8: {\r\n                xp_multipliers: {\r\n                    hero: 1.05,\r\n                }\r\n            },\r\n            10: {\r\n                xp_multipliers: {\r\n                    all: 1.05,\r\n                    Perception: 1.1,\r\n                }\r\n            },\r\n            12: {    \r\n                stats: {\r\n                    intuition: {multiplier: 1.05},\r\n                },\r\n                xp_multipliers: {\r\n                    \"Literacy\": 1.05,\r\n                    \"Persistence\": 1.05,\r\n                    \"Fortitude\": 1.05,\r\n                }\r\n            },\r\n            15: {    \r\n                stats: {\r\n                    intuition: {flat: 5, multiplier: 1.05},\r\n                },\r\n            },\r\n            20: {    \r\n                stats: {\r\n                    intuition: {multiplier: 1.1},\r\n                },\r\n                xp_multipliers: {\r\n                    all: 1.1,\r\n                    Literacy: 1.1,\r\n                    Persistence: 1.1,\r\n                    Fortitude: 1.1,\r\n                }\r\n            },\r\n        }\r\n    });\r\n\r\n    skills[\"Scrambling\"] = new Skill({\r\n\t\tnames: {0: \"Scrambling\"}, \r\n        description: \"Ability to act quickly and with secure footing in rough, loose, or unstable ground\", \r\n        category: \"Environmental\",\r\n        base_xp_cost: 400,\r\n        max_level: 60,\r\n        xp_scaling: 1.7,\r\n        get_effect_description: ()=> {\r\n            return `Reduces environmental penalty in rough terrain`;\r\n        },\r\n        milestones: {\r\n            1: {\r\n                stats: {\r\n\t\t\t\t\tdexterity: {\r\n\t\t\t\t\t\tflat: 1\r\n                    },\r\n\t\t\t\t\tagility: {\r\n\t\t\t\t\t\tflat: 1\r\n                    },\r\n                    max_stamina: {\r\n                        multiplier: 1.1,\r\n                    }\r\n                }\r\n            },\r\n            3: {\r\n                stats: {\r\n\t\t\t\t\tdexterity: {\r\n\t\t\t\t\t\tmultiplier: 1.05\r\n                    },\r\n\t\t\t\t\tagility: {\r\n\t\t\t\t\t\tmultiplier: 1.05\r\n                    },\r\n                }\r\n            },\r\n            5: {\r\n                stats: {\r\n\t\t\t\t\tdexterity: {\r\n\t\t\t\t\t\tflat: 3\r\n                    },\r\n\t\t\t\t\tagility: {\r\n\t\t\t\t\t\tflat: 3\r\n                    },\r\n                },\r\n                xp_multipliers: {\r\n                    Running: 1.2,\r\n                }\r\n            },\r\n            8: {\r\n\t\t\t\tstats: {\r\n                    stamina_regeneration_flat: {\r\n                        flat: 0.2,\r\n                    },\r\n                    stamina_efficiency: {\r\n                        multiplier: 1.05,\r\n                    }\r\n                },\r\n            },\r\n            10: {\r\n\t\t\t\tstats: {\r\n                    attack_speed: {\r\n                        multiplier: 1.01,\r\n                    },\r\n                },\r\n            },\r\n            13: {\r\n                stats: {\r\n\t\t\t\t\tdexterity: {\r\n\t\t\t\t\t\tflat: 2\r\n                    },\r\n\t\t\t\t\tagility: {\r\n\t\t\t\t\t\tflat: 2\r\n                    },\r\n                    max_stamina: {\r\n                        multiplier: 1.2,\r\n                    },\r\n                }\r\n            },\r\n            15: {\r\n                stats: {\r\n\t\t\t\t\tdexterity: {\r\n\t\t\t\t\t\tmultiplier: 1.1\r\n                    },\r\n\t\t\t\t\tagility: {\r\n\t\t\t\t\t\tmultiplier: 1.1\r\n                    },\r\n                }\r\n            },\r\n            18: {\r\n                stats: {\r\n\t\t\t\t\tdexterity: {\r\n\t\t\t\t\t\tflat: 4},\r\n\t\t\t\t\tagility: {\r\n\t\t\t\t\t\tflat: 4},\r\n                },\r\n                xp_multipliers: {\r\n                    \"Scrambling\": 1.2,\r\n                },\r\n            },\r\n            20: {\r\n\t\t\t\tstats: {\r\n                    attack_speed: { multiplier: 1.02},\r\n                    stamina_regeneration_flat: { flat: 0.3},\r\n                    stamina_efficiency: { multiplier: 1.05 },\r\n                },\r\n            },\r\n        }\r\n    });\r\n\r\n    skills[\"Heat resistance\"] = new Skill({\r\n        names: {0: \"Heat resistance\"},\r\n        description: \"Ability to survive and function in high temperatures\",\r\n        base_xp_cost: 100,\r\n        max_level: 40,\r\n        category: \"Environmental\",\r\n    });\r\n    skills[\"Cold resistance\"] = new Skill({\r\n        names: {0: \"Cold resistance\"},\r\n        description: \"Ability to survive and function in low temperatures\",\r\n        base_xp_cost: 200,\r\n        xp_scaling: 1.8,\r\n        max_level: 40,\r\n        category: \"Environmental\",\r\n        get_effect_description: ()=>{\r\n            return `Increases cold tolerance by ${skills[\"Cold resistance\"].current_level*0.5}`;\r\n        },\r\n    });\r\n\r\n    skills[\"Dazzle resistance\"] = new Skill({\r\n        names: {0: \"Dazzle resistance\"},\r\n        description: \"Don't look at the sun, it's bad for your eyes\",\r\n        base_xp_cost: 60,\r\n        max_level: 30,\r\n        category: \"Environmental\",\r\n        get_effect_description: ()=> {\r\n            return `Reduces hit and evasion penalty in super bright areas`;\r\n        },\r\n        max_level_bonus: 0.5\r\n    });\r\n})();\r\n\r\n//weapon skills\r\n(function(){\r\n    skills[\"Weapon mastery\"] = new Skill({\r\n                                    names: {0: \"Weapon proficiency\", 15: \"Weapon mastery\"}, \r\n                                    description: \"Knowledge of all weapons\",\r\n                                    category: \"Weapon\",\r\n                                    get_effect_description: ()=> {\r\n                                        return `Increases xp gains of all weapon skills of level lower than this, x1.1 per level of difference`;\r\n                                    },\r\n                                });\r\n    skills[\"Swords\"] = new Skill({\r\n                                parent_skill: \"Weapon mastery\",\r\n                                names: {0: \"Swordsmanship\"}, \r\n                                category: \"Weapon\",\r\n                                description: \"The noble art of swordsmanship\", \r\n                                get_effect_description: ()=> {\r\n                                    return `Multiplies damage dealt with swords by ${Math.round(get_total_skill_coefficient({skill_id:\"Swords\",scaling_type:\"multiplicative\"})*1000)/1000}.\r\nMultiplies AP with swords by ${Math.round((get_total_skill_coefficient({skill_id:\"Swords\",scaling_type:\"multiplicative\"})**0.3333)*1000)/1000}`;\r\n                                },\r\n                                milestones: {\r\n                                    1: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 1},\r\n                                        }\r\n                                    },\r\n                                    3: {\r\n                                        stats: {\r\n                                            \"agility\": {flat: 1},\r\n                                        }\r\n                                    },\r\n                                    5: {\r\n                                        stats: {\r\n                                            \"strength\": {flat: 1},\r\n                                            \"crit_rate\": {flat: 0.01},\r\n                                        },\r\n                                    },\r\n                                    7: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 1},\r\n                                        }\r\n                                    },\r\n                                    10: {\r\n                                        stats: {\r\n                                            \"agility\": {flat: 1},\r\n                                            \"crit_multiplier\": {flat: 0.1}, \r\n                                        },\r\n                                    },\r\n                                    12: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 2},\r\n                                        }\r\n                                    },\r\n                                },\r\n                                max_level_coefficient: 8\r\n                            });\r\n\r\n    skills[\"Axes\"] = new Skill({ \r\n                                parent_skill: \"Weapon mastery\",\r\n                                names: {0: \"Axe combat\"}, \r\n                                category: \"Weapon\",\r\n                                description: \"Ability to fight with axes\", \r\n                                get_effect_description: ()=> {\r\n                                    return `Multiplies damage dealt with axes by ${Math.round(get_total_skill_coefficient({skill_id:\"Axes\",scaling_type:\"multiplicative\"})*1000)/1000}.\r\nMultiplies AP with axes by ${Math.round((get_total_skill_coefficient({skill_id:\"Axes\",scaling_type:\"multiplicative\"})**0.3333)*1000)/1000}`;\r\n                                },\r\n                                milestones: {\r\n                                    1: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 1},\r\n                                        }\r\n                                    },\r\n                                    3: {\r\n                                        stats: {\r\n                                            \"strength\": {flat: 1},\r\n                                        }\r\n                                    },\r\n                                    5: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 1},\r\n                                            \"strength\": {flat: 1},\r\n                                        },\r\n\r\n                                    },\r\n                                    7: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 1},\r\n                                        }\r\n                                    },\r\n                                    10: {\r\n                                        stats: {\r\n                                                \"strength\": {multiplier: 1.05},\r\n                                        },\r\n                                    },\r\n                                    12: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 2},\r\n                                        }\r\n                                    },\r\n                                },\r\n                                max_level_coefficient: 8});\r\n\r\n    skills[\"Spears\"] = new Skill({\r\n                                parent_skill: \"Weapon mastery\",\r\n                                names: {0: \"Spearmanship\"}, \r\n                                category: \"Weapon\",\r\n                                description: \"The ability to fight with the most deadly weapon in history\", \r\n                                get_effect_description: ()=> {\r\n                                    return `Multiplies damage dealt with spears by ${Math.round(get_total_skill_coefficient({skill_id:\"Spears\",scaling_type:\"multiplicative\"})*1000)/1000}.\r\nMultiplies AP with spears by ${Math.round((get_total_skill_coefficient({skill_id:\"Spears\",scaling_type:\"multiplicative\"})**0.3333)*1000)/1000}`;\r\n                                },\r\n                                milestones: {\r\n                                    1: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 1},\r\n                                        }\r\n                                    },\r\n                                    3: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 1},\r\n                                        }\r\n                                    },\r\n                                    5: {\r\n                                        stats: {\r\n                                            \"strength\": {flat: 1},\r\n                                            \"crit_rate\": {flat: 0.01},\r\n                                        },\r\n                                    },\r\n                                    7: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 1},\r\n                                        }\r\n                                    },\r\n                                    10: {\r\n                                        stats: {\r\n                                            \"strength\": {flat: 1},\r\n                                            \"crit_multiplier\": {flat: 0.1}, \r\n                                        },\r\n                                    },\r\n                                    12: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 2},\r\n                                        }\r\n                                    },\r\n                                },\r\n                                max_level_coefficient: 8\r\n                            });\r\n\r\n    skills[\"Hammers\"] = new Skill({ \r\n                                        parent_skill: \"Weapon mastery\",\r\n                                        names: {0: \"Hammer combat\"}, \r\n                                        category: \"Weapon\",\r\n                                        description: \"Ability to fight with battle hammers. Why bother trying to cut someone, when you can just crack all their bones?\", \r\n                                        get_effect_description: ()=> {\r\n                                            return `Multiplies damage dealt with battle hammers by ${Math.round(get_total_skill_coefficient({skill_id:\"Hammers\",scaling_type:\"multiplicative\"})*1000)/1000}.\r\nMultiplies AP with hammers by ${Math.round((get_total_skill_coefficient({skill_id:\"Hammers\",scaling_type:\"multiplicative\"})**0.3333)*1000)/1000}`;\r\n                                        },\r\n                                        milestones: {\r\n                                            1: {\r\n                                                stats: {\r\n                                                    \"strength\": {flat: 1},\r\n                                                }\r\n                                            },\r\n                                            3: {\r\n                                                stats: {\r\n                                                    \"strength\": {flat: 1},\r\n                                                }\r\n                                            },\r\n                                            5: {\r\n                                                stats: {\r\n                                                    \"strength\": {flat: 1},\r\n                                                    \"dexterity\": {flat: 1},\r\n                                                },\r\n                                            },\r\n                                            7: {\r\n                                                stats: {\r\n                                                    \"strength\": {flat: 1},\r\n                                                }\r\n                                            },\r\n                                            10: {\r\n                                                stats: {\r\n                                                    \"strength\": {flat: 1},\r\n                                                    \"dexterity\": {flat: 1}, \r\n                                                },\r\n                                            },\r\n                                            12: {\r\n                                                stats: {\r\n                                                    \"dexterity\": {flat: 2},\r\n                                                }\r\n                                            },\r\n                                        },\r\n                                        max_level_coefficient: 8\r\n                                    });\r\n\r\n    skills[\"Daggers\"] = new Skill({\r\n                                parent_skill: \"Weapon mastery\",\r\n                                names: {0: \"Dagger combat\"},\r\n                                category: \"Weapon\",\r\n                                description: \"The disdained art of fighting (and stabbing) with daggers\",\r\n                                get_effect_description: ()=> {\r\n                                    return `Multiplies damage dealt with daggers by ${Math.round(get_total_skill_coefficient({skill_id:\"Daggers\",scaling_type:\"multiplicative\"})*1000)/1000}.\r\nMultiplies AP with daggers by ${Math.round((get_total_skill_coefficient({skill_id:\"Daggers\",scaling_type:\"multiplicative\"})**0.3333)*1000)/1000}`;\r\n                                },\r\n                                milestones: {\r\n                                    1: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 1},\r\n                                        }\r\n                                    },\r\n                                    3: {\r\n                                        stats: {\r\n                                            \"agility\": {flat: 1},\r\n                                        }\r\n                                    },\r\n                                    5: {\r\n                                        stats: {\r\n                                            \"crit_multiplier\": {flat: 0.1},\r\n                                            \"crit_rate\": {flat: 0.01},\r\n                                        },\r\n                                    },\r\n                                    7: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 1},\r\n                                        }\r\n                                    },\r\n                                    10: {\r\n                                        stats: {\r\n                                            \"crit_rate\": {flat: 0.02},\r\n                                            \"crit_multiplier\": {flat: 0.1}, \r\n                                        },\r\n                                    },\r\n                                    12: {\r\n                                        stats: {\r\n                                            \"dexterity\": {flat: 2},\r\n                                        }\r\n                                    },\r\n                                },\r\n                                max_level_coefficient: 8\r\n                            });\r\n\r\n    skills[\"Wands\"] = new Skill({\r\n                                parent_skill: \"Weapon mastery\",\r\n                                names: {0: \"Wand casting\"}, \r\n                                category: \"Weapon\",\r\n                                description: \"Ability to cast spells with magic wands, increases damage dealt\", \r\n                                get_effect_description: ()=> {\r\n                                    return `Multiplies damage dealt with wands by ${Math.round(get_total_skill_coefficient({skill_id:\"Wands\",scaling_type:\"multiplicative\"})*1000)/1000}`;\r\n                                },\r\n                                max_level_coefficient: 8});\r\n\r\n    skills[\"Staffs\"] = new Skill({\r\n                                parent_skill: \"Weapon mastery\",\r\n                                names: {0: \"Staff casting\"}, \r\n                                category: \"Weapon\",\r\n                                description: \"Ability to cast spells with magic staffs, increases damage dealt\", \r\n                                get_effect_description: ()=> {\r\n                                    return `Multiplies damage dealth with staffs by ${Math.round(get_total_skill_coefficient({skill_id:\"Staffs\",scaling_type:\"multiplicative\"})*1000)/1000}`;\r\n                                },\r\n                                max_level_coefficient: 8});\r\n})();\r\n\r\n//work related\r\n(function(){\r\n    skills[\"Farming\"] = new Skill({\r\n                                names: {0: \"Farming\"}, \r\n                                description: \"Even a simple action of plowing some fields, can be performed better with skills and experience\",\r\n                                base_xp_cost: 40,\r\n                                category: \"Activity\",\r\n                                max_level: 10,\r\n                                xp_scaling: 1.6,\r\n                                max_level_coefficient: 2,\r\n                                milestones: {\r\n                                    1: {\r\n                                        stats: {\r\n                                            max_stamina: {flat: 2},\r\n                                        },\r\n                                    },\r\n                                    2: {\r\n                                        stats: {\r\n                                            strength: {flat: 1}\r\n                                        },\r\n                                    },\r\n                                    3: {\r\n                                        stats: {\r\n                                            dexterity: {flat: 1},\r\n                                            max_stamina: {flat: 2},\r\n                                        }\r\n                                    },\r\n                                    4: {\r\n                                        stats: {\r\n                                            strength: {flat: 1},\r\n                                            max_stamina: {flat: 2},\r\n                                        }\r\n                                    },\r\n                                    5: {\r\n                                        stats: {\r\n                                            strength: {flat: 1},\r\n                                            max_stamina: {flat: 2},\r\n                                        },\r\n                                        xp_multipliers: {\r\n                                            \"Herbalism\": 1.05,\r\n                                        }\r\n                                    },\r\n                                    6: {\r\n                                        stats: {\r\n                                            strength: {flat: 1},\r\n                                        },\r\n                                        xp_multipliers: {\r\n                                            Weightlifting: 1.1,\r\n                                        }\r\n                                    },\r\n                                    7: {\r\n                                        stats: {\r\n                                            dexterity: {flat: 1},\r\n                                            max_stamina: {flat: 2},\r\n                                        },\r\n                                        xp_multipliers: {\r\n                                            \"Unarmed\": 1.05,\r\n                                        }\r\n                                    },\r\n                                    8: {\r\n                                        stats: {\r\n                                            strength: {flat: 1},\r\n                                            max_stamina: {flat: 2},\r\n                                        }\r\n                                    },\r\n                                    9: {\r\n                                        stats: {\r\n                                            strength: {flat: 1},\r\n                                            dexterity: {flat: 1},\r\n                                        },\r\n                                    },\r\n                                    10: {\r\n                                        stats: {\r\n                                            max_stamina: {flat: 4},\r\n                                            strength: {multiplier: 1.05},\r\n                                            dexterity: {multiplier: 1.05},\r\n                                        },\r\n                                        xp_multipliers: {\r\n                                            \"Unarmed\": 1.1,\r\n                                            \"Herbalism\": 1.1,\r\n                                        }\r\n                                    }\r\n                                }});\r\n})();\r\n\r\n//non-work activity related\r\n(function(){\r\n    skills[\"Sleeping\"] = new Skill({\r\n                                    names: {0: \"Sleeping\"}, \r\n                                    description: \"Good, regular sleep is the basis of getting stronger and helps your body heal\",\r\n                                    get_effect_description: ()=>{\r\n                                        return `Multiplies health restored when sleeping by ${Math.round(100*(1 + get_total_skill_level(\"Sleeping\")/skills[\"Sleeping\"].max_level))/100}`;\r\n                                    },\r\n                                    base_xp_cost: 1000,\r\n                                    flavour_text: \"One rat, two rats, three rats...\",\r\n                                    visibility_treshold: 300,\r\n                                    xp_scaling: 2,\r\n                                    category: \"Activity\",\r\n                                    max_level: 10,\r\n                                    max_level_coefficient: 2.5,    \r\n                                    milestones: {\r\n                                        2: {\r\n                                            stats: {\r\n                                                \"max_health\": {\r\n                                                    flat: 10,\r\n                                                    multiplier: 1.04,\r\n                                                }\r\n                                            },\r\n                                            xp_multipliers: {\r\n                                                all: 1.05,\r\n                                            }\r\n                                        },\r\n                                        4: {\r\n                                            stats: {\r\n                                                \"max_health\": {\r\n                                                    flat: 20,\r\n                                                    multiplier: 1.04,\r\n                                                }\r\n                                            },\r\n                                            xp_multipliers: {\r\n                                                all: 1.05,\r\n                                            },\r\n                                        },\r\n                                        5: {\r\n                                            unlocks: {\r\n                                                skills: [\r\n                                                    \"Meditation\"\r\n                                                ]\r\n                                            }\r\n                                        },\r\n                                        6: {\r\n                                            stats: {\r\n                                                \"max_health\": {\r\n                                                    flat: 30,\r\n                                                    multiplier: 1.04,\r\n                                                }\r\n                                            },\r\n                                            xp_multipliers: {\r\n                                                all: 1.05,\r\n                                                \"Meditation\": 1.1,\r\n                                            }\r\n                                        },\r\n                                        8: {\r\n                                            stats: {\r\n                                                \"max_health\": {\r\n                                                    flat: 30,\r\n                                                    multiplier: 1.04,\r\n                                                }\r\n                                            },\r\n                                            xp_multipliers: {\r\n                                                all: 1.05,\r\n                                            }\r\n                                        },\r\n                                        10: {\r\n                                            stats: {\r\n                                                \"max_health\": {\r\n                                                    flat: 40,\r\n                                                    multiplier: 1.1,\r\n                                                }\r\n                                            },\r\n                                            xp_multipliers: {\r\n                                                all: 1.1,\r\n                                                \"Meditation\": 1.2,\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                });                         \r\n    skills[\"Meditation\"] = new Skill({\r\n        names: {0: \"Meditation\"}, \r\n        description: \"Focus your mind\",\r\n        base_xp_cost: 200,\r\n        category: \"Activity\",\r\n        max_level: 30, \r\n        max_level_coefficient: 2,\r\n        is_unlocked: false,\r\n        visibility_treshold: 0,\r\n        milestones: {\r\n            2: {\r\n                stats: {\r\n                    \"intuition\": {flat: 1},\r\n                },\r\n                xp_multipliers: {\r\n                    all: 1.05,\r\n                    \"Presence sensing\": 1.05,\r\n                }\r\n            },\r\n            4: {\r\n                stats: {\r\n                    \"intuition\": {\r\n                        flat: 1, \r\n                        multiplier: 1.05\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    all: 1.05,\r\n                    \"Strength of mind\": 1.05,\r\n                }\r\n            },\r\n            5: {\r\n                xp_multipliers: {\r\n                    \"Sleeping\": 1.1,\r\n                    \"Breathing\": 1.1,\r\n                    \"Presence sensing\": 1.05,\r\n                }\r\n            },\r\n            6: {\r\n                stats: {\r\n                    \"intuition\": {\r\n                        flat: 2,\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    \"Strength of mind\": 1.05,\r\n                }\r\n            },\r\n            8: {\r\n                stats: {\r\n                    \"intuition\": {\r\n                        multiplier: 1.05\r\n                    },\r\n                },\r\n                xp_multipliers: {\r\n                    all: 1.05,\r\n                    \"Sleeping\": 1.1,\r\n                    \"Breathing\": 1.1,\r\n                    \"Presence sensing\": 1.05,\r\n                }\r\n            },\r\n            10: {\r\n                stats: {\r\n                    \"intuition\": {\r\n                        flat: 2,\r\n                        multiplier: 1.05\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    all: 1.1,\r\n                    \"Sleeping\": 1.1,\r\n                    \"Breathing\": 1.1,\r\n                    \"Presence sensing\": 1.1,\r\n                    \"Strength of mind\": 1.1,\r\n                }\r\n            },\r\n            12: {\r\n                stats: {\r\n                    \"intuition\": {\r\n                        flat: 2,\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    all: 1.05,\r\n                    \"Presence sensing\": 1.1,\r\n                }\r\n            },\r\n            15: {\r\n                xp_multipliers: {\r\n                    all: 1.1,\r\n                }\r\n            },\r\n            20: {\r\n                stats: {\r\n                    \"intuition\": {\r\n                        multiplier: 1.05,\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    all_skill: 1.1,\r\n                    \"Presence sensing\": 1.2,\r\n                    Sleeping: 1.2,\r\n                }\r\n            }\r\n        },\r\n        get_effect_description: ()=> {\r\n            let value = get_total_skill_coefficient({skill_id:\"Meditation\",scaling_type:\"multiplicative\"})\r\n            return `Multiplies intuition ${Math.round(value*100)/100}`;\r\n        },\r\n    });                  \r\n    skills[\"Running\"] = new Skill({\r\n        description: \"Great way to improve the efficiency of the body\",\r\n        names: {0: \"Running\"},\r\n        max_level: 50,\r\n        category: \"Activity\",\r\n        max_level_coefficient: 2,\r\n        base_xp_cost: 50,\r\n        milestones: {\r\n            1: {\r\n                stats: {\r\n                    agility: {\r\n                        flat: 1\r\n                    },\r\n                },\r\n            },\r\n            3: {\r\n                stats: {\r\n                    agility: {\r\n                        flat: 1\r\n                    },\r\n                },\r\n                xp_multipliers: {\r\n                    \"Breathing\": 1.1,\r\n                }\r\n            },\r\n            5: {\r\n                stats: {\r\n                    agility: {\r\n                        flat: 1,\r\n                    },\r\n                    max_stamina: {\r\n                        multiplier: 1.05,\r\n                    }\r\n                },                                          \r\n            },\r\n            7: {\r\n                stats: {\r\n                    agility: {\r\n                        flat: 1,\r\n                        multiplier: 1.05,\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    \"Breathing\": 1.05,\r\n                }\r\n            },\r\n            10: {\r\n                stats: {\r\n                    agility: {\r\n                        flat: 1,\r\n                        multiplier: 1.05,\r\n                    },\r\n                    max_stamina: {\r\n                        multiplier: 1.05,\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    \"Breathing\": 1.1,\r\n                }\r\n            },\r\n            12: {\r\n                stats: {\r\n                    agility: {\r\n                        flat: 2\r\n                    },\r\n                    max_stamina: {\r\n                        flat: 5\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    \"Breathing\": 1.05,\r\n                },\r\n                unlocks: {\r\n                            quests: [\r\n                                \"Swimming/climbing unlock\",\r\n                                \"Swimming alternative unlock\"\r\n                            ]\r\n                        }\r\n            },\r\n            15: {\r\n                stats: {\r\n                    agility: {\r\n                        flat: 3\r\n                    },\r\n                    max_stamina: {\r\n                        flat: 5\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    \"Breathing\": 1.1,\r\n                },\r\n            },\r\n            20: {\r\n                stats: {\r\n                    agility: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                    max_stamina: {\r\n                        multiplier: 1.1,\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    \"Breathing\": 1.2,\r\n                },\r\n            }\r\n        },\r\n        get_effect_description: ()=> {\r\n            let value = get_total_skill_coefficient({skill_id:\"Running\",scaling_type:\"multiplicative\"})\r\n            return `Multiplies stamina efficiency by ${Math.round(value*100)/100}`;\r\n        },\r\n    });\r\n    skills[\"Weightlifting\"] = new Skill({\r\n        description: \"No better way to get stronger than by lifting heavy things\",\r\n        names: {0: \"Weightlifting\"},\r\n        max_level: 50,\r\n        category: \"Activity\",\r\n        max_level_coefficient: 4,\r\n        base_xp_cost: 50,\r\n        milestones: {\r\n            1: {\r\n                stats: {\r\n                    strength: {\r\n                        flat: 1\r\n                    },\r\n                },\r\n            },\r\n            3: {\r\n                stats: {\r\n                    strength: {\r\n                        flat: 1\r\n                    },\r\n                },\r\n                xp_multipliers: {\r\n                    \"Unarmed\": 1.05,\r\n                }\r\n            },\r\n            5: {\r\n                stats: {\r\n                    strength: {\r\n                        flat: 1,\r\n                        multiplier: 1.05,\r\n                    },\r\n                    max_stamina: {\r\n                        multiplier: 1.05,\r\n                    }\r\n                },\r\n            },\r\n            7: {\r\n                stats: {\r\n                    strength: {\r\n                        flat: 1\r\n                    },\r\n                },\r\n                xp_multipliers: {\r\n                    \"Unarmed\": 1.1,\r\n                }\r\n            },\r\n            10: {\r\n                stats: {\r\n                    strength: {\r\n                        flat: 1, \r\n                        multiplier: 1.05\r\n                    },\r\n                    max_stamina: {\r\n                        multiplier: 1.05,\r\n                    }\r\n                },\r\n            },\r\n            12: {\r\n                stats: {\r\n                    strength: {\r\n                        flat: 2\r\n                    },\r\n                    max_stamina: {\r\n                        flat: 5\r\n                    }\r\n                },\r\n                unlocks: {\r\n                            quests: [\r\n                                \"Swimming/climbing unlock\",\r\n                                \"Swimming alternative unlock\"\r\n                            ]\r\n                        }\r\n            },\r\n            15: {\r\n                stats: {\r\n                    strength: {\r\n                        flat: 2\r\n                    },\r\n                    max_stamina: {\r\n                        flat: 5\r\n                    }\r\n                },\r\n            },\r\n            20: {\r\n                stats: {\r\n                    strength: {\r\n                        flat: 5,\r\n                        multiplier: 1.05\r\n                    },\r\n                    max_stamina: {\r\n                        flat: 20,\r\n                    },\r\n                },\r\n            }\r\n        },\r\n        get_effect_description: ()=> {\r\n        let value = get_total_skill_coefficient({skill_id:\"Weightlifting\",scaling_type:\"multiplicative\"})\r\n        return `Multiplies strength by ${Math.round(value*100)/100}`;\r\n        },\r\n    });\r\n    skills[\"Swimming\"] = new Skill({\r\n        description: \"A nice, gentle, and relaxing exercise. Just remember to be careful\",\r\n        names: {0: \"Swimming\"},\r\n        max_level: 50,\r\n        category: \"Activity\",\r\n        max_level_coefficient: 2,\r\n        base_xp_cost: 50,\r\n        milestones: {\r\n            1: {\r\n                stats: {\r\n                    agility: {\r\n                        flat: 1\r\n                    },\r\n                },\r\n            },\r\n            3: {\r\n                stats: {\r\n                    strength: {\r\n                        flat: 1\r\n                    },\r\n                },\r\n                xp_multipliers: {\r\n                    \"Breathing\": 1.05,\r\n                }\r\n            },\r\n            5: {\r\n                stats: {\r\n                    agility: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                    max_stamina: {\r\n                        multiplier: 1.05,\r\n                    }\r\n                },\r\n            },\r\n            7: {\r\n                stats: {\r\n                    agility: {\r\n                        flat: 1,\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    \"Breathing\": 1.1,\r\n                }\r\n            },\r\n            10: {\r\n                stats: {\r\n                    agility: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                    max_stamina: {\r\n                        multiplier: 1.05,\r\n                    }\r\n                },\r\n            },\r\n            12: {\r\n                stats: {\r\n                    agility: {\r\n                        flat: 2,\r\n                    },\r\n                    max_stamina: {\r\n                        flat: 10,\r\n                    }\r\n                }\r\n            },\r\n            15: {\r\n                stats: {\r\n                    agility: {\r\n                        flat: 2,\r\n                    },\r\n                    max_stamina: {\r\n                        flat: 10,\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    \"Breathing\": 1.1,\r\n                }\r\n            },\r\n            20: {\r\n                stats: {\r\n                    agility: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                    stamina_efficiency: {\r\n                        multiplier: 1.05,\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    \"Breathing\": 1.2,\r\n                }\r\n            }\r\n        },\r\n        get_effect_description: ()=> {\r\n            let value = get_total_skill_coefficient({skill_id:\"Swimming\",scaling_type:\"multiplicative\"})\r\n            return `Multiplies agility and stamina by ${Math.round(value*100)/100}`;\r\n        },\r\n    });\r\n\r\n    skills[\"Equilibrium\"] = new Skill({\r\n        description: \"Nothing will throw you off your balance (at least the physical one)\",\r\n        names: {0: \"Equilibrium\"},\r\n        category: \"Activity\",\r\n        max_level: 50,\r\n        max_level_coefficient: 4,\r\n        base_xp_cost: 50,\r\n        milestones: {\r\n            1: {\r\n                stats: {\r\n                    agility: {flat: 1},\r\n                },\r\n            },\r\n            3: {\r\n                stats: {\r\n                    intuition: {flat: 1},\r\n                }\r\n            },\r\n            5: {\r\n                stats: {\r\n                    agility: {\r\n                        flat: 1,\r\n                        multiplier: 1.05,\r\n                    },\r\n                    strength: {flat: 1},\r\n                    max_stamina: {multiplier: 1.05},\r\n                },\r\n                xp_multipliers: {\r\n                    \"Unarmed\": 1.1,\r\n                }\r\n            },\r\n            7: {\r\n                stats: {\r\n                    intuition: {flat: 1},\r\n                },\r\n            },\r\n            9: {\r\n                stats: {\r\n                    strength: {flat: 1},\r\n                }\r\n            },\r\n            10: {\r\n                stats: {\r\n                    agility: {flat: 1},\r\n                    intuition: {multiplier: 1.05},\r\n                    max_stamina: {multiplier: 1.05},\r\n                },\r\n            },\r\n            12: {\r\n                stats: {\r\n                    agility: {flat: 1},\r\n                    strength: {flat: 1},\r\n                }\r\n            },\r\n            15: {\r\n                stats: {\r\n                    agility: {flat: 5},\r\n                    strength: {flat: 5},\r\n                }\r\n            },\r\n            20: {\r\n                stats: {\r\n                    intuition: {multiplier: 1.05},\r\n                },\r\n                xp_multipliers: {\r\n                    \"Unarmed\": 1.2,\r\n                }\r\n            }\r\n        },\r\n        get_effect_description: ()=> {\r\n        let value = get_total_skill_coefficient({skill_id:\"Equilibrium\",scaling_type:\"multiplicative\"});\r\n        return `Multiplies agility by ${Math.round(value*100)/100}`;\r\n        },\r\n    });\r\n\r\n    skills[\"Climbing\"] = new Skill({\r\n        description: \"Intense and slightly dangerous form of training that involves majority of your muscles\",\r\n        names: {0: \"Climbing\"},\r\n        max_level: 50,\r\n        category: \"Activity\",\r\n        max_level_coefficient: 2,\r\n        base_xp_cost: 50,\r\n        milestones: {\r\n            1: {\r\n                stats: {\r\n                    agility: {\r\n                        flat: 1\r\n                    },\r\n                },\r\n            },\r\n            3: {\r\n                stats: {\r\n                    strength: {\r\n                        flat: 1\r\n                    },\r\n                },\r\n            },\r\n            5: {\r\n                stats: {\r\n                    agility: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                    max_stamina: {\r\n                        multiplier: 1.03,\r\n                    }\r\n                },\r\n            },\r\n            7: {\r\n                stats: {\r\n                    strength: {\r\n                        flat: 1\r\n                    },\r\n                },\r\n            },\r\n            10: {\r\n                stats: {\r\n                    strength: {\r\n                        multiplier: 1.05\r\n                    },\r\n                    max_stamina: {\r\n                        multiplier: 1.03,\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    Perception: 1.1, //because when climbing you need to find things that you can hold to, right?\r\n                }\r\n            },\r\n            12: {\r\n                stats: {\r\n                    strength: {\r\n                        flat: 2\r\n                    },\r\n                    agility: {\r\n                        flat: 2\r\n                    }\r\n                }\r\n            },\r\n            15: {\r\n                stats: {\r\n                    agility: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                    max_stamina: {\r\n                        multiplier: 1.05,\r\n                    }\r\n                }\r\n            },\r\n            20: {\r\n                stats: {\r\n                    strength: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                    intuition: {\r\n                        flat: 3,\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        get_effect_description: ()=> {\r\n          let value = get_total_skill_coefficient({skill_id:\"Climbing\",scaling_type:\"multiplicative\"});\r\n\r\n          return `Multiplies strength, dexterity and agility by ${Math.round(value*100)/100}`;\r\n        },\r\n    });\r\n})();\r\n\r\n//resource gathering related\r\n(function(){\r\n    skills[\"Woodcutting\"] = new Skill({\r\n        names: {0: \"Woodcutting\"}, \r\n        description: \"Get better with chopping the wood\",\r\n        category: \"Gathering\",\r\n        base_xp_cost: 10,\r\n        visibility_treshold: 4,\r\n        xp_scaling: 1.6,\r\n    });\r\n\r\n    skills[\"Mining\"] = new Skill({\r\n        names: {0: \"Mining\"}, \r\n        description: \"Get better with mining the ores\",\r\n        category: \"Gathering\",\r\n        base_xp_cost: 10,\r\n        visibility_treshold: 4,\r\n        xp_scaling: 1.6,\r\n    });\r\n\r\n    skills[\"Digging\"] = new Skill({\r\n        names: {0: \"Digging\"}, \r\n        description: \"Get better with swinging the shovel\",\r\n        category: \"Gathering\",\r\n        base_xp_cost: 10,\r\n        visibility_treshold: 4,\r\n        xp_scaling: 1.6,\r\n    });\r\n\r\n    skills[\"Herbalism\"] = new Skill({\r\n        names: {0: \"Herbalism\"}, \r\n        description: \"Knowledge of useful plants and mushrooms\",\r\n        category: \"Gathering\",\r\n        base_xp_cost: 10,\r\n        visibility_treshold: 4,\r\n        xp_scaling: 1.6,\r\n    });\r\n\r\n    skills[\"Animal handling\"] = new Skill({\r\n        names: {0: \"Animal handling\"}, \r\n        description: \"Knowledge and skills required to deal with a wide variety of animals\",\r\n        category: \"Gathering\",\r\n        base_xp_cost: 10,\r\n        visibility_treshold: 4,\r\n        xp_scaling: 1.6,\r\n    });\r\n\r\n    skills[\"Fishing\"] = new Skill({\r\n        names: {0: \"Fishing\"}, \r\n        description: \"Get better at luring all kinds of fish\",\r\n        category: \"Gathering\",\r\n        base_xp_cost: 10,\r\n        visibility_treshold: 4,\r\n        xp_scaling: 1.6,\r\n    });\r\n})();\r\n\r\n//crafting skills\r\n(function(){\r\n    skills[\"Crafting mastery\"] = new Skill({\r\n        skill_id: \"Crafting mastery\", \r\n        names: {0: \"Crafting mastery\"}, \r\n        description: \"A mastery of the minor crafting branches like tinkering, woodworking, or butchering\",\r\n        category: skill_category_crafting,\r\n        base_xp_cost: 40,\r\n        xp_scaling: 1.5,\r\n        max_level: 60,\r\n        milestones: {\r\n            5: {\r\n                stats: {\r\n                    dexterity: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                }\r\n            },\r\n            10: {\r\n                stats: {\r\n                    dexterity: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                }\r\n            },\r\n            15: {\r\n                stats: {\r\n                    dexterity: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                }\r\n            },\r\n            20: {\r\n                stats: {\r\n                    dexterity: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                }\r\n            },\r\n            25: {\r\n                stats: {\r\n                    dexterity: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                }\r\n            },\r\n            30: {\r\n                stats: {\r\n                    dexterity: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    skills[\"Crafting\"] = new Skill({\r\n        names: {0: \"Tinkering\"}, \r\n        description: \"Turn smaller pieces into one bigger thing\",\r\n        category: skill_category_crafting,\r\n        parent_skill: \"Crafting mastery\",\r\n        base_xp_cost: 40,\r\n        xp_scaling: 1.5,\r\n        max_level: 60,\r\n        get_effect_description: () => {\r\n            return `Quality cap: ${get_crafting_quality_caps(\"Crafting\").components}% for comps, ${get_crafting_quality_caps(\"Crafting\").equipment}% for eq`;\r\n        },\r\n    });\r\n    skills[\"Smelting\"] = new Skill({\r\n        names: {0: \"Smelting\"}, \r\n        description: \"Turning raw ore into raw metal\",\r\n        category: skill_category_crafting,\r\n        base_xp_cost: 40,\r\n        xp_scaling: 1.5,\r\n        max_level: 60,\r\n    });\r\n    skills[\"Forging\"] = new Skill({\r\n        names: {0: \"Forging\"}, \r\n        description: \"Turning raw metal into something useful\",\r\n        category: skill_category_crafting,\r\n        base_xp_cost: 40,\r\n        xp_scaling: 1.5,\r\n        max_level: 60,\r\n        get_effect_description: () => {\r\n            return `Quality cap: ${get_crafting_quality_caps(\"Forging\").components}% for components`;\r\n        },\r\n        milestones: {\r\n            10: {\r\n                unlocks: {\r\n                    recipes: [\r\n                        {category: \"smelting\", subcategory: \"items\", recipe_id: \"Steel ingot (inefficient)\"},\r\n                    ]\r\n                }\r\n            }\r\n        }\r\n    });\r\n    skills[\"Cooking\"] = new Skill({\r\n        names: {0: \"Cooking\"}, \r\n        description: \"Making the inedible edible\",\r\n        category: skill_category_crafting,\r\n        base_xp_cost: 40,\r\n        xp_scaling: 1.5,\r\n        max_level: 60,\r\n    });\r\n    skills[\"Alchemy\"] = new Skill({\r\n        names: {0: \"Alchemy\"}, \r\n        description: \"Extracting and enhancing useful properties of the ingredients\",\r\n        category: skill_category_crafting,\r\n        base_xp_cost: 40,\r\n        xp_scaling: 1.5,\r\n        max_level: 60,\r\n    });\r\n    skills[\"Butchering\"] = new Skill({\r\n        skill_id: \"Butchering\", \r\n        names: {0: \"Butchering\"}, \r\n        description: \"Making the most of what you kill\",\r\n        category: skill_category_crafting,\r\n        parent_skill: \"Crafting mastery\",\r\n        base_xp_cost: 40,\r\n        xp_scaling: 1.5,\r\n        max_level_coefficient: 2,\r\n        max_level: 60,\r\n        is_unlocked: false,\r\n        visibility_treshold: 0,\r\n        get_effect_description: () => {\r\n            let value = get_total_skill_coefficient({skill_id:\"Butchering\",scaling_type:\"multiplicative\"});\r\n            return `Multiplies drop chances from Beasts by ${Math.round(value*100)/100}`;},\r\n    });\r\n    skills[\"Woodworking\"] = new Skill({\r\n        skill_id: \"Woodworking\", \r\n        names: {0: \"Woodworking\"}, \r\n        description: \"Turning wood logs into something useful\",\r\n        category: skill_category_crafting,\r\n        parent_skill: \"Crafting mastery\",\r\n        base_xp_cost: 40,\r\n        xp_scaling: 1.5,\r\n        max_level: 60,\r\n    });\r\n})();\r\n\r\n//defensive skills\r\n(function(){\r\n    skills[\"Iron skin\"] = new Skill({\r\n        category: \"Combat\",\r\n        names: {0: \"Tough skin\", 10: \"Wooden skin\", 20: \"Stone skin\", 30: \"Iron skin\"},\r\n        description: \"Wearing no protective armor means that your skin keeps getting damaged in combat, which leads to it regenerating over and over to become tougher\",\r\n        base_xp_cost: 400,\r\n        xp_scaling: 1.9,\r\n        max_level: 30,\r\n        max_level_bonus: 30,\r\n        get_effect_description: ()=> {\r\n            return `Increases base defense by ${Math.round(get_total_level_bonus(\"Iron skin\"))}`;\r\n        },\r\n        milestones: {\r\n            3: {\r\n                stats: {\r\n                    max_health: {multiplier: 1.01},\r\n                }\r\n            },\r\n            5: {\r\n                stats: {\r\n                    max_health: {multiplier: 1.01},\r\n                    unarmed_power: {flat: 0.4},\r\n                }\r\n            },\r\n            7: {\r\n                stats: {\r\n                    max_health: {multiplier: 1.02},\r\n                },\r\n                xp_multipliers: {\r\n                    \"Fortitude\": 1.05,\r\n                }\r\n            },\r\n            10: {\r\n                stats: {\r\n                    max_health: {multiplier: 1.02},\r\n                    unarmed_power: {flat: 0.6},\r\n                }\r\n            },\r\n            12: {\r\n                stats: {\r\n                    max_health: {multiplier: 1.02},\r\n                },\r\n                xp_multipliers: {\r\n                    \"Fortitude\": 1.05,\r\n                }\r\n            },\r\n            15: {\r\n                stats: {\r\n                    max_health: {multiplier: 1.1},\r\n                    unarmed_power: {flat: 1},\r\n                },\r\n            },\r\n            20: {\r\n                stats: {\r\n                    max_health: {multiplier: 1.1},\r\n                },\r\n                xp_multipliers: {\r\n                    Fortitude: 1.2,\r\n                    Persistence: 1.2,\r\n                }\r\n            }\r\n        }\r\n    }); \r\n    skills[\"Fortitude\"] = new Skill({\r\n        category: \"Combat\",\r\n        names: {0: \"Fortitude\"},\r\n        description: \"Pretend the wounds are not there\",\r\n        base_xp_cost: 200,\r\n        xp_scaling: 1.6,\r\n        max_level: 60,\r\n        max_level_coefficient: 4,\r\n        get_effect_description: ()=> {\r\n            return `Multiplies max health by ${Math.round(100*get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Fortitude\"}))/100}`;\r\n        },\r\n        milestones: {\r\n            3: {\r\n                stats: {\r\n                    max_health: {multiplier: 1.01},\r\n                }\r\n            },\r\n            5: {\r\n                stats: {\r\n                    defense: {flat: 1},\r\n                },\r\n                xp_multipliers: {\r\n                    \"Iron skin\": 1.05,\r\n                }\r\n            },\r\n            7: {\r\n                stats: {\r\n                    max_health: {multiplier: 1.02},\r\n                }\r\n            },\r\n            10: {\r\n                stats: {\r\n                    defense: {flat: 1},\r\n                },\r\n                xp_multipliers: {\r\n                    \"Iron skin\": 1.05,\r\n                }\r\n            },\r\n            12: {\r\n                stats: {\r\n                    max_health: {multiplier: 1.02},\r\n                }\r\n            },\r\n            15: {\r\n                stats: {\r\n                    max_health: {multiplier: 1.05},\r\n                }\r\n            },\r\n            20: {\r\n                stats: {\r\n                    max_health: {multiplier: 1.02},\r\n                },\r\n                xp_multipliers: {\r\n                    \"Iron skin\": 1.2,\r\n                    Persistence: 1.2,\r\n                }\r\n            }\r\n        }\r\n    }); \r\n})();\r\n\r\n//character skills and resistances\r\n(function(){\r\n    skills[\"Persistence\"] = new Skill({\r\n        names: {0: \"Persistence\"},\r\n        description: \"Do not give up, no matter what\",\r\n        flavour_text: \"Believe in me that believes in you!\",\r\n        base_xp_cost: 60,\r\n        category: \"Character\",\r\n        max_level: 30,\r\n        get_effect_description: ()=> {\r\n            return `Increases low stamina stat multiplier to x${(50+Math.round(get_total_level_bonus(\"Persistence\")*100000)/1000)/100} (originally x0.5)`;\r\n        },\r\n        milestones: {\r\n            2: {\r\n                stats: {\r\n                    max_stamina: {flat: 5},\r\n                },\r\n                xp_multipliers: {\r\n                    all_skill: 1.05,\r\n                }\r\n            },\r\n            4: {\r\n                stats: {\r\n                    max_stamina: {flat: 5},\r\n                },\r\n                xp_multipliers: {\r\n                    hero: 1.05,\r\n                }\r\n            },\r\n            6: {\r\n                stats: {\r\n                    max_stamina: {flat: 10},\r\n                    heat_tolerance: {flat: 1},\r\n                    cold_tolerance: {flat: 1},\r\n                },\r\n                xp_multipliers: {\r\n                    all: 1.05,\r\n                    \"Strength of mind\": 1.05,\r\n                }\r\n            },\r\n            8: {\r\n                stats: {\r\n                    max_stamina: {flat: 10},\r\n                },\r\n                xp_multipliers: {\r\n                    all: 1.05,\r\n                }\r\n            },\r\n            10: {\r\n                stats: {\r\n                    max_stamina: {multiplier: 1.1},\r\n                },\r\n                xp_multipliers: {\r\n                    hero: 1.05,\r\n                    \"Strength of mind\": 1.05,\r\n                }\r\n            },\r\n            12: {\r\n                stats: {\r\n                    max_stamina: {flat: 10},\r\n                    heat_tolerance: {flat: 1},\r\n                    cold_tolerance: {flat: 1},\r\n                },\r\n                xp_multipliers: {\r\n                    hero: 1.05,\r\n                }\r\n            },\r\n            15: {\r\n                stats: {\r\n                    stamina_efficiency: {multiplier: 1.1},\r\n                },\r\n                xp_multipliers: {\r\n                    all_skill: 1.05,\r\n                    \"Strength of mind\": 1.05,\r\n                }\r\n            },\r\n            20: {\r\n                stats: {\r\n                    stamina_efficiency: {multiplier: 1.1},\r\n                    max_stamina: {flat: 10},\r\n                    heat_tolerance: {flat: 1},\r\n                    cold_tolerance: {flat: 1},\r\n                },\r\n                xp_multipliers: {\r\n                    all: 1.1,\r\n                }\r\n            }\r\n        },\r\n        max_level_bonus: 0.3\r\n    });\r\n    skills[\"Perception\"] = new Skill({\r\n        names: {0: \"Perception\"}, \r\n        description: \"Better grasp on your senses allows you to notice small and hidden things, as well as to discern the true nature of what you observe\",\r\n        base_xp_cost: 100,\r\n        visibility_treshold: 80,\r\n        xp_scaling: 1.8,\r\n        max_level: 40,\r\n        category: \"Character\",\r\n        get_effect_description: ()=> {\r\n            return `Increases critical hit chance by ${Math.min(skills[\"Perception\"].max_level, get_total_skill_level(\"Perception\"))} points`;\r\n        },\r\n        milestones: {\r\n            1: {\r\n                stats: {\r\n                    intuition: {flat: 2},\r\n                    dexterity: {flat: 2},\r\n                },\r\n                xp_multipliers: {\r\n                    all: 1.1,\r\n                }\r\n            },\r\n            3: {\r\n                stats: {\r\n                    intuition: {flat: 2},\r\n                    dexterity: {flat: 2},\r\n                    crit_multiplier: {flat: 0.1},\r\n                },\r\n            },\r\n            5: {\r\n                xp_multipliers: {\r\n                    Herbalism: 1.1,\r\n                    Fishing: 1.1,\r\n                }\r\n            },\r\n            7: {\r\n                stats: {\r\n                    intuition: {flat: 2},\r\n                    dexterity: {multiplier: 1.1},\r\n                    crit_multiplier: {flat: 0.1},\r\n                },\r\n            },\r\n            10: {\r\n                xp_multipliers: {\r\n                    Herbalism: 1.2,\r\n                    Fishing: 1.2,\r\n                    hero: 1.1,\r\n                }\r\n            },\r\n            15: {\r\n                stats: {\r\n                    intuition: {flat: 5},\r\n                    dexterity: {multiplier: 1.1},\r\n                    crit_multiplier: {flat: 0.2},\r\n                },\r\n            },\r\n            20: {\r\n                xp_multipliers: {\r\n                    Herbalism: 1.2,\r\n                    Fishing: 1.2,\r\n                    hero: 1.2,\r\n                },\r\n                stats: {\r\n                    intuition: {flat: 10},\r\n                    dexterity: {multiplier: 1.1},\r\n                    crit_multiplier: {flat: 0.2},\r\n                },\r\n            }\r\n        }\r\n    }); \r\n    skills[\"Literacy\"] = new Skill({\r\n        names: {0: \"Literacy\"}, \r\n        description: \"Ability to read and understand written text\",\r\n        category: \"Character\",\r\n        base_xp_cost: 120,\r\n        max_level: 10,\r\n        xp_scaling: 2,\r\n        milestones: {\r\n            1: {\r\n                xp_multipliers: {\r\n                    hero: 1.05,\r\n                    \"Strength of mind\": 1.05,\r\n                }\r\n            },\r\n            2: {\r\n                xp_multipliers: {\r\n                    all_skill: 1.05,\r\n                }\r\n            },\r\n            3: {\r\n                xp_multipliers: {\r\n                    all: 1.05,\r\n                }\r\n            },\r\n            5: {\r\n                xp_multipliers: {\r\n                    hero: 1.05,\r\n                    \"Strength of mind\": 1.05,\r\n                }\r\n            }\r\n        }\r\n    }); \r\n    skills[\"Medicine\"] = new Skill({\r\n        names: {0: \"Medicine\"}, \r\n        description: \"Create better medicaments and improve your skill at treating wounds\",\r\n        category: \"Character\",\r\n        max_level: 30,\r\n        visibility_treshold: 5,\r\n        max_level_coefficient: 2,\r\n        get_effect_description: ()=> {\r\n            let value = get_total_skill_coefficient({skill_id:\"Medicine\",scaling_type:\"multiplicative\"});\r\n            return `Multiplies additive effects of medicines by ${Math.round((value**2)*100)/100} and multiplicative effects by ${Math.round(value*100)/100}`;\r\n          },\r\n    });\r\n    skills[\"Gluttony\"] = new Skill({\r\n        names: {0: \"Gluttony\"}, \r\n        description: \"The more you eat the better you will be at digesting, right?\",\r\n        category: \"Character\",\r\n        max_level: 30,\r\n        visibility_treshold: 5,\r\n        max_level_coefficient: 2,\r\n        get_effect_description: ()=> {\r\n            let value = get_total_skill_coefficient({skill_id:\"Gluttony\",scaling_type:\"multiplicative\"});\r\n            return `Multiplies additive effects of foods by ${Math.round((value**2)*100)/100} and multiplicative effects by ${Math.round(value*100)/100}`;\r\n        },\r\n        milestones: {\r\n            3: {\r\n                xp_multipliers: {\r\n                    hero: 1.05,\r\n                }\r\n            },\r\n            5: {\r\n                stats: {\r\n                    max_health: {\r\n                        flat: 20,\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    \"Regeneration\": 1.1,\r\n                }\r\n            },\r\n            7: {\r\n                stats: {\r\n                    health_regeneration_flat: {\r\n                        flat: 0.1,\r\n                    }\r\n                }\r\n            },\r\n            10: {\r\n                stats: {\r\n                    stamina_regeneration_flat: {\r\n                        flat: 0.1,\r\n                    },\r\n                    cold_tolerance: {flat: 1},\r\n                },\r\n                xp_multipliers: {\r\n                    hero: 1.05,\r\n                }\r\n            },\r\n            12: {\r\n                stats: {\r\n                    health_regeneration_flat: {\r\n                        flat: 0.2,\r\n                    }\r\n                },\r\n                xp_multipliers: {\r\n                    \"Regeneration\": 1.1,\r\n                }\r\n            },\r\n            15: {\r\n                xp_multipliers: {\r\n                    Regeneration: 1.1,\r\n                    Weightlifting: 1.1,\r\n                    Running: 1.1,\r\n                    Climbing: 1.1,\r\n                    Swimming: 1.1,\r\n                }\r\n            },\r\n            20: {\r\n                stats: {\r\n                    stamina_regeneration_flat: {\r\n                        flat: 0.2,\r\n                    },\r\n                    cold_tolerance: {flat: 1},\r\n                },\r\n                xp_multipliers: {\r\n                    hero: 1.1,\r\n                    Regeneration: 1.2,\r\n                }\r\n            },\r\n        }\r\n    });\r\n    skills[\"Breathing\"] = new Skill({\r\n        names: {0: \"Breathing\"},\r\n        description: \"Oxygen is the most important resource for improving the performance of your body. Learn how to take it in more efficiently\",\r\n        flavour_text: \"You are now breathing manually\",\r\n        base_xp_cost: 400,\r\n        visibility_treshold: 390,\r\n        xp_scaling: 1.6,\r\n        category: \"Character\",\r\n        max_level_coefficient: 2,\r\n        max_level: 40,\r\n        milestones: {\r\n            3: {\r\n                xp_multipliers: {\r\n                    Running: 1.1,\r\n                    Meditation: 1.1,\r\n                },\r\n                stats: {\r\n                    attack_speed: {\r\n                        multiplier: 1.02,\r\n                    }\r\n                }\r\n            },\r\n            5: {\r\n                stats: {\r\n                    agility: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                    stamina_efficiency: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                },\r\n            },\r\n            7: {\r\n                xp_multipliers: {\r\n                    Running: 1.1,\r\n                    Meditation: 1.1,\r\n                },\r\n                stats: {\r\n                    stamina_regeneration_flat: {\r\n                        flat: 0.1,\r\n                    }\r\n                }\r\n            },\r\n            10: {\r\n                stats: {\r\n                    strength: {\r\n                        multiplier: 1.05\r\n                    },\r\n                    max_stamina: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                    attack_speed: {\r\n                        multiplier: 1.02,\r\n                    }\r\n                },\r\n            },\r\n            12: {\r\n                stats: {\r\n                    strength: {\r\n                        flat: 2\r\n                    },\r\n                    agility: {\r\n                        flat: 2\r\n                    },\r\n                },\r\n                xp_multipliers: {\r\n                    Running: 1.1,\r\n                    Meditation: 1.1,\r\n                }\r\n            }, \r\n            15: {\r\n                xp_multipliers: {\r\n                    Running: 1.1,\r\n                    Meditation: 1.1,\r\n                },\r\n                stats: {\r\n                    attack_speed: {\r\n                        multiplier: 1.02,\r\n                    },\r\n                    stamina_efficiency: {\r\n                        multiplier: 1.05,\r\n                    },\r\n                    stamina_regeneration_flat: {\r\n                        flat: 0.1,\r\n                    }\r\n                }\r\n            },\r\n            20: {\r\n                xp_multipliers: {\r\n                    category_Activity: 1.2,\r\n                },\r\n                stats: {\r\n                    attack_speed: {\r\n                        multiplier: 1.02,\r\n                    },\r\n                    stamina_efficiency: {\r\n                        multiplier: 1.05,\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        get_effect_description: ()=> {\r\n            let value = get_total_skill_coefficient({skill_id:\"Breathing\",scaling_type:\"multiplicative\"});\r\n            return `Multiplies strength, agility and stamina by ${Math.round(value*100)/100}. Reduces thin air effects`;\r\n          },\r\n    });  \r\n    skills[\"Regeneration\"] = new Skill({\r\n                                names: {0: \"Regeneration\"}, \r\n                                description: \"As your body regenerates more and more, it slowly becomes more proficient in this task\",\r\n                                get_effect_description: ()=>{\r\n                                    return `Multiplies health restored when resting or sleeping by ${Math.round(100*(1 + 3*get_total_skill_level(\"Regeneration\")/skills[\"Regeneration\"].max_level))/100}`;\r\n                                },\r\n                                base_xp_cost: 1000,\r\n                                visibility_treshold: 500,\r\n                                xp_scaling: 1.5,\r\n                                category: \"Character\",\r\n                                max_level: 40,\r\n                                max_level_coefficient: 2.5,    \r\n                                milestones: {\r\n                                    1: {\r\n                                        stats: {\r\n                                            max_health: {\r\n                                                flat: 10,\r\n                                            }\r\n                                        }\r\n                                    },\r\n                                    3: {\r\n                                        stats: {\r\n                                            max_health: {\r\n                                                flat: 10,\r\n                                            }\r\n                                        }\r\n                                    },\r\n                                    5: {\r\n                                        stats: {\r\n                                            health_regeneration_flat: {\r\n                                                flat: 0.1,\r\n                                            }\r\n                                        }\r\n                                    },\r\n                                    7: {\r\n                                        stats: {\r\n                                            max_health: {\r\n                                                flat: 20,\r\n                                            }\r\n                                        }\r\n                                    },\r\n                                    10: {\r\n                                        stats: {\r\n                                            max_health: {\r\n                                                flat: 20,\r\n                                            },\r\n                                            health_regeneration_flat: {\r\n                                                flat: 0.2,\r\n                                            }\r\n                                        }\r\n                                    },\r\n                                    12: {\r\n                                        stats: {\r\n                                            max_health: {\r\n                                                flat: 20,\r\n                                            },\r\n                                        }\r\n                                    },\r\n                                    15: {\r\n                                        stats: {\r\n                                            health_regeneration_flat: {\r\n                                                flat: 0.4,\r\n                                            },\r\n                                            max_health: {\r\n                                                flat: 40,\r\n                                            },\r\n                                        }\r\n                                    },\r\n                                    20: {\r\n                                        stats: {\r\n                                            max_health: {\r\n                                                multiplier: 1.1,\r\n                                            }\r\n                                        },\r\n                                        xp_multipliers: {\r\n                                            \"Iron skin\": 1.2,\r\n                                            Fortitude: 1.2,\r\n                                        }\r\n                                    },\r\n                                }\r\n    });  \r\n})();\r\n\r\n//miscellaneous skills\r\n(function(){\r\n    skills[\"Haggling\"] = new Skill({\r\n        names: {0: \"Haggling\"},\r\n        description: \"The art of the deal\",\r\n        category: \"Character\",\r\n        base_xp_cost: 100,\r\n        max_level: 25,\r\n        get_effect_description: ()=> {\r\n            return `Lowers trader cost multiplier to ${Math.round((1 - get_total_level_bonus(\"Haggling\"))*100)}% of original value`;\r\n        },\r\n        max_level_bonus: 0.5,\r\n        milestones: {\r\n            2: {\r\n                stats: {\r\n                    intuition: {\r\n                        flat: 1\r\n                    },\r\n                },\r\n            },\r\n            3: {\r\n                xp_multipliers: {\r\n                    \"Literacy\": 1.05,\r\n                },\r\n            },\r\n            5: {\r\n                stats: {\r\n                    intuition: {\r\n                        flat: 2\r\n                    },\r\n                },\r\n                xp_multipliers: {\r\n                    \"Literacy\": 1.05,\r\n                    \"Persistence\": 1.05,\r\n                    Perception: 1.05,\r\n                },\r\n            },\r\n            7: {\r\n                stats: {\r\n                    intuition: {\r\n                        flat: 2\r\n                    }\r\n                },\r\n            },\r\n            10: {\r\n                stats: {\r\n                    intuition: {\r\n                        flat: 2\r\n                    },\r\n                },\r\n                xp_multipliers: {\r\n                    Literacy: 1.05,\r\n                    Persistence: 1.05,\r\n                    Perception: 1.1,\r\n                },\r\n            },\r\n            15: {\r\n                stats: {\r\n                    intuition: {\r\n                        flat: 5\r\n                    },\r\n                },\r\n                xp_multipliers: {\r\n                    Literacy: 1.1,\r\n                    Persistence: 1.1,\r\n                    Perception: 1.1,\r\n                },\r\n            }\r\n        }\r\n    });\r\n})();\r\n\r\nObject.keys(skills).forEach(id => {\r\n    skills[id].skill_id = id;\r\n});\r\n\r\nexport {\r\n    skills, Skill, skill_categories, \r\n    get_unlocked_skill_rewards, get_next_skill_milestone, \r\n    weapon_type_to_skill, which_skills_affect_skill, \r\n    skill_xp_gains_cap, crafting_skill_xp_gains_cap\r\n};\r\n", "\"use strict\";\r\n\r\nimport { character, get_total_level_bonus } from \"./character.js\";\r\nimport { current_game_time } from \"./game_time.js\";\r\nimport { InventoryHaver } from \"./inventory.js\";\r\nimport { item_templates, getItem} from \"./items.js\";\r\n\r\nconst traders = {};\r\nconst inventory_templates = {};\r\n\r\n\r\nclass Trader extends InventoryHaver {\r\n    constructor({\r\n                name,\r\n                display_name,\r\n                trade_text,\r\n                unlock_message = null,\r\n                location_name,\r\n                refresh_time = 4,\r\n                refresh_shift = 0,\r\n                inventory_template,\r\n                profit_margin = 3,\r\n                is_unlocked = true,\r\n            }) \r\n    {\r\n        super();\r\n        this.name = name;\r\n        this.display_name = display_name || name;\r\n        this.trade_text = trade_text || `Trade with ${this.display_name}`;\r\n        this.unlock_message = unlock_message,\r\n        this.location_name = location_name;\r\n        this.last_refresh = -1;  \r\n        //just the day_count from game_time at which trader was supposedly last refreshed\r\n\r\n        this.refresh_time = refresh_time; \r\n        //7 would mean it's refreshed every 7 days (with shift at 0 it's every monday)\r\n        \r\n        this.refresh_shift = refresh_shift; \r\n        //shift refreshing days, e.g. time 7 + shift 2 would be every wednesday, shift 4 would push it to every friday\r\n        //pretty much pointless if refresh time is not N*7\r\n        \r\n        this.inventory_template = inventory_template;\r\n        //a template for the trader to use, so multiple traders can have same predefined item selection (but still separate and with certain randomness)\r\n\r\n        this.profit_margin = profit_margin;\r\n        //how much more expensive are the trader's items than their actual value, with default being 2 (so 2x more)\r\n        //don't make it too low to prevent easy xp grinding for the haggling skill\r\n        this.is_unlocked = is_unlocked;\r\n\r\n        this.is_finished = false; \r\n        //for permalocking a trader; named like this for consistency with other things that can get locked; only for some fringe situations (e.g. swapping some trader for a better one instead of simply unlocking another)\r\n    }\r\n    \r\n    /**\r\n     * refreshes trader inventory\r\n     * @returns boolean informing if it was able to refresh\r\n     */\r\n    refresh() {\r\n        if(this.can_refresh()) {\r\n            //refresh inventory\r\n            this.inventory = this.get_inventory_from_template();\r\n\r\n            this.last_refresh = (current_game_time.day_count + 1 - current_game_time.day_count % this.refresh_time);\r\n            return true;\r\n        }\r\n        //otherwise do nothing\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * checks if enough time passed since last refresh\r\n     * @returns {Boolean}\r\n     */\r\n    can_refresh() {\r\n        return (this.last_refresh < 0 || current_game_time.day_count - (this.last_refresh + this.refresh_shift) >= this.refresh_time);\r\n    }\r\n\r\n    /**\r\n     * creates new choice of items for the trader, based on assigned inventory template\r\n     * @returns {null}\r\n     */\r\n    get_inventory_from_template() {\r\n        const inventory = {};\r\n        const inventory_template = inventory_templates[this.inventory_template];\r\n\r\n        for (let i = 0; i < inventory_template.length; i++) {\r\n            if (inventory_template[i].chance >= Math.random()) {\r\n                let item_count = inventory_template[i].count.length == 1 ?\r\n                inventory_template[i].count[0] : Math.round(Math.random() *\r\n                    (inventory_template[i].count[1] - inventory_template[i].count[0]) + inventory_template[i].count[0]);\r\n                \r\n                if(inventory_template[i].quality) {\r\n                    let quality = Math.round(Math.random() *\r\n                        (inventory_template[i].quality[1] - inventory_template[i].quality[0]) + inventory_template[i].quality[0]);\r\n\r\n                    const item = getItem({...item_templates[inventory_template[i].item_name], quality});\r\n                    inventory[item.getInventoryKey()] = { item: item, count: item_count };\r\n                } else {\r\n                    inventory[item_templates[inventory_template[i].item_name].getInventoryKey()] = { item: getItem(item_templates[inventory_template[i].item_name]), count: item_count }; \r\n                }\r\n            }\r\n        }\r\n\r\n        //just add items based on their chances and counts in inventory_template\r\n        return inventory;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns {Number} trader's profit margin multiplied by bonus from the haggling skill and by reputation impact\r\n     */\r\n    getProfitMargin(region) {\r\n\r\n        const skill_multi = (1-get_total_level_bonus(\"Haggling\"));\r\n        const rep_multi = (1-Math.min(1000,character.reputation[region])/2000) || 1;\r\n\r\n        return 1 + (this.profit_margin - 1) * skill_multi * rep_multi;\r\n    }\r\n\r\n    /*\r\n    getItemPrice(value, region) {\r\n        let price = Math.ceil(value*this.getProfitMargin(region));\r\n        if(price >= 100) {\r\n            return Math.round(price/10)*10;\r\n        } else if(price >= 1000) {\r\n            return Math.round(price/100)*100;\r\n        } else {\r\n            return price;\r\n        }\r\n    }\r\n    */  \r\n}\r\n\r\nclass TradeItem {\r\n    constructor({ item_name,\r\n                  chance = 1,\r\n                  count = [1],\r\n                  quality = null,\r\n                }) \r\n    {\r\n        this.item_name = item_name;\r\n        this.chance = chance; //chance for item to appear, 1 is 100%\r\n        this.count = count; \r\n        //how many can appear, will randomly choose something between min and max if specificed, otherwise will go with specific ammount\r\n        \r\n        this.quality = quality; //min and max quality of item\r\n    }\r\n}\r\n\r\n//create traders\r\n(function(){\r\n    traders[\"village trader\"] = new Trader({\r\n        name: \"village trader\",\r\n        inventory_template: \"Basic\",\r\n        is_unlocked: false,\r\n        location_name: \"Village\",\r\n        trade_text: \"Trade on the village market\",\r\n        unlock_message: \"You can now visit the village market\",\r\n    });\r\n    traders[\"suspicious trader\"] = new Trader({\r\n        name: \"suspicious trader\",\r\n        inventory_template: \"Basic plus\",\r\n        is_unlocked: true,\r\n        location_name: \"Slums\",\r\n        profit_margin: 5,\r\n    });\r\n    traders[\"suspicious trader 2\"] = new Trader({\r\n        name: \"suspicious trader 2\",\r\n        display_name: \"suspicious trader\",\r\n        inventory_template: \"Intermediate\",\r\n        is_unlocked: false,\r\n        location_name: \"Slums\",\r\n        profit_margin: 4, //rise back to 5 once reputation impact is implemented\r\n    });\r\n    traders[\"swampland trader\"] = new Trader({\r\n        name: \"swampland trader\",\r\n        inventory_template: \"Swamp\",\r\n        is_unlocked: true,\r\n        location_name: \"Swampland tribe\",\r\n        profit_margin: 7,\r\n    });\r\n    traders[\"swampland trader 2\"] = new Trader({\r\n        name: \"swampland trader\",\r\n        inventory_template: \"Swamp plus\",\r\n        is_unlocked: false,\r\n        location_name: \"Swampland tribe\",\r\n        profit_margin: 5,\r\n    });\r\n})();\r\n\r\n//create inventory templates\r\n(function(){\r\n    inventory_templates[\"Basic\"] = \r\n    [\r\n            new TradeItem({item_name: \"Cheap iron spear\", count: [1], quality: [40, 90], chance: 0.8}),\r\n            new TradeItem({item_name: \"Cheap iron dagger\", count: [1], quality: [40, 90], chance: 0.8}),\r\n            new TradeItem({item_name: \"Cheap iron sword\", count: [1], quality: [40, 90], chance: 0.8}),\r\n            new TradeItem({item_name: \"Cheap iron axe\", count: [1], quality: [40, 90], chance: 0.8}),\r\n            new TradeItem({item_name: \"Cheap iron battle hammer\", count: [1], quality: [40, 90], chance: 0.8}),\r\n\r\n            new TradeItem({item_name: \"Cheap iron spear\", count: [1], quality: [91, 120], chance: 0.4}),\r\n            new TradeItem({item_name: \"Cheap iron dagger\", count: [1], quality: [91, 120], chance: 0.4}),\r\n            new TradeItem({item_name: \"Cheap iron sword\", count: [1], quality: [91, 120], chance: 0.4}),\r\n            new TradeItem({item_name: \"Cheap iron axe\", count: [1], quality: [91, 120], chance: 0.4}),\r\n            new TradeItem({item_name: \"Cheap iron battle hammer\", count: [1], quality: [91, 120], chance: 0.4}),\r\n\r\n            new TradeItem({item_name: \"Iron spear\", count: [1], quality: [70, 90], chance: 0.4}),\r\n            new TradeItem({item_name: \"Iron dagger\", count: [1], quality: [70, 90], chance: 0.4}),\r\n            new TradeItem({item_name: \"Iron sword\", count: [1], quality: [70, 90], chance: 0.4}),\r\n            new TradeItem({item_name: \"Iron axe\", count: [1], quality: [70, 90], chance: 0.4}),\r\n            new TradeItem({item_name: \"Iron battle hammer\", count: [1], quality: [70, 90], chance: 0.4}),\r\n\r\n            new TradeItem({item_name: \"Wooden training shield\", count: [1], quality: [100,100]}),\r\n            new TradeItem({item_name: \"Cheap wooden shield\", count: [1], quality: [40, 90]}),\r\n            new TradeItem({item_name: \"Cheap wooden shield\", count: [1], chance: 0.8, quality: [91, 120]}),\r\n            new TradeItem({item_name: \"Crude wooden shield\", count: [1], chance: 0.7, quality: [40, 90]}),\r\n            new TradeItem({item_name: \"Crude wooden shield\", count: [1], chance: 0.4, quality: [91, 120]}),\r\n\r\n            new TradeItem({item_name: \"Cheap leather vest\", count: [1], quality: [40, 90]}),\r\n            new TradeItem({item_name: \"Cheap leather vest\", count: [1], chance: 0.5, quality: [91, 120]}),\r\n            new TradeItem({item_name: \"Cheap leather pants\", count: [1], quality: [40, 90]}),\r\n            new TradeItem({item_name: \"Cheap leather pants\", count: [1], chance: 0.5, quality: [91, 120]}),\r\n            new TradeItem({item_name: \"Cheap leather hat\", count: [1], quality: [40, 90]}),\r\n            new TradeItem({item_name: \"Cheap leather hat\", count: [1], chance: 0.5, quality: [91, 120]}),\r\n            new TradeItem({item_name: \"Cheap leather shoes\", count: [1], chance: 0.5, quality: [91, 120]}),\r\n\r\n            new TradeItem({item_name: \"Leather shoes\", count: [1], chance: 0.4, quality: [91, 120]}),\r\n            new TradeItem({item_name: \"Leather vest\", count: [1], chance: 0.7, quality: [70, 120]}),\r\n            new TradeItem({item_name: \"Leather pants\", count: [1], chance: 0.7, quality: [70, 120]}),\r\n            new TradeItem({item_name: \"Leather hat\", count: [1], chance: 0.7, quality: [70, 120]}),\r\n            new TradeItem({item_name: \"Leather gloves\", count: [1], chance: 0.7, quality: [70, 120]}),\r\n            new TradeItem({item_name: \"Work shoes\", count: [1,2], chance: 0.6, quality: [100, 100]}),\r\n\r\n            new TradeItem({item_name: \"Wolf leather armor\", count: [1], chance: 0.3, quality: [60, 120]}),\r\n            new TradeItem({item_name: \"Wolf leather armored pants\", count: [1], chance: 0.3, quality: [60, 120]}),\r\n            new TradeItem({item_name: \"Wolf leather helmet\", count: [1], chance: 0.3, quality: [60, 120]}),\r\n\r\n            new TradeItem({item_name: \"Rat pelt cape\", count: [1,3], chance: 1, quality: [70, 120]}),\r\n\r\n            new TradeItem({item_name: \"Stale bread\", count: [7,14]}),\r\n            new TradeItem({item_name: \"Bread kwas\", count: [3,5], chance: 0.6}),\r\n            new TradeItem({item_name: \"Fresh bread\", count: [4,7]}),\r\n            new TradeItem({item_name: \"Weak healing powder\", count: [2,5]}),\r\n            new TradeItem({item_name: \"Cooking herbs\", count: [2,4], chance: 0.5}),\r\n\r\n            new TradeItem({item_name: \"Coal\", count: [5,20]}),\r\n\r\n            new TradeItem({item_name: \"ABC for kids\", count: [1], chance: 1}),\r\n            new TradeItem({item_name: \"Old combat manual\", count: [1], chance: 0.5}),\r\n            new TradeItem({item_name: \"Butchering and you\", count: [1], chance: 0.2}),\r\n            new TradeItem({item_name: \"Medicine for dummies\", count: [1], chance: 0.2}),\r\n            new TradeItem({item_name: \"Ode to Whimsy, and other poems\", count: [1], chance: 0.2}),\r\n            new TradeItem({item_name: \"A Glint On The Sand\", count: [1], chance: 0.2}),\r\n            \r\n            new TradeItem({item_name: \"Glass phial\", count: [5,10], chance: 1}),\r\n            new TradeItem({item_name: \"Glass bottle\", count: [4,8], chance: 1}),\r\n\r\n            new TradeItem({item_name: \"Camping supplies\", count: [1,3], chance: 1}),\r\n            new TradeItem({item_name: \"Coil of rope\", count: [1,3], chance: 1}),\r\n    ];\r\n\r\n    inventory_templates[\"Basic plus\"] = \r\n    [\r\n            new TradeItem({item_name: \"Iron spear\", count: [1], quality: [70, 90], chance: 0.8}),\r\n            new TradeItem({item_name: \"Iron dagger\", count: [1], quality: [70, 90], chance: 0.8}),\r\n            new TradeItem({item_name: \"Iron sword\", count: [1], quality: [70, 90], chance: 0.8}),\r\n            new TradeItem({item_name: \"Iron axe\", count: [1], quality: [70, 90], chance: 0.8}),\r\n            new TradeItem({item_name: \"Iron battle hammer\", count: [1], quality: [40, 80], chance: 0.8}),\r\n\r\n            new TradeItem({item_name: \"Iron spear\", count: [1], quality: [81, 120], chance: 0.8}),\r\n            new TradeItem({item_name: \"Iron dagger\", count: [1], quality: [81, 120], chance: 0.8}),\r\n            new TradeItem({item_name: \"Iron sword\", count: [1], quality: [81, 120], chance: 0.8}),\r\n            new TradeItem({item_name: \"Iron axe\", count: [1], quality: [81, 120], chance: 0.8}),\r\n            new TradeItem({item_name: \"Iron battle hammer\", count: [1], quality: [81, 120], chance: 0.8}),\r\n\r\n            new TradeItem({item_name: \"Steel spear\", count: [1], quality: [70, 100], chance: 0.5}),\r\n            new TradeItem({item_name: \"Steel dagger\", count: [1], quality: [70, 100], chance: 0.5}),\r\n            new TradeItem({item_name: \"Steel sword\", count: [1], quality: [70, 100], chance: 0.5}),\r\n            new TradeItem({item_name: \"Steel axe\", count: [1], quality: [70, 100], chance: 0.5}),\r\n            new TradeItem({item_name: \"Steel battle hammer\", count: [1], quality: [70, 100], chance: 0.5}),\r\n            \r\n            new TradeItem({item_name: \"Steel spear\", count: [1], quality: [81, 120], chance: 0.4}),\r\n            new TradeItem({item_name: \"Steel dagger\", count: [1], quality: [81, 120], chance: 0.4}),\r\n            new TradeItem({item_name: \"Steel sword\", count: [1], quality: [81, 120], chance: 0.4}),\r\n            new TradeItem({item_name: \"Steel axe\", count: [1], quality: [81, 120], chance: 0.4}),\r\n            new TradeItem({item_name: \"Steel battle hammer\", count: [1], quality: [81, 120], chance: 0.4}),\r\n\r\n            new TradeItem({item_name: \"Wooden shield\", count: [1], quality: [40, 80]}),\r\n            new TradeItem({item_name: \"Wooden shield\", count: [1], chance: 0.8, quality: [81, 120]}),\r\n            new TradeItem({item_name: \"Crude iron shield\", count: [1], quality: [40, 80]}),\r\n            new TradeItem({item_name: \"Crude iron shield\", count: [1], chance: 0.8, quality: [81, 120]}),\r\n            new TradeItem({item_name: \"Iron shield\", count: [1], chance: 0.6, quality: [40, 80]}),\r\n            new TradeItem({item_name: \"Iron shield\", count: [1], chance: 0.4, quality: [81, 120]}),\r\n            new TradeItem({item_name: \"Steel shield\", count: [1], chance: 0.3, quality: [81, 100]}),\r\n            new TradeItem({item_name: \"Ash wood shield\", count: [1], chance: 0.3, quality: [81, 100]}),\r\n\r\n            new TradeItem({item_name: \"Leather vest\", count: [1], chance: 0.9, quality: [81, 120]}),\r\n            new TradeItem({item_name: \"Leather pants\", count: [1], chance: 0.9, quality: [81, 120]}),\r\n            new TradeItem({item_name: \"Leather hat\", count: [1], chance: 0.9, quality: [81, 120]}),\r\n            new TradeItem({item_name: \"Leather shoes\", count: [1], chance: 0.8, quality: [91, 120]}),\r\n            new TradeItem({item_name: \"Leather gloves\", count: [1], chance: 0.8, quality: [91, 120]}),\r\n            new TradeItem({item_name: \"Work shoes\", count: [2,3], chance: 0.6, quality: [100, 100]}),\r\n\r\n            new TradeItem({item_name: \"Wolf leather armor\", count: [1], chance: 0.8, quality: [91, 120]}),\r\n            new TradeItem({item_name: \"Wolf leather armored pants\", count: [1], chance: 0.8, quality: [91, 120]}),\r\n            new TradeItem({item_name: \"Wolf leather helmet\", count: [1], chance: 0.8, quality: [91, 120]}),\r\n\r\n            new TradeItem({item_name: \"Rat pelt cape\", count: [1,2], chance: 0.6, quality: [70, 120]}),\r\n            new TradeItem({item_name: \"Wolf pelt cape\", count: [1], chance: 0.9, quality: [70, 120]}),\r\n            \r\n            new TradeItem({item_name: \"Iron chainmail armor\", count: [1], chance: 0.8, quality: [40, 80]}),\r\n            new TradeItem({item_name: \"Iron chainmail armor\", count: [1], chance: 0.6, quality: [81, 120]}),\r\n            new TradeItem({item_name: \"Iron chainmail pants\", count: [1], chance: 0.8, quality: [40, 80]}),\r\n            new TradeItem({item_name: \"Iron chainmail pants\", count: [1], chance: 0.6, quality: [81, 120]}),\r\n            new TradeItem({item_name: \"Iron chainmail helmet\", count: [1], chance: 0.8, quality: [40, 80]}),\r\n            new TradeItem({item_name: \"Iron chainmail helmet\", count: [1], chance: 0.6, quality: [81, 120]}),\r\n            \r\n            new TradeItem({item_name: \"Stale bread\", count: [4,10]}),\r\n            new TradeItem({item_name: \"Fresh bread\", count: [2,5]}),\r\n            new TradeItem({item_name: \"Bread kwas\", count: [1,3]}),\r\n            new TradeItem({item_name: \"Weak healing powder\", count: [2,5]}),\r\n            new TradeItem({item_name: \"Oneberry juice\", count: [2,5]}),\r\n            new TradeItem({item_name: \"Cooking herbs\", count: [1,4], chance: 0.6}),\r\n\r\n            new TradeItem({item_name: \"Coal\", count: [20,50]}),\r\n\r\n            new TradeItem({item_name: \"Twist liek a snek\", count: [1], chance: 0.8}),\r\n            new TradeItem({item_name: \"Butchering and you\", count: [1], chance: 0.6}),\r\n            new TradeItem({item_name: \"Medicine for dummies\", count: [1], chance: 0.6}),\r\n            new TradeItem({item_name: \"Ode to Whimsy, and other poems\", count: [1], chance: 0.4}),\r\n            new TradeItem({item_name: \"A Glint On The Sand\", count: [1], chance: 0.4}),\r\n\r\n            new TradeItem({item_name: \"Glass phial\", count: [5,10], chance: 1}),\r\n            new TradeItem({item_name: \"Glass bottle\", count: [4,8], chance: 1}),\r\n\r\n            new TradeItem({item_name: \"Camping supplies\", count: [1], chance: 1}),\r\n            new TradeItem({item_name: \"Coil of rope\", count: [1], chance: 1}),\r\n\r\n            new TradeItem({item_name: \"Iron sickle\", count: [1], chance: 0.8}),\r\n            new TradeItem({item_name: \"Iron pickaxe\", count: [1], chance: 0.8}),\r\n            new TradeItem({item_name: \"Iron chopping axe\", count: [1], chance: 0.8}),\r\n            new TradeItem({item_name: \"Iron shovel\", count: [1], chance: 0.8}),\r\n    ];\r\n\r\n    inventory_templates[\"Intermediate\"] = \r\n    [\r\n        new TradeItem({item_name: \"Iron spear\", count: [1], quality: [100, 120], chance: 0.8}),\r\n        new TradeItem({item_name: \"Iron dagger\", count: [1], quality: [100, 120], chance: 0.8}),\r\n        new TradeItem({item_name: \"Iron sword\", count: [1], quality: [100, 120], chance: 0.8}),\r\n        new TradeItem({item_name: \"Iron axe\", count: [1], quality: [100, 120], chance: 0.8}),\r\n        new TradeItem({item_name: \"Iron battle hammer\", count: [1], quality: [100, 120], chance: 0.8}),\r\n\r\n        new TradeItem({item_name: \"Steel spear\", count: [1], quality: [80, 100], chance: 0.8}),\r\n        new TradeItem({item_name: \"Steel dagger\", count: [1], quality: [80, 100], chance: 0.8}),\r\n        new TradeItem({item_name: \"Steel sword\", count: [1], quality: [80, 100], chance: 0.8}),\r\n        new TradeItem({item_name: \"Steel axe\", count: [1], quality: [80, 100], chance: 0.8}),\r\n        new TradeItem({item_name: \"Steel battle hammer\", count: [1], quality: [80, 100], chance: 0.8}),\r\n\r\n        new TradeItem({item_name: \"Steel spear\", count: [1], quality: [81, 120], chance: 0.8}),\r\n        new TradeItem({item_name: \"Steel dagger\", count: [1], quality: [81, 120], chance: 0.8}),\r\n        new TradeItem({item_name: \"Steel sword\", count: [1], quality: [81, 120], chance: 0.8}),\r\n        new TradeItem({item_name: \"Steel axe\", count: [1], quality: [81, 120], chance: 0.8}),\r\n        new TradeItem({item_name: \"Steel battle hammer\", count: [1], quality: [81, 120], chance: 0.8}),\r\n\r\n        new TradeItem({item_name: \"Wooden shield\", count: [1], quality: [40, 80]}),\r\n        new TradeItem({item_name: \"Wooden shield\", count: [1], chance: 0.8, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Crude iron shield\", count: [1], quality: [40, 80]}),\r\n        new TradeItem({item_name: \"Crude iron shield\", count: [1], chance: 0.8, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Iron shield\", count: [1], chance: 0.6, quality: [40, 80]}),\r\n        new TradeItem({item_name: \"Iron shield\", count: [1], chance: 0.4, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Steel shield\", count: [1], chance: 0.4, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Ash wood shield\", count: [1], chance: 0.4, quality: [81, 120]}),\r\n\r\n        new TradeItem({item_name: \"Leather vest\", count: [1], chance: 0.9, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Leather pants\", count: [1], chance: 0.9, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Leather hat\", count: [1], chance: 0.9, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Leather shoes\", count: [1], chance: 0.8, quality: [91, 120]}),\r\n        new TradeItem({item_name: \"Leather gloves\", count: [1], chance: 0.8, quality: [91, 120]}),\r\n        new TradeItem({item_name: \"Work shoes\", count: [2,3], chance: 0.6, quality: [100, 100]}),\r\n\r\n        new TradeItem({item_name: \"Goat leather vest\", count: [1], chance: 0.5, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Goat leather pants\", count: [1], chance: 0.5, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Goat leather hat\", count: [1], chance: 0.5, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Goat leather shoes\", count: [1], chance: 0.5, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Goat leather gloves\", count: [1], chance: 0.5, quality: [81, 120]}),\r\n\r\n        new TradeItem({item_name: \"Wolf leather armor\", count: [1], chance: 0.8, quality: [91, 120]}),\r\n        new TradeItem({item_name: \"Wolf leather armored pants\", count: [1], chance: 0.8, quality: [91, 120]}),\r\n        new TradeItem({item_name: \"Wolf leather helmet\", count: [1], chance: 0.8, quality: [91, 120]}),\r\n        \r\n        new TradeItem({item_name: \"Iron chainmail armor\", count: [1], chance: 0.8, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Iron chainmail pants\", count: [1], chance: 0.8, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Iron chainmail helmet\", count: [1], chance: 0.8, quality: [81, 120]}),\r\n\r\n        new TradeItem({item_name: \"Steel chainmail armor\", count: [1], chance: 0.6, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Steel chainmail pants\", count: [1], chance: 0.6, quality: [81, 120]}),\r\n        new TradeItem({item_name: \"Steel chainmail helmet\", count: [1], chance: 0.6, quality: [81, 120]}),\r\n\r\n        new TradeItem({item_name: \"Wolf pelt cape\", count: [1], chance: 0.9, quality: [70, 120]}),\r\n        new TradeItem({item_name: \"Boar hide cape\", count: [1], chance: 0.9, quality: [70, 120]}),\r\n        new TradeItem({item_name: \"Goat hide cape\", count: [1], chance: 0.9, quality: [70, 120]}),\r\n        new TradeItem({item_name: \"Bear hide cape\", count: [1], chance: 0.5, quality: [70, 120]}),\r\n        \r\n        \r\n        new TradeItem({item_name: \"Fresh bread\", count: [4,10]}),\r\n        new TradeItem({item_name: \"Bread kwas\", count: [2,5]}),\r\n        new TradeItem({item_name: \"Weak healing powder\", count: [2,5]}),\r\n        new TradeItem({item_name: \"Oneberry juice\", count: [2,5]}),\r\n        new TradeItem({item_name: \"Healing powder\", count: [2,5]}),\r\n        new TradeItem({item_name: \"Healing potion\", count: [2,5]}),\r\n        new TradeItem({item_name: \"Cooking herbs\", count: [2,5], chance: 0.8}),\r\n\r\n        new TradeItem({item_name: \"Coal\", count: [20,50]}),\r\n\r\n        new TradeItem({item_name: \"Twist liek a snek\", count: [1], chance: 1}),\r\n        new TradeItem({item_name: \"Butchering and you\", count: [1], chance: 1}),\r\n        new TradeItem({item_name: \"Medicine for dummies\", count: [1], chance: 1}),\r\n        new TradeItem({item_name: \"Ode to Whimsy, and other poems\", count: [1], chance: 0.4}),\r\n        new TradeItem({item_name: \"A Glint On The Sand\", count: [1], chance: 0.4}),\r\n\r\n        new TradeItem({item_name: \"Glass phial\", count: [10,16], chance: 1}),\r\n        new TradeItem({item_name: \"Glass bottle\", count: [6,12], chance: 1}),\r\n\r\n        new TradeItem({item_name: \"Camping supplies\", count: [1], chance: 1}),\r\n        new TradeItem({item_name: \"Coil of rope\", count: [1], chance: 1}),\r\n\r\n        new TradeItem({item_name: \"Iron sickle\", count: [1], chance: 1}),\r\n        new TradeItem({item_name: \"Iron pickaxe\", count: [1], chance: 1}),\r\n        new TradeItem({item_name: \"Iron chopping axe\", count: [1], chance: 1}),\r\n        new TradeItem({item_name: \"Iron shovel\", count: [1], chance: 1}),\r\n    ];\r\n\t\r\n\tinventory_templates[\"Swamp\"] = \r\n    [\r\n            new TradeItem({item_name: \"Alligator jerky\", count: [1,2]}),\r\n            new TradeItem({item_name: \"Snake jerky\", count: [1,2]}),\r\n            new TradeItem({item_name: \"Turtle jerky\", count: [1,2]}),\r\n\r\n            new TradeItem({item_name: \"Cooking herbs\", count: [1,3]}),\r\n            new TradeItem({item_name: \"Wild onion\", count: [1,3]}),\r\n            new TradeItem({item_name: \"Wild garlic\", count: [1,3]}),\r\n            new TradeItem({item_name: \"Wild potato\", count: [1,3]}),\r\n    ];\r\n\tinventory_templates[\"Swamp plus\"] = \r\n    [\r\n            new TradeItem({item_name: \"Alligator jerky\", count: [2,5]}),\r\n            new TradeItem({item_name: \"Snake jerky\", count: [2,5]}),\r\n            new TradeItem({item_name: \"Turtle jerky\", count: [2,5]}),\r\n\r\n            new TradeItem({item_name: \"Cooking herbs\", count: [3,6]}),\r\n            new TradeItem({item_name: \"Wild onion\", count: [3,6]}),\r\n            new TradeItem({item_name: \"Wild garlic\", count: [3,6]}),\r\n            new TradeItem({item_name: \"Wild potato\", count: [5,9]}),\r\n\r\n            new TradeItem({item_name: \"Alligator armor\", count: [1], quality: [70, 100], chance: 0.05}),\r\n            new TradeItem({item_name: \"Alligator helmet\", count: [1], quality: [70, 100], chance: 0.05}),\r\n            new TradeItem({item_name: \"Alligator armored pants\", count: [1], quality: [70, 100], chance: 0.05}),\r\n\r\n            new TradeItem({item_name: \"Turtleshell platemail armor\", count: [1], quality: [70, 100], chance: 0.01}),\r\n            new TradeItem({item_name: \"Turtleshell platemail helmet\", count: [1], quality: [70, 100], chance: 0.01}),\r\n            new TradeItem({item_name: \"Turtleshell platemail pants\", count: [1], quality: [70, 100], chance: 0.01}),\r\n            new TradeItem({item_name: \"Turtleshell shield\", count: [1], quality: [70, 100], chance: 0.01}),\r\n\r\n            new TradeItem({item_name: \"Shellfish desires\", count: [1], chance: 0.5}),\r\n\r\n\t\t\tnew TradeItem({item_name: \"Healing balm\", count: [1,2], chance: 0.15}),\r\n\t\t\tnew TradeItem({item_name: \"Healing powder\", count: [1,3], chance: 0.2}),\r\n\t\t\tnew TradeItem({item_name: \"Healing potion\", count: [1,3], chance: 0.25}),\r\n\t\t\t\r\n            new TradeItem({item_name: \"Oneberry\", count: [1,4], chance: 0.1}),\r\n            new TradeItem({item_name: \"Silver thistle\", count: [1,3], chance: 0.1}),\r\n            new TradeItem({item_name: \"Golmoon leaf\", count: [1,3], chance: 0.1}),\r\n            new TradeItem({item_name: \"Belmart leaf\", count: [1,3], chance: 0.1}),\r\n    ];\r\n\r\n})();\r\nexport { traders, inventory_templates, TradeItem };", "\"use strict\";\r\n\r\nimport { traders } from \"./traders.js\";\r\nimport { update_displayed_trader, update_displayed_trader_inventory, \r\n         update_displayed_character_inventory, exit_displayed_trade, update_displayed_money } from \"./display.js\";\r\nimport { add_to_character_inventory, remove_from_character_inventory } from \"./character.js\";\r\nimport { skills } from \"./skills.js\";\r\nimport { getItemFromKey } from \"./items.js\";\r\nimport { add_to_sold, calculate_total_saturation, capped_at, equipment_capped_at, group_key_prefix, remove_from_sold } from \"./market_saturation.js\";\r\nimport { character } from \"./character.js\";\r\nimport { add_xp_to_skill, current_location } from \"./main.js\";\r\nimport { round_item_price } from \"./misc.js\";\r\n\r\nlet current_trader = null;\r\nconst to_sell = {value: 0, items: [], groups: {}};\r\nconst to_buy = {value: 0, items: [], groups: {}};\r\n\r\n/*\r\n{\r\n    items: [],\r\n    value: Number,\r\n    groups: {\r\n        group_key: {\r\n            count: [] //index = group tier\r\n            needs_resort: Boolean\r\n            unsorted: [] //same as items ({item_key:item_count}) but split by groups\r\n            sorted: [] //'unsorted' but sorted by tier and then value\r\n            group_value: Number\r\n        },\r\n    }\r\n}\r\n*/\r\n\r\nclass TradeGroupContent {\r\n    constructor(group_tier) {\r\n        this.count = new Array(group_tier + 1).fill(0),\r\n        this.needs_resort = false,\r\n        this.unsorted = [],\r\n        this.sorted = [],\r\n        this.group_value = 0;\r\n    }\r\n}\r\n\r\nfunction set_current_trader(trader_key) {\r\n    current_trader = trader_key;\r\n}\r\n\r\n/**\r\n * \r\n * @param {String} trader_key \r\n */\r\nfunction start_trade(trader_key) {\r\n    traders[trader_key].refresh();\r\n    current_trader = trader_key;\r\n    \r\n    update_displayed_trader();\r\n    update_displayed_character_inventory({is_trade: true});\r\n}\r\n\r\nfunction cancel_trade() {\r\n\r\n    to_buy.items = [];\r\n    to_buy.groups = {};\r\n    to_buy.value = 0;\r\n    to_sell.items = [];\r\n    to_sell.groups = {};\r\n    to_sell.value = 0;\r\n\r\n    update_displayed_character_inventory({is_trade: true});\r\n    update_displayed_trader_inventory();\r\n}\r\n\r\nfunction accept_trade() {\r\n\r\n    let new_balance;\r\n    \r\n    if(to_sell.items.length == 0 && to_buy.items.length == 0) {\r\n        new_balance = character.money;\r\n    } else {\r\n        new_balance = character.money + to_sell.value - to_buy.value;\r\n    }\r\n\r\n    if(new_balance < 0) { //button shouldn't be clickable if trade is not affordable, so this is just in case\r\n        throw new Error(\"Trying to make a trade that can't be afforded\");\r\n    } else {\r\n\r\n        character.money = new_balance;\r\n\r\n        let item_list = [];\r\n        let to_remove = [];\r\n        while(to_buy.items.length > 0) {\r\n            //add to character inventory\r\n            //remove from trader inventory\r\n\r\n            const trade_item = to_buy.items.pop();\r\n            \r\n            trade_item.item_count = trade_item.count;\r\n            to_remove.push(trade_item);\r\n\r\n            item_list.push({item_key: trade_item.item_key, count: trade_item.count});\r\n\r\n            const item = getItemFromKey(trade_item.item_key);\r\n            const {group_key, group_tier} = item.getMarketSaturationGroup();\r\n            if(item.saturates_market) {\r\n                remove_from_sold({group_key, group_tier, count: trade_item.count, region: current_location.market_region});\r\n            }\r\n        }\r\n        \r\n        if(to_remove.length > 0) {\r\n            add_to_character_inventory(item_list);\r\n            remove_from_trader_inventory(current_trader,to_remove);\r\n\r\n            for(let i = 0; i < item_list.length; i++) {\r\n                //update (remove) single item from display\r\n                update_displayed_character_inventory({item_key: item_list[i].item_key});\r\n            }\r\n        }\r\n        \r\n\r\n        item_list = []; //totally could reduce it to 1 array instead of 2 if I made param naming more consistent, maybe one day\r\n        to_remove = [];\r\n\r\n        while(to_sell.items.length > 0) {\r\n            //remove from character inventory\r\n            //add to trader inventory\r\n            \r\n            const trade_item = to_sell.items.pop();\r\n            \r\n            trade_item.item_count = trade_item.count;\r\n            to_remove.push(trade_item);\r\n\r\n            item_list.push({item_key: trade_item.item_key, count: trade_item.count});\r\n        \r\n            const item = getItemFromKey(trade_item.item_key);\r\n            const {group_key, group_tier} = item.getMarketSaturationGroup();\r\n            if(item.saturates_market) {\r\n                add_to_sold({group_key, group_tier, count: trade_item.count, region: current_location.market_region});\r\n            }\r\n        }\r\n        \r\n        if(to_remove.length > 0) {\r\n            add_to_trader_inventory(current_trader,item_list);\r\n            remove_from_character_inventory(to_remove);\r\n\r\n            for(let i = 0; i < item_list.length; i++) {\r\n                update_displayed_trader_inventory({item_key: item_list[i].item_key});\r\n            }\r\n        }\r\n    }\r\n\r\n    add_xp_to_skill({skill: skills[\"Haggling\"], xp_to_add: (to_sell.value + to_buy.value)/10, cap_gained_xp: false});\r\n    //xp not capped for this one\r\n\r\n    to_buy.value = 0;\r\n    to_buy.groups = {};\r\n    to_sell.value = 0;\r\n    to_sell.groups = {};\r\n\r\n\r\n    update_displayed_character_inventory({is_trade: true});\r\n    update_displayed_trader_inventory();\r\n    update_displayed_money();\r\n}\r\n\r\nfunction exit_trade() {\r\n    current_trader = null;\r\n    to_buy.items = [];\r\n    to_buy.groups = {};\r\n    to_buy.value = 0;\r\n    to_sell.items = [];\r\n    to_sell.groups = {};\r\n    to_sell.value = 0;\r\n    exit_displayed_trade();\r\n    update_displayed_character_inventory();\r\n}\r\n\r\n/**\r\n * @param {} selected_item \r\n * {item_key: {string with value of data- attribute, which is supposed to be an inventory key}, count: Number}\r\n * @returns {Number} change of trade value\r\n */\r\nfunction add_to_buying_list(selected_item) {\r\n    const item = getItemFromKey(selected_item.item_key);\r\n    const {group_key, group_tier} = item.getMarketSaturationGroup();\r\n    const present_item = to_buy.items.find(a => a.item_key === selected_item.item_key);\r\n    \r\n    let actual_number_to_add = selected_item.count;\r\n    let item_count_in_trader = traders[current_trader].inventory[selected_item.item_key].count;\r\n\r\n    if(present_item) { //there's already some in to_buy\r\n        if(item_count_in_trader - present_item.count < selected_item.count) {\r\n            //trying to buy more than trader has left, so just put all in the buy list\r\n            actual_number_to_add = item_count_in_trader - present_item.count;\r\n            present_item.count = item_count_in_trader;\r\n        } else {\r\n            present_item.count += actual_number_to_add;\r\n        }\r\n\r\n        to_buy.groups[group_key].count[group_tier] += actual_number_to_add;\r\n        to_buy.groups[group_key].unsorted.find(x => selected_item.item_key === x.item_key).count += actual_number_to_add;\r\n        //no need to increase value in sorted, it's part of the same object and will be affected\r\n    } else { //it's not yet in to_buy\r\n        if(item_count_in_trader < selected_item.count) { \r\n            //trader has not enough: buy all available\r\n            selected_item.count = item_count_in_trader;\r\n        }\r\n\r\n        if(!to_buy.groups[group_key]) {\r\n            to_buy.groups[group_key] = new TradeGroupContent(group_tier);\r\n        } else if(to_buy.groups[group_key].count.length < (group_tier + 1)) {\r\n            to_buy.groups[group_key].count.push(...new Array(group_tier + 1 - to_buy.groups[group_key].count.length).fill(0));\r\n        }\r\n\r\n        to_buy.items.push(selected_item);\r\n        to_buy.groups[group_key].unsorted.push({...selected_item});\r\n\r\n        //increase overall tier count, mark as needing a resorting\r\n        to_buy.groups[group_key].count[group_tier] += selected_item.count;\r\n        to_buy.groups[group_key].needs_resort = true;\r\n    }\r\n\r\n    return calculate_total_values();\r\n}\r\n\r\n/**\r\n * @param {} selected_item \r\n * {item_key: {string with value of data- attribute}, count: Number}\r\n * @returns {Number} change of trade value\r\n */\r\nfunction remove_from_buying_list(selected_item) {\r\n    const item = getItemFromKey(selected_item.item_key);\r\n    const {group_key, group_tier} = item.getMarketSaturationGroup();\r\n\r\n    let actual_number_to_remove = selected_item.count;\r\n    \r\n    const present_item = to_buy.items.find(a => a.item_key === selected_item.item_key);\r\n    if(present_item?.count < actual_number_to_remove) {\r\n        actual_number_to_remove = present_item.count;\r\n    }\r\n\r\n    //trying to remove something not in list -> error\r\n    if(!to_buy.groups[group_key] || to_buy.groups[group_key].count.length < (group_tier + 1)) {\r\n        throw new Error(`Tried to remove an item of trade group '${group_key}:${group_tier}' from the buying list, but nothing of such group was present in it!`);\r\n    }\r\n    //trying to remove more than present -> error\r\n    if(to_buy.groups[group_key].count[group_tier] < actual_number_to_remove) {\r\n        throw new Error(`Tried to remove an item of trade group '${group_key}:${group_tier}' from the buying list, but provided count of '${actual_number_to_remove}' would lead to a negative number!`);\r\n    }\r\n\r\n    if(present_item?.count > selected_item.count) { //more than to remove, use the provided count\r\n        present_item.count -= actual_number_to_remove;\r\n        to_buy.groups[group_key].unsorted.find(x => selected_item.item_key === x.item_key).count -= actual_number_to_remove;\r\n        //no need to decrease value in sorted, it's part of the same object and will be affected\r\n    } else { //less than to remove, so just remove all\r\n        actual_number_to_remove = present_item.count;\r\n        present_item.count = 0;\r\n\r\n        to_buy.items.splice(to_buy.items.indexOf(present_item), 1);\r\n        to_buy.groups[group_key].unsorted = to_buy.groups[group_key].unsorted.filter(x => selected_item.item_key !== x.item_key);\r\n        to_buy.groups[group_key].sorted = to_buy.groups[group_key].sorted.filter(x => selected_item.item_key !== x.item_key);\r\n    }\r\n\r\n    to_buy.groups[group_key].count[group_tier] -= actual_number_to_remove;\r\n\r\n    return calculate_total_values();\r\n}\r\n\r\nfunction is_in_trade() {\r\n    return Boolean(current_trader);\r\n}\r\n\r\nfunction add_to_selling_list(selected_item) {\r\n    const item = getItemFromKey(selected_item.item_key);\r\n    const {group_key, group_tier} = item.getMarketSaturationGroup();\r\n\r\n    const present_item = to_sell.items.find(a => a.item_key === selected_item.item_key);\r\n    //find if item is already present in the sell list\r\n\r\n    let item_count_in_player = character.inventory[selected_item.item_key].count;\r\n\r\n    if(present_item) {\r\n        //item present in to_sell -> increase its count, up to what player has in inventory\r\n\r\n        if(item_count_in_player - present_item.count < selected_item.count) {\r\n            //trying to sell more that remains in inventory, so just add everything\r\n            selected_item.count = item_count_in_player - present_item.count;\r\n            present_item.count = item_count_in_player;\r\n        } else {\r\n            present_item.count += selected_item.count;\r\n        }\r\n\r\n        //increase overall tier count and specific counts in unsorted and sorted\r\n        to_sell.groups[group_key].count[group_tier] += selected_item.count;\r\n        to_sell.groups[group_key].unsorted.find(x => selected_item.item_key === x.item_key).count += selected_item.count;\r\n        //no need to increase value in sorted, it's part of the same object and will be affected\r\n    } else { \r\n        //item not present in to_sell, add it and do other necessary stuff\r\n\r\n        if(item_count_in_player < selected_item.count) { \r\n            //character has not enough: sell all available\r\n            selected_item.count = item_count_in_player;\r\n        }\r\n\r\n        if(!to_sell.groups[group_key]) {\r\n            to_sell.groups[group_key] = new TradeGroupContent(group_tier);\r\n        } else if(to_sell.groups[group_key].count.length < (group_tier + 1)) {\r\n            to_sell.groups[group_key].count.push(...new Array(group_tier + 1 - to_sell.groups[group_key].count.length).fill(0));\r\n        }\r\n\r\n        to_sell.items.push(selected_item);\r\n        to_sell.groups[group_key].unsorted.push({...selected_item});\r\n\r\n        //increase overall tier count, mark as needing a resorting\r\n        to_sell.groups[group_key].count[group_tier] += selected_item.count;\r\n        to_sell.groups[group_key].needs_resort = true;\r\n    }\r\n    return calculate_total_values();\r\n}\r\n\r\nfunction remove_from_selling_list(selected_item) {\r\n    const item = getItemFromKey(selected_item.item_key);\r\n    const {group_key, group_tier} = item.getMarketSaturationGroup();\r\n\r\n    let actual_number_to_remove = selected_item.count;\r\n\r\n    const present_item = to_sell.items.find(a => a.item_key === selected_item.item_key);\r\n    if(present_item?.count < actual_number_to_remove) {\r\n        actual_number_to_remove = present_item.count;\r\n    }\r\n\r\n    //trying to remove something not in list -> error\r\n    if(!to_sell.groups[group_key] || to_sell.groups[group_key].count.length < (group_tier + 1)) {\r\n        throw new Error(`Tried to remove an item of trade group '${group_key}:${group_tier}' from the selling list, but nothing of such group was present in it!`);\r\n    }\r\n    //trying to remove more than present -> error\r\n    if(to_sell.groups[group_key].count[group_tier] < actual_number_to_remove) {\r\n        throw new Error(`Tried to remove an item of trade group '${group_key}:${group_tier}' from the selling list, but provided count of '${actual_number_to_remove}' would lead to a negative number!`);\r\n    }\r\n    \r\n    if(present_item?.count > selected_item.count) { //more than to remove, use the provided count\r\n        present_item.count -= actual_number_to_remove;\r\n        to_sell.groups[group_key].unsorted.find(x => selected_item.item_key === x.item_key).count -= actual_number_to_remove;\r\n        //no need to decrease value in sorted, it's part of the same object and will be affected\r\n    } else { //less than to remove, so just remove all\r\n        actual_number_to_remove = present_item.count;\r\n        present_item.count = 0;\r\n\r\n        to_sell.items.splice(to_sell.items.indexOf(present_item), 1);\r\n        to_sell.groups[group_key].unsorted = to_sell.groups[group_key].unsorted.filter(x => selected_item.item_key !== x.item_key);\r\n        to_sell.groups[group_key].sorted = to_sell.groups[group_key].sorted.filter(x => selected_item.item_key !== x.item_key);\r\n    }\r\n\r\n    to_sell.groups[group_key].count[group_tier] -= actual_number_to_remove;\r\n\r\n    return calculate_total_values();\r\n}\r\n\r\nfunction add_to_trader_inventory(trader_key, items) {\r\n    traders[trader_key].add_to_inventory(items);\r\n\r\n    if(current_trader === trader_key) {\r\n        update_displayed_trader_inventory();\r\n    }\r\n}\r\n\r\nfunction remove_from_trader_inventory(trader_key, items) {\r\n    traders[trader_key].remove_from_inventory(items);\r\n    \r\n    if(current_trader === trader_key) {\r\n        update_displayed_trader_inventory();\r\n    }\r\n}\r\n\r\n/**\r\n * calculates total values of to_sell and to_buy, taking market saturation into account\r\n */\r\nfunction calculate_total_values() {\r\n    /*\r\n        {\r\n            items: [],\r\n            value: Number,\r\n            groups: {\r\n                group_key: {\r\n                    count: [] //index = group tier\r\n                    needs_resort: Boolean\r\n                    unsorted: [] //same as items but split by groups\r\n                    sorted: [] //'unsorted' but sorted by tier and then value\r\n                    group_value: Number\r\n                },\r\n            }\r\n        }\r\n    */\r\n\r\n    const traded_groups = {buying_precalculated: {}, selling: {}, buying: {}};\r\n    to_buy.value = 0;\r\n    to_sell.value = 0;\r\n\r\n\r\n    ///////////////////////////////////////////////\r\n    //precalculate buying count for use in selling\r\n    //selling count for use in buying will be just calculated in selling, so no need\r\n\r\n    Object.keys(to_buy.groups).forEach(group_key => {\r\n        if(!traded_groups.buying_precalculated[group_key]) {\r\n            traded_groups.buying_precalculated[group_key] = [];\r\n        }\r\n\r\n        for(let i = 0; i < to_buy.groups[group_key].sorted.length; i++) {\r\n            const item = getItemFromKey(to_buy.groups[group_key].sorted[i].item_key);\r\n            const {group_tier} = item.getMarketSaturationGroup();\r\n\r\n            //array too short compared to tier: push a spreaded array with the length of how much is missing, filled with zeroes\r\n            if(traded_groups.buying_precalculated[group_key].length < group_tier + 1) {\r\n                traded_groups.buying_precalculated[group_key].push(...new Array(group_tier + 1 - traded_groups.buying_precalculated[group_key].length).fill(0));\r\n            }\r\n\r\n            //and then just increase tier count\r\n            traded_groups.buying_precalculated[group_key][group_tier] += to_buy.groups[group_key].sorted[i].count;\r\n        }\r\n    });\r\n\r\n    ///////////////////////////////////////////////////////\r\n    //go through both categories and calculate their values\r\n\r\n    Object.keys(to_sell.groups).forEach(traded_group_key => {\r\n        to_sell.groups[traded_group_key].group_value = 0;\r\n        traded_groups.selling[traded_group_key] = [];\r\n\r\n        if(to_sell.groups[traded_group_key].needs_resort) {\r\n            to_sell.groups[traded_group_key].sorted = to_sell.groups[traded_group_key].unsorted.sort((a,b) => sort_traded_items(a,b)); \r\n\r\n            to_sell.groups[traded_group_key].needs_resort = false;\r\n        }\r\n\r\n        \r\n        for(let i = 0; i < to_sell.groups[traded_group_key].sorted.length; i++) {\r\n            const item = getItemFromKey(to_sell.groups[traded_group_key].sorted[i].item_key);\r\n            const {group_tier, group_key} = item.getMarketSaturationGroup();\r\n\r\n            let trade_cap;\r\n            if(group_key.startsWith(group_key_prefix)) {\r\n                trade_cap = equipment_capped_at;\r\n            } else {\r\n                trade_cap = capped_at;\r\n            }\r\n\r\n            //grab both saturations beforehand, to avoid unnecessary recalc (those are not total, just for current trade)\r\n            const sold_saturation = calculate_total_saturation({sold_by_tier: traded_groups.selling[traded_group_key], target_tier: group_tier, cap: trade_cap});\r\n            const bought_saturation = calculate_total_saturation({sold_by_tier: traded_groups.buying_precalculated[traded_group_key], target_tier: group_tier, cap: trade_cap});\r\n\r\n            /*\r\n            increase value by value of however many there is of specific item\r\n            additional traded count: what's being sold from same group (and is already processed)\r\n            stop_multiplier_at: difference in counts, as only count over that difference should be subject to saturation\r\n            */\r\n            to_sell.groups[traded_group_key].group_value \r\n                                    += item.getValueOfMultiple({\r\n                                        additional_traded_count: sold_saturation,\r\n                                        stop_multiplier_at: Math.max(0,sold_saturation-bought_saturation+to_sell.groups[traded_group_key].sorted[i].count),\r\n                                        count: to_sell.groups[traded_group_key].sorted[i].count,\r\n                                        region: current_location.market_region,\r\n                                    });\r\n\r\n            //array too short compared to tier: push a spreaded array with the length of how much is missing, filled with zeroes                        \r\n            if(traded_groups.selling[traded_group_key].length < group_tier + 1) {\r\n                traded_groups.selling[traded_group_key].push(...new Array(group_tier + 1 - traded_groups.selling[traded_group_key].length).fill(0));\r\n            }\r\n\r\n            //and then just increase tier count so that other stuff can take already processed items into account\r\n            //also used for processing of to_buy\r\n            traded_groups.selling[traded_group_key][group_tier] += to_sell.groups[traded_group_key].sorted[i].count;\r\n        }\r\n\r\n        to_sell.value += to_sell.groups[traded_group_key].group_value;\r\n    });\r\n\r\n    Object.keys(to_buy.groups).forEach(traded_group_key => {\r\n        to_buy.groups[traded_group_key].group_value = 0;\r\n\r\n        traded_groups.buying[traded_group_key] = [];\r\n\r\n        if(to_buy.groups[traded_group_key].needs_resort) {\r\n            to_buy.groups[traded_group_key].sorted = to_buy.groups[traded_group_key].unsorted.sort((a,b) => sort_traded_items(a,b));\r\n\r\n            to_buy.groups[traded_group_key].needs_resort = false;\r\n        }\r\n\r\n        for(let i = 0; i < to_buy.groups[traded_group_key].sorted.length; i++) {\r\n            const item = getItemFromKey(to_buy.groups[traded_group_key].sorted[i].item_key);\r\n            const {group_tier, group_key} = item.getMarketSaturationGroup();\r\n\r\n            let trade_cap;\r\n            if(group_key.startsWith(group_key_prefix)) {\r\n                trade_cap = equipment_capped_at;\r\n            } else {\r\n                trade_cap = capped_at;\r\n            }\r\n            //grab both saturations beforehand, to avoid unnecessary recalc\r\n            const sold_saturation = calculate_total_saturation({sold_by_tier: traded_groups.selling[traded_group_key], target_tier: group_tier, cap: trade_cap});\r\n            const bought_saturation = calculate_total_saturation({sold_by_tier: traded_groups.buying[traded_group_key], target_tier: group_tier, cap: trade_cap});\r\n\r\n            /*\r\n            increase value by value of however many there is of specific item\r\n            additional traded count: what's being bought from same group\r\n            stop_multiplier_at: difference in counts, as only count over that difference should be subject to saturation\r\n            */\r\n            \r\n            to_buy.groups[group_key].group_value \r\n                                    += item.getValueOfMultiple({\r\n                                        additional_traded_count: -bought_saturation,\r\n                                        stop_multiplier_at: Math.max(0,sold_saturation-bought_saturation-to_buy.groups[traded_group_key].sorted[i].count),\r\n                                        count: to_buy.groups[traded_group_key].sorted[i].count,\r\n                                        region: current_location.market_region,\r\n                                        price_multiplier: traders[current_trader].getProfitMargin(current_location.market_region),\r\n                                        is_selling: false,\r\n                                    });\r\n\r\n            //array too short compared to tier: push a spreaded array with the length of how much is missing, filled with zeroes\r\n            if(traded_groups.buying[traded_group_key].length < group_tier + 1) {\r\n                traded_groups.buying[traded_group_key].push(...new Array(group_tier + 1 - traded_groups.buying[traded_group_key].length).fill(0));\r\n            }\r\n\r\n            //and then just increase tier count\r\n            traded_groups.buying[traded_group_key][group_tier] += to_buy.groups[traded_group_key].sorted[i].count;\r\n        }\r\n\r\n        to_buy.value += to_buy.groups[traded_group_key].group_value;\r\n    });\r\n\r\n    return  to_sell.value - to_buy.value;\r\n}\r\n\r\n/**\r\n * @description calculates item value based on current trader, does not take market saturation into account\r\n * @param {*} selected_item {item, count}\r\n * @param {Boolean} is_stackable\r\n * @returns total value of items, including character haggling skill and trader profit margin\r\n */\r\nfunction get_item_value(selected_item) {\r\n    const profit_margin = traders[current_trader].getProfitMargin(current_location.market_region);\r\n\r\n    const item = getItemFromKey(selected_item.item_key);\r\n\r\n    return round_item_price(profit_margin * item.getValue({quality: item.quality, region: current_location.market_region})) * selected_item.count;\r\n}\r\n\r\n/**\r\n * sorts by tier, then by value, in descending order\r\n * */\r\nfunction sort_traded_items(a,b) {\r\n    const item_a = getItemFromKey(a.item_key);\r\n    const item_b = getItemFromKey(b.item_key);\r\n    const tier_a = item_a.getMarketSaturationGroup().group_tier;\r\n    const tier_b = item_b.getMarketSaturationGroup().group_tier;\r\n    if(tier_a != tier_b) {\r\n        return tier_b - tier_a;\r\n    } else {\r\n        return item_b.getBaseValue() - item_a.getBaseValue();\r\n    }\r\n}\r\n\r\nexport {to_buy, to_sell, set_current_trader, current_trader, \r\n        start_trade, cancel_trade, accept_trade, exit_trade, \r\n        add_to_trader_inventory, remove_from_trader_inventory,\r\n        add_to_buying_list, remove_from_buying_list,\r\n        add_to_selling_list, remove_from_selling_list,\r\n        is_in_trade};", "\"use strict\";\r\n\r\nimport { get_total_skill_level } from \"./character.js\";\r\nimport { current_game_time } from \"./game_time.js\";\r\nimport { global_flags } from \"./main.js\";\r\n\r\n/*\r\n    either single set of values or two sets, one for minimum chance provided and one for maximum\r\n    two-set approach does not apply to items, so it only checks them for conditions[0]\r\n    if applicable, items get removed both on failure and on success; if action requires them, it would be a better approach to have a guaranteed success\r\n    for dialogues, passing two sets is meaningless as returned value will be treated as true/false\r\n    for dialogues, removing anything on visibility check is a terrible idea as it would remove item every time the dialogue is opened\r\n\r\n    {\r\n        money: {\r\n            number: Number, //how much money to require\r\n            remove: Boolean //if should be removed from inventory (false -> its kept)\r\n        }\r\n        stats: [\r\n            \"stat_id\": Number //required stat\r\n        ],\r\n\r\n        skills: [\r\n            \"skill_id\": Number //required level\r\n        ],\r\n\r\n        hero_level: Number //required hero level\r\n\r\n        items_by_id: \r\n        [\r\n            {\r\n                \"item_id\": {\r\n                    count: Number,\r\n                    remove: Boolean\r\n            }\r\n        ],\r\n\r\n        tools_by_slot: [\r\n            \r\n        ]\r\n\r\n        season: { //either season that needs to be active or season that CAN'T be active\r\n            not: String,\r\n            yes: String,\r\n        }\r\n\r\n        flags: [String] //global flags required\r\n    }\r\n*/\r\n\r\n\r\n/**\r\n     * Analyzes passed conditions, returns their status (0 or 1 if single element array, fuzzy value if two element array)\r\n     * @param {*} character \r\n     * @param {*} condition \r\n    **/\r\nconst process_conditions = (conditions, character) => {\r\n    let met = 1;\r\n\r\n    if(conditions.length == 0) {\r\n        return 1;\r\n    }\r\n\r\n    //check money\r\n    if(conditions[0].money && character.money < conditions[0].money) {\r\n        met = 0;\r\n        return met;\r\n    } else if(conditions[1]?.money && conditions[1].money > conditions[0].money && character.money < conditions[1].money) {\r\n        met *= (character.money - conditions[0].money)/(conditions[1].money - conditions[0].money);\r\n    }\r\n\r\n    if(!met) {\r\n        return met;\r\n    }\r\n    //check skills\r\n    if(conditions[0].skills) {\r\n        Object.keys(conditions[0].skills).forEach(skill_id => {\r\n            if(get_total_skill_level(skill_id) < conditions[0].skills[skill_id]) {\r\n                met = 0;\r\n            } else if(conditions[1]?.skills && conditions[1].skills[skill_id] > conditions[0].skills[skill_id] && get_total_skill_level(skill_id) < conditions[1].skills[skill_id]) {\r\n                met *= (get_total_skill_level(skill_id) - conditions[0].skills[skill_id])/(conditions[1].skills[skill_id] - conditions[0].skills[skill_id]);\r\n            }\r\n        });\r\n    }\r\n\r\n    if(conditions[0].hero_level) {\r\n        if(character.xp.current_level < conditions[0].hero_level) {\r\n            met = 0;\r\n            return met;\r\n        } else if(conditions[1]?.hero_level && conditions[1].hero_level > character.xp.current_level) {\r\n            met *= (character.xp.current_level - conditions[0].hero_level)/(conditions[1].hero_level - conditions[0].hero_level);\r\n        }\r\n    }\r\n\r\n    if(!met) {\r\n        return met;\r\n    }\r\n    //check items\r\n    if(conditions[0].items_by_id) {\r\n        Object.keys(conditions[0].items_by_id).forEach(item_id => {\r\n            let found = false;\r\n            //iterate through inventory, set found to true if id is present and count is enough\r\n            Object.keys(character.inventory).forEach(item_key => {\r\n                if(found) {\r\n                    return;\r\n                }\r\n                \r\n                const {id} = JSON.parse(item_key);\r\n                if(id === item_id && character.inventory[item_key].count >= conditions[0].items_by_id[item_id].count) {\r\n                    found = true;\r\n                }\r\n            });\r\n\r\n            if(!found) {\r\n                met = 0;\r\n            }\r\n        });\r\n    }\r\n    if(!met) {\r\n        return met;\r\n    }\r\n    //checks stats\r\n    if(conditions[0].stats) {\r\n        Object.keys(conditions[0].stats).forEach(stat_key => {\r\n            if(character.stats.full[stat_key] < conditions[0].stats[stat_key]) {\r\n                met = 0;\r\n            } else if(conditions[1]?.stats && conditions[1].stats[stat_key] > conditions[0].stats[stat_key] && character.stats.full[stat_key] < conditions[1].stats[stat_key]) {\r\n                met *= (character.stats.full[stat_key] - conditions[0].stats[stat_key])/(conditions[1].stats[stat_key] - conditions[0].stats[stat_key]);\r\n            }\r\n        });\r\n    }\r\n\r\n    //checks season\r\n    if(conditions[0].season) {\r\n        if(conditions[0].season.yes) {\r\n            if(current_game_time.getSeason() !== conditions[0].season.yes) {\r\n                met = 0;\r\n            }\r\n        } else if(conditions[0].season.not) {\r\n            if(current_game_time.getSeason() === conditions[0].season.not) {\r\n                met = 0;\r\n            }\r\n        }\r\n    }\r\n\r\n    //checks tools\r\n    if(conditions[0].tools_by_slot) {\r\n        for(let i = 0; i < conditions[0].tools_by_slot.length; i++) {\r\n            if(!character.equipment[conditions[0].tools_by_slot[i]]) {\r\n                met = 0;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    //checks reputation\r\n    if(conditions[0].reputation) {\r\n        Object.keys(conditions[0].reputation).forEach(rep_region => {\r\n            if(character.reputation[rep_region] < conditions[0].reputation[rep_region]) {\r\n                met = 0;\r\n                return met;\r\n            } else if(conditions[1]?.reputation && conditions[1].reputation[rep_region] > conditions[0].reputation[rep_region] && character.reputation[rep_region] < conditions[1].reputation[rep_region]) {\r\n                met *= (character.reputation[rep_region] - conditions[0].reputation[rep_region])/(conditions[1].reputation[rep_region] - conditions[0].reputation[rep_region]);\r\n            }\r\n        });\r\n    }\r\n    \r\n    //check flags\r\n    if(conditions[0].flags) {\r\n        for(let i = 0; i < conditions[0].flags.length; i++) {\r\n            if(!global_flags[conditions[0].flags[i]]) {\r\n                met = 0;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    return met;\r\n}\r\n\r\n\r\n\r\n\r\nexport {process_conditions};", "\"use strict\";\r\nimport { process_conditions } from \"./conditions.js\";\r\n\r\nclass GameAction{\r\n    /**\r\n     * \r\n     * @param {Object} data\r\n     * @param {Object} data.conditions [{stats, skills, [items_by_id: {item_id: {count, remove?}}], money: {number, remove?}}]\r\n     */\r\n    constructor({\r\n        starting_text,\r\n        action_id,\r\n        action_name,\r\n        description,\r\n        action_text,\r\n        success_text,\r\n        failure_texts = {},\r\n        required = {},\r\n        display_conditions = {},\r\n        conditions = [],\r\n        rewards = {},\r\n        attempt_duration = 0,\r\n        success_chances = [1,1],\r\n        keep_progress = false,\r\n        is_unlocked = false,\r\n        repeatable = false,\r\n        check_conditions_on_finish = true,\r\n        unlock_text,\r\n    }) {\r\n        this.starting_text = starting_text; //text on the button to start\r\n        this.action_name = action_name || starting_text;\r\n        this.action_id = action_id;\r\n        this.description = description; //description on hover\r\n        this.action_text = action_text; //text displayed during action animation\r\n        this.failure_texts = failure_texts; //text displayed on failure\r\n        if(!this.failure_texts.conditional_loss) {\r\n            this.failure_texts.conditional_loss = [];\r\n        }\r\n        if(!this.failure_texts.random_loss) {\r\n            this.failure_texts.random_loss = [];\r\n        }\r\n        if(!this.failure_texts.unable_to_begin) {\r\n            this.failure_texts.unable_to_begin = [];\r\n        }\r\n        /*  conditional_loss - conditions not met\r\n            random_loss - conditions (at least 1st part) were met, but didn't roll high enough on success chance\r\n        */\r\n        this.success_text = success_text; //text displayed on success\r\n                                          //if action is supposed to be \"impossible\" for narrative purposes, just make it finish without unlocks and with text that says it failed\r\n        \r\n        this.required = required; //things needed to be able to make an attempt\r\n        //{stats, skills, items_by_id: {'item_id': {count, remove_on_success?, remove_on_fail?}}, money: {Number, remove_on_success?, remove_on_fail?}}\r\n        if(conditions.length > 2) {\r\n            throw new Error('LocationAction cannot have more than 2 sets of conditions!');\r\n        }\r\n        this.conditions = conditions; \r\n        //things needed to succeed, breakdown in conditions.js\r\n\r\n        this.display_conditions = display_conditions;\r\n        \r\n        this.check_conditions_on_finish = check_conditions_on_finish; \r\n        //means an action with duration can be attempted even if conditions are not met;\r\n        //setting it to false will check them on start instead\r\n        this.rewards = rewards; //{unlocks, money, items,move_to}?\r\n        this.attempt_duration = attempt_duration; //0 means instantaneous, otherwise there's a progress bar\r\n        this.success_chances = success_chances; \r\n        //chances to succeed; to guarantee that multiple attempts will be needed, just make a few consecutive actions with same text\r\n        this.keep_progress = keep_progress;\r\n        //will make progress persist through leaving the action and through save/load; \r\n        //should be used only for actions that guarantee success if conditions are met, to not encourage save scumming\r\n        this.accumulated_progress = 0;\r\n\r\n        this.is_unlocked = is_unlocked;\r\n        this.is_finished = false; //really same as is_locked but with a more fitting name\r\n        this.repeatable = repeatable;\r\n        this.completion_count = 0; //only used for repeatables\r\n        this.unlock_text = unlock_text;\r\n    }\r\n\r\n    /**\r\n     * @returns {Number} the degree at which conditions are met. 0 means failure (some requirement is not met at all),\r\n     * everything else is for calculating final success chance (based on minimal and maximal chance, with 1 meaning that it's just the maximal).\r\n     * Items do not get fuzzy treatment, they are either all met or not.\r\n     */\r\n    get_conditions_status(character) {\r\n        return process_conditions(this.conditions, character);\r\n    }\r\n\r\n    /**\r\n     * @returns {Boolean} if start conditions are met\r\n     */\r\n    can_be_started(character) {\r\n        return process_conditions([this.required], character);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns  {Boolean} if display conditions are met\r\n     */\r\n    can_be_displayed(character) {\r\n        return process_conditions([this.display_conditions], character);\r\n    }\r\n}\r\n\r\nexport {GameAction};", "\"use strict\";\r\n\r\nimport { GameAction } from \"./actions.js\";\r\n\r\nconst dialogues = {};\r\n\r\nclass Dialogue {\r\n    constructor({ \r\n        name,\r\n        getName = () =>{return this.name},\r\n        id,\r\n        starting_text = `Talk to the ${name}`,\r\n        getStartingText = () =>{return this.starting_text},\r\n        ending_text = `Go back`,\r\n        is_unlocked = true,\r\n        is_finished = false,\r\n        textlines = {},\r\n        actions = {},\r\n        description = \"\",\r\n        getDescription = ()=>{return this.description;},\r\n        location_name\r\n    })  {\r\n        this.name = name; //displayed name, e.g. \"Village elder\"; if id is not provided, name must match the key dialogue has in dialogues object\r\n        this.getName = getName;\r\n        this.id = id || this.name;\r\n        this.starting_text = starting_text;\r\n        this.getStartingText = getStartingText;\r\n        this.ending_text = ending_text; //text shown on option to finish talking\r\n        this.is_unlocked = is_unlocked;\r\n        this.is_finished = is_finished; //separate bool to remove dialogue option if it's finished\r\n        this.textlines = textlines; //all the lines in dialogue\r\n        this.actions = actions;\r\n        this.description = description;\r\n        this.getDescription = getDescription;\r\n\r\n        this.location_name = location_name; //this is purely informative and wrong value shouldn't cause any actual issues\r\n    }\r\n}\r\n\r\nclass Textline {\r\n    constructor({name,\r\n                 text,\r\n                 getText,\r\n                 is_unlocked = true,\r\n                 is_finished = false,\r\n                 is_branch_only = false,\r\n                 rewards = {textlines: [],\r\n                            locations: [],\r\n                            dialogues: [],\r\n                            traders: [],\r\n                            stances: [],\r\n                            flags: [],\r\n                            items: [],\r\n                            locks: {textlines: {}}, //for lines to be locked in diferent dialogues and possibly for other stuff\r\n                            //reputation reward from textlines is currently not supported\r\n                            },\r\n                branches_into = [],\r\n                locks_lines = [], //for lines to be locked in same dialogue\r\n                //it's a simplified version of doing rewards: {locks: textlines: {...blah blah blah, values from it are actually autofilled in that form in a script at the end of this file\r\n                otherUnlocks,\r\n                required_flags,\r\n                display_conditions = [],\r\n            }) \r\n    {\r\n        this.name = name; // displayed option to click, don't make it too long\r\n        this.text = text; // what's shown after clicking\r\n        this.getText = getText || function(){return this.text;};\r\n        this.otherUnlocks = otherUnlocks || function(){return;};\r\n        this.is_unlocked = is_unlocked;\r\n        this.is_finished = is_finished;\r\n        this.is_branch_only = is_branch_only; //if true, textline won't be displayed in overall view and instead will only be available as a branch dialogue\r\n        this.rewards = rewards || {};\r\n        this.branches_into = branches_into;\r\n        \r\n        this.rewards.textlines = rewards.textlines || [];\r\n        this.rewards.locations = rewards.locations || [];\r\n        this.rewards.dialogues = rewards.dialogues || [];\r\n        this.rewards.traders = rewards.traders || [];\r\n        this.rewards.stances = rewards.stances || [];\r\n        this.rewards.flags = rewards.flags || [];\r\n        this.rewards.items = rewards.items || [];\r\n        \r\n        this.display_conditions = [display_conditions];\r\n        this.required_flags = required_flags; //generally could be handled via display_conditions but offers a bit more freedom allowing a condition of /not/ having a flag too\r\n\r\n        this.locks_lines = locks_lines;\r\n\r\n        this.rewards.locks = rewards.locks || {};\r\n        if(!this.rewards.locks.textlines) {\r\n            this.rewards.locks.textlines = {};\r\n        }\r\n        //related text lines that get locked; might be itself, might be some previous line \r\n        //e.g. line finishing quest would also lock line like \"remind me what I was supposed to do\"\r\n        //should be alright if it's limited only to lines in same Dialogue\r\n        //just make sure there won't be Dialogues with ALL lines unavailable\r\n    }\r\n}\r\n\r\nclass DialogueAction extends GameAction {\r\n    constructor(data) {\r\n        super(data);\r\n        this.giveup_text = data.giveup_text;\r\n        this.floating_click_effects = data.floating_click_effects;\r\n    }\r\n}\r\n\r\n(function(){\r\n    dialogues[\"village elder\"] = new Dialogue({\r\n        //ram\r\n        name: \"village elder\",\r\n        textlines: {\r\n            \"hello\": new Textline({\r\n                name: \"elder hello\",\r\n                text: \"elder hello answ\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village elder\", lines: [\"what happened\", \"where am i\", \"dont remember\", \"about\"]}],\r\n                },\r\n                locks_lines: [\"hello\"],\r\n            }),\r\n            \"what happened\": new Textline({\r\n                name: \"elder head hurts\",\r\n                text: \"elder head hurts answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"what happened\", \"where am i\", \"dont remember\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village elder\", lines: [\"ask to leave 1\"]}],\r\n                    quest_progress: [\r\n                        {quest_id: \"Lost memory\", task_index: 0},\r\n                    ]\r\n                },\r\n            }),\r\n            \"where am i\": new Textline({\r\n                name: \"elder where\",\r\n                text: \"elder where answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"what happened\", \"where am i\", \"dont remember\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village elder\", lines: [\"ask to leave 1\"]}],\r\n                    quest_progress: [\r\n                        {quest_id: \"Lost memory\", task_index: 0},\r\n                    ]\r\n                },\r\n            }),\r\n            \"dont remember\": new Textline({\r\n                name: \"elder remember\",\r\n                text: \"elder remember answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"what happened\", \"where am i\", \"dont remember\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village elder\", lines: [\"ask to leave 1\"]}],\r\n                    quest_progress: [\r\n                        {quest_id: \"Lost memory\", task_index: 0},\r\n                    ]\r\n                },\r\n            }),\r\n            \"about\": new Textline({\r\n                name: \"elder who\",\r\n                text: \"elder who answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"about\"]\r\n            }),\r\n            \"ask to leave 1\": new Textline({\r\n                name: \"elder leave 1\",\r\n                text: \"elder leave 1 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village elder\", lines: [\"need to\"]}],\r\n                },\r\n                locks_lines: [\"ask to leave 1\"],\r\n            }),\r\n            \"need to\": new Textline({\r\n                name: \"elder need to\",\r\n                text: \"elder need to answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village elder\", lines: [\"rats\", \"ask to leave 2\", \"equipment\"]}],\r\n                    locations: [{location: \"Infested field\"}],\r\n                    activities: [{location:\"Village\", activity:\"weightlifting\"}, {location:\"Village\",activity:\"running\"}],\r\n                    quest_progress: [\r\n                        {quest_id: \"Lost memory\", task_index: 1},\r\n                    ]\r\n                },\r\n                locks_lines: [\"need to\"],\r\n            }),\r\n            \"equipment\": new Textline({\r\n                name: \"elder eq\",\r\n                text: \"elder eq answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"equipment\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village elder\", lines: [\"money\"]}],\r\n                    traders: [{trader: \"village trader\"}]\r\n                }\r\n            }),\r\n            \"money\": new Textline({\r\n                name: \"elder money\",\r\n                text: \"elder money answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"money\"],\r\n                rewards: {\r\n                    activities: [{location: \"Village\", activity: \"fieldwork\"}],\r\n                }\r\n            }),\r\n            \"ask to leave 2\": new Textline({\r\n                name: \"elder leave 2\",\r\n                text: \"elder leave 2 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                },\r\n            }),\r\n            \"rats\": new Textline({\r\n                name: \"elder rats\",\r\n                text: \"elder rats answ\",\r\n                is_unlocked: false,\r\n            }),\r\n            \"cleared field\": new Textline({ //will be unlocked on clearing infested field combat_zone\r\n                name: \"elder cleared 1\",\r\n                text: \"elder cleared 1 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    locations: [{location: \"Nearby cave\"}, {location: \"Infested field\"}, {location: \"Shack\"}],\r\n                    textlines: [{dialogue: \"village elder\", lines: [\"ask to leave 3\"]}],\r\n                    dialogues: [\"old craftsman\"],\r\n                },\r\n                locks_lines: [\"ask to leave 2\", \"cleared field\"],\r\n            }),\r\n            \"ask to leave 3\": new Textline({\r\n                name: \"elder leave 3\",\r\n                text: \"elder leave 3 answ\",\r\n                rewards: {\r\n                    locations: [{location: \"Nearby cave\"}, {location: \"Infested field\"}],\r\n                    dialogues: [\"old craftsman\"],\r\n                },\r\n                is_unlocked: false,\r\n            }),\r\n            \"cleared room\": new Textline({\r\n                name: \"elder room clear\",\r\n                text: \"elder room clear answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    locations: [{location: \"Eastern mill\"}],\r\n                    quests: [\"It won't mill itself\"],\r\n                },\r\n                locks_lines: [\"cleared room\"],\r\n            }),\r\n            \"cleared cave\": new Textline({\r\n                name: \"elder cave clear\",\r\n                text: \"elder cave clear answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village elder\", lines: [\"ask to leave 4\", \"crab rumors\"]}],\r\n                    locations: [{location: \"Forest road\"}, {location: \"Infested field\"}, {location: \"Nearby cave\"}],\r\n                    dialogues: [\"village guard\"],\r\n                    quest_progress: [\r\n                        {quest_id: \"Lost memory\", task_index: 2},\r\n                    ]\r\n                },\r\n                locks_lines: [\"ask to leave 3\", \"rats\", \"cleared cave\"],\r\n            }),\r\n            \"ask to leave 4\": new Textline({\r\n                name: \"elder leave 4\",\r\n                text: \"elder leave 4 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    locations: [{location: \"Forest road\"}, {location: \"Infested field\"}, {location: \"Nearby cave\"}],\r\n                    dialogues: [\"village guard\", \"old craftsman\"],\r\n                    textlines: [{dialogue: \"village elder\", lines: [\"about guard\"]}],\r\n                },\r\n            }),\r\n            \"about guard\": new Textline({\r\n                name: \"elder about guard\",\r\n                text: \"elder about guard answ\",\r\n                is_unlocked: false,\r\n                required_flags: {yes: [\"is_guard_met\"]},\r\n                locks_lines: [\"about guard\"],\r\n            }),\r\n            \"new tunnel\": new Textline({\r\n                name: \"elder tunnel\",\r\n                text: \"elder tunnel answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"new tunnel\"],\r\n            }),\r\n\r\n            \"crab rumors\": new Textline({\r\n                name: \"elder crab rumors\",\r\n                text: \"elder crab rumors answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village elder\", lines: [\"crab where\"]}],\r\n                },\r\n                display_conditions: {\r\n                    hero_level: 35,\r\n                },\r\n                locks_lines: [\"crab rumors\"],\r\n            }),\r\n            \r\n            \"crab where\": new Textline({\r\n                name: \"elder crab where\",\r\n                text: \"elder crab where answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village elder\", lines: [\"crab hunt\"]}],\r\n                },\r\n                locks_lines: [\"crab where\"],\r\n            }),\r\n            \"crab hunt\": new Textline({\r\n                name: \"elder crab hunt\",\r\n                text: \"elder crab hunt answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    actions: [{location: \"Village\", action: \"hike down river\"}],\r\n                    quests: [\"Giant Enemy Crab\"],\r\n                },\r\n                locks_lines: [\"crab hunt\"]\r\n            }),\r\n            \r\n            \"more training\": new Textline({\r\n                name: \"elder training\",\r\n                getText: (context) => {\r\n                    if(context?.season === \"Winter\") {\r\n                        return \"elder training answ 2\";\r\n                    } else {\r\n                        return \"elder training answ 1\";\r\n                    }\r\n                },\r\n                is_unlocked: false,\r\n                locks_lines: [\"more training\"],\r\n                rewards: {\r\n                    global_activities: [\"swimming\", \"climbing\"],\r\n                    actions: [{location: \"Nearby cave\", action: \"climb the mountain\"}],\r\n                    locks: {\r\n                        quests: [\"Swimming alternative unlock\"]\r\n                    }\r\n                }\r\n            })\r\n        },\r\n        description: \"elder description\",\r\n    });\r\n\r\n    dialogues[\"old craftsman\"] = new Dialogue({\r\n        //badger\r\n        name: \"old craftsman\",\r\n        is_unlocked: false,\r\n        textlines: {\r\n            \"hello\": new Textline({\r\n                name: \"craftsman hello\",\r\n                text: \"craftsman hello answ\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"old craftsman\", lines: [\"learn\", \"leave\", \"about guard\"]}],\r\n                },\r\n                locks_lines: [\"hello\"],\r\n            }),\r\n            \"learn\": new Textline({\r\n                name: \"craftsman learn\",\r\n                text: \"craftsman learn answ\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"old craftsman\", lines: [\"remind1\", \"remind2\", \"remind3\", \"remind4\"]}],\r\n                    items: [\"Old pickaxe\" ,\"Old axe\", \"Old sickle\", \"Old shovel\"],\r\n                    flags: [\"is_gathering_unlocked\", \"is_crafting_unlocked\"],\r\n                },\r\n                locks_lines: [\"learn\",\"leave\"],\r\n                is_unlocked: false,\r\n            }),\r\n            \"leave\": new Textline({\r\n                name: \"craftsman leave\",\r\n                text: \"craftsman leave answ\",\r\n                is_unlocked: false,\r\n            }),\r\n            \r\n            \"remind1\": new Textline({\r\n                name: \"craftsman remind 1\",\r\n                text: \"craftsman remind 1 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"old craftsman\", lines: [\"remind4\"]}],\r\n                },\r\n            }),\r\n            \"remind2\": new Textline({\r\n                name: \"craftsman remind 2\",\r\n                text: \"craftsman remind 2 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"old craftsman\", lines: [\"remind4\"]}],\r\n                },\r\n            }),\r\n            \"remind3\": new Textline({\r\n                name: \"craftsman remind 3\",\r\n                text: \"craftsman remind 3 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"old craftsman\", lines: [\"remind4\"]}],\r\n                },\r\n            }),\r\n            \"remind4\": new Textline({\r\n                name: \"craftsman remind 4\",\r\n                text: \"craftsman remind 4 answ\",\r\n                is_unlocked: false,\r\n            }),\r\n            \"about guard\": new Textline({\r\n                name: \"craftsman about guard\",\r\n                text: \"craftsman about guard answ\",\r\n                is_unlocked: false,\r\n                required_flags: {yes: [\"is_guard_met\"]},\r\n                locks_lines: [\"about guard\"],\r\n            }),\r\n        },\r\n        description: \"craftsman description\",\r\n    });\r\n\r\n    dialogues[\"village guard\"] = new Dialogue({\r\n        name: \"village guard\",\r\n        is_unlocked: false,\r\n        textlines: {\r\n            \"hello\": new Textline({\r\n                name: \"guard hello\",\r\n                text: \"guard hello answ\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village guard\", lines: [\"tips\", \"job\", \"hi\"]}],\r\n                    flags: [\"is_guard_met\"],\r\n                },\r\n                locks_lines: [\"hello\"],\r\n            }),\r\n            \"job\": new Textline({\r\n                name: \"guard job\",\r\n                is_unlocked: false,\r\n                text: \"guard job answ\",\r\n                rewards: {\r\n                    activities: [{location:\"Village\", activity:\"patrolling\"}],\r\n                },\r\n                locks_lines: [\"job\"],\r\n            }),\r\n            \"tips\": new Textline({\r\n                name: \"guard tips\",\r\n                is_unlocked: false,\r\n                text: \"guard tips answ\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village guard\", lines: [\"teach\"]}],\r\n                },\r\n            }),\r\n            \"hi\": new Textline({\r\n                name: \"guard hi\",\r\n                is_unlocked: false,\r\n                text: \"guard hi answ\",\r\n                display_conditions: {\r\n                    reputation: {Village: 200},\r\n                },\r\n                rewards: {\r\n                    actions: [{dialogue: \"village guard\", action: \"ask for pats\"}, {dialogue: \"village guard\", action: \"try to pat\"}],\r\n                },\r\n                locks_lines: [\"hi\"],\r\n            }),\r\n            \"teach\": new Textline({\r\n                name: \"guard teach\",\r\n                is_unlocked: false,\r\n                text: \"guard teach answ\",\r\n                rewards: {\r\n                    locations: [{location: \"Sparring with the village guard (quick)\"}, {location: \"Sparring with the village guard (heavy)\"}],\r\n                },\r\n                locks_lines: [\"teach\"],\r\n            }),\r\n            \"quick\": new Textline({\r\n                name: \"guard quick\",\r\n                is_unlocked: false,\r\n                text: \"guard quick answ\",\r\n                otherUnlocks: () => {\r\n                    if(dialogues[\"village guard\"].textlines[\"heavy\"].is_finished) {\r\n                        dialogues[\"village guard\"].textlines[\"wide\"].is_unlocked = true;\r\n                    }\r\n                },\r\n                locks_lines: [\"quick\"],\r\n                rewards: {\r\n                    stances: [\"quick\"],\r\n                    skill_xp: {\r\n                        Combat: 100,\r\n                    }\r\n                }\r\n            }),\r\n            \"heavy\": new Textline({\r\n                name: \"guard heavy\",\r\n                is_unlocked: false,\r\n                text: \"guard heavy answ\",\r\n                otherUnlocks: () => {\r\n                    if(dialogues[\"village guard\"].textlines[\"quick\"].is_finished) {\r\n                        dialogues[\"village guard\"].textlines[\"wide\"].is_unlocked = true;\r\n                    }\r\n                },\r\n                locks_lines: [\"heavy\"],\r\n                rewards: {\r\n                    stances: [\"heavy\"],\r\n                    skill_xp: {\r\n                        Combat: 100,\r\n                    }\r\n                }\r\n            }),\r\n            \"wide\": new Textline({\r\n                name: \"guard wide\",\r\n                is_unlocked: false,\r\n                text: \"guard wide answ\",\r\n                locks_lines: [\"wide\"],\r\n                rewards: {\r\n                    stances: [\"wide\"],\r\n                    textlines: [{dialogue: \"village guard\", lines: [\"serious\", \"hi\", \"tips 2\", \"teach more\"]}],\r\n                    skill_xp: {\r\n                        Combat: 100,\r\n                    }\r\n                }\r\n            }),\r\n            \"teach more\": new Textline({\r\n                name: \"guard teach more\",\r\n                is_unlocked: false,\r\n                text: \"guard teach more answ\",\r\n                locks_lines: [\"teach more\"],\r\n            }),\r\n            \"serious\": new Textline({\r\n                name: \"guard serious\",\r\n                is_unlocked: false,\r\n                text: \"guard serious answ\",\r\n                locks_lines: [\"serious\"],\r\n            }),\r\n            \"tips 2\": new Textline({\r\n                name: \"guard tips 2\",\r\n                is_unlocked: false,\r\n                text: \"guard tips 2 answ\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village guard\", lines: [\"scars\"]}],\r\n                }\r\n            }),\r\n            \"scars\": new Textline({\r\n                name: \"guard scars\",\r\n                is_unlocked: false,\r\n                text: \"guard scars answ\",\r\n                locks_lines: [\"scars\"],\r\n            }),\r\n        },\r\n        actions: {\r\n            \"ask for pats\": new DialogueAction({\r\n                action_id: \"ask for pats\",\r\n                is_unlocked: false,\r\n                repeatable: true,\r\n                starting_text: \"guard pats\",\r\n                floating_click_effects: ['(\u30CE= \u2A4A = )\u30CE', '( \u00B4\uFF65\uFF65)\uFF89'],\r\n                description: \"\",\r\n                action_text: \"\",\r\n                success_text: \"guard pats answ\",\r\n                attempt_duration: 0,\r\n                success_chances: [1],\r\n            }),\r\n            \"try to pat\": new DialogueAction({\r\n                action_id: \"try to pat\",\r\n                is_unlocked: false,\r\n                repeatable: true,\r\n                starting_text: \"guard try\",\r\n                floating_click_effects: ['(\u30CE= \u2A4A = )\u30CE', '( \u00B4\uFF65\uFF65)\uFF89'],\r\n                description: \"\",\r\n                action_text: \"\",\r\n                success_text: \"guard try answ\",\r\n                attempt_duration: 0,\r\n                success_chances: [1],\r\n            }),\r\n        },\r\n        description: \"guard description\",\r\n    });\r\n\r\n    dialogues[\"village millers\"] = new Dialogue({\r\n        //cat and mouse\r\n        name: \"village millers\",\r\n        textlines: {\r\n            \"hello\": new Textline({\r\n                name: \"millers hello\",\r\n                text: \"millers hello answ\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village millers\", lines: [\"how\", \"young\", \"about guard\"]}],\r\n                },\r\n                locks_lines: [\"hello\"],\r\n            }),\r\n            \"how\": new Textline({\r\n                is_unlocked: false,\r\n                name: \"millers how\",\r\n                text: \"millers how answ\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village millers\", lines: [\"sure\"]}],\r\n                },\r\n                locks_lines: [\"how\"],\r\n            }),\r\n            \"sure\": new Textline({\r\n                is_unlocked: false,\r\n                name: \"millers sure\",\r\n                text: \"millers sure answ\",\r\n                rewards: {\r\n                    quest_progress: [{quest_id: \"It won't mill itself\", task_index: 0}],\r\n                    locations: [{location: \"Eastern storehouse\"}],\r\n                },\r\n                locks_lines: [\"sure\"],\r\n            }),\r\n            \"young\": new Textline({\r\n                is_unlocked: false,\r\n                name: \"millers young\",\r\n                text: \"millers young answ\",\r\n                locks_lines: [\"young\"],\r\n            }),\r\n            \"cleared storage\": new Textline({\r\n                is_unlocked: false,\r\n                name: \"millers cleared\",\r\n                text: \"millers cleared answ\",\r\n                locks_lines: [\"cleared storage\"],\r\n                rewards: {\r\n                    quest_progress: [{quest_id: \"It won't mill itself\", task_index: 1}],\r\n                    actions: [{location: \"Village\", action: \"search for delivery\"}],\r\n                },\r\n            }),\r\n            \"delivered\": new Textline({\r\n                is_unlocked: false,\r\n                name: \"millers delivered\",\r\n                text: \"millers delivered answ\",\r\n                locks_lines: [\"delivered\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village millers\", lines: [\"kiss\"]}],\r\n                    quest_progress: [{quest_id: \"It won't mill itself\", task_index: 2}],\r\n                    actions: [{location: \"Village\", action: \"search for delivery\"}],\r\n                },\r\n            }),\r\n            \"kiss\": new Textline({\r\n                is_unlocked: false,\r\n                name: \"millers kiss\",\r\n                text: \"millers kiss answ\",\r\n                branches_into: [\"kiss both\", \"kiss cat\", \"kiss mouse\", \"reject nice\", \"reject mean\"],\r\n            }),\r\n            \"kiss both\": new Textline({\r\n                is_branch_only: true,\r\n                name: \"millers kiss both\",\r\n                text: \"millers kiss both answ\",\r\n                locks_lines: [\"kiss\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village millers\", lines: [\"kiss more\", \"how2\"]}],\r\n                }\r\n            }),\r\n            \"kiss cat\": new Textline({\r\n                is_branch_only: true,\r\n                name: \"millers kiss cat\",\r\n                text: \"millers kiss cat answ\",\r\n                locks_lines: [\"kiss\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village millers\", lines: [\"kiss more\", \"how2\"]}],\r\n                }\r\n            }),\r\n            \"kiss mouse\": new Textline({\r\n                is_branch_only: true,\r\n                name: \"millers kiss mouse\",\r\n                text: \"millers kiss mouse answ\",\r\n                locks_lines: [\"kiss\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village millers\", lines: [\"kiss more\", \"how2\"]}],\r\n                }\r\n            }),\r\n            \"reject nice\": new Textline({\r\n                is_branch_only: true,\r\n                name: \"millers reject nice\",\r\n                text: \"millers reject nice answ\",\r\n                locks_lines: [\"kiss\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village millers\", lines: [\"how2\"]}],\r\n                }\r\n            }),\r\n            \"reject mean\": new Textline({\r\n                is_branch_only: true,\r\n                name: \"millers reject mean\",\r\n                text: \"millers reject mean answ\",\r\n                locks_lines: [\"kiss\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village millers\", lines: [\"how2\"]}],\r\n                }\r\n            }),\r\n            \"kiss more\": new Textline({\r\n                is_unlocked: false,\r\n                name: \"millers kiss more\",\r\n                text: \"millers kiss more answ\",\r\n                locks_lines: [\"kiss more\"],\r\n            }),\r\n            \"how2\": new Textline({\r\n                is_unlocked: false,\r\n                name: \"millers how2\",\r\n                text: \"millers how2 answ\",\r\n            }),\r\n            \"about guard\": new Textline({\r\n                name: \"millers about guard\",\r\n                text: \"millers about guard answ\",\r\n                is_unlocked: false,\r\n                required_flags: {yes: [\"is_guard_met\"]},\r\n                locks_lines: [\"about guard\"],\r\n            }),\r\n        },\r\n        description: \"millers description\",\r\n    });\r\n\r\n    dialogues[\"gate guard\"] = new Dialogue({\r\n        name: \"gate guard\",\r\n        textlines: {\r\n            \"enter\": new Textline({\r\n                name: \"g guard hello\",\r\n                text: \"g guard hello answ\",\r\n            }), \r\n        },\r\n        description: \"g guard description\",\r\n    });\r\n    dialogues[\"suspicious man\"] = new Dialogue({\r\n        name: \"suspicious man\",\r\n        getName: (context)=>{\r\n            if(dialogues[\"suspicious man\"].actions[\"headpat\"].is_unlocked) {\r\n                if(context.is_mofu_mofu_enabled) {\r\n                    return \"puppy\"; //yeah, whatever\r\n                } else {\r\n                    return \"no-longer-suspicious guy\";\r\n                }\r\n            } else {\r\n                return dialogues[\"suspicious man\"].name;\r\n            }\r\n        },\r\n        getStartingText: (context)=>{\r\n            return `Talk to the ${dialogues[\"suspicious man\"].getName(context)}`;\r\n        },\r\n        textlines: {\r\n            \"hello\": new Textline({ \r\n                name: \"sus hello\",\r\n                text: \"sus hello answ\",\r\n                rewards: {\r\n                    locations: [{location: \"Fight off the assailant\"}],\r\n                },\r\n                locks_lines: [\"hello\"],\r\n            }), \r\n            \"defeated\": new Textline({ \r\n                name: \"sus defeated\",\r\n                is_unlocked: false,\r\n                text: \"sus defeated answ\",\r\n                locks_lines: [\"defeated\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"suspicious man\", lines: [\"behave\", \"situation\"]}],\r\n                    quest_progress: [\r\n                        {quest_id: \"Lost memory\", task_index: 3},\r\n                    ]\r\n                },\r\n            }), \r\n            \"behave\": new Textline({ \r\n                name: \"sus behave\",\r\n                is_unlocked: false,\r\n                text: \"sus behave answ\",\r\n                locks_lines: [\"defeated\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"suspicious man\", lines: [\"situation\", \"boss\"]}],\r\n                },\r\n            }), \r\n            \"boss\": new Textline({ \r\n                name: \"sus boss\",\r\n                is_unlocked: false,\r\n                text: \"sus boss answ\",\r\n                locks_lines: [\"boss\"],\r\n            }), \r\n            \"situation\": new Textline({\r\n                name: \"sus situation\",\r\n                is_unlocked: false,\r\n                text: \"sus situation answ\",\r\n                locks_lines: [\"situation\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"suspicious man\", lines: [\"gang\", \"boss\"]}],\r\n                },\r\n            }),\r\n            \"gang\": new Textline({\r\n                name: \"sus gang\",\r\n                is_unlocked: false,\r\n                text: \"sus gang answ\",\r\n                locks_lines: [\"gang\", \"behave\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"suspicious man\", lines: [\"gang\", \"behave 2\"]}],\r\n                    locations: [\r\n                        {location: \"Gang hideout\"},\r\n                    ],\r\n                    quest_progress: [{quest_id: \"Light in the darkness\", task_index: 0}],\r\n                },\r\n            }),\r\n            \"defeated gang\": new Textline({\r\n                name: \"sus gang defeated\",\r\n                is_unlocked: false,\r\n                text: \"sus gang defeated answ\",\r\n                locks_lines: [\"defeated gang\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"suspicious man\", lines: [\"tricks\", \"behave 3\" ]}],\r\n                    dialogues: [\"old woman of the slums\"],\r\n                }\r\n            }),\r\n            \"behave 2\": new Textline({ \r\n                name: \"sus behave 2\",\r\n                is_unlocked: false,\r\n                text: \"sus behave 2 answ\",\r\n            }),\r\n            \"behave 3\": new Textline({ \r\n                name: \"sus behave 3\",\r\n                is_unlocked: false,\r\n                text: \"sus behave 3 answ\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"suspicious man\", lines: [\"tricks\"]}],\r\n                    dialogues: [\"old woman of the slums\"],\r\n                    actions: [{dialogue: \"suspicious man\", action: \"headpat\"}],\r\n                }\r\n            }),\r\n            \"tricks\": new Textline({ \r\n                name: \"sus tricks\",\r\n                is_unlocked: false,\r\n                text: \"sus tricks answ\",\r\n                rewards: {\r\n                    stances: [\"defensive\"],\r\n                },\r\n                locks_lines: [\"tricks\"],\r\n            }),\r\n        }, \r\n        getDescription: ()=>{\r\n            if(dialogues[\"suspicious man\"].textlines[\"defeated gang\"].is_finished) {\r\n                return \"sus description 2\";\r\n            } else {\r\n                return \"sus description 1\";\r\n            }\r\n        },\r\n        actions: {\r\n            \"headpat\": new DialogueAction({\r\n                action_id: \"headpat\",\r\n                is_unlocked: false,\r\n                repeatable: true,\r\n                starting_text: \"sus headpat\",\r\n                floating_click_effects: ['(* ^ \u03C9 ^)\t', '<(\uFFE3\uFE36\uFFE3)>\t', '(*\u2267\u03C9\u2266*)\t', '(\u15D2\u2A4A\u15D5)', '(= \u2A4A =)'],\r\n                description: \"\",\r\n                action_text: \"\",\r\n                success_text: \"sus headpat answ\",\r\n                display_conditions: {\r\n                    flags: [\"is_mofu_mofu_enabled\"],\r\n                },\r\n                attempt_duration: 0,\r\n                success_chances: [1],\r\n            }),\r\n        }\r\n    });\r\n\r\n    dialogues[\"old woman of the slums\"] = new Dialogue({\r\n        name: \"old woman of the slums\",\r\n        is_unlocked: false,\r\n        textlines: {\r\n            \"hello\": new Textline({\r\n                name: \"old hello\",\r\n                text: \"old hello answ\",\r\n                locks_lines: [\"hello\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"old woman of the slums\", lines: [\"dinner\"]}],\r\n                }\r\n            }),\r\n            \"dinner\": new Textline({\r\n                name: \"old dinner\",\r\n                is_unlocked: false,\r\n                text: \"old dinner answ\",\r\n                locks_lines: [\"dinner\"],\r\n                rewards: {\r\n                    textlines: [{dialogue: \"old woman of the slums\", lines: [\"ingredients\"]}],\r\n                }\r\n            }),\r\n            \"ingredients\": new Textline({\r\n                name: \"old ingredients\",\r\n                is_unlocked: false,\r\n                text: \"old ingredients answ\",\r\n                locks_lines: [\"ingredients\"],\r\n                rewards: {\r\n                    activities: [{location: \"Town outskirts\", activity: \"herbalism\"}],\r\n                }\r\n            }),\r\n        },\r\n        getDescription: ()=>{\r\n            if(dialogues[\"old woman of the slums\"].textlines[\"hello\"].is_finished) {\r\n                return \"old description 2\";\r\n            } else {\r\n                return \"old description 1\";\r\n            }\r\n        }\r\n    });\r\n\r\n    dialogues[\"farm supervisor\"] = new Dialogue({\r\n        name: \"farm supervisor\",\r\n        textlines: {\r\n            \"hello\": new Textline({ \r\n                name: \"sup hello\",\r\n                text: \"sup hello answ\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"farm supervisor\", lines: [\"things\", \"work\", \"animals\", \"fight\", \"fight0\", \"anything\"]}],\r\n                },\r\n                locks_lines: [\"hello\"],\r\n            }),\r\n            \"work\": new Textline({\r\n                name:\"sup work\",\r\n                is_unlocked: false,\r\n                text: \"sup work answ\",\r\n                rewards: {\r\n                    activities: [{location: \"Town farms\", activity: \"fieldwork\"}],\r\n                },\r\n                locks_lines: [\"work\"],\r\n            }),\r\n            \"anything\": new Textline({\r\n                name: \"sup anything\",\r\n                is_unlocked: false,\r\n                text: \"sup anything answ\",\r\n                rewards: {\r\n                    actions: [{dialogue: \"farm supervisor\", action: \"bonemeal1\"}],\r\n                    quests: [\"Bonemeal delivery\"],\r\n                },\r\n                locks_lines: [\"anything\"],\r\n            }),\r\n            \"more bonemeal\": new Textline({\r\n                name: \"sup bonemeal\",\r\n                is_unlocked: false,\r\n                text: \"sup bonemeal answ\",\r\n                rewards: {\r\n                    actions: [{dialogue: \"farm supervisor\", action: \"bonemeal2\"}],\r\n                },\r\n                locks_lines: [\"more bonemeal\"],\r\n            }),\r\n            \"animals\": new Textline({\r\n                name: \"sup animals\",\r\n                is_unlocked: false,\r\n                text: \"sup animals answ\",\r\n                required_flags: {yes: [\"is_gathering_unlocked\"]},\r\n                rewards: {\r\n                    activities: [{location: \"Town farms\", activity: \"animal care\"}],\r\n                },\r\n                locks_lines: [\"animals\"],\r\n            }),\r\n            \"fight0\": new Textline({\r\n                name: \"sup fight0\",\r\n                is_unlocked: false,\r\n                text: \"sup fight0 answ\",\r\n                required_flags: {no: [\"is_strength_proved\"]},\r\n                rewards: {\r\n                    quests: [\"Ploughs to swords\"],\r\n                }\r\n            }),\r\n            \"fight\": new Textline({\r\n                name: \"sup fight\",\r\n                is_unlocked: false,\r\n                text: \"sup fight answ\",\r\n                required_flags: {yes: [\"is_strength_proved\"]},\r\n                rewards: {\r\n                    actions: [{location: \"Forest road\", action: \"search for boars\"}],\r\n                    //locations: [{location: \"Forest clearing\"}],\r\n                    quests: [\"Ploughs to swords\"],\r\n                    quest_progress: [{quest_id: \"Ploughs to swords\", task_index: 0}],\r\n                },\r\n                locks_lines: [\"fight\"],\r\n            }),\r\n            \"things\": new Textline({\r\n                is_unlocked: false,\r\n                name: \"sup things\",\r\n                text: \"sup things answ\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"farm supervisor\", lines: [\"animals\", \"fight\", \"fight0\", \"anything\"]}],\r\n                }\r\n            }), \r\n            \"defeated boars\": new Textline({\r\n                is_unlocked: false,\r\n                name: \"sup defeated boars\",\r\n                text: \"sup defeated boars answ\",\r\n                locks_lines: [\"defeated boars\"],\r\n                rewards: {\r\n                    money: 4000,\r\n                    quest_progress: [{quest_id: \"Ploughs to swords\", task_index: 1}],\r\n                    textlines: [{dialogue: \"farm supervisor\", lines: [\"troubled\"]}],\r\n                }\r\n            }),\r\n            \"troubled\": new Textline({\r\n                is_unlocked: false,\r\n                name: \"sup troubled\",\r\n                text: \"sup troubled answ\",\r\n                locks_lines: [\"troubled\"],\r\n                display_conditions: {\r\n                    season: {\r\n                        not: \"Winter\",\r\n                    }\r\n                },\r\n                rewards: {\r\n                    quest_progress: [{quest_id: \"Ploughs to swords\", task_index: 2}],\r\n                    actions: [{location: \"Town farms\", action: \"dig for ants 1\"}],\r\n                }\r\n            }),\r\n            \"eliminated ants\": new Textline({\r\n                is_unlocked: false,\r\n                name: \"sup eliminated\",\r\n                text: \"sup eliminated answ\",\r\n                locks_lines: [\"eliminated ants\"],\r\n                rewards: {\r\n                    quest_progress: [{quest_id: \"Ploughs to swords\", task_index: 3}],\r\n                    //other rewards are from quest itself\r\n                }\r\n            }),\r\n        },\r\n        actions: {\r\n            \"bonemeal1\": new DialogueAction({\r\n                action_id: \"bonemeal1\",\r\n                starting_text: \"sup deliver\",\r\n                description: \"\",\r\n                action_text: \"\",\r\n                success_text: \"sup deliver answ\",\r\n                failure_texts: {\r\n                    unable_to_begin: [\"sup deliver not\"],\r\n                },\r\n                required: {\r\n                    items_by_id: {\"Bonemeal\": {count: 50, remove_on_success: true}},\r\n                },\r\n                attempt_duration: 0,\r\n                success_chances: [1],\r\n                rewards: {\r\n                    quest_progress: [\r\n                        {\r\n                            quest_id: \"Bonemeal delivery\",\r\n                            task_index: 0\r\n                        }\r\n                    ], \r\n                    textlines: [{dialogue: \"farm supervisor\", lines: [\"more bonemeal\"]}],\r\n                },\r\n            }),\r\n            \"bonemeal2\": new DialogueAction({\r\n                action_id: \"bonemeal2\",\r\n                starting_text: \"sup deliver 2\",\r\n                description: \"\",\r\n                action_text: \"\",\r\n                success_text: \"sup deliver 2 answ\",\r\n                repeatable: true,\r\n                failure_texts: {\r\n                    unable_to_begin: [\"sup deliver 2 not\"],\r\n                },\r\n                required: {\r\n                    items_by_id: {\"Bonemeal\": {count: 50, remove_on_success: true}},\r\n                },\r\n                attempt_duration: 0,\r\n                success_chances: [1],\r\n                rewards: {\r\n                    money: 2000,\r\n                },\r\n            }),\r\n        },\r\n        description: \"sup description\",\r\n    });\r\n    dialogues[\"swampland chief\"] = new Dialogue({\r\n        //lizard like everyone in triber, aggressive and proud\r\n        name: \"swampland chief\",\r\n        textlines: {\r\n            \"swampchief meet\": new Textline({\r\n                name: \"swampchief meet\",\r\n                text: \"swampchief meet answ\",\r\n                is_unlocked: true,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland chief\", lines: [\"swampchief explain\"]}],\r\n                },\r\n                locks_lines: [\"swampchief meet\"],\r\n            }),\r\n            \"swampchief explain\": new Textline({\r\n                name: \"swampchief explain\",\r\n                text: \"swampchief explain answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland chief\", lines: [\"swampchief help\"]}],\r\n                },\r\n                locks_lines: [\"swampchief explain\"],\r\n            }),\r\n            \"swampchief help\": new Textline({\r\n                name: \"swampchief help\",\r\n                text: \"swampchief help answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland chief\", lines: [\"swampchief mid help\"]}],\r\n                    dialogues: [\"swampland cook\"],\r\n                    quest_progress: [{quest_id: \"In Times of Need\", task_index: 0}],\r\n                },\r\n                locks_lines: [\"swampchief help\"],\r\n            }),\r\n            \"swampchief mid help\": new Textline({\r\n                name: \"swampchief mid help\",\r\n                text: \"swampchief mid help answ\",\r\n                is_unlocked: false,\r\n            }),\r\n            \"swampchief report\": new Textline({\r\n                name: \"swampchief report\",\r\n                text: \"swampchief report answ\",\r\n                is_unlocked: false,\r\n                display_conditions: {\r\n                    reputation: {Village: 50},\r\n                }, \r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland chief\", lines: [\"swampchief confirm\"]}],\r\n                },\r\n                locks_lines: [\"swampchief report\",\"swampchief mid help\"],\r\n            }),\r\n            \"swampchief confirm\": new Textline({\r\n                name: \"swampchief confirm\",\r\n                text: \"swampchief confirm answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland chief\", lines: [\"swampchief accept\"]}],\r\n                },\r\n                locks_lines: [\"swampchief confirm\"],\r\n            }),\r\n            \"swampchief accept\": new Textline({\r\n                name: \"swampchief accept\",\r\n                text: \"swampchief accept answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    quest_progress: [{quest_id: \"In Times of Need\", task_index: 10}],   //finishes the quest\r\n                    textlines: [{dialogue: \"swampland chief\", lines: [\"swampchief generic\"]}],\r\n                    locations: [{location: \"Longhouse\"}],\r\n                    items: [\"Snake fang ring\"],\r\n                    traders: [{trader: \"swampland trader 2\"}],\r\n                    crafting: [\"Swampland tribe\"],\r\n                    locks: {\r\n                        traders: [\"swampland trader\"],\r\n                    }\r\n                },\r\n                locks_lines: [\"swampchief accept\"],\r\n            }),\r\n            \"swampchief generic\": new Textline({\r\n                name: \"swampchief generic\",\r\n                text: \"swampchief generic answ\",\r\n                is_unlocked: false,\r\n            }),\r\n        },\r\n        getDescription: ()=>{\r\n            if(dialogues[\"swampland chief\"].textlines[\"swampchief confirm\"].is_finished) {\r\n                return \"swampchief description 3\";\r\n            } else if (dialogues[\"swampland chief\"].textlines[\"swampchief help\"].is_finished) {\r\n                return \"swampchief description 2\";\r\n            } else {\r\n                return \"swampchief description 1\";\r\n            }}\r\n        });\r\n    dialogues[\"swampland cook\"] = new Dialogue({\r\n        //lizard, an outlander to the tribe. Slips foreign terms in dialogue. Speaks in odd, short sentences ending with exclamation marks\r\n        name: \"swampland cook\",\r\n        is_unlocked: false,\r\n        textlines: {\r\n            \"swampcook greeting1\": new Textline({\r\n                name: \"swampcook greeting1\",\r\n                text: \"swampcook greeting1 answ\",\r\n                is_unlocked: true,\r\n                rewards: {\r\n                    textlines: [\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook greeting2\", \"swampcook obaru\"]},\r\n                ]\r\n            },\r\n                locks_lines: [\"swampcook greeting1\"],\r\n            }),\r\n            \"swampcook greeting2\": new Textline({\r\n                name: \"swampcook greeting2\",\r\n                text: \"swampcook greeting2 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland cook\", lines: [\"swampcook help\"]}]\r\n                },\r\n                locks_lines: [\"swampcook greeting2\"],\r\n            }),\r\n            \"swampcook help\": new Textline({\r\n                name: \"swampcook help\",\r\n                text: \"swampcook help answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook sosso\"]},\r\n                    ],\r\n                    actions: [\r\n                        {dialogue: \"swampland cook\", action: \"swampcook deliver\"}\r\n                    ],\r\n                    quest_progress: [{quest_id: \"In Times of Need\", task_index: 1}],\r\n                },\r\n                locks_lines: [\"swampcook help\"],\r\n            }),\r\n            \"swampcook know\": new Textline({\r\n                name: \"swampcook know\",\r\n                text: \"swampcook know answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines:[\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook yeslore\", \"swampcook nolore\"]},\r\n                    ]\r\n                },\r\n                locks_lines: [\"swampcook know\"],\r\n            }),\r\n            \"swampcook yeslore\": new Textline({\r\n                name: \"swampcook yeslore\",\r\n                text: \"swampcook yeslore answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook history\", \"swampcook surround\", \"swampcook chief\", \"swampcook people\"]},\r\n                    ],\r\n                    recipes: [\r\n                        {category: \"cooking\", subcategory: \"items\", recipe_id: \"Alligator jerky\"},\r\n                        {category: \"cooking\", subcategory: \"items\", recipe_id: \"Turtle jerky\"},\r\n                        {category: \"cooking\", subcategory: \"items\", recipe_id: \"Snake jerky\"},\r\n                        {category: \"cooking\", subcategory: \"items\", recipe_id: \"Swampland skewer\"},\r\n                    ],\r\n                },\r\n                locks_lines: [\"swampcook yeslore\", \"swampcook nolore\"],\r\n            }),\r\n            \"swampcook history\": new Textline({\r\n                name: \"swampcook history\",\r\n                text: \"swampcook history answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook history1\", \"swampcook historyend\"]},\r\n                    ]\r\n                },\r\n                locks_lines: [\"swampcook history\"],\r\n            }),\r\n            \"swampcook history1\": new Textline({\r\n                name: \"swampcook history1\",\r\n                text: \"swampcook history1 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook history2\"]}\r\n                    ]\r\n                },\r\n                locks_lines: [\"swampcook history1\"],\r\n            }),\r\n            \"swampcook history2\": new Textline({\r\n                name: \"swampcook history2\",\r\n                text: \"swampcook history2 answ\",\r\n                is_unlocked: false,\r\n                rewards: {textlines: [\r\n                    {dialogue: \"swampland cook\", lines: [\"swampcook history3\"]}\r\n                ]\r\n            },\r\n                locks_lines: [\"swampcook history2\"],\r\n            }),\r\n            \"swampcook history3\": new Textline({\r\n                name: \"swampcook history3\",\r\n                text: \"swampcook history3 answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook history3\"],\r\n            }),\r\n            \"swampcook historyend\": new Textline({\r\n                name: \"swampcook historyend\",\r\n                text: \"swampcook historyend answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook history1\", \"swampcook history2\", \"swampcook history3\", \"swampcook historyend\"],\r\n            }),\r\n            \"swampcook surround\": new Textline({\r\n                name: \"swampcook surround\",\r\n                text: \"swampcook surround answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook surround1\", \"swampcook surround2\", \"swampcook surround3\", \"swampcook surround4\", \"swampcook surroundend\"]},\r\n                    ]\r\n                },\r\n                locks_lines: [\"swampcook surround\"],\r\n            }),\r\n            \"swampcook surround1\": new Textline({\r\n                name: \"swampcook surround1\",\r\n                text: \"swampcook surround1 answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook surround1\"],\r\n            }),\r\n            \"swampcook surround2\": new Textline({\r\n                name: \"swampcook surround2\",\r\n                text: \"swampcook surround2 answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook surround2\"],\r\n            }),\r\n            \"swampcook surround3\": new Textline({\r\n                name: \"swampcook surround3\",\r\n                text: \"swampcook surround3 answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook surround3\"],\r\n            }),\r\n            \"swampcook surround4\": new Textline({\r\n                name: \"swampcook surround4\",\r\n                text: \"swampcook surround4 answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook surround4\"],\r\n            }),\r\n            \"swampcook surroundend\": new Textline({\r\n                name: \"swampcook surroundend\",\r\n                text: \"swampcook surroundend answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook surround1\", \"swampcook surround2\", \"swampcook surround3\", \"swampcook surround4\", \"swampcook surroundend\"],\r\n            }),\r\n            \"swampcook chief\": new Textline({\r\n                name: \"swampcook chief\",\r\n                text: \"swampcook chief answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook chief1\", \"swampcook chiefend\"]},\r\n                    ]\r\n                },\r\n                locks_lines: [\"swampcook chief\"],\r\n            }),\r\n            \"swampcook chief1\": new Textline({\r\n                name: \"swampcook chief1\",\r\n                text: \"swampcook chief1 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland cook\", lines: [\"swampcook chief2\"]}]\r\n                },\r\n                locks_lines: [\"swampcook chief1\"],\r\n            }),\r\n            \"swampcook chief2\": new Textline({\r\n                name: \"swampcook chief2\",\r\n                text: \"swampcook chief2 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                        textlines: [{dialogue: \"swampland cook\", lines: [\"swampcook chief3\"]}]\r\n                },\r\n                locks_lines: [\"swampcook chief2\"],\r\n            }),\r\n            \"swampcook chief3\": new Textline({\r\n                name: \"swampcook chief3\",\r\n                text: \"swampcook chief3 answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook chief3\"],\r\n            }),\r\n            \"swampcook chiefend\": new Textline({\r\n                name: \"swampcook chiefend\",\r\n                text: \"swampcook chiefend answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook chief1\", \"swampcook chief2\", \"swampcook chief3\", \"swampcook chiefend\"],\r\n            }),\r\n            \"swampcook people\": new Textline({\r\n                name: \"swampcook people\",\r\n                text: \"swampcook people answ\",\r\n                is_unlocked: false,\r\n                rewards: {textlines: [\r\n                    {dialogue: \"swampland cook\", lines: [\"swampcook cook\",\"swampcook trader\", \"swampcook fangs\"]},\r\n                ]\r\n            },\r\n                locks_lines: [\"swampcook people\"],\r\n            }),\r\n            \"swampcook cook\": new Textline({\r\n                name: \"swampcook cook\",\r\n                text: \"swampcook cook answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland cook\", lines: [\"swampcook cook2\"]}]\r\n                },\r\n                locks_lines: [\"swampcook cook\"],\r\n            }),\r\n            \"swampcook cook2\": new Textline({\r\n                name: \"swampcook cook2\",\r\n                text: \"swampcook cook2 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland cook\", lines: [\"swampcook zalgo\"]}]\r\n                },\r\n                locks_lines: [\"swampcook cook2\"],\r\n            }),\r\n            \"swampcook trader\": new Textline({\r\n                name: \"swampcook trader\",\r\n                text: \"swampcook trader answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook trader1\", \"swampcook traderend\"]},\r\n                    ]\r\n                },\r\n                locks_lines: [\"swampcook trader\"],\r\n            }),\r\n            \"swampcook trader1\": new Textline({\r\n                name: \"swampcook trader1\",\r\n                text: \"swampcook trader1 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland cook\", lines: [\"swampcook trader2\"]}]\r\n                },\r\n                locks_lines: [\"swampcook trader1\"],\r\n            }),\r\n            \"swampcook trader2\": new Textline({\r\n                name: \"swampcook trader2\",\r\n                text: \"swampcook trader2 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland cook\", lines: [\"swampcook trader3\"]}]\r\n                },\r\n                locks_lines: [\"swampcook trader2\"],\r\n            }),\r\n            \"swampcook trader3\": new Textline({\r\n                name: \"swampcook trader3\",\r\n                text: \"swampcook trader3 answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook trader3\"],\r\n            }),\r\n            \"swampcook traderend\": new Textline({\r\n                name: \"swampcook traderend\",\r\n                text: \"swampcook traderend answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook trader1\", \"swampcook trader2\", \"swampcook trader3\", \"swampcook traderend\"],\r\n            }),\r\n            \"swampcook fangs\": new Textline({\r\n                name: \"swampcook fangs\",\r\n                text: \"swampcook fangs answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook tailor\", \"swampcook tanner\", \"swampcook peopleend\"]},\r\n                    ]\r\n                },\r\n                locks_lines: [\"swampcook fangs\"],\r\n            }),\r\n            \"swampcook tailor\": new Textline({\r\n                name: \"swampcook tailor\",\r\n                text: \"swampcook tailor answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook tailor1\", \"swampcook tailorend\"]},\r\n                    ],\r\n                },\r\n                locks_lines: [\"swampcook tailor\"],\r\n            }),\r\n            \"swampcook tailor1\": new Textline({\r\n                name: \"swampcook tailor1\",\r\n                text: \"swampcook tailor1 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland cook\", lines: [\"swampcook tailor2\"]}],\r\n                },\r\n                locks_lines: [\"swampcook tailor1\"],\r\n            }),\r\n            \"swampcook tailor2\": new Textline({\r\n                name: \"swampcook tailor2\",\r\n                text: \"swampcook tailor2 answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook tailor2\"],\r\n            }),\r\n            \"swampcook tailorend\": new Textline({\r\n                name: \"swampcook tailorend\",\r\n                text: \"swampcook tailorend answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook tailor1\", \"swampcook tailor2\", \"swampcook tailorend\"],\r\n            }),\r\n            \"swampcook tanner\": new Textline({\r\n                name: \"swampcook tanner\",\r\n                text: \"swampcook tanner answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook tanner1\", \"swampcook tannerend\"]},\r\n                    ]\r\n                },\r\n                locks_lines: [\"swampcook tanner\"],\r\n            }),\r\n            \"swampcook tanner1\": new Textline({\r\n                name: \"swampcook tanner1\",\r\n                text: \"swampcook tanner1 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland cook\", lines: [\"swampcook tanner2\"]}]\r\n                },\r\n                locks_lines: [\"swampcook tanner1\"],\r\n            }),\r\n            \"swampcook tanner2\": new Textline({\r\n                name: \"swampcook tanner2\",\r\n                text: \"swampcook tanner2 answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook tanner2\"],\r\n            }),\r\n            \"swampcook tannerend\": new Textline({\r\n                name: \"swampcook tannerend\",\r\n                text: \"swampcook tannerend answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook tanner1\", \"swampcook tanner2\", \"swampcook tannerend\"],\r\n            }),\r\n            \"swampcook peopleend\": new Textline({\r\n                name: \"swampcook peopleend\",\r\n                text: \"swampcook peopleend answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook whycrab\", \"swampcook tumana\"]},\r\n                    ], \r\n                    dialogues: [\"swampland tailor\"],\r\n                    quest_progress: [{quest_id: \"In Times of Need\", task_index: 3}],\r\n                },\r\n                locks_lines: [\"swampcook history\", \"swampcook history1\", \"swampcook history2\", \"swampcook history3\", \"swampcook historyend\", \"swampcook surround\",  \"swampcook surround1\", \"swampcook surround2\", \"swampcook surround3\", \"swampcook surround4\", \"swampcook surroundend\", \"swampcook chief\", \"swampcook chief1\", \"swampcook chief2\", \"swampcook chief3\", \"swampcook chiefend\", \"swampcook people\", \"swampcook cook\", \"swampcook cook2\", \"swampcook trader\", \"swampcook trader1\", \"swampcook trader2\", \"swampcook trader3\", \"swampcook traderend\", \"swampcook tailor\",  \"swampcook tailor1\", \"swampcook tailor2\", \"swampcook tailorend\", \"swampcook tanner\", \"swampcook tanner1\", \"swampcook tanner2\", \"swampcook tannerend\", \"swampcook peopleend\"], //should close all previous dialogue trees\r\n            }),\r\n            \"swampcook whycrab\": new Textline({\r\n                name: \"swampcook whycrab\",\r\n                text: \"swampcook whycrab answ\",\r\n                is_unlocked: false,\r\n                rewards: {textlines: [\r\n                    {dialogue: \"swampland cook\", lines: [\"swampcook whycrabpress\", \"swampcook whycrabdrop\"]},\r\n                ]\r\n            },\r\n                locks_lines: [\"swampcook whycrab\"],\r\n            }),\r\n            \"swampcook whycrabpress\": new Textline({\r\n                name: \"swampcook whycrabpress\",\r\n                text: \"swampcook whycrabpress answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland cook\", lines: [\"swampcook liked\"]}]\r\n                },\r\n                locks_lines: [\"swampcook whycrabpress\", \"swampcook whycrabdrop\"],\r\n            }),\r\n            \"swampcook whycrabdrop\": new Textline({\r\n                name: \"swampcook whycrabdrop\",\r\n                text: \"swampcook whycrabdrop answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland cook\", lines: [\"swampcook liked\"]}]\r\n                },\r\n                locks_lines: [\"swampcook whycrabpress\", \"swampcook whycrabdrop\"],\r\n            }),\r\n            \"swampcook nolore\": new Textline({\r\n                name: \"swampcook nolore\",\r\n                text: \"swampcook nolore answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines:[\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook liked\", \"swampcook tumana\", \"swampcook noloreteach\"]},\r\n                    ],\r\n                    dialogues: [\"swampland tailor\"],\r\n                    quest_progress: [{quest_id: \"In Times of Need\", task_index: 3}],\r\n                },\r\n                locks_lines: [\"swampcook yeslore\", \"swampcook nolore\"]\r\n            }),\r\n            \"swampcook liked\": new Textline({\r\n                name: \"swampcook liked\",\r\n                text: \"swampcook liked answ\",\r\n                is_unlocked: false,\r\n                rewards: {textlines: [{dialogue: \"swampland cook\", lines: [\"swampcook menaka\"]}]\r\n            },\r\n            }),\r\n            \"swampcook noloreteach\": new Textline({\r\n                name: \"swampcook noloreteach\",\r\n                text: \"swampcook noloreteach answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    recipes: [\r\n                        {category: \"cooking\", subcategory: \"items\", recipe_id: \"Alligator jerky\"},\r\n                        {category: \"cooking\", subcategory: \"items\", recipe_id: \"Turtle jerky\"},\r\n                        {category: \"cooking\", subcategory: \"items\", recipe_id: \"Snake jerky\"},\r\n                        {category: \"cooking\", subcategory: \"items\", recipe_id: \"Swampland skewer\"},\r\n                    ],\r\n                },  \r\n                locks_lines: [\"swampcook noloreteach\"],\r\n            }),\r\n            \"swampcook obaru\": new Textline({\r\n                name: \"swampcook obaru\",\r\n                text: \"swampcook obaru answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook obaru\"],\r\n            }),\r\n            \"swampcook kazoku\": new Textline({\r\n                name: \"swampcook kazoku\",\r\n                text: \"swampcook kazoku answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook kazoku\"],\r\n            }),\r\n            \"swampcook sosso\": new Textline({\r\n                name: \"swampcook sosso\",\r\n                text: \"swampcook sosso answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook sosso\"],\r\n            }),\r\n            \"swampcook zalgo\": new Textline({\r\n                name: \"swampcook zalgo\",\r\n                text: \"swampcook zalgo answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook zalgo\"],\r\n            }),\r\n            \"swampcook menaka\": new Textline({\r\n                name: \"swampcook menaka\",\r\n                text: \"swampcook menaka answ\",\r\n                is_unlocked: false,\r\n            }),\r\n            \"swampcook tumana\": new Textline({\r\n                name: \"swampcook tumana\",\r\n                text: \"swampcook tumana answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swampcook tumana\"],\r\n            }),\r\n        },\r\n        actions: {\r\n            \"swampcook deliver\": new DialogueAction({\r\n                action_id: \"swampcook deliver\",\r\n                starting_text: \"swampcook deliver\",\r\n                description: \"\",\r\n                action_text: \"\",\r\n                success_text: \"swampcook deliver answ\",\r\n                repeatable: false,\r\n                failure_texts: {\r\n                    unable_to_begin: [\"swampcook deliver not\"],\r\n                },\r\n                required: {\r\n                    items_by_id: {\"Crab meat\": {count: 60, remove_on_success: true}},\r\n                },\r\n                attempt_duration: 0,\r\n                success_chances: [1],\r\n                rewards: {\r\n                    quest_progress: [{quest_id: \"In Times of Need\", task_index: 2}],\r\n                    textlines: [\r\n                        {dialogue: \"swampland cook\", lines: [\"swampcook know\", \"swampcook kazoku\"]},\r\n                    ],\r\n                    locks: {\r\n                        textlines: {\"swampland chief\": [\"swampchief mid help\"]},\r\n                    }\r\n                },\r\n                locks_lines: [\"swampcook deliver\", \"swampcook obaru\"],\r\n            }),\r\n        },\r\n        getDescription: ()=>{\r\n            if(dialogues[\"swampland cook\"].actions[\"swampcook deliver\"].is_finished) {\r\n                return \"swampcook description 3\";\r\n            } else if (dialogues[\"swampland cook\"].textlines[\"swampcook help\"].is_finished) {\r\n                return \"swampcook description 2\";\r\n            } else {\r\n                return \"swampcook description 1\";\r\n            }}\r\n        });\r\n    dialogues[\"swampland tailor\"] = new Dialogue({\r\n        //lizard, speaks in verbose diatribes\r\n        name: \"swampland tailor\",\r\n        is_unlocked: false,\r\n        textlines: {\r\n            \"swamptailor interrupt\": new Textline({ // moves forward\r\n                name: \"swamptailor interrupt\",\r\n                text: \"swamptailor interrupt answ\",\r\n                is_unlocked: true,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland tailor\", lines: [\"swamptailor cookword\"]}],\r\n                },\r\n                locks_lines: [\"swamptailor interrupt\", \"swamptailor listen1\", \"swamptailor listen2\", \"swamptailor listen3\", \"swamptailor listen4\", \"swamptailor listen5\", \"swamptailor listen6\", \"swamptailor listen7\", \"swamptailor listen8\"],\r\n            }),\r\n            \"swamptailor listen1\": new Textline({\r\n                name: \"swamptailor listen1\",\r\n                text: \"swamptailor listen1 answ\",\r\n                is_unlocked: true,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland tailor\", lines: [\"swamptailor listen2\"]}],\r\n                },\r\n                locks_lines: [\"swamptailor listen1\"],\r\n            }),\r\n            \"swamptailor listen2\": new Textline({\r\n                name: \"swamptailor listen2\",\r\n                text: \"swamptailor listen2 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland tailor\", lines: [\"swamptailor listen3\"]}],\r\n                },\r\n                locks_lines: [\"swamptailor listen2\"],\r\n            }),\r\n            \"swamptailor listen3\": new Textline({\r\n                name: \"swamptailor listen3\",\r\n                text: \"swamptailor listen3 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland tailor\", lines: [\"swamptailor listen4\"]}],\r\n                },\r\n                locks_lines: [\"swamptailor listen3\"],\r\n            }),\r\n            \"swamptailor listen4\": new Textline({\r\n                name: \"swamptailor listen4\",\r\n                text: \"swamptailor listen4 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland tailor\", lines: [\"swamptailor listen5\"]}],\r\n                },\r\n                locks_lines: [\"swamptailor listen4\"],\r\n            }),\r\n            \"swamptailor listen5\": new Textline({\r\n                name: \"swamptailor listen5\",\r\n                text: \"swamptailor listen5 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland tailor\", lines: [\"swamptailor listen6\"]}],\r\n                },\r\n                locks_lines: [\"swamptailor listen5\"],\r\n            }),\r\n            \"swamptailor listen6\": new Textline({\r\n                name: \"swamptailor listen6\",\r\n                text: \"swamptailor listen6 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland tailor\", lines: [\"swamptailor listen7\"]}],\r\n                },\r\n                locks_lines: [\"swamptailor listen6\"],\r\n            }),\r\n            \"swamptailor listen7\": new Textline({\r\n                name: \"swamptailor listen7\",\r\n                text: \"swamptailor listen7 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland tailor\", lines: [\"swamptailor listen8\"]}],\r\n                },\r\n                locks_lines: [\"swamptailor listen7\"],\r\n            }),\r\n            \"swamptailor listen8\": new Textline({\r\n                name: \"swamptailor listen8\",\r\n                text: \"swamptailor listen8 answ\",\r\n                is_unlocked: false,\r\n                locks_lines: [\"swamptailor listen8\"],\r\n            }),\r\n            \"swamptailor cookword\": new Textline({\r\n                name: \"swamptailor cookword\",\r\n                text: \"swamptailor cookword answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland tailor\", lines: [\"swamptailor help\"]}],\r\n                },\r\n                locks_lines: [\"swamptailor cookword\"],\r\n            }),\r\n            \"swamptailor help\": new Textline({\r\n                name: \"swamptailor help\",\r\n                text: \"swamptailor help answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland tailor\", lines: [\"swamptailor flax\"]}],\r\n                },\r\n                locks_lines: [\"swamptailor help\"],\r\n            }),\r\n            \"swamptailor flax\": new Textline({\r\n                name: \"swamptailor flax\",\r\n                text: \"swamptailor flax answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    actions: [{dialogue: \"swampland tailor\", action: \"swamptailor deliver\"}],\r\n                    activities: [{location: \"Riverbank\", activity: \"herbalism\"}],\r\n                    quest_progress: [{quest_id: \"In Times of Need\", task_index: 4}],\r\n                },\r\n                locks_lines: [\"swamptailor flax\"],\r\n            }),\r\n            \"swamptailor liked\": new Textline({\r\n                name: \"swamptailor liked\",\r\n                text: \"swamptailor liked answ\",\r\n                is_unlocked: false,\r\n            }),\r\n        },\r\n        actions: {\r\n            \"swamptailor deliver\": new DialogueAction({\r\n                action_id: \"swamptailor deliver\",\r\n                starting_text: \"swamptailor deliver\",\r\n                description: \"\",\r\n                action_text: \"\",\r\n                success_text: \"swamptailor deliver answ\",\r\n                repeatable: false,\r\n                failure_texts: {\r\n                    unable_to_begin: [\"swamptailor deliver not\"],\r\n                },\r\n                required: {\r\n                    items_by_id: {\"Flax\": {count: 200, remove_on_success: true}},\r\n                },\r\n                attempt_duration: 0,\r\n                success_chances: [1],\r\n                rewards: {\r\n                    quest_progress: [{quest_id: \"In Times of Need\", task_index: 5}], \r\n                    textlines: [{dialogue: \"swampland tailor\", lines: [\"swamptailor liked\"]}],\r\n                    recipes: [{category: \"crafting\", subcategory: \"items\", recipe_id: \"Linen cloth\"}],\r\n                    dialogues: [\"swampland tanner\"],\r\n                },\r\n                locks_lines: [\"swamptailor deliver\"],\r\n            }),\r\n        },\r\n        getDescription: ()=>{\r\n            if(dialogues[\"swampland tailor\"].actions[\"swamptailor deliver\"].is_finished) {\r\n                return \"swamptailor description 3\";\r\n            } else if (dialogues[\"swampland tailor\"].textlines[\"swamptailor interrupt\"].is_finished) {\r\n                return \"swamptailor description 2\";\r\n            } else {\r\n                return \"swamptailor description 1\";\r\n            }}\r\n        });\r\n    dialogues[\"swampland tanner\"] = new Dialogue({\r\n        //lizard, speaks in short sentences\r\n        name: \"swampland tanner\",\r\n        is_unlocked: false,\r\n        textlines: {\r\n            \"swamptanner unknown\": new Textline({\r\n                name: \"swamptanner unknown\",\r\n                text: \"swamptanner unknown answ\",\r\n                is_unlocked: true,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland tanner\", lines: [\"swamptanner help\"]}],\r\n                },\r\n                locks_lines: [\"swamptanner unknown\"],\r\n            }),\r\n            \"swamptanner help\": new Textline({\r\n                name: \"swamptanner help\",\r\n                text: \"swamptanner help answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    quest_progress: [{quest_id: \"In Times of Need\", task_index: 6}], \r\n                    actions: [{dialogue: \"swampland tanner\", action: [\"swamptanner deliver 1\"]}],\r\n                },\r\n                locks_lines: [\"swamptanner help\"],\r\n            }),\r\n            \"swamptanner known\": new Textline({\r\n                name: \"swamptanner known\",\r\n                text: \"swamptanner known answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    quest_progress: [{quest_id: \"In Times of Need\", task_index: 8}], \r\n                    actions: [{dialogue: \"swampland tanner\", action: [\"swamptanner deliver 2\"]}],\r\n                },\r\n                locks_lines: [\"swamptanner known\"],\r\n            }),\r\n            \"swamptanner liked\": new Textline({\r\n                name: \"swamptanner liked\",\r\n                text: \"swamptanner liked answ\",\r\n                is_unlocked: false,\r\n            }),\r\n        },\r\n        actions: {\r\n            \"swamptanner deliver 1\": new DialogueAction({\r\n                action_id: \"swamptanner deliver 1\",\r\n                starting_text: \"swamptanner deliver 1\",\r\n                description: \"\",\r\n                action_text: \"\",\r\n                success_text: \"swamptanner deliver 1 answ\",\r\n                repeatable: false,\r\n                failure_texts: {\r\n                    unable_to_begin: [\"swamptanner deliver 1 not\"],\r\n                },\r\n                required: {\r\n                    items_by_id: {\"Alligator skin\": {count: 60, remove_on_success: true}},\r\n                },\r\n                attempt_duration: 0,\r\n                success_chances: [1],\r\n                rewards: {\r\n                    quest_progress: [{quest_id: \"In Times of Need\", task_index: 7}], \r\n                    textlines: [{dialogue: \"swampland tanner\", lines: [\"swamptanner known\"]}],\r\n                },\r\n                locks_lines: [\"swamptanner deliver 1\"],\r\n            }),\r\n            \"swamptanner deliver 2\": new DialogueAction({\r\n                action_id: \"swamptanner deliver 2\",\r\n                starting_text: \"swamptanner deliver 2\",\r\n                description: \"\",\r\n                action_text: \"\",\r\n                success_text: \"swamptanner deliver 2 answ\",\r\n                repeatable: false,\r\n                failure_texts: {\r\n                    unable_to_begin: [\"swamptanner deliver 2 not\"],\r\n                },\r\n                required: {\r\n                    items_by_id: {\"Giant snake skin\": {count: 60, remove_on_success: true}},\r\n                },\r\n                attempt_duration: 0,\r\n                success_chances: [1],\r\n                rewards: {\r\n                    quest_progress: [{quest_id: \"In Times of Need\", task_index: 9}],\r\n                    textlines: [{dialogue: \"swampland tanner\", lines: [\"swamptanner liked\"]}, {dialogue: \"swampland chief\", lines: [\"swampchief report\"]}],\r\n                    recipes: [\r\n                        {category: \"butchering\", subcategory: \"items\", recipe_id: \"Piece of alligator leather\"},\r\n                        {category: \"butchering\", subcategory: \"items\", recipe_id: \"Piece of snakeskin leather\"},\r\n                        {category: \"butchering\", subcategory: \"items\", recipe_id: \"Turtle shellplate\"},\r\n                    ],\r\n                    locks: {\r\n                        textlines: {\"swampland chief\": [\"swampchief mid help\"]},\r\n                    }\r\n                },\r\n                locks_lines: [\"swamptanner deliver 2\"],\r\n            }),\r\n        },\r\n        getDescription: ()=>{ \r\n            if(dialogues[\"swampland tanner\"].actions[\"swamptanner deliver 2\"].is_finished) {\r\n                return \"swamptanner description 3\";\r\n            } else if (dialogues[\"swampland tanner\"].actions[\"swamptanner deliver 1\"].is_finished) {\r\n                return \"swamptanner description 2\";\r\n            } else {\r\n                return \"swamptanner description 1\";\r\n            }}\r\n        });\r\n\r\n\tdialogues[\"swampland scout\"] = new Dialogue({\r\n        //lizard, speaks in rambling run-on sentences with long pauses\r\n        name: \"swampland scout\",\r\n        textlines: {\r\n            \"swampscout meet\": new Textline({\r\n                name: \"swampscout meet\",\r\n                text: \"swampscout meet answ\",\r\n                is_unlocked: true,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland scout\", lines: [\"swampscout lore1\"]}],\r\n                },\r\n                locks_lines: [\"swampscout meet\"],\r\n            }),\r\n            \"swampscout lore1\": new Textline({\r\n                name: \"swampscout lore1\",\r\n                text: \"swampscout lore1 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland scout\", lines: [\"swampscout lore2\"]}],\r\n                },\r\n                locks_lines: [\"swampscout lore1\"],\r\n            }),\r\n            \"swampscout lore2\": new Textline({\r\n                name: \"swampscout lore2\",\r\n                text: \"swampscout lore2 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland scout\", lines: [\"swampscout lore3\"]}],\r\n                },\r\n                locks_lines: [\"swampscout lore2\"],\r\n            }),\r\n            \"swampscout lore3\": new Textline({\r\n                name: \"swampscout lore3\",\r\n                text: \"swampscout lore3 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland scout\", lines: [\"swampscout lore4\"]}],\r\n                },\r\n                locks_lines: [\"swampscout lore3\"],\r\n            }),\r\n            \"swampscout lore4\": new Textline({\r\n                name: \"swampscout lore4\",\r\n                text: \"swampscout lore4 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland scout\", lines: [\"swampscout lore5\"]}],\r\n                },\r\n                locks_lines: [\"swampscout lore4\"],\r\n            }),\r\n            \"swampscout lore5\": new Textline({\r\n                name: \"swampscout lore5\",\r\n                text: \"swampscout lore5 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland scout\", lines: [\"swampscout lore6\"]}],\r\n                },\r\n                locks_lines: [\"swampscout lore5\"],\r\n            }),\r\n            \"swampscout lore6\": new Textline({\r\n                name: \"swampscout lore6\",\r\n                text: \"swampscout lore6 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland scout\", lines: [\"swampscout lore7\"]}],\r\n                },\r\n                locks_lines: [\"swampscout lore6\"],\r\n            }),\r\n            \"swampscout lore7\": new Textline({\r\n                name: \"swampscout lore7\",\r\n                text: \"swampscout lore7 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [{dialogue: \"swampland scout\", lines: [\"swampscout lore8\"]}],\r\n                },\r\n                locks_lines: [\"swampscout lore7\"],\r\n            }),\r\n            \"swampscout lore8\": new Textline({\r\n                name: \"swampscout lore8\",\r\n                text: \"swampscout lore8 answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    textlines: [\r\n                        {dialogue: \"swampland scout\", lines: [\"swampscout generic\"]},\r\n                        {dialogue: \"swampland scout\", lines: [\"swampscout foraging\"]}\r\n                    ],\r\n                },\r\n                locks_lines: [\"swampscout lore8\"],\r\n            }),\r\n            \"swampscout generic\": new Textline({\r\n                name: \"swampscout generic\",\r\n                text: \"swampscout generic answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    actions: [\r\n                        {dialogue: \"swampland scout\", action: [\"swampscout help\"]},\r\n                    ],\r\n                },\r\n            }),\r\n            \"swampscout foraging\": new Textline({\r\n                name: \"swampscout foraging\",\r\n                text: \"swampscout foraging answ\",\r\n                is_unlocked: false,\r\n                rewards: {\r\n                    actions: [{location: \"Longhouse\", action: \"learn forage\"}],\r\n                },\r\n                locks_lines: [\"swampscout foraging\"],\r\n            }),\r\n        },\r\n        actions: {\r\n            \"swampscout help\": new DialogueAction({\r\n                action_id: \"swampscout help\",\r\n                starting_text: \"swampscout help\",\r\n                description: \"\",\r\n                action_text: \"\",\r\n                success_text: \"swampscout help answ\",\r\n                repeatable: false,\r\n                failure_texts: {\r\n                    unable_to_begin: [\"swampscout help not\"],\r\n                },\r\n                required: {\r\n                    items_by_id: {\"Healing potion\": {count: 1, remove_on_success: true}},\r\n                },\r\n                attempt_duration: 0,\r\n                success_chances: [1],\r\n            }),\r\n        },\r\n        getDescription: ()=>{\r\n            if(dialogues[\"swampland scout\"].actions[\"swampscout help\"].is_finished) {\r\n                return \"swampscout description 4\";\r\n            } else if (dialogues[\"swampland scout\"].textlines[\"swampscout foraging\"].is_finished) {\r\n                return \"swampscout description 3\";\r\n            } else if (dialogues[\"swampland scout\"].textlines[\"swampscout meet\"].is_finished) {\r\n                return \"swampscout description 2\";\r\n            } else {\r\n                return \"swampscout description 1\";\r\n            }}\r\n        });\r\n\r\n    /*\r\n    dialogues[\"cute little rat\"] = new Dialogue({\r\n        name: \"cute little rat\",\r\n        description: \"You see a cute little rat. It appears completely harmless. It has a cute litle crown on its cute little head and is sitting on a cute little comfortable pillow.\",\r\n        textlines: {\r\n            \"hello\": new Textline({ \r\n                name: \"Uhm, hi?\",\r\n                text: \"Hello, o mighty adventurer!\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"cute little rat\", lines: [\"what\"]}],\r\n                },\r\n                locks_lines: [\"hello\"],\r\n            }),\r\n            \"what\": new Textline({ \r\n                name: \"What... are you?\",\r\n                text: \"My name be Ratzor Rathai, the Rat Prince Who Be Promised!\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"cute little rat\", lines: [\"walls\"]}],\r\n                },\r\n                locks_lines: [\"what\"],\r\n            }),\r\n            \"who\": new Textline({ \r\n                name: \"Promised by who?\",\r\n                text: \"By my papa, the great Rat God, of course! The He Who Bring Infite Rat Blessings uppon this dimension!\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"cute little rat\", lines: [\"monsters\"]}],\r\n                },\r\n                locks_lines: [\"who\"],\r\n            }),\r\n            \"monsters\": new Textline({ \r\n                name: \"Are those strange monsters that I fought on the way amonst those 'blessings' you speak of?\",\r\n                text: \"No no, they don't be blessings, they be the blessed! Creatures of all the creation, who embrace the gift of my papa! Monsters, animals, adventurers, plants, papa accepts all!\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"cute little rat\", lines: [\"walls\", \"kill\", \"mind\"]}],\r\n                },\r\n                locks_lines: [\"monsters\"],\r\n            }),\r\n            \"mind\": new Textline({ \r\n                name: \"And you don't mind that I slaughtered so many rats on my way here?\",\r\n                text: \"Why? It's the rule of the world that the strong kill the weak and papa believe it too! Besides, maybe you be join us one day? Embrace the truth of your inner rat and reject the human shell!\",\r\n                locks_lines: [\"mind\"],\r\n            }),\r\n            \"walls\": new Textline({ \r\n                name: \"So some of those wall-like things could have once been human?\",\r\n                text: \"Only in soul. They be given the blessing of papa, but they try to reject but be too weak to really reject so they end up looking funny.\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"cute little rat\", lines: [\"walls\"]}],\r\n                },\r\n                locks_lines: [\"monsters\"],\r\n            }),\r\n            \"kill\": new Textline({ \r\n                name: \"Okay, give me one reason why I shouldn't kill you.\",\r\n                text: \"I don't mind, if I die my soul be return to papa. But my blood be full of papa power, don't do it unless you want to face him personally.\",\r\n                rewards: {\r\n                    textlines: [{dialogue: \"cute little rat\", lines: [\"walls\"]}],\r\n                },\r\n                locks_lines: [\"kill\"],\r\n            }),\r\n        },\r\n    });\r\n    */\r\n})();\r\n\r\n\r\n//setup ids\r\nObject.keys(dialogues).forEach(dialogue_key => {\r\n    const dial = dialogues[dialogue_key];\r\n    dialogues[dialogue_key].id = dialogue_key;\r\n    if(!dialogues[dialogue_key].getName()) {\r\n        dialogues[dialogue_key].name = dialogue_key;\r\n    }\r\n\r\n    Object.keys(dial.textlines).forEach(textline_key => {\r\n        const textline = dial.textlines[textline_key];\r\n        if(textline.locks_lines) {\r\n            if(!textline.rewards.locks.textlines[dialogue_key]) {\r\n                textline.rewards.locks.textlines[dialogue_key] = [];\r\n            }\r\n            textline.rewards.locks.textlines[dialogue_key].push(...textline.locks_lines);\r\n        }\r\n    });\r\n});\r\n\r\nexport {dialogues};", "\"use strict\";\r\n\r\nconst activities = {};\r\n\r\n/*\r\n    A bit complicated with activities defined both here and in locations, but:\r\n    - multiple locations can have \"same\" activity available, though with different xp/money gains\r\n    - activity can be overall unlocked, but not yet available in specific location (or vice versa)\r\n*/\r\n\r\nclass Activity {\r\n    constructor({ name,\r\n                  description,\r\n                  action_text,\r\n                  base_skills_names,\r\n                  is_unlocked = false,\r\n                  getBackgroundNoises,\r\n        }) \r\n    {\r\n        this.name = name;\r\n        this.description = description; //description on job\r\n        this.action_text = action_text; //text displayed in action div, e.g. \"Working the fields\"\r\n        this.base_skills_names = base_skills_names;\r\n        //skills that affect efficiency of an activity and are raised when performing it\r\n        //originally meant to allow multiple, but with current implementation of stuff, doing that would break a lot of things\r\n        this.tags = [];\r\n        this.is_unlocked = is_unlocked;\r\n\r\n        this.getBackgroundNoises = getBackgroundNoises || function(){return [];}\r\n    }\r\n}\r\n\r\nclass Job extends Activity {\r\n    constructor(activity_data) {\r\n        super(activity_data);\r\n        this.type = \"JOB\";\r\n        this.payment_type = activity_data.payment_type;\r\n    }\r\n}\r\n\r\nclass Training extends Activity {\r\n    constructor(activity_data) {\r\n        super(activity_data);\r\n        this.type = \"TRAINING\";\r\n    }\r\n}\r\n\r\nclass Gathering extends Training {\r\n    constructor({ name,\r\n        description,\r\n        action_text,\r\n        base_skills_names,\r\n        is_unlocked = false,\r\n        required_tool_type,\r\n        getBackgroundNoises = null\r\n    }) {\r\n        super({name, description, action_text, base_skills_names, is_unlocked, getBackgroundNoises});\r\n        this.type = \"GATHERING\";\r\n        this.tags[\"gathering\"] = true;\r\n        this.required_tool_type = required_tool_type;\r\n        //drops are defined in locations\r\n    }\r\n}\r\n/*\r\n    All 3 types of activity can yield loot.\r\n    For trainings and jobs, it doesn't require a tool and is a small bonus on top of xp/money, plus their skills get xp every tick.\r\n    For gatherings, tools are required and loot is the main focus, plus their skills get xp when work period is finished\r\n*/\r\n\r\n//jobs\r\n(function(){\r\n    activities[\"fieldwork\"] = new Job({\r\n        name: \"fieldwork\",\r\n        action_text: \"Working on the fields\",\r\n        description: \"It's tiring and doesn't pay much, but it's better than doing nothing\",\r\n        base_skills_names: [\"Farming\"],\r\n        is_unlocked: true,\r\n    });\r\n    activities[\"patrolling\"] = new Job({\r\n        name: \"patrolling\",\r\n        action_text: \"Patrolling\",\r\n        description: \"Nothing ever happens\",\r\n        base_skills_names: [\"Spatial awareness\"],\r\n        is_unlocked: true,\r\n    })\r\n})();\r\n\r\n//trainings\r\n(function(){\r\n    activities[\"running\"] = new Training({\r\n        name: \"running\",\r\n        action_text: \"Just running around\",\r\n        description: \"One of the most basic exercises\",\r\n        base_skills_names: [\"Running\"],\r\n        is_unlocked: true,\r\n    });\r\n    activities[\"weightlifting\"] = new Training({\r\n        name: \"weightlifting\",\r\n        action_text: \"Carrying heavy things\",\r\n        description: \"One of the most basic exercises\",\r\n        base_skills_names: [\"Weightlifting\"],\r\n        is_unlocked: true,\r\n    });\r\n    activities[\"balancing\"] = new Training({\r\n        name: \"balancing\",\r\n        action_text: \"Trying to keep your balance\",\r\n        description: \"One of the most basic exercises\",\r\n        base_skills_names: [\"Equilibrium\"],\r\n        is_unlocked: true,\r\n    });\r\n    activities[\"swimming\"] = new Training({\r\n        name: \"swimming\",\r\n        action_text: \"Splish, splash, splosh\",\r\n        description: \"A rather basic, although somewhat risky exercise\",\r\n        base_skills_names: [\"Swimming\"],\r\n        is_unlocked: false,\r\n    });\r\n    activities[\"meditating\"] = new Training({\r\n        name: \"meditating\",\r\n        action_text: \"Focusing your mind\",\r\n        description: \"A somewhat basic exercise\",\r\n        base_skills_names: [\"Meditation\"],\r\n        is_unlocked: true,\r\n    });\r\n    activities[\"climbing\"] = new Training({\r\n        name: \"climbing\",\r\n        action_text: \"Looking for next grip to hold to\",\r\n        description: \"An advanced exercise that uses majority of muscles in the body\",\r\n        base_skills_names: [\"Climbing\"],\r\n        is_unlocked: false,\r\n    });\r\n    activities[\"enduring\"] = new Training({\r\n        name: \"enduring\",\r\n        action_text: \"Withstanding the elements\",\r\n        description: \"An advanced technique that hardens your resolve more than your body\",\r\n        base_skills_names: [\"Persistence\"],\r\n        is_unlocked: true,\r\n    });\r\n})();\r\n\r\n//resource gatherings\r\n(function(){\r\n    activities[\"mining\"] = new Gathering({\r\n        name: \"mining\",\r\n        action_text: \"Swinging the pickaxe\",\r\n        description: \"Swing you pickaxe against the hard rock\",\r\n        base_skills_names: [\"Mining\"],\r\n        is_unlocked: true,\r\n        required_tool_type: \"pickaxe\",\r\n        getBackgroundNoises: () => [\"clang clang\", \"clink clink\", \"tink tink\", \"crunch\", \"*Your pickaxe strikes the heart of the rock*\"]\r\n    });\r\n    activities[\"digging\"] = new Gathering({\r\n        name: \"digging\",\r\n        action_text: \"Swinging the shovel\",\r\n        description: \"Dig up useful materials with a shovel\",\r\n        base_skills_names: [\"Digging\"],\r\n        is_unlocked: true,\r\n        required_tool_type: \"shovel\",\r\n        getBackgroundNoises: () => [\"plap plap\", \"plop plop\", \"crunch\", \"thwack\", \"scrape\", \"squelch\"]\r\n    });\r\n    activities[\"woodcutting\"] = new Gathering({\r\n        name: \"woodcutting\",\r\n        action_text: \"Gathering wood\",\r\n        description: \"Chop chop\",\r\n        base_skills_names: [\"Woodcutting\"],\r\n        is_unlocked: true,\r\n        required_tool_type: \"axe\",\r\n        getBackgroundNoises: () => [\"chop\", \"CHOP chop\", \"chop CHOP\", \"chop chop\", \"creeeak\", \"Sap oozes from the gash\", \"*Splinters burst from under your axe*\", \"*A pinecone falls on you*\", \"*A squirrel is upset with you*\"]\r\n    });\r\n\r\n    activities[\"herbalism\"] = new Gathering({\r\n        name: \"herbalism\",\r\n        action_text: \"Searching for herbs\",\r\n        description: \"Look for any useful plants and mushrooms\",\r\n        base_skills_names: [\"Herbalism\"],\r\n        is_unlocked: true,\r\n        required_tool_type: \"sickle\",\r\n        getBackgroundNoises: () => [\"*rustle*\", \"A frog is watching you work\", \"You find a particularly impressive snail under a leaf\"]\r\n    });\r\n\r\n    activities[\"animal care\"] = new Gathering({\r\n        name: \"animal care\",\r\n        action_text: \"Tending to animals\",\r\n        description: \"Take care of animals\",\r\n        base_skills_names: [\"Animal handling\"],\r\n        is_unlocked: true,\r\n    });\r\n\r\n    activities[\"fishing\"] = new Gathering({\r\n        name: \"fishing\",\r\n        action_text: \"Waiting for a bite\",\r\n        description: \"Try to catch some fish\",\r\n        base_skills_names: [\"Fishing\"],\r\n        is_unlocked: true,\r\n        required_tool_type: \"fishing_pole\",\r\n        getBackgroundNoises: () => [\"*Nothing bites*\", \"*You feel a light tug, but no bite*\", \"*The fish escapes before you can reel it in*\", \"*The fish steals your bait*\", \"*Your catch gets swiped by a bigger fish*\", \"*Your catch gets swiped by a passing bird*\", \"*Your catch flies away*\"]\r\n    });\r\n})();\r\n\r\n\r\nexport {activities, Gathering};", "\"use strict\";\r\n\r\nimport { get_total_skill_coefficient } from \"./character.js\";\r\nimport { log_message } from \"./display.js\";\r\nimport { add_active_effect } from \"./main.js\";\r\n\r\nlet enemy_templates = {};\r\nlet enemy_killcount = {};\r\n//enemy templates; locations create new enemies based on them\r\n\r\nconst enemy_sizes = {\r\n    SMALL: \"small\",\r\n    MEDIUM: \"medium\",\r\n    LARGE: \"large\",\r\n}\r\n\r\n//tag: skill\r\nconst droprate_modifier_skills_for_tags = {\r\n    \"beast\": \"Butchering\",\r\n}\r\n\r\n//tag: [skills], since some skills might be tag-specific and some might affect multiple tags\r\nconst enemy_tag_to_skill_mapping = {\r\n    small: [\"Pest killer\"],\r\n    large: [\"Giant slayer\"],\r\n}\r\n\r\nconst tags_for_droprate_modifier_skills = {};\r\nObject.keys(droprate_modifier_skills_for_tags).forEach(tag => {\r\n    tags_for_droprate_modifier_skills[droprate_modifier_skills_for_tags[tag]] = tag;\r\n});\r\n\r\nclass Enemy {\r\n    constructor({\r\n        name, \r\n        id,\r\n        description, \r\n        xp_value = 1, \r\n        stats, \r\n        rank,\r\n        loot_list = [], \r\n        size = \"small\",\r\n        add_to_bestiary = true,\r\n        tags = [],\r\n        on_hit = (character) => { },\r\n        on_damaged = (character) => { },\r\n        on_death = (character) => { },\r\n    }) {\r\n                    \r\n        this.name = name;\r\n        this.id = id;\r\n        this.rank = rank; //only for the bestiary order; higher rank => higher in display\r\n        this.description = description; //try to keep it short\r\n        this.xp_value = xp_value;\r\n        this.stats = stats;\r\n        //only magic & defense can be 0 in stats, other things will cause issues\r\n        this.stats.max_health = stats.health;\r\n        this.loot_list = loot_list;\r\n        this.tags = {};\r\n        for(let i = 0; i <tags.length; i++) {\r\n            this.tags[tags[i]] = true;\r\n        }\r\n        this.tags[size] = true;\r\n\r\n        this.add_to_bestiary = add_to_bestiary; //generally set it false only for SOME of challenges and keep true for everything else\r\n\r\n        if(size !== enemy_sizes.SMALL && size !== enemy_sizes.MEDIUM && size !== enemy_sizes.LARGE) {\r\n            throw new Error(`No such enemy size option as \"${size}\"!`);\r\n        } else {\r\n            this.size = size;\r\n        }\r\n\r\n        this.on_hit = on_hit;\r\n        this.on_damaged = on_damaged;\r\n        this.on_death = on_death;\r\n        //try to limit the usage of those 3\r\n    }\r\n    get_loot({drop_chance_modifier = 1} = {}) {\r\n        // goes through items and calculates drops\r\n        // result is in form [{item: Item, count: item_count}, {...}, {...}]\r\n        let loot = [];\r\n        let item;\r\n        \r\n        for (let i = 0; i < this.loot_list.length; i++) {\r\n            item = this.loot_list[i];\r\n            if(item.chance * this.get_droprate_modifier(drop_chance_modifier) >= Math.random()) {\r\n                // checks if it should drop\r\n                let item_count = 1;\r\n                if(\"count\" in item) {\r\n                    item_count = Math.round(Math.random() * (item[\"count\"][\"max\"] - item[\"count\"][\"min\"]) + item[\"count\"][\"min\"]);\r\n                    // calculates how much drops (from range min-max, both inclusive)\r\n                }\r\n                loot.push({item_id: item.item_name, \"count\": item_count });\r\n            }\r\n        }\r\n\r\n        return loot;\r\n    }\r\n\r\n    /**\r\n     * does kinda nothing nowadays, used to be more important, but leaving it in case some more things impacting droprate are added\r\n     * @param {*} drop_chance_modifier \r\n     * @returns \r\n     */\r\n    get_droprate_modifier(drop_chance_modifier = 1) {\r\n        let droprate_modifier = 1 * drop_chance_modifier;\r\n\r\n        Object.keys(this.tags).forEach(tag => {\r\n            if(droprate_modifier_skills_for_tags[tag]) {\r\n                droprate_modifier *= get_total_skill_coefficient({ skill_id: droprate_modifier_skills_for_tags[tag], scaling_type: \"multiplicative\" });\r\n            }\r\n        });\r\n\r\n        return droprate_modifier;\r\n    }\r\n}\r\n\r\nconst enemy_abilites = {\r\n    bufotoxin(duration) {\r\n        let statuses = [\"Irritation\", \"Confusion\", \"Hallucinations\",\r\n            \"Weak necrotizing venom\", \"Mild necrotizing venom\",\r\n            \"Paralysing poison\", \"Infected lungs\", \"Convulsive poison\"];\r\n\r\n        add_active_effect(\r\n            statuses[Math.floor(Math.random() * statuses.length)],\r\n            duration);\r\n    }\r\n};\r\n\r\n//regular enemies\r\n(function(){\r\n    /*\r\n    lore note:\r\n    wolf rats are semi-magical creatures that feed on natural magical energy; cave near the village, where they live, is filled up with it on lower levels, \r\n    providing them with a perfect environment;\r\n    rats on the surface are ones that were kicked out (because space is limited and they were weak), half starving and trying to quench their hunger by eating plants and stuff\r\n    \r\n\r\n    */\r\n    enemy_templates[\"Starving wolf rat\"] = new Enemy({\r\n        name: \"Starving wolf rat\",\r\n        description: \"Rat with size of a dog, starved and weakened\",\r\n        xp_value: 1,\r\n        rank: 1,\r\n        size: \"small\",\r\n        tags: [\"living\", \"beast\", \"wolf rat\"],\r\n        stats: {health: 20, attack: 4, agility: 5, dexterity: 4, magic: 0, intuition: 5, attack_speed: 0.8, defense: 1},\r\n        loot_list: [\r\n            {item_name: \"Rat tail\", chance: 0.04},\r\n            {item_name: \"Rat fang\", chance: 0.04},\r\n            {item_name: \"Rat pelt\", chance: 0.01}\r\n        ]\r\n    });\r\n\r\n    enemy_templates[\"Wolf rat\"] = new Enemy({\r\n        name: \"Wolf rat\",\r\n        description: \"Rat with size of a dog\",\r\n        xp_value: 1,\r\n        rank: 1,\r\n        size: \"small\",\r\n        tags: [\"living\", \"beast\", \"wolf rat\"],\r\n        stats: {health: 30, attack: 6, agility: 6, dexterity: 5, intuition: 6, magic: 0, attack_speed: 1, defense: 2},\r\n        loot_list: [\r\n            {item_name: \"Rat tail\", chance: 0.04},\r\n            {item_name: \"Rat fang\", chance: 0.04},\r\n            {item_name: \"Rat pelt\", chance: 0.01},\r\n        ]\r\n    });\r\n    enemy_templates[\"Elite wolf rat\"] = new Enemy({\r\n        name: \"Elite wolf rat\",\r\n        description: \"Rat with size of a dog, much more ferocious than its relatives\",\r\n        xp_value: 4,\r\n        rank: 2,\r\n        size: enemy_sizes.SMALL,\r\n        tags: [\"living\", \"beast\", \"wolf rat\"],\r\n        stats: {health: 80, attack: 32, agility: 30, dexterity: 24, intuition: 24, magic: 0, attack_speed: 1.5, defense: 8},\r\n        loot_list: [\r\n            {item_name: \"Rat tail\", chance: 0.04},\r\n            {item_name: \"Rat fang\", chance: 0.04},\r\n            {item_name: \"Rat pelt\", chance: 0.02},\r\n        ]\r\n    });\r\n    enemy_templates[\"Elite wolf rat guardian\"] = new Enemy({\r\n        name: \"Elite wolf rat guardian\",\r\n        description: \"It's no longer dog-sized, but rather around the size of an average wolf, with thicker skin, longer claws and pure insanity in the eyes\",\r\n        xp_value: 15,\r\n        rank: 4,\r\n        size: enemy_sizes.MEDIUM,\r\n        tags: [\"living\", \"beast\", \"wolf rat\", \"monster\"],\r\n        stats: {health: 600, attack: 60, agility: 50, dexterity: 50, intuition: 50, magic: 0, attack_speed: 1.2, defense: 30},\r\n        loot_list: [\r\n            {item_name: \"Rat tail\", chance: 0.04},\r\n            {item_name: \"Rat fang\", chance: 0.04},\r\n            {item_name: \"Rat pelt\", chance: 0.02},\r\n            {item_name: \"Weak monster bone\", chance: 0.005},\r\n        ]\r\n    });\r\n    enemy_templates[\"Wall rat\"] = new Enemy({\r\n        name: \"Wall rat\",\r\n        description: \"They don't live in the walls, they ARE the walls. Insane writhing masses of teeth, fangs, and tails, that make no logical sense. An abomination that cannot exist, and yet it does\",\r\n        xp_value: 50,\r\n        rank: 8,\r\n        size: enemy_sizes.LARGE,\r\n        tags: [\"living\", \"beast\", \"wolf rat\", \"monster\", \"eldritch\"],\r\n        stats: {health: 4000, attack: 100, agility: 2, dexterity: 120, intuition: 200, magic: 0, attack_speed: 2, attack_count: 4, defense: 20},\r\n        loot_list: [\r\n            {item_name: \"Rat tail\", chance: 0.08},\r\n            {item_name: \"Rat fang\", chance: 0.08},\r\n        ]\r\n    });\r\n\r\n    enemy_templates[\"Starving wolf\"] = new Enemy({\r\n        name: \"Starving wolf\", description: \"A big, wild and hungry canine\", \r\n        xp_value: 5,\r\n        rank: 2,\r\n        tags: [\"living\", \"beast\"],\r\n        stats: {health: 200, attack: 22, agility: 34, dexterity: 34, intuition: 32, magic: 0, attack_speed: 1, defense: 12},\r\n        loot_list: [\r\n            {item_name: \"Wolf fang\", chance: 0.03},\r\n            {item_name: \"Wolf pelt\", chance: 0.01},\r\n        ],\r\n        size: enemy_sizes.MEDIUM,\r\n    });\r\n\r\n    enemy_templates[\"Young wolf\"] = new Enemy({\r\n        name: \"Young wolf\",\r\n        description: \"A small, wild canine\",\r\n        xp_value: 5,\r\n        rank: 2,\r\n        tags: [\"living\", \"beast\"],\r\n        stats: {health: 150, attack: 25, agility: 34, dexterity: 30, intuition: 24, magic: 0, attack_speed: 1.4, defense: 6},\r\n        loot_list: [\r\n            {item_name: \"Wolf fang\", chance: 0.03},\r\n            {item_name: \"Wolf pelt\", chance: 0.01},\r\n        ],\r\n        size: enemy_sizes.SMALL,\r\n    });\r\n\r\n    enemy_templates[\"Wolf\"] = new Enemy({\r\n        name: \"Wolf\",\r\n        description: \"A large, wild canine\",\r\n        xp_value: 8,\r\n        rank: 3,\r\n        tags: [\"living\", \"beast\"],\r\n        stats: {health: 250, attack: 40, agility: 50, dexterity: 50, intuition: 40, magic: 0, attack_speed: 1.3, defense: 20},\r\n        loot_list: [\r\n            {item_name: \"Wolf fang\", chance: 0.04},\r\n            {item_name: \"Wolf pelt\", chance: 0.02},\r\n            {item_name: \"High quality wolf fang\", chance: 0.0005}\r\n        ],\r\n        size: enemy_sizes.MEDIUM,\r\n    });\r\n\r\n    enemy_templates[\"Direwolf\"] = new Enemy({\r\n        name: \"Direwolf\",\r\n        description: \"A powerful wild wolf variant of unmatched ferocity\",\r\n        xp_value: 20,\r\n        rank: 7,\r\n        tags: [\"living\", \"beast\"],\r\n        stats: {health: 1000, attack: 160, agility: 160, dexterity: 70, intuition: 70, magic: 0, attack_speed: 1.4, defense: 30},\r\n        loot_list: [\r\n            {item_name: \"Wolf fang\", chance: 0.08},\r\n            {item_name: \"Wolf pelt\", chance: 0.04},\r\n            {item_name: \"High quality wolf fang\", chance: 0.001},\r\n            {item_name: \"Weak monster bone\", chance: 0.02}\r\n        ],\r\n        size: enemy_sizes.MEDIUM,\r\n    });\r\n\r\n    enemy_templates[\"Direwolf hunter\"] = new Enemy({\r\n        name: \"Direwolf hunter\",\r\n        description: \"A powerful wild wolf variant of unmatched ferocity, the strongest and heaviest out of all direwolves\",\r\n        xp_value: 30,\r\n        rank: 7,\r\n        tags: [\"living\", \"beast\"],\r\n        stats: {health: 2000, attack: 240, agility: 130, dexterity: 80, intuition: 90, magic: 0, attack_speed: 1.1, defense: 40},\r\n        loot_list: [\r\n            {item_name: \"Wolf fang\", chance: 0.12},\r\n            {item_name: \"Wolf pelt\", chance: 0.06},\r\n            {item_name: \"Weak monster bone\", chance: 0.02},\r\n            {item_name: \"High quality wolf fang\", chance: 0.0015}\r\n        ],\r\n        size: enemy_sizes.MEDIUM,\r\n    });\r\n\r\n    enemy_templates[\"Boar\"] = new Enemy({\r\n        name: \"Boar\",\r\n        description: \"A big wild creature, with thick skin and large tusks\",\r\n        xp_value: 10,\r\n        rank: 4,\r\n        tags: [\"living\", \"beast\"],\r\n        stats: {health: 600, attack: 50, agility: 30, dexterity: 50, intuition: 60, magic: 0, attack_speed: 1, defense: 35},\r\n        loot_list: [\r\n            {item_name: \"Boar hide\", chance: 0.04},\r\n            {item_name: \"Boar meat\", chance: 0.02},\r\n            {item_name: \"Boar tusk\", chance: 0.02},\r\n            {item_name: \"High quality boar tusk\", chance: 0.0005},\r\n        ],\r\n        size: enemy_sizes.MEDIUM,\r\n    });\r\n\r\n    enemy_templates[\"Angry mountain goat\"] = new Enemy({\r\n        name: \"Angry mountain goat\",\r\n        description: \"It's a mountain goat and it's angry\",\r\n        xp_value: 15,\r\n        rank: 6,\r\n        tags: [\"living\", \"beast\"],\r\n        size: enemy_sizes.MEDIUM,\r\n        stats: {health: 600, attack: 120, agility: 100, dexterity: 60, magic: 0, intuition: 60, attack_speed: 0.5, defense: 50},\r\n        loot_list: [\r\n            {item_name: \"Mountain goat hide\", chance: 0.04},\r\n            {item_name: \"Goat meat\", chance: 0.02},\r\n            {item_name: \"Mountain goat horn\", chance: 0.02},\r\n            {item_name: \"Pristine mountain goat horn\", chance: 0.0005},\r\n        ],\r\n    });\r\n\r\n    enemy_templates[\"Forest bear\"] = new Enemy({\r\n        name: \"Forest bear\",\r\n        description: \"A mighty and dangerous predator with thick skin, sharp teeth, and dangerous claws\",\r\n        xp_value: 60,\r\n        rank: 8,\r\n        tags: [\"living\", \"beast\"],\r\n        stats: {health: 6000, attack: 600, agility: 160, dexterity: 200, intuition: 200, magic: 0, attack_speed: 0.8, defense: 500},\r\n        loot_list: [\r\n            {item_name: \"Bear hide\", chance: 0.05},\r\n            {item_name: \"Bear claw\", chance: 0.1},\r\n            {item_name: \"Sharp bear claw\", chance: 0.002},\r\n        ],\r\n        size: enemy_sizes.LARGE,\r\n    });\r\n\r\n    enemy_templates[\"Frog\"] = new Enemy({\r\n        name: \"Frog\",\r\n        description: \"A huge beast with muscular legs and a mouth large enough to swallow a direwolf whole\",\r\n        xp_value: 80,\r\n        rank: 8,\r\n        tags: [\"living\", \"beast\"],\r\n        stats: {health: 8000, attack: 500, agility: 120, dexterity: 200, intuition: 200, magic: 0, attack_speed: 0.8, defense: 500},\r\n        loot_list: [\r\n            {item_name: \"Frog meat\", chance: 0.08},\r\n            {item_name: \"Frog hide\", chance: 0.05},\r\n            {item_name: \"Weak monster bone\", chance: 0.05},\r\n        ],\r\n        size: enemy_sizes.LARGE,\r\n        on_hit: (character) => {\r\n            let roll = Math.random();\r\n            if(roll < 0.2) {\r\n                //todo: add some category for these messages\r\n                log_message(\"The frog's long tongue leaves you covered in sticky saliva!\");\r\n                add_active_effect(\"Sticky\", 30);\r\n            } else if (roll < 0.3) {\r\n                log_message(\"The frog's attack leaves some of its toxins on you!\");\r\n                enemy_abilites.bufotoxin(10);\r\n            }\r\n        },\r\n        on_damaged: (character) => {\r\n            let roll = Math.random();\r\n            if (character.equipment.weapon == null && roll < 0.2) {\r\n                log_message(\"Touching the frog with your bare hands leaves them covered in toxins!\");\r\n                enemy_abilites.bufotoxin(10);\r\n            }\r\n            else if (character.equipment.weapon != null && roll < 0.05) {\r\n                log_message(\"Striking the frog causes some toxins to splash on you!\");\r\n                enemy_abilites.bufotoxin(10);\r\n            }\r\n        },\r\n    });\r\n\r\n    enemy_templates[\"Red ant swarm\"] = new Enemy({\r\n        name: \"Red ant swarm\",\r\n        description: \"A swarm of angry red ants, each the size of a regular rat\",\r\n        xp_value: 20,\r\n        rank: 7,\r\n        tags: [\"living\", \"insect\"],\r\n        stats: {health: 600, attack: 4, agility: 100, dexterity: 200, intuition: 100, magic: 0, attack_speed: 1.5, attack_count: 30, defense: 10},\r\n        size: enemy_sizes.SMALL,\r\n    });\r\n\r\n    enemy_templates[\"Red ant queen\"] = new Enemy({\r\n        name: \"Red ant queen\",\r\n        description: \"A red ant queen, despite her decent size she's not much of a fighter\",\r\n        xp_value: 10,\r\n        rank: 5,\r\n        tags: [\"living\", \"insect\"],\r\n        stats: {health: 200, attack: 20, agility: 50, dexterity: 200, intuition: 100, magic: 0, attack_speed: 0.5, defense: 20},\r\n        size: enemy_sizes.SMALL,\r\n    });\r\n\r\n    enemy_templates[\"Slums thug\"] = new Enemy({\r\n        name: \"Slums thug\",\r\n        description: \"A nasty thug with shabby equipment\",\r\n        xp_value: 10,\r\n        rank: 5,\r\n        tags: [\"living\", \"human\"],\r\n        size: enemy_sizes.MEDIUM,\r\n        stats: {health: 500, attack: 60, agility: 60, dexterity: 60, magic: 0, intuition: 60, attack_speed: 1.7, defense: 45},\r\n    });\r\n\t\r\n\tenemy_templates[\"River crab\"] = new Enemy({\r\n        name: \"River crab\",\r\n        description: \"A crab the size of a small boulder\",\r\n        xp_value: 30,\r\n        rank: 7,\r\n        size: enemy_sizes.SMALL,\r\n        tags: [\"living\", \"beast\", \"aquatic\"],\r\n        stats: {health: 2000, attack: 75, agility: 120, dexterity: 90, intuition: 50, magic: 0, attack_speed: 1.3, attack_count: 2, defense: 145},\r\n        loot_list: [\r\n            {item_name: \"Crab meat\", chance: 0.02},\r\n        ]\r\n    });\r\n\r\n\tenemy_templates[\"Stone crab\"] = new Enemy({\r\n        name: \"Stone crab\",\r\n        description: \"A crab the size of a large boulder, and about as hard to crack open\",\r\n        xp_value: 50,\r\n        rank: 8,\r\n        size: enemy_sizes.MEDIUM,\r\n        tags: [\"living\", \"beast\", \"aquatic\"],\r\n        stats: {health: 7000, attack: 160, agility: 180, dexterity: 160, intuition: 120, magic: 0, attack_speed: 1.7, attack_count: 2, defense: 700},\r\n        loot_list: [\r\n            {item_name: \"Crab meat\", chance: 0.05},\r\n            {item_name: \"Crab claw\", chance: 0.01},\r\n            {item_name: \"Giant crab claw\", chance: 0.005},\r\n        ]\r\n    });\r\n\r\n\tenemy_templates[\"Alligator\"] = new Enemy({\r\n        name: \"Alligator\",\r\n        description: \"An alligator in it's natural habitat is one of the deadliest predators in nature\",\r\n        xp_value: 150,\r\n        rank: 9,\r\n        size: enemy_sizes.LARGE,\r\n        tags: [\"living\", \"beast\", \"aquatic\"],\r\n        stats: {health: 16750, attack: 830, agility: 250, dexterity: 350, intuition: 120, magic: 0, attack_speed: 1.6, defense: 545},\r\n        loot_list: [\r\n            {item_name: \"Alligator meat\", chance: 0.02},\r\n            {item_name: \"Alligator skin\", chance: 0.01},\r\n        ]\r\n    });\r\n\r\n\tenemy_templates[\"Snapping turtle\"] = new Enemy({\r\n        name: \"Snapping turtle\",\r\n        description: \"A large turtle with an incredibly dense shell\",\r\n        xp_value: 250,      //in between alligator and snake because it'll probably take the longest to kill during post-completion grinding\r\n        rank: 10,\r\n        size: enemy_sizes.MEDIUM,\r\n        tags: [\"living\", \"beast\", \"aquatic\"],\r\n        stats: {health: 22000, attack: 525, agility: 230, dexterity: 220, intuition: 130, magic: 0, attack_speed: 0.9, defense: 1000},\r\n        loot_list: [\r\n            {item_name: \"Turtle meat\", chance: 0.02},\r\n            {item_name: \"Turtle shell\", chance: 0.005},\r\n        ]\r\n    });\r\n\r\n\tenemy_templates[\"Giant snake\"] = new Enemy({\r\n        name: \"Giant snake\",\r\n        description: \"This large snake is fast enough to catch even the most cautious warriors by surprise\",\r\n        xp_value: 300,  //more than alligator and turtle because initially the most dangerous\r\n        rank: 10,\r\n        size: enemy_sizes.LARGE,\r\n        tags: [\"living\", \"beast\"],\r\n        stats: {health: 12500, attack: 440, agility: 260, dexterity: 460, intuition: 150, magic: 0, attack_speed: 2.7, defense: 385},\r\n        loot_list: [\r\n            {item_name: \"Giant snake meat\", chance: 0.02},\r\n            {item_name: \"Giant snake skin\", chance: 0.01},\r\n        ]\r\n    });\r\n})();\r\n\r\n\r\n//challenge enemies\r\n(function(){\r\n    enemy_templates[\"Village guard (heavy)\"] = new Enemy({\r\n        name: \"Village guard (heavy)\", \r\n        description: \"\", \r\n        add_to_bestiary: false,\r\n        xp_value: 1,\r\n        rank: 4,\r\n        tags: [\"living\", \"human\"],\r\n        size: enemy_sizes.MEDIUM,\r\n        stats: {health: 300, attack: 50, agility: 20, dexterity: 80, magic: 0, intuition: 20, attack_speed: 0.2, defense: 30},\r\n    });\r\n    enemy_templates[\"Village guard (quick)\"] = new Enemy({\r\n        name: \"Village guard (quick)\", \r\n        description: \"\", \r\n        add_to_bestiary: false,\r\n        xp_value: 1,\r\n        rank: 4,\r\n        tags: [\"living\", \"human\"],\r\n        size: enemy_sizes.MEDIUM,\r\n        stats: {health: 300, attack: 20, agility: 20, dexterity: 50, magic: 0, intuition: 20, attack_speed: 2, defense: 10},\r\n    });\r\n    enemy_templates[\"Suspicious wall\"] = new Enemy({\r\n        name: \"Suspicious wall\", \r\n        description: \"\", \r\n        add_to_bestiary: false,\r\n        xp_value: 1,\r\n        rank: 1,\r\n        tags: [\"inanimate\"],\r\n        size: enemy_sizes.LARGE,\r\n        stats: {health: 10000, attack: 0, agility: 0, dexterity: 0, magic: 0, intuition: 0, attack_speed: 0.000001, defense: 100},\r\n    });\r\n\r\n    enemy_templates[\"Suspicious man\"] = new Enemy({\r\n        name: \"Suspicious man\", \r\n        description: \"\", \r\n        add_to_bestiary: false,\r\n        xp_value: 1,\r\n        rank: 5,\r\n        tags: [\"living\", \"human\"],\r\n        size: enemy_sizes.MEDIUM,\r\n        stats: {health: 400, attack: 60, agility: 60, dexterity: 60, magic: 0, intuition: 60, attack_speed: 2, defense: 30},\r\n    });\r\n\r\n    enemy_templates[\"Angry-looking mountain goat\"] = new Enemy({\r\n        name: \"Angry-looking mountain goat\", \r\n        description: \"It's a mountain goat and it's angry\", \r\n        add_to_bestiary: false,\r\n        xp_value: 1,\r\n        rank: 6,\r\n        tags: [\"living\", \"beast\"],\r\n        size: enemy_sizes.MEDIUM,\r\n        stats: {health: 1200, attack: 150, agility: 100, dexterity: 70, magic: 0, intuition: 60, attack_speed: 0.5, defense: 60},\r\n    });\r\n\tenemy_templates[\"Giant crab\"] = new Enemy({\r\n        name: \"Giant crab\",\r\n        description: \"This was the biggest crab you had ever seen. It's also the smallest crab you had ever seen\",  //descriptions of challenge fights aren't visible, but this is a joke based on the fact that the player hasn't seen any other crab enemies yet\r\n        add_to_bestiary: false,\r\n        xp_value: 1,\r\n        rank: 11,\r\n        size: enemy_sizes.LARGE,\r\n        tags: [\"living\", \"beast\", \"aquatic\"],\r\n        stats: {health: 25000, attack: 250, agility: 350, dexterity: 580, intuition: 50, magic: 0, attack_speed: 1.3, attack_count: 2, defense: 3500},\r\n    });\r\n\r\n\tenemy_templates[\"Enraged giant crab\"] = new Enemy({     //not working at present, not sure where the problem is\r\n        name: \"Enraged giant crab\",\r\n        description: \"Graa~! Crab battle!\",     //reference to the Metal Gear Solid 3 flash animation \"Crab Battle\"\r\n        add_to_bestiary: false,\r\n        xp_value: 1,\r\n        rank: 11,\r\n        size: enemy_sizes.LARGE,\r\n        tags: [\"living\", \"beast\", \"aquatic\"],\r\n        stats: {health: 18000, attack: 400, agility: 350, dexterity: 680, intuition: 70, magic: 0, attack_speed: 1.6, attack_count: 2, defense: 750},\r\n        loot_list: [{item_name: \"Giant crab claw\", chance: 1}],\r\n    });\r\n\r\n})();\r\n\r\n    Object.keys(enemy_templates).forEach(enemy_key => {\r\n        enemy_templates[enemy_key].id = enemy_key;\r\n    });\r\n\r\n\r\nexport {Enemy, enemy_templates, enemy_killcount, tags_for_droprate_modifier_skills, enemy_tag_to_skill_mapping};", "\"use strict\";\r\n\r\nimport { enemy_templates, Enemy } from \"./enemies.js\";\r\nimport { skills } from \"./skills.js\";\r\nimport { current_game_time } from \"./game_time.js\";\r\nimport { activities } from \"./activities.js\";\r\nimport { get_total_skill_level, is_rat } from \"./character.js\";\r\nimport { GameAction } from \"./actions.js\";\r\nimport { fill_market_regions, market_regions } from \"./market_saturation.js\";\r\nimport { global_flags } from \"./main.js\";\r\nconst locations = {}; //contains all the created locations\r\nconst location_types = {};\r\n\r\nconst favourite_locations = {};\r\n\r\nclass Location {\r\n    constructor({\r\n                name, \r\n                id,\r\n                description, \r\n                connected_locations = [], \r\n                is_unlocked = true, \r\n                is_finished = false,\r\n                dialogues = [], \r\n                traders = [],\r\n                market_region = null,\r\n                types = [], //{type, xp per tick}\r\n                housing = {},\r\n                light_level = \"normal\",\r\n                getDescription,\r\n                background_noises = [],\r\n                getBackgroundNoises,\r\n                crafting = null,\r\n                tags = {},\r\n                is_temperature_static = false,\r\n                static_temperature = null,\r\n                reverse_day_night_temperatures = false,\r\n                temperature_range_modifier = 1,\r\n                temperature_modifier = 0,\r\n                is_under_roof = false,\r\n                entrance_rewards, //rewards gained on entering it, to be used for unlocks\r\n            }) {\r\n        // always a safe zone\r\n\r\n        this.name = name;\r\n        this.id = id;\r\n        this.description = description;\r\n        this.getDescription = getDescription || function(){return description;}\r\n        this.background_noises = background_noises;\r\n        this.getBackgroundNoises = getBackgroundNoises || function(){return background_noises;}\r\n        this.connected_locations = connected_locations; \r\n        //[{location: Location, custom_text: String (replaces 'Go to [X]'), travel_time: Number, travel_time_skills: [String] (skill ids, if skipped defaults to ['Running'])}]\r\n        //for combat zones, it's symmetrical; otherwise it doesn't have to be as such\r\n        //for challenge zones, travel times are expected to be 0 and therefore not displayed, so setting them to something different would require display changes\r\n        this.is_unlocked = is_unlocked;\r\n        this.is_finished = is_finished; //for when it's in any way or form \"completed\" and player shouldn't be allowed back\r\n        this.dialogues = dialogues;\r\n        this.traders = traders;\r\n        this.market_region = market_region; //for separate regions for market saturation\r\n        if(market_region) {\r\n            market_regions[market_region] = true;\r\n        }\r\n        this.activities = {};\r\n        this.actions = {};\r\n        this.types = types;\r\n        this.housing = housing;\r\n        /*\r\n            housing: {\r\n                is_unlocked: Boolean, \r\n                sleeping_xp_per_tick: Number,\r\n                text_to_start: String\r\n            }\r\n        */\r\n\r\n        this.light_level = light_level; //not really used for this type\r\n        this.crafting = crafting;\r\n        this.tags = tags;\r\n        this.tags[\"safe_zone\"] = true;\r\n        this.entrance_rewards = entrance_rewards;\r\n        /* \r\n        crafting: {\r\n            is_unlocked: Boolean, \r\n            use_text: String, \r\n            tiers: {\r\n                crafting: Number,\r\n                forging: Number,\r\n                smelting: Number,\r\n                cooking: Number,\r\n                alchemy: Number,\r\n                butchering: Number,\r\n                woodworking: Number,\r\n            }\r\n        },\r\n         */\r\n\r\n        this.is_temperature_static = is_temperature_static; //true -> uses static temperature, either provided or default\r\n        this.static_temperature = static_temperature;\r\n        this.reverse_day_night_temperatures = reverse_day_night_temperatures; //true -> nights are warmer, days are colder\r\n        this.temperature_range_modifier = temperature_range_modifier; //multiplier to how much temperature varies from base; lower value will make both max and min temps closer do base\r\n        this.temperature_modifier = temperature_modifier; //flat modifier to temperature, applied AFTER range modifier\r\n        this.is_under_roof = is_under_roof; //only for weather display\r\n    }\r\n}\r\n\r\nclass Combat_zone {\r\n    constructor({name, \r\n                id,\r\n                 description, \r\n                 getDescription,\r\n                 is_unlocked = true, \r\n                 is_finished = false,\r\n                 types = [], //{type, xp_gain}\r\n                 enemy_groups_list = [],\r\n                 is_enemy_groups_list_random = true,\r\n                 predefined_lineup_on_nth_group = 1,\r\n                 enemies_list = [], \r\n                 enemy_group_size = [1,1],\r\n                 enemy_count = 30,\r\n                 enemy_stat_variation = 0,\r\n                 parent_location, \r\n                 leave_text,\r\n                 first_reward = {},\r\n                 repeatable_reward = {},\r\n                 rewards_with_clear_requirement = [],\r\n                 otherUnlocks,\r\n                 unlock_text,\r\n                 is_challenge = false,\r\n                 tags = {},\r\n                 is_temperature_static = false,\r\n                 static_temperature = null,\r\n                 reverse_day_night_temperatures = false,\r\n                 temperature_range_modifier = 1,\r\n                 temperature_modifier = 0,\r\n                 is_under_roof = false,\r\n                }) {\r\n\r\n        this.name = name;\r\n        this.id = id;\r\n        this.unlock_text = unlock_text;\r\n        this.description = description;\r\n        this.getDescription = getDescription || function(){return description;}\r\n        this.otherUnlocks = otherUnlocks || function() {return;} //try not to use it if possible\r\n        this.is_unlocked = is_unlocked;\r\n        this.is_finished = is_finished;\r\n        this.types = types; //special properties of the location, e.g. \"narrow\" or \"dark\"\r\n        this.enemy_groups_list = enemy_groups_list; //predefined enemy teams, names only\r\n        this.is_enemy_groups_list_random = is_enemy_groups_list_random; //only used when enemy_groups_list is present; false will result in enemy groups being used in the provided order\r\n        this.predefined_lineup_on_nth_group = predefined_lineup_on_nth_group; //if not 0, every nth fight will be from enemy_groups_list instead of randomized from enemies_list\r\n        this.enemies_list = enemies_list; //possible enemies (to be used if there's no enemy_groups_list or if it exists but is to only be used every n fights), names only\r\n        this.enemy_group_size = enemy_group_size; // [min, max], used only if enemy_groups_list is not provided\r\n        if(!this.enemy_groups_list){\r\n            if(this.enemy_group_size[0] < 1) {\r\n                this.enemy_group_size[0] = 1;\r\n                console.error(`Minimum enemy group size in zone \"${this.name}\" is set to unallowed value of ${this.enemy_group_size[0]} and was corrected to lowest value possible of 1`);\r\n            }\r\n            if(this.enemy_group_size[0] > 8) {\r\n                this.enemy_group_size[0] = 8;\r\n                console.error(`Minimum enemy group size in zone \"${this.name}\" is set to unallowed value of ${this.enemy_group_size[0]} and was corrected to highest value possible of 8`);\r\n            }\r\n            if(this.enemy_group_size[1] < 1) {\r\n                this.enemy_group_size[1] = 1;\r\n                console.error(`Maximum enemy group size in zone \"${this.name}\" is set to unallowed value of ${this.enemy_group_size[1]} and was corrected to lowest value possible of 1`);\r\n            }\r\n            if(this.enemy_group_size[1] > 8) {\r\n                this.enemy_group_size[1] = 8;\r\n                console.error(`Maximum enemy group size in zone \"${this.name}\" is set to unallowed value of ${this.enemy_group_size[1]} and was corrected to highest value possible of 8`);\r\n            }\r\n        }\r\n        this.enemy_count = enemy_count; //how many enemy groups need to be killed for the clearing reward\r\n\r\n        if(this.enemy_groups_list.length == 0 && this.enemies_list.length == 0 ) {\r\n            throw new Error(`No enemies provided for zone \"${this.name}\"`);\r\n        }\r\n\r\n        this.enemy_groups_killed = 0; //killcount for clearing\r\n\r\n        this.enemy_stat_variation = enemy_stat_variation; // e.g. 0.1 means each stat can go 10% up/down from base value; random for each enemy in group\r\n        if(this.enemy_stat_variation < 0) {\r\n            this.enemy_stat_variation = 0;\r\n            console.error(`Stat variation for enemies in zone \"${this.name}\" is set to unallowed value and was corrected to a default 0`);\r\n        }\r\n\r\n        this.parent_location = parent_location;\r\n\r\n        this.leave_text = leave_text; //text on option to leave\r\n        this.first_reward = first_reward; //reward for first clear\r\n        this.repeatable_reward = repeatable_reward; //reward for each clear, including first; all unlocks should be in this, just in case\r\n        this.rewards_with_clear_requirement = rewards_with_clear_requirement; //rewards that are only given on N-th clear\r\n\r\n        this.is_challenge = is_challenge;\r\n        //challenges can be completed only once \r\n\r\n        //skills and their xp gain on every tick, based on location types;\r\n        this.gained_skills = this.types\r\n            ?.map(type => {return {skill: skills[location_types[type.type].stages[type.stage || 1].related_skill], xp: type.xp_gain}})\r\n            .filter(skill => skill.skill);\r\n       \r\n        const temp_types = this.types.map(type => type.type);\r\n        if(temp_types.includes(\"bright\")) {\r\n            this.light_level = \"bright\";\r\n        }\r\n        else if(temp_types.includes(\"dark\")) {\r\n            this.light_level = \"dark\";\r\n        } else {\r\n            this.light_level = \"normal\";\r\n        }\r\n\r\n        this.tags = tags;\r\n        this.tags[\"Combat zone\"] = true;\r\n\r\n        this.is_temperature_static = is_temperature_static; //true -> uses static temperature, either provided or default\r\n        this.static_temperature = static_temperature;\r\n        this.reverse_day_night_temperatures = reverse_day_night_temperatures; //true -> nights are warmer, days are colder\r\n        this.temperature_range_modifier = temperature_range_modifier; //flat modifier to how much temperature varies from base\r\n        this.temperature_modifier = temperature_modifier; //flat modifier to temperature, applied AFTER range modifier\r\n        this.is_under_roof = is_under_roof; //only for weather display\r\n    }\r\n\r\n    get_next_enemies() {\r\n\r\n        const enemies = [];\r\n        let enemy_group = [];\r\n\r\n        if(this.enemy_groups_list.length > 0 && this.enemy_groups_killed%this.predefined_lineup_on_nth_group == 0 && (this.enemy_groups_killed > 0 || this.predefined_lineup_on_nth_group == 0)) { // PREDEFINED GROUPS EXIST\r\n\r\n            if(this.is_enemy_groups_list_random) { \r\n                //choose randomly\r\n                const index = Math.floor(Math.random() * this.enemy_groups_list.length);\r\n                enemy_group = this.enemy_groups_list[index].enemies; //names\r\n            } else { \r\n                //choose in order provided\r\n                const index = this.enemy_groups_killed % this.enemy_groups_list.length;\r\n                enemy_group = this.enemy_groups_list[index].enemies; //names\r\n            }\r\n            \r\n\r\n        } else {  // PREDEFINED GROUPS DON'T EXIST\r\n\r\n            const group_size = this.enemy_group_size[0] + Math.round(Math.random() * (this.enemy_group_size[1] - this.enemy_group_size[0]));\r\n            for(let i = 0; i < group_size; i++) {\r\n                enemy_group.push(this.enemies_list[Math.floor(Math.random() * this.enemies_list.length)]);\r\n            }\r\n        }\r\n \r\n        for(let i = 0; i < enemy_group.length; i++) {\r\n            const enemy = enemy_templates[enemy_group[i]];\r\n            let newEnemy;\r\n\r\n            if(this.enemy_stat_variation != 0) {\r\n\r\n                const variation = Math.random() * this.enemy_stat_variation;\r\n\r\n                const base = 1 + variation;\r\n                const vary = 2 * variation;\r\n                newEnemy = new Enemy({...enemy,\r\n                    stats: {\r\n                        health: Math.round(enemy.stats.health * (base - Math.random() * vary)),\r\n                        attack: Math.round(enemy.stats.attack * (base - Math.random() * vary)),\r\n                        agility: Math.round(enemy.stats.agility * (base - Math.random() * vary)),\r\n                        dexterity: Math.round(enemy.stats.dexterity * (base - Math.random() * vary)),\r\n                        magic: Math.round(enemy.stats.magic * (base - Math.random() * vary)),\r\n                        intuition: Math.round(enemy.stats.intuition * (base - Math.random() * vary)),\r\n                        attack_speed: Math.round(enemy.stats.attack_speed * (base - Math.random() * vary) * 100) / 100,\r\n                        attack_count: Math.round((enemy.stats.attack_count || 1) * (base - Math.random() * vary)),\r\n                        defense: Math.round(enemy.stats.defense * (base - Math.random() * vary))\r\n                    },\r\n                });\r\n\r\n            } else {\r\n                newEnemy = new Enemy({...enemy, stats: {...enemy.stats, attack_count: enemy.stats.attack_count || 1}});\r\n            }\r\n            newEnemy.is_alive = true;\r\n            enemies.push(newEnemy); \r\n        }\r\n        return enemies;\r\n    }\r\n\r\n    //calculates total penalty with and without hero skills\r\n    //launches on every combat action (which is probably suboptimal as it could instead be stored and recalculated only on skill change)\r\n    get_total_effect() {\r\n        const effects = {multipliers: {}, flats: {}};\r\n        const hero_effects = {multipliers: {}, flats: {}};\r\n        \r\n        //iterate over types of location\r\n        for(let i = 0; i < this.types.length; i++) {\r\n            const type = location_types[this.types[i].type].stages[this.types[i].stage];\r\n\r\n            if(!type.related_skill || !type.effects) { \r\n                continue; \r\n            }\r\n\r\n            //iterate over effects each type has \r\n\r\n            Object.keys(type.effects).forEach(stat => { \r\n                if(type.effects[stat].multiplier) {\r\n                    effects.multipliers[stat] = (effects.multipliers[stat] || 1) * type.effects[stat].multiplier;\r\n                \r\n                    hero_effects.multipliers[stat] = (hero_effects.multipliers[stat] || 1) * get_location_type_penalty(this.types[i].type, this.types[i].stage, stat, \"multiplier\");\r\n                }\r\n\r\n                if(type.effects[stat].flat) {\r\n                    effects.flats[stat] = (effects.flats[stat] || 0) + type.effects[stat].flat;\r\n                \r\n                    hero_effects.flats[stat] = (hero_effects.flats[stat] || 0) + get_location_type_penalty(this.types[i].type, this.types[i].stage, stat, \"flat\");\r\n                }\r\n\r\n            })\r\n        }\r\n\r\n        \r\n\r\n        return {base_penalty: effects, hero_penalty: hero_effects};\r\n    }\r\n}\r\n\r\nclass Challenge_zone extends Combat_zone {\r\n    constructor(data) \r\n    {\r\n        super({...data, enemy_stat_variation: 0, is_challenge: true});\r\n    }\r\n}\r\n\r\nclass LocationActivity{\r\n    constructor({activity_name, \r\n                 starting_text, \r\n                 get_payment = ()=>{return 1},\r\n                 is_unlocked = true, \r\n                 working_period = 60,\r\n                 infinite = true,\r\n                 availability_time,\r\n                 availability_seasons,\r\n                 skill_xp_per_tick = 1,\r\n                 unlock_text,\r\n                 gained_resources,\r\n                 require_tool = false,\r\n                 applied_effects = [],\r\n                })\r\n    {\r\n        this.activity_name = activity_name; //name of activity from activities.js\r\n        this.starting_text = starting_text; //text displayed on button to start action\r\n\r\n        this.get_payment = get_payment;\r\n        this.is_unlocked = is_unlocked;\r\n        this.unlock_text = unlock_text;\r\n        this.working_period = working_period; //if exists -> time that needs to be worked to earn anything; only for jobs\r\n        this.infinite = infinite; //if true -> can be done 24/7, otherwise requires availability time/season\r\n\r\n        if(availability_time && availability_seasons) {\r\n            this.infinite = false;\r\n        }\r\n\r\n        if(!this.infinite) {\r\n            if(!(availability_seasons || availability_time)) {\r\n                console.error(\"Activity is set to limited availability, but has neither availability_seasons nor availability_time provided for it\");\r\n            }\r\n        } else if((availability_time || availability_seasons)) {\r\n            this.infinite = false;\r\n        }\r\n        \r\n        this.availability_time = availability_time; //if not infinite -> hours between which it's available; used only for work and for training\r\n        this.availability_seasons = availability_seasons; //if not infinite -> seasons when it's available; used for work and for training\r\n        \r\n        this.skill_xp_per_tick = skill_xp_per_tick; //skill xp gained per game tick (default -> 1 in-game minute)\r\n\r\n        this.require_tool = require_tool; //if false, can be started without tool equipped\r\n\r\n        this.applied_effects = applied_effects;\r\n\r\n        this.gained_resources = gained_resources; \r\n        /*\r\n            {\r\n                scales_with_skill: boolean, \r\n                resources: [{name, ammount: [[min,max], [min,max]], chance: [min,max]}], \r\n                time_period: [min,max], \r\n                skill_required: [min_efficiency, max_efficiency]\r\n            }\r\n        */\r\n        //every 2-value array is oriented [starting_value, value_with_required_skill_level], except for subarrays of ammount (which are for randomizing gained item count) and for skill_required\r\n        //                                                                                   (ammount array itself follows the mentioned orientation)\r\n        //ammounts can be skipped if they are meant to be [[1,1],[1,1]] (auto-filled just below the comments)\r\n        //value start scaling after reaching min_efficiency skill lvl, before that they are just all at min\r\n        //skill required refers to level of every skill\r\n        //if scales_with_skill is false, scalings will be ignored and first value will be used\r\n\r\n        for(let i = 0; i < this.gained_resources?.resources.length; i++) {\r\n            if(!this.gained_resources.resources[i].ammount) {\r\n                this.gained_resources.resources[i].ammount = [[1,1],[1,1]];\r\n            }\r\n        }\r\n    }\r\n\r\n    getActivityEfficiency = function() {\r\n        let skill_modifier = 1;\r\n        if(this.gained_resources.scales_with_skill){\r\n            let skill_level_sum = 0;\r\n            for(let i = 0; i < activities[this.activity_name].base_skills_names?.length; i++) {\r\n                skill_level_sum += Math.min(\r\n                    this.gained_resources.skill_required[1]-this.gained_resources.skill_required[0]+1, Math.max(0,get_total_skill_level(activities[this.activity_name].base_skills_names[i])-this.gained_resources.skill_required[0]+1)\r\n                )/(this.gained_resources.skill_required[1]-this.gained_resources.skill_required[0]+1);\r\n            }\r\n            skill_modifier = (skill_level_sum/(activities[this.activity_name].base_skills_names?.length || 1));\r\n        }\r\n        const gathering_time_needed = Math.floor(this.gained_resources.time_period[0]*(this.gained_resources.time_period[1]/this.gained_resources.time_period[0])**skill_modifier);\r\n\r\n        const gained_resources = [];\r\n\r\n        for(let i = 0; i < this.gained_resources.resources.length; i++) {\r\n\r\n            const chance = this.gained_resources.resources[i].chance[0]*(this.gained_resources.resources[i].chance[1]/this.gained_resources.resources[i].chance[0])**skill_modifier;\r\n            const min = Math.round(this.gained_resources.resources[i].ammount[0][0]*(this.gained_resources.resources[i].ammount[1][0]/this.gained_resources.resources[i].ammount[0][0])**skill_modifier);\r\n            const max = Math.round(this.gained_resources.resources[i].ammount[0][1]*(this.gained_resources.resources[i].ammount[1][1]/this.gained_resources.resources[i].ammount[0][1])**skill_modifier);\r\n            gained_resources.push({name: this.gained_resources.resources[i].name, count: [min,max], chance: chance});\r\n        }\r\n\r\n        return {gathering_time_needed, gained_resources};\r\n    }\r\n}\r\n\r\nclass LocationType{\r\n    constructor({name, related_skill, scaling_lvl, stages = {}}) {\r\n        this.name = name;\r\n        this.scaling_lvl = scaling_lvl;\r\n\r\n        if(related_skill) {\r\n            if(!skills[related_skill]) {\r\n                throw new Error(`No such skill as \"${related_skill}\"`);\r\n            }\r\n            else { \r\n                this.related_skill = related_skill; //one per each; skill xp defined in location/combat_zone\r\n            }\r\n        }\r\n        this.stages = stages; //up to 3\r\n        /* \r\n        >number<: {\r\n            description,\r\n            related_skill,\r\n            effects,\r\n            applied_effects // relates to active_effects, just like same-named property on activities\r\n        }\r\n\r\n        */\r\n    }\r\n}\r\n\r\nfunction get_location_type_penalty(type, stage, stat, category) {\r\n    \r\n    const skill = skills[location_types[type].stages[stage].related_skill];\r\n\r\n    //maybe give all stages a range of skill lvls where they start scaling and where they get fully nullified?\r\n\r\n    const scaling_lvl = location_types[type].stages[stage].scaling_lvl || skill.max_level;\r\n\r\n    if(category === \"multiplier\") {\r\n        const base = location_types[type].stages[stage].effects[stat].multiplier;\r\n    \r\n        return base**(1- Math.min(scaling_lvl,get_total_skill_level(skill.skill_id))/scaling_lvl);\r\n    } else if(category === \"flat\") {\r\n        const base = location_types[type].stages[stage].effects[stat].flat;\r\n\r\n        return base*(1-Math.min(scaling_lvl,get_total_skill_level(skill.skill_id))/scaling_lvl)**0.66667;\r\n    } else {\r\n        throw new Error(`Unsupported category of stat effects \"${category}\", should be either \"flat\" or \"multiplier\"!`);\r\n    }\r\n    \r\n}\r\n\r\n//create location types\r\n(function(){ \r\n    location_types[\"bright\"] = new LocationType({\r\n        name: \"bright\",\r\n        stages: {\r\n            1: {\r\n                description: \"A place that's always lit, no matter the time of the day\",\r\n            },\r\n            2: {\r\n                description: \"An extremely bright place, excessive light makes it hard to keep eyes open\",\r\n                related_skill: \"Dazzle resistance\",\r\n                effects: {\r\n                    attack_points: {multiplier: 0.5},\r\n                    evasion_points: {multiplier: 0.5},\r\n                }\r\n            },\r\n            3: {\r\n                description: \"A place with so much light that an average person would go blind in an instant\",\r\n                related_skill: \"Dazzle resistance\",\r\n                effects: {\r\n                    attack_points: {multiplier: 0.1},\r\n                    evasion_points: {multiplier: 0.1},\r\n                }\r\n            }\r\n        }\r\n    });\r\n    location_types[\"dark\"] = new LocationType({\r\n        name: \"dark\",\r\n        stages: {\r\n            1: {\r\n                description: \"It's dark here, comparable to a bright night\",\r\n                related_skill: \"Night vision\",\r\n                //no effects here, since in this case they are provided via the overall \"night\" penalty\r\n            },\r\n            2: {\r\n                description: \"An extremely dark place, darker than most of the nights\",\r\n                related_skill: \"Night vision\",\r\n                effects: {\r\n                    //they dont need to be drastic since they apply on top of 'night' penalty\r\n                    attack_points: {multiplier: 0.8},\r\n                    evasion_points: {multiplier: 0.8},\r\n                }\r\n            },\r\n            3: {\r\n                description: \"Pure darkness with not even a tiniest flicker of light\",\r\n                related_skill: \"Presence sensing\",\r\n                effects: {\r\n                    attack_points: {multiplier: 0.15},\r\n                    evasion_points: {multiplier: 0.15},\r\n                }\r\n            }\r\n        }\r\n    });\r\n    location_types[\"narrow\"] = new LocationType({\r\n        name: \"narrow\",\r\n        stages: {\r\n            1: {\r\n                description: \"A narrow area where there's not much place for maneuvering\",\r\n                related_skill: \"Tight maneuvers\",\r\n                scaling_lvl: 20,\r\n                effects: {\r\n                    evasion_points: {multiplier: 0.5},\r\n                }\r\n            },\r\n            2: {\r\n                description: \"A very tight and narrow area where there's not much place for maneuvering\",\r\n                related_skill: \"Tight maneuvers\",\r\n                effects: {\r\n                    evasion_points: {multiplier: 0.333},\r\n                },\r\n                scaling_lvl: 40,\r\n            },\r\n            3: {\r\n                description: \"An area so cramped that it's a miracle you can even move\",\r\n                related_skill: \"Tight maneuvers\",\r\n                effects: {\r\n                    evasion_points: {\r\n                        multiplier: 0.1\r\n                    },\r\n                    dexterity: {\r\n                        multiplier: 0.5,\r\n                    }\r\n                }        \r\n            }\r\n        }\r\n    });\r\n    location_types[\"open\"] = new LocationType({\r\n        name: \"open\",\r\n        stages: {\r\n            1: {\r\n                description: \"A completely open area where attacks can come from any direction\",\r\n                related_skill: \"Spatial awareness\",\r\n                scaling_lvl: 30,\r\n                effects: {\r\n                    evasion_points: {multiplier:  0.75},\r\n                }\r\n            },\r\n            2: {\r\n                description: \"An area that's completely open and simultanously obstructs your view, making it hard to predict where an attack will come from\",\r\n                related_skill: \"Spatial awareness\",\r\n                effects: {\r\n                    evasion_points: {multiplier: 0.5},\r\n                }\r\n            }\r\n        }\r\n    });\r\n    location_types[\"thin air\"] = new LocationType({\r\n        name: \"thin air\",\r\n        stages: {\r\n            1: {\r\n                description: \"Place with thinner air, which negatively impacts your body\",\r\n                related_skill: \"Breathing\",\r\n                scaling_lvl: 25,\r\n                effects: {\r\n                    stamina_efficiency: {multiplier: 0.5},\r\n                    agility: {multiplier: 0.8},\r\n                    strength: {multiplier: 0.8},\r\n                    dexterity: {multiplier: 0.8},\r\n                    intuition: {multiplier: 0.8},\r\n                }\r\n            },\r\n            2: {\r\n                description: \"Place with very thin air, heavily affecting your body\",\r\n                related_skill: \"Breathing\",\r\n                effects: {\r\n                    stamina_efficiency: {multiplier: 0.1},\r\n                    agility: {multiplier: 0.5},\r\n                    strength: {multiplier: 0.5},\r\n                    dexterity: {multiplier: 0.5},\r\n                    intuition: {multiplier: 0.5},\r\n                }\r\n            }\r\n        }\r\n    });\r\n    location_types[\"eldritch\"] = new LocationType({\r\n        name: \"eldritch\",\r\n        stages: {\r\n            1: {\r\n                description: \"This place brings a strong sense of unease\",\r\n                related_skill: \"Strength of mind\",\r\n                scaling_lvl: 30,\r\n                effects: {\r\n                    agility: {multiplier: 0.8},\r\n                    dexterity: {multiplier: 0.8},\r\n                    intuition: {multiplier: 0.5},\r\n                    stamina_efficiency: {multiplier: 0.75},\r\n                    health_loss_flat: {flat: -5},\r\n                }\r\n            },\r\n            2: {\r\n                description: \"This place goes against the laws of the world\",\r\n                related_skill: \"Strength of mind\",\r\n                effects: {\r\n                    agility: {multiplier: 0.3},\r\n                    dexterity: {multiplier: 0.3},\r\n                    intuition: {multiplier: 0.2},\r\n                    stamina_efficiency: {multiplier: 0.5},\r\n                    health_loss_flat: {flat: -50},\r\n                }\r\n            }\r\n        }\r\n    });\r\n\tlocation_types[\"rough\"] = new LocationType({\r\n        name: \"rough\",\r\n        stages: {\r\n            1: {\r\n                description: \"The loose sand and jagged rocks make it harder to fight effectively\",\r\n                related_skill: \"Scrambling\",\r\n                scaling_lvl: 20, \r\n                effects: {\r\n                    agility: {multiplier: 0.5},\r\n                    dexterity: {multiplier: 0.5},\r\n                    attack_points: {multiplier: 0.5},\r\n                    evasion_points: {multiplier: 0.5},\r\n\t\t\t\t\tattack_speed: {multiplier: 0.7},\r\n                }\r\n            },\r\n            2: {\r\n                description: \"A boggy marshland is a terrible location to fight for your life in\",\r\n                related_skill: \"Scrambling\",\r\n\t\t\t\tscaling_lvl: 30,\r\n                effects: {\r\n                    agility: {multiplier: 0.2},\r\n                    dexterity: {multiplier: 0.2},\r\n                    attack_points: {multiplier: 0.2},\r\n                    evasion_points: {multiplier: 0.2},\r\n\t\t\t\t\tattack_speed: {multiplier: 0.4},\r\n                }\r\n            },\r\n\t\t\t3: {\r\n                description: \"The muck somehow causes you to slip even while holding you firmly in place\",\r\n                related_skill: \"Scrambling\",\r\n\t\t\t\tscaling_lvl: 60, //not implemented, intended for if in slick high viscosity fluids above waist height\r\n                effects: {\r\n                    agility: {multiplier: 0.08},\r\n                    dexterity: {multiplier: 0.08},\r\n                    attack_points: {multiplier: 0.08},\r\n                    evasion_points: {multiplier: 0.08},\r\n\t\t\t\t\tattack_speed: {multiplier: 0.15},\r\n                }\r\n            }\r\n        }\r\n    });\r\n    location_types[\"wet\"] = new LocationType({\r\n        name: \"wet\",\r\n        stages: {\r\n            1: {\r\n                description: \"Attempting to stay dry in conditions like this is impossible\",\r\n                applied_effects: [{effect: \"Wet\", duration: 30}]\r\n            }\r\n        }\r\n    });\r\n\r\n    location_types[\"aquatic\"] = new LocationType({\r\n        name: \"aquatic\",\r\n        stages: {\r\n            1: {\r\n                description: \"Wading in water up to your knees restrict your movement\",\r\n                related_skill: \"Swimming\",\r\n                scaling_lvl: 20,\r\n                effects: {\r\n                    agility: {multiplier: 0.75},\r\n                    dexterity: {multiplier: 0.75},\r\n                    stamina_efficiency: {multiplier: 0.75},\r\n                },\r\n                applied_effects: [{effect: \"Wet\", duration: 30}]\r\n            },\r\n            2: {\r\n                description: \"With most of your body submerged, it's hard to move\",\r\n                related_skill: \"Swimming\",\r\n                scaling_lvl: 30,\r\n                effects: {\r\n                    agility: {multiplier: 0.5},\r\n                    dexterity: { multiplier: 0.5 },\r\n                    attack_speed: {multiplier: 0.5 },\r\n                    stamina_efficiency: { multiplier: 0.5 },\r\n                },\r\n                applied_effects: [{effect: \"Wet\", duration: 30}]\r\n            },\r\n            3: {\r\n                description: \"Fully underwater and with no ground under your feet, the moves you learned on land will help you little\",\r\n                related_skill: \"Swimming\",\r\n                effects: {\r\n                    agility: {multiplier: 0.1},\r\n                    dexterity: {multiplier: 0.1},\r\n                    attack_speed: {multiplier: 0.25},\r\n                    stamina_efficiency: {multiplier: 0.25}\r\n                },\r\n                applied_effects: [{effect: \"Wet\", duration: 30}]\r\n            },\r\n            4: {\r\n                description: \"Crushed by the immense pressure of the oceanic abyss\",\r\n                related_skill: \"Swimming\",\r\n                effects: {\r\n                    agility: {multiplier: 0.01},\r\n                    dexterity: {multiplier: 0.01},\r\n                    attack_speed: {multiplier: 0.1},\r\n                    stamina_efficiency: {multiplier: 0.1},\r\n                    health_loss_flat: {flat: -1000},\r\n                },\r\n                applied_effects: [{effect: \"Wet\", duration: 30}]\r\n            }\r\n        }\r\n    });\r\n})();\r\n\r\n//create locations and zones\r\n(function(){ \r\n    locations[\"Village\"] = new Location({ \r\n        getDescription: function() {\r\n            if(locations[\"Infested field\"].enemy_groups_killed >= 5 * locations[\"Infested field\"].enemy_count) { \r\n                return \"Medium-sized village, built next to a small and calm river at the foot of the mountains. It's surrounded by many fields, a few of them infested by huge rats, which, while an annoyance, don't seem possible to fully eradicate. Other than that, there's nothing interesting around\";\r\n            } else if(locations[\"Infested field\"].enemy_groups_killed >= 2 * locations[\"Infested field\"].enemy_count) {\r\n                return \"Medium-sized village, built next to a small and calm river at the foot of the mountains. It's surrounded by many fields, many of them infested by huge rats. Other than that, there's nothing interesting around\";\r\n            } else {\r\n                return \"Medium-sized village, built next to a small and calm river at the foot of the mountains. It's surrounded by many fields, most of them infested by huge rats. Other than that, there's nothing interesting around\"; \r\n            }\r\n        },\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"*You hear some rustling*\"];\r\n            if(current_game_time.hour > 4 && current_game_time.hour <= 20) {\r\n                noises.push(\"Anyone seen my cow?\", \"Mooooo!\", \"Tomorrow I'm gonna fix the roof\", \"Look, a bird!\");\r\n\r\n                if(locations[\"Infested field\"].enemy_groups_killed <= 3) {\r\n                    noises.push(\"These nasty rats almost ate my cat!\");\r\n                    if(is_rat()) {\r\n                        //you can blame Mercurius for this line\r\n                        //pasted 3 times for increased chance\r\n                        noises.push(\"These nasty rats almost ate my rat!\",\"These nasty rats almost ate my rat!\",\"These nasty rats almost ate my rat!\");\r\n                    }\r\n                } else if(is_rat()) {\r\n                    //also possible after clear condition is done, but less common\r\n                    noises.push(\"These nasty rats almost ate my rat!\");\r\n                }\r\n            }\r\n\r\n            if(current_game_time.hour > 3 && current_game_time.hour < 10) {\r\n                noises.push(\"\u266B\u266B Heigh ho, heigh ho, it's off to work I go~ \u266B\u266B\", \"Cock-a-doodle-doo!\");\r\n            } else if(current_game_time.hour > 18 && current_game_time.hour < 22) {\r\n                noises.push(\"\u266B\u266B Heigh ho, heigh ho, it's home from work I go~ \u266B\u266B\");\r\n            } \r\n\r\n            if(current_game_time.hour > 8 && current_game_time.hour < 10) {     //limited timeframe because rumors, and also that Oblivion reference should be obscure\r\n                noises.push(\"Did you hear about what that fisherman saw?\", \"I just don't believe you can find one that big\");\r\n            } else if(current_game_time.hour > 16 && current_game_time.hour < 18) {\r\n                noises.push(\"Saw a river crab the other day, horrible creatures\");\r\n            } \r\n\r\n            return noises;\r\n        },\r\n        dialogues: [\"village elder\", \"village guard\", \"old craftsman\"],\r\n        traders: [\"village trader\"],\r\n        market_region: \"Village\",\r\n        name: \"Village\", \r\n        crafting: {\r\n            is_unlocked: true, \r\n            use_text: \"Try to craft something\", \r\n            tiers: {\r\n                crafting: 1,\r\n                forging: 1,\r\n                smelting: 1,\r\n                cooking: 1,\r\n                alchemy: 1,\r\n                butchering: 1,\r\n                woodworking: 1,\r\n            }\r\n        },\r\n    });\r\n\r\n    locations[\"Shack\"] = new Location({\r\n        connected_locations: [{location: locations[\"Village\"], custom_text: \"Go outside to [Village]\", travel_time: 10}],\r\n        description: \"This small shack was the only spare building in the village. It's surprisingly tidy\",\r\n        name: \"Shack\",\r\n        is_unlocked: false,\r\n        housing: {\r\n            is_unlocked: true,\r\n            text_to_sleep: \"Take a nap\",\r\n            sleeping_xp_per_tick: 1},\r\n        temperature_range_modifier: 0.4,\r\n        is_under_roof: true,\r\n    });\r\n\r\n    locations[\"Village\"].connected_locations.push({location: locations[\"Shack\"], travel_time: 10});\r\n    //remember to always add it like that, otherwise travel will be possible only in one direction and location might not even be reachable\r\n\r\n    locations[\"Eastern mill\"] = new Location({\r\n        name: \"Eastern mill\",\r\n        is_unlocked: false,\r\n        connected_locations: [{location: locations[\"Village\"], travel_time: 30, custom_text: \"Go outside to [Village]\"}],\r\n        description: \"Local mill, run by a young duo. It's somewhat tidy, with occasional flour dust in corners\",\r\n        getBackgroundNoises: function() {\r\n            let noises = [\r\n                \"*Creaking*\", \"*A small cloud of flour dust rises in the air*\", \r\n                \"*Crunch*\",\"*You hear a steady crunching sounds as stones crush grain*\",\r\n                \"Shhh, not now, we're not alone...\", \"I have a fun idea for later~\", \r\n            ];\r\n\r\n            if(is_rat()) {\r\n                noises.push(\"Shhh, don't move, there's a rat on your shoulder\");\r\n            }\r\n\r\n            if(global_flags.is_mofu_mofu_enabled) {\r\n                noises.push(\"*Their tails brush against each other and the duo blushes*\", \"*A tail brushes against your leg* oh my, sorry for that~\");\r\n            }\r\n\r\n            if(current_game_time.hour > 20 ) {\r\n                noises.push(\"It's getting late\", \"Time for a break\", \"Can't wait to... hehe...~\");\r\n            } else if(current_game_time.hour < 4) {\r\n                noises.push(\"Why are we even working at this hour...\", \"I wanna sleep...\");\r\n            } \r\n\r\n            return noises;\r\n        },\r\n        dialogues: [\"village millers\"],\r\n    });\r\n    locations[\"Village\"].connected_locations.push({location: locations[\"Eastern mill\"], travel_time: 30});\r\n\r\n    locations[\"Eastern storehouse\"] = new Combat_zone({\r\n        name: \"Eastern storehouse\",\r\n        is_unlocked: false,\r\n        description: \"\",\r\n        enemies_list: [\"Wolf rat\"],\r\n        types: [{type: \"narrow\", stage: 1, xp_gain: 3}, {type: \"dark\", stage: 1, xp_gain: 2}],\r\n        enemy_count: 25,\r\n        enemy_group_size: [3,5],\r\n        enemy_stat_variation: 0.2,\r\n        parent_location: locations[\"Eastern mill\"],\r\n        first_reward: {\r\n            xp: 40,\r\n        },\r\n        repeatable_reward: {\r\n            textlines: [{dialogue: \"village millers\", lines: [\"cleared storage\"]}],\r\n            locks: {\r\n                locations: [\"Eastern storehouse\"]\r\n            }, \r\n            move_to: {location: \"Eastern mill\"},\r\n        },\r\n        temperature_range_modifier: 0.8,\r\n        is_under_roof: true,   \r\n    });\r\n    locations[\"Eastern mill\"].connected_locations.push({location: locations[\"Eastern storehouse\"], travel_time: 10});\r\n\r\n    locations[\"Infested field\"] = new Combat_zone({\r\n        description: \"Field infested with wolf rats. You can see the grain stalks move as these creatures scurry around\", \r\n        enemy_count: 15, \r\n        enemies_list: [\"Starving wolf rat\", \"Wolf rat\"],\r\n        types: [{type: \"open\", stage: 1, xp_gain: 1}],\r\n        enemy_stat_variation: 0.1,\r\n        is_unlocked: false, \r\n        name: \"Infested field\", \r\n        parent_location: locations[\"Village\"],\r\n        first_reward: {\r\n            xp: 10,\r\n            reputation: {Village: 20},\r\n        },\r\n        repeatable_reward: {\r\n            textlines: [\r\n                {dialogue: \"village elder\", lines: [\"cleared field\"]},\r\n            ],\r\n            xp: 5,\r\n        },\r\n        rewards_with_clear_requirement: [\r\n            {\r\n                required_clear_count: 2,\r\n                reputation: {Village: 10},\r\n            },\r\n            {\r\n                required_clear_count: 4,\r\n                reputation: {Village: 30},\r\n            },\r\n            {\r\n                required_clear_count: 10,\r\n                reputation: {Village: 50},\r\n            }\r\n        ]\r\n    });\r\n    locations[\"Village\"].connected_locations.push({location: locations[\"Infested field\"], travel_time: 15});\r\n\r\n    locations[\"Nearby cave\"] = new Location({ \r\n        connected_locations: [{location: locations[\"Village\"], custom_text: \"Go outside and to the [Village]\", travel_time: 60}], \r\n        getDescription: function() {\r\n            if(locations[\"Pitch black tunnel\"].enemy_groups_killed >= locations[\"Pitch black tunnel\"].enemy_count) { \r\n                return \"A big cave at the base of a steep mountain, near the village. There are old storage sheds outside and signs of mining inside. Groups of fluorescent mushrooms cover the cave walls, providing a dim light. Your efforts have secured a decent space and many of the tunnels. It seems like you almost reached the deepest part\";\r\n            }\r\n            else if(locations[\"Hidden tunnel\"].enemy_groups_killed >= locations[\"Hidden tunnel\"].enemy_count) { \r\n                return \"A big cave at the base of a steep mountain, near the village. There are old storage sheds outside and signs of mining inside. Groups of fluorescent mushrooms cover the walls, providing a dim light. Your efforts have secured a major space and some tunnels, but there are still more places left to clear out\";\r\n            }\r\n            else if(locations[\"Cave depths\"].enemy_groups_killed >= locations[\"Cave depths\"].enemy_count) { \r\n                return \"A big cave at the base of a steep mountain, near the village. There are old storage sheds outside and signs of mining inside. Groups of fluorescent mushrooms cover the walls, providing a dim light. Your efforts have secured a decent space and even a few tunnels, yet somehow you can still hear the sounds of the wolf rats\";\r\n            }\r\n            else if(locations[\"Cave room\"].enemy_groups_killed >= locations[\"Cave room\"].enemy_count) {\r\n                return \"A big cave at the base of a steep mountain, near the village. There are old storage sheds outside and signs of mining inside. Groups of fluorescent mushrooms cover the walls, providing a dim light. Your efforts have secured some space, but you can hear more wolf rats in some deeper tunnels\";\r\n            } else {\r\n                return \"A big cave at the base of a steep mountain, near the village. There are old storage sheds outside and signs of mining inside. Groups of fluorescent mushrooms cover the walls, providing a dim light. You can hear sounds of wolf rats from the nearby room\";\r\n            }\r\n        },\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"*You hear rocks rumbling somewhere*\", \"Squeak!\", ];\r\n            return noises;\r\n        },\r\n        temperature_range_modifier: 0.8,\r\n        name: \"Nearby cave\",\r\n        is_unlocked: false,\r\n        is_under_roof: true,\r\n    });\r\n    locations[\"Village\"].connected_locations.push({location: locations[\"Nearby cave\"], travel_time: 60});\r\n    //remember to always add it like that, otherwise travel will be possible only in one direction and location might not even be reachable\r\n\r\n    locations[\"Cave room\"] = new Combat_zone({\r\n        description: \"It's full of rats. At least the glowing mushrooms provide some light\", \r\n        enemy_count: 25, \r\n        types: [{type: \"narrow\", stage: 1,  xp_gain: 3}, {type: \"bright\", stage:1}],\r\n        enemies_list: [\"Wolf rat\"],\r\n        enemy_group_size: [2,3],\r\n        enemy_stat_variation: 0.2,\r\n        is_unlocked: true, \r\n        name: \"Cave room\", \r\n        leave_text: \"Go back to entrance\",\r\n        parent_location: locations[\"Nearby cave\"],\r\n        temperature_range_modifier: 0.7,\r\n        is_under_roof: true,\r\n        first_reward: {\r\n            xp: 30,\r\n        },\r\n        repeatable_reward: {\r\n            textlines: [{dialogue: \"village elder\", lines: [\"cleared room\"]}],\r\n            locations: [{location: \"Cave depths\"}],\r\n            xp: 15,\r\n            activities: [{location:\"Nearby cave\", activity:\"weightlifting\"}, {location:\"Nearby cave\", activity:\"mining\"}, {location:\"Village\", activity:\"balancing\"}],\r\n        },\r\n        rewards_with_clear_requirement: [\r\n            {\r\n                required_clear_count: 1,\r\n                reputation: {Village: 10},\r\n            },\r\n            {\r\n                required_clear_count: 4,\r\n                reputation: {Village: 20},\r\n            },\r\n        ],\r\n    });\r\n    locations[\"Nearby cave\"].connected_locations.push({location: locations[\"Cave room\"], travel_time: 5});\r\n\r\n    locations[\"Cave depths\"] = new Combat_zone({\r\n        description: \"It's dark. And full of rats\", \r\n        enemy_count: 40,\r\n        types: [{type: \"narrow\", stage: 1,  xp_gain: 3}, {type: \"dark\", stage: 2, xp_gain: 3}],\r\n        enemies_list: [\"Wolf rat\"],\r\n        enemy_group_size: [5,8],\r\n        enemy_stat_variation: 0.2,\r\n        is_unlocked: false, \r\n        name: \"Cave depths\", \r\n        leave_text: \"Climb out\",\r\n        parent_location: locations[\"Nearby cave\"],\r\n        first_reward: {\r\n            xp: 100,\r\n        },\r\n        repeatable_reward: {\r\n            textlines: [{dialogue: \"village elder\", lines: [\"cleared cave\"]}],\r\n            xp: 50,\r\n        },\r\n        rewards_with_clear_requirement: [\r\n            {\r\n                required_clear_count: 4,\r\n                locations: [{location: \"Suspicious wall\"}],\r\n                reputation: {Village: 40},\r\n            }\r\n        ],\r\n        temperature_range_modifier: 0.6,\r\n        is_under_roof: true,\r\n    });\r\n    \r\n    locations[\"Hidden tunnel\"] = new Combat_zone({\r\n        description: \"There is, in fact, even more rats here\", \r\n        enemy_count: 50, \r\n        types: [{type: \"narrow\", stage: 1,  xp_gain: 3}, {type: \"dark\", stage: 3, xp_gain: 1}],\r\n        enemies_list: [\"Elite wolf rat\"],\r\n        enemy_group_size: [1,2],\r\n        enemy_stat_variation: 0.2,\r\n        is_unlocked: false, \r\n        name: \"Hidden tunnel\", \r\n        leave_text: \"Retreat for now\",\r\n        parent_location: locations[\"Nearby cave\"],\r\n        first_reward: {\r\n            xp: 120,\r\n        },\r\n        repeatable_reward: {\r\n            locations: [{location: \"Pitch black tunnel\"}],\r\n            xp: 60,\r\n            activities: [{location:\"Nearby cave\", activity:\"mining2\"}],\r\n        },\r\n        is_temperature_static: false,\r\n        temperature_range_modifier: 0.5,\r\n        is_under_roof: true,\r\n        unlock_text: \"As the wall falls apart, you find yourself in front of a new tunnel, leading even deeper. And of course, it's full of wolf rats.\"\r\n    });\r\n    locations[\"Pitch black tunnel\"] = new Combat_zone({\r\n        description: \"There is no light here. Only rats\",\r\n        enemy_count: 50,\r\n        types: [{type: \"narrow\", stage: 1,  xp_gain: 6}, {type: \"dark\", stage: 3, xp_gain: 3}],\r\n        enemies_list: [\"Elite wolf rat\"],\r\n        enemy_group_size: [6,8],\r\n        enemy_stat_variation: 0.2,\r\n        is_unlocked: false,\r\n        name: \"Pitch black tunnel\",\r\n        leave_text: \"Retreat for now\",\r\n        parent_location: locations[\"Nearby cave\"],\r\n        first_reward: {\r\n            xp: 520,\r\n            messages: [\"As you descend deeper and deeper, a sudden thought strikes you - what if you instead tried going up?\"],\r\n        },\r\n        repeatable_reward: {\r\n            xp: 260,\r\n            global_activities: [\"climbing\"],\r\n            actions: [{location: \"Nearby cave\", action: \"climb the mountain\"}],\r\n        },\r\n        rewards_with_clear_requirement: [\r\n            {\r\n                required_clear_count: 4,\r\n                locations: [{location: \"Mysterious gate\"}],\r\n            }\r\n        ],\r\n        is_temperature_static: true,\r\n        static_temperature: 16,\r\n        is_under_roof: true,\r\n        unlock_text: \"As you keep going deeper, you barely notice a pitch black hole. Not even a tiniest speck of light reaches it\"\r\n    });\r\n\r\n    locations[\"Mysterious gate\"] = new Combat_zone({\r\n        description: \"It's dark. And full of rats.\", \r\n        enemy_count: 50, \r\n        types: [{type: \"dark\", stage: 3, xp_gain: 5}],\r\n        enemies_list: [\"Elite wolf rat guardian\"],\r\n        enemy_group_size: [6,8],\r\n        enemy_stat_variation: 0.2,\r\n        is_unlocked: false,\r\n        name: \"Mysterious gate\", \r\n        leave_text: \"Get away\",\r\n        parent_location: locations[\"Nearby cave\"],\r\n        first_reward: {\r\n            xp: 2000,\r\n        },\r\n        repeatable_reward: {\r\n            xp: 1000,\r\n            activities: [{location:\"Nearby cave\", activity:\"meditating\"}, {location:\"Nearby cave\", activity:\"mining3\"}],\r\n            actions: [{action: \"open the gate\", location:\"Nearby cave\"}],\r\n            quest_progress: [\r\n                {quest_id: \"The Infinite Rat Saga\", task_index: 0},\r\n            ],\r\n            flags: [\"is_strength_proved\"],\r\n        },\r\n        is_temperature_static: true,\r\n        static_temperature: 18,\r\n        is_under_roof: true,\r\n        unlock_text: \"After a long and ardous fight, you reach a chamber that ends with a massive stone gate. You can feel it's guarded by some kind of wolf rats, but much bigger than the ones you fought until now\"\r\n    });\r\n\r\n    locations[\"Nearby cave\"].connected_locations.push(\r\n        {location: locations[\"Cave depths\"], travel_time: 20}, \r\n        {location: locations[\"Hidden tunnel\"], custom_text: \"Enter the [Hidden tunnel]\", travel_time: 40}, \r\n        {location: locations[\"Pitch black tunnel\"], custom_text: \"Go into the [Pitch black tunnel]\", travel_time: 60},\r\n        {location: locations[\"Mysterious gate\"], custom_text: \"Go to the [Mysterious gate]\", travel_time: 90}\r\n    );\r\n\r\n    locations[\"Writhing tunnel\"] = new Combat_zone({\r\n        description: \"The walls are moving...\", \r\n        enemy_count: 50, \r\n        types: [{type: \"dark\", stage: 3, xp_gain: 5}, {type: \"narrow\", stage: 2, xp_gain: 5}, {type: \"eldritch\", stage: 1, xp_gain: 1}],\r\n        enemies_list: [\"Wall rat\"],\r\n        enemy_group_size: [4,4],\r\n        enemy_stat_variation: 0.2,\r\n        is_unlocked: false,\r\n        name: \"Writhing tunnel\", \r\n        leave_text: \"Run away...\",\r\n        parent_location: locations[\"Nearby cave\"],\r\n        first_reward: {\r\n            xp: 4000,\r\n        },\r\n        repeatable_reward: {\r\n            xp: 2000,\r\n            locations: [{location: \"Mysterious depths\"}],\r\n            quest_progress: [\r\n                {quest_id: \"The Infinite Rat Saga\", task_index: 2},\r\n            ]\r\n        },\r\n        is_temperature_static: true,\r\n        static_temperature: 20,\r\n        is_under_roof: true,\r\n        unlock_text: \"You see something. You struggle to comprehend it. When you finally understand, you regret it instantly. It might have been better to be born blind.\"\r\n    });\r\n\r\n    locations[\"Nearby cave\"].connected_locations.push({location: locations[\"Writhing tunnel\"], travel_time: 100});\r\n\r\n    locations[\"Mysterious depths\"] = new Location({ //not yet unlockable\r\n        connected_locations: [{location: locations[\"Nearby cave\"], custom_text: \"Climb back up to the main level of [Nearby cave]\", travel_time: 100}], \r\n        getDescription: function() {\r\n            return  `You find yourself in a large chamber with smooth walls and vaulted ceiling. The floor is covered in square tiles in the center, yet you cannot help but notice that all these squares make a circle, in some impossible to understand way.\r\nThere's another gate on the wall in front of you, but you have a strange feeling that you won't be able to open it with brute strength.`;\r\n        },\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"*You hear rocks rumbling somewhere*\", \"Squeak!\", \"*Air vibrates in an impossible to describe manner*\", \"*You feel an immense sense of something being wrong*\", '\"All these squares make a circle... All these squares make a circle...\"'];\r\n            return noises;\r\n        },\r\n        name: \"Mysterious depths\",\r\n        is_unlocked: false,\r\n        unlock_text: \"You manage to find a way to another chamber.\",\r\n        is_temperature_static: true,\r\n        static_temperature: 20,\r\n        is_under_roof: true,\r\n    });\r\n\r\n    locations[\"Nearby cave\"].connected_locations.push({location: locations[\"Mysterious depths\"], custom_text: \"Climb down to [Mysterious depths]\", travel_time: 120});\r\n\r\n    locations[\"Forest road\"] = new Location({ \r\n        connected_locations: [{location: locations[\"Village\"], travel_time: 240}],\r\n        description: \"Old trodden road leading through a dark forest, the only path connecting the village to the town. You can hear some animals from the surrounding woods\",\r\n        name: \"Forest road\",\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"*You hear some rustling*\", \"Roar!\", \"*You almost tripped on some roots*\", \"*You hear some animal running away*\"];\r\n\r\n            return noises;\r\n        },\r\n        is_unlocked: false,\r\n    });\r\n    locations[\"Village\"].connected_locations.push({location: locations[\"Forest road\"], custom_text: \"Leave the village towards [Forest road]\", travel_time: 240});\r\n\r\n    locations[\"Forest\"] = new Combat_zone({\r\n        description: \"Forest surrounding the village, a dangerous place\", \r\n        enemies_list: [\"Starving wolf\", \"Young wolf\"],\r\n        types: [{type: \"narrow\", stage: 1, xp_gain: 1}],\r\n        enemy_count: 30, \r\n        enemy_stat_variation: 0.2,\r\n        name: \"Forest\", \r\n        parent_location: locations[\"Forest road\"],\r\n        first_reward: {\r\n            xp: 60,\r\n        },\r\n        repeatable_reward: {\r\n            xp: 30,\r\n            locations: [{location:\"Deep forest\"}],\r\n            activities: [{location:\"Forest road\", activity: \"herbalism\"}],\r\n        },\r\n    });\r\n    locations[\"Forest road\"].connected_locations.push({location: locations[\"Forest\"], custom_text: \"Leave the safe path and walk into the [Forest]\", travel_time: 30});\r\n\r\n    locations[\"Deep forest\"] = new Combat_zone({\r\n        description: \"Deeper part of the forest, a dangerous place\", \r\n        enemies_list: [\"Wolf\", \"Starving wolf\", \"Young wolf\"],\r\n        types: [{type: \"narrow\", stage: 1, xp_gain: 2}],\r\n        enemy_count: 50, \r\n        enemy_group_size: [2,3],\r\n        enemy_stat_variation: 0.2,\r\n        is_unlocked: false,\r\n        name: \"Deep forest\", \r\n        parent_location: locations[\"Forest road\"],\r\n        first_reward: {\r\n            xp: 300,\r\n        },\r\n        repeatable_reward: {\r\n            xp: 150,\r\n            flags: [\"is_strength_proved\"],\r\n            activities: [{location:\"Forest road\", activity: \"woodcutting\"}],\r\n        },\r\n        rewards_with_clear_requirement: [\r\n            {\r\n                required_clear_count: 4,\r\n                actions: [{action: \"follow the trail\", location:\"Forest road\"}]\r\n            }\r\n        ],\r\n    });\r\n    locations[\"Forest road\"].connected_locations.push({location: locations[\"Deep forest\"], custom_text: \"Venture into the [Deep forest]\", travel_time: 60});\r\n\r\n    locations[\"Forest clearing\"] = new Combat_zone({\r\n        description: \"A surprisingly big clearing hidden in the northern part of the forest, covered with very tall grass and filled with a mass of wild boars\",\r\n        enemies_list: [\"Boar\"],\r\n        enemy_count: 50,\r\n        enemy_group_size: [4,7],\r\n        is_unlocked: false,\r\n        enemy_stat_variation: 0.2,\r\n        name: \"Forest clearing\", \r\n        types: [{type: \"open\", stage: 2, xp_gain: 3}],\r\n        parent_location: locations[\"Forest road\"],\r\n        first_reward: {\r\n            xp: 1000,\r\n        },\r\n        repeatable_reward: {\r\n            xp: 500,\r\n            textlines: [{dialogue: \"farm supervisor\", lines: [\"defeated boars\"]}],\r\n            activities: [{location: \"Forest road\", activity: \"woodcutting2\"}],\r\n        }\r\n    });\r\n    locations[\"Forest road\"].connected_locations.push({location: locations[\"Forest clearing\"], custom_text: \"Go towards the [Forest clearing] in the north\", travel_time: 60});\r\n\r\n    locations[\"Forest den\"] = new Combat_zone({\r\n        description: \"A relatively large cave in the depths of the forest, filled with hordes of direwolves\",\r\n        enemies_list: [\"Direwolf\"],\r\n        enemy_count: 50,\r\n        enemy_group_size: [2,3],\r\n        enemy_groups_list: [{enemies: [\"Direwolf hunter\"]}],\r\n        predefined_lineup_on_nth_group: 4,\r\n        is_unlocked: false,\r\n        enemy_stat_variation: 0.2,\r\n        name: \"Forest den\", \r\n        types: [{type: \"narrow\", stage: 2, xp_gain: 5}, {type: \"dark\", stage: 2, xp_gain: 5}],\r\n        parent_location: locations[\"Forest road\"],\r\n        first_reward: {\r\n            xp: 1000,\r\n            items: [\"Warrior's necklace\"],\r\n        },\r\n        repeatable_reward: {\r\n            xp: 500,\r\n        },\r\n        rewards_with_clear_requirement: [\r\n            {\r\n                required_clear_count: 2,\r\n                actions: [{action: \"search predator\", location:\"Forest road\"}]\r\n            },\r\n            {\r\n                required_clear_count: 4,\r\n                messages: [\"In a moment of quiet between fights, you can make out a faint sound of rushing water in the distance\"],\r\n                locations: [{location:\"Forest den traversal\"}]\r\n            }\r\n        ],\r\n        temperature_range_modifier: 0.8,\r\n        is_under_roof: true,\r\n    });\r\n    locations[\"Forest road\"].connected_locations.push({location: locations[\"Forest den\"], custom_text: \"Enter the [Forest den]\", travel_time: 90});\r\n\r\n    locations[\"Bears' den\"] = new Combat_zone({\r\n        description: \"A dark, smelly cave in the heart of the forest, with massive bones spread around the entrance\",\r\n        enemies_list: [\"Forest bear\"],\r\n        enemy_count: 20,\r\n        is_unlocked: false,\r\n        enemy_stat_variation: 0.2,\r\n        name: \"Bears' den\", \r\n        types: [{type: \"narrow\", stage: 2, xp_gain: 10}, {type: \"dark\", stage: 2, xp_gain: 10}],\r\n        parent_location: locations[\"Forest road\"],\r\n        first_reward: {\r\n            xp: 500,\r\n        },\r\n        repeatable_reward: {\r\n            xp: 250,\r\n        },\r\n        temperature_range_modifier: 0.8,\r\n        is_under_roof: true,\r\n    });\r\n\r\n    locations[\"Forest road\"].connected_locations.push({location: locations[\"Bears' den\"], custom_text: \"Enter the [Bears' den]\", travel_time: 180});\r\n\r\n    locations[\"Forest lake\"] = new Location({\r\n        connected_locations: [{location: locations[\"Forest road\"], travel_time: 120}],\r\n        description: \"Far away from civilization, the forest opens up to an unspoiled lake. Nestled between a small cliff where it receives water from a rocky waterfall, and a dense canopy leading to what must be the forest's heart, it serves as a respite for the local animals - and now, yourself\",\r\n        name: \"Forest lake\",\r\n        getBackgroundNoises: () => [\"*Mosquitoes buzzing*\", \"*Frogs croaking*\", \"*something splashes in the water*\", \"*an animal comes out to drink*\", \"Quack\", \"Quack!\"],\r\n        is_unlocked: false,\r\n    });\r\n    locations[\"Forest road\"].connected_locations.push({ location: locations[\"Forest lake\"], travel_time: 120 });\r\n\r\n    locations[\"Frogs\"] = new Combat_zone({\r\n        description: \"Battling at the lake's edge\",\r\n        enemies_list: [\"Frog\"],\r\n        enemy_count: 50,\r\n        is_unlocked: false,\r\n        enemy_stat_variation: 0.2,\r\n        name: \"Frogs\",\r\n        types: [{type: \"aquatic\", stage: 1, xp_gain: 5}, {type: \"open\", stage: 1, xp_gain: 5}],\r\n        parent_location: locations[\"Forest lake\"],\r\n        first_reward: {\r\n            xp: 1600,\r\n        },\r\n        repeatable_reward: {\r\n            xp: 800,\r\n            actions: [\r\n                //{location: \"Forest lake\", action: \"search2\"} //locked as the reward doesn't really have any uses yet\r\n            ],\r\n        },\r\n        temperature_range_modifier: 0.8,\r\n        is_under_roof: false,\r\n    });\r\n    locations[\"Forest lake\"].connected_locations.push({location: locations[\"Frogs\"], custom_text: \"Challenge the apex predator\"});\r\n\r\n    locations[\"Forest ant nest\"] = new Combat_zone({ \r\n        description: \"A labyrinthine nest of red ants\", \r\n        enemies_list: [\"Red ant swarm\"],\r\n        enemy_groups_list: [{enemies: [\"Red ant queen\", \"Red ant swarm\", \"Red ant swarm\", \"Red ant swarm\", \"Red ant swarm\", \"Red ant swarm\", \"Red ant swarm\", \"Red ant swarm\"]}],\r\n        predefined_lineup_on_nth_group: 99,\r\n        types: [{type: \"narrow\", stage: 3, xp_gain: 10}, {type: \"dark\", stage: 2, xp_gain: 7}],\r\n        enemy_count: 100,\r\n        is_unlocked: false,\r\n        enemy_group_size: [8,8],\r\n        enemy_stat_variation: 0.1,\r\n        id: \"Forest ant nest\",\r\n        name: \"Red ant nest\",\r\n        parent_location: locations[\"Forest road\"],\r\n        first_reward: {\r\n            xp: 6000,\r\n        },\r\n        repeatable_reward: {\r\n            xp: 3000,\r\n        },\r\n        temperature_range_modifier: 0.7,\r\n        is_under_roof: true,\r\n    });\r\n    locations[\"Forest road\"].connected_locations.push({location: locations[\"Forest ant nest\"], custom_text: \"Enter the [Red ant nest]\", travel_time: 120});\r\n\r\n    locations[\"Town outskirts\"] = new Location({ \r\n        connected_locations: [{location: locations[\"Forest road\"], custom_text: \"Return to the [Forest road]\", travel_time: 240}],\r\n        description: \"The town is surrounded by a tall stone wall. The only gate seems to be closed, with a lone guard outside. You can see farms to the north and slums to the south\",\r\n        name: \"Town outskirts\",\r\n        is_unlocked: true,\r\n        dialogues: [\"gate guard\"],\r\n    });\r\n    locations[\"Forest road\"].connected_locations.push({location: locations[\"Town outskirts\"], custom_text: \"Go towards the [Town outskirts]\", travel_time: 240});\r\n\r\n    locations[\"Slums\"] = new Location({ \r\n        connected_locations: [{location: locations[\"Town outskirts\"], travel_time: 60}],\r\n        getDescription: function() {\r\n            if(locations[\"Gang hideout\"].is_finished) {\r\n                return \"A wild settlement next to city walls, filled with decaying buildings, poverty, and occasional thieves\";\r\n            }\r\n\r\n            return \"A wild settlement next to city walls, filled with decaying buildings, poverty, and violent criminals\";\r\n        },\r\n        name: \"Slums\",\r\n        is_unlocked: true,\r\n        dialogues: [\"suspicious man\", \"old woman of the slums\"],\r\n        traders: [\"suspicious trader\", \"suspicious trader 2\"],\r\n        market_region: \"Slums\",\r\n        entrance_rewards: {\r\n            quests: [\"Light in the darkness\"],\r\n        },\r\n        temperature_range_modifier: 0.9,\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"Cough cough\", \"Cough cough cough\", \"*You hear someone sobbing*\", \"*You see someone sleeping in an alleyway.*\", \"I'm so hungry...\", \"Even rotten food is better than nothing\"];\r\n            \r\n            if(current_game_time.hour > 4 && current_game_time.hour <= 20) {\r\n                noises.push(\"Please, do you have a coin to spare?\");\r\n            } else {\r\n                if(!locations[\"Gang hideout\"].is_finished) {\r\n                    noises.push(\"*Sounds of someone getting repeatedly stabbed*\", \"Scammed some fools for money today, time to get drunk!\", \"Damn, I need a new dagger\");\r\n                }\r\n            }\r\n            if(!locations[\"Gang hideout\"].is_finished) {\r\n                noises.push(\"*You hear a terrified scream.*\");\r\n            } else {\r\n                noises.push(\"You're the one who took out that gang, aren't you? Thank you so much.\", \"Things got a lot better since those thugs left...\", \"The crime isn't as bad as it used to be\");\r\n            }\r\n            return noises;\r\n        },\r\n    });\r\n    locations[\"Town farms\"] = new Location({ \r\n        connected_locations: [{location: locations[\"Town outskirts\"], travel_time: 60}],\r\n        description: \"Semi-private farms under jurisdiction of the city council. Full of life and sounds of heavy work\",\r\n        name: \"Town farms\",\r\n        is_unlocked: true,\r\n        dialogues: [\"farm supervisor\"],\r\n        getBackgroundNoises: function() {\r\n            let noises = [];\r\n            if(current_game_time.hour > 4 && current_game_time.hour <= 20) {\r\n                noises.push(\"Mooooo!\", \"Look, a bird!\", \"Bark bark!\", \"*You notice a goat staring at you menacingly*\", \"Neigh!\", \"Oink oink\");\r\n            } else {\r\n                noises.push(\"*You can hear some rustling*\", \"*You can hear snoring workers*\");\r\n            }\r\n\r\n            if(current_game_time.hour > 3 && current_game_time.hour < 10) {\r\n                noises.push(\"\u266B\u266B Heigh ho, heigh ho, it's off to work I go~ \u266B\u266B\", \"Cock-a-doodle-doo!\");\r\n            } else if(current_game_time.hour > 18 && current_game_time.hour < 22) {\r\n                noises.push(\"\u266B\u266B Heigh ho, heigh ho, it's home from work I go~ \u266B\u266B\");\r\n            } \r\n\r\n            return noises;\r\n        },\r\n    });\r\n\r\n    locations[\"Red ant nest 1\"] = new Combat_zone({ \r\n        description: \"A labyrinthine nest of red ants\", \r\n        enemies_list: [\"Red ant swarm\"],\r\n        enemy_groups_list: [{enemies: [\"Red ant queen\"]}],\r\n        predefined_lineup_on_nth_group: 99,\r\n        types: [{type: \"narrow\", stage: 3, xp_gain: 10}, {type: \"dark\", stage: 2, xp_gain: 7}],\r\n        enemy_count: 100,\r\n        is_unlocked: false,\r\n        enemy_group_size: [5,6],\r\n        enemy_stat_variation: 0.1,\r\n        id: \"Red ant nest 1\",\r\n        name: \"Red ant nest\",\r\n        parent_location: locations[\"Town farms\"],\r\n        first_reward: {\r\n            xp: 4000,\r\n        },\r\n        repeatable_reward: {\r\n            locks: {\r\n                locations: [\"Red ant nest 1\"],\r\n            }, \r\n            move_to: {location: \"Town farms\"},\r\n            actions: [\r\n                {location: \"Town farms\", action: \"dig for ants 2\"}\r\n            ]\r\n        },\r\n        temperature_range_modifier: 0.7,\r\n        is_under_roof: true,\r\n    });\r\n    locations[\"Red ant nest 2\"] = new Combat_zone({ \r\n        description: \"A labyrinthine nest of red ants\", \r\n        enemies_list: [\"Red ant swarm\"],\r\n        enemy_groups_list: [{enemies: [\"Red ant queen\"]}],\r\n        predefined_lineup_on_nth_group: 99,\r\n        types: [{type: \"narrow\", stage: 3, xp_gain: 10}, {type: \"dark\", stage: 2, xp_gain: 7}],\r\n        enemy_count: 100,\r\n        is_unlocked: false,\r\n        enemy_group_size: [5,6],\r\n        enemy_stat_variation: 0.1,\r\n        id: \"Red ant nest 2\",\r\n        name: \"Red ant nest\",\r\n        parent_location: locations[\"Town farms\"],\r\n        first_reward: {\r\n            xp: 4000,\r\n        },\r\n        repeatable_reward: {\r\n            locks: {\r\n                locations: [\"Red ant nest 2\"],\r\n            }, \r\n            move_to: {location: \"Town farms\"},\r\n            actions: [\r\n                {location: \"Town farms\", action: \"dig for ants 3\"}\r\n            ]\r\n        },\r\n        temperature_range_modifier: 0.7,\r\n        is_under_roof: true,\r\n    });\r\n    locations[\"Red ant nest 3\"] = new Combat_zone({ \r\n        description: \"A labyrinthine nest of red ants\", \r\n        enemies_list: [\"Red ant swarm\"],\r\n        enemy_groups_list: [{enemies: [\"Red ant queen\"]}],\r\n        predefined_lineup_on_nth_group: 99,\r\n        types: [{type: \"narrow\", stage: 3, xp_gain: 10}, {type: \"dark\", stage: 2, xp_gain: 7}],\r\n        enemy_count: 100,\r\n        is_unlocked: false,\r\n        enemy_group_size: [5,6],\r\n        enemy_stat_variation: 0.1,\r\n        id: \"Red ant nest 3\",\r\n        name: \"Red ant nest\",\r\n        parent_location: locations[\"Town farms\"],\r\n        first_reward: {\r\n            xp: 4000,\r\n        },\r\n        repeatable_reward: {\r\n            locks: {\r\n                locations: [\"Red ant nest 3\"],\r\n            }, \r\n            move_to: {location: \"Town farms\"},\r\n            actions: [\r\n                {location: \"Town farms\", action: \"follow ant trail\"}\r\n            ],\r\n            textlines: [{dialogue: \"farm supervisor\", lines: [\"eliminated ants\"]}],\r\n        },\r\n        temperature_range_modifier: 0.7,\r\n        is_under_roof: true,\r\n    });\r\n\r\n    locations[\"Town farms\"].connected_locations.push(\r\n        {location: locations[\"Red ant nest 1\"], custom_text: \"Enter the [Red ant nest]\", travel_time: 10},\r\n        {location: locations[\"Red ant nest 2\"], custom_text: \"Enter the [Red ant nest]\", travel_time: 10},\r\n        {location: locations[\"Red ant nest 3\"], custom_text: \"Enter the [Red ant nest]\", travel_time: 10},\r\n    );\r\n\r\n    locations[\"Gang hideout\"] = new Combat_zone({ \r\n        description: \"Hideout of a local gang. Old building with a labirynth of narrow corridors\", \r\n        enemies_list: [\"Slums thug\"],\r\n        types: [{type: \"narrow\", stage: 2, xp_gain: 3}, {type: \"dark\", stage: 1, xp_gain: 3}],\r\n        enemy_count: 30,\r\n        is_unlocked: false,\r\n        enemy_group_size: [4,5],\r\n        enemy_stat_variation: 0.1,\r\n        name: \"Gang hideout\", \r\n        parent_location: locations[\"Slums\"],\r\n        first_reward: {\r\n            xp: 1000,\r\n            reputation: {Slums: 200, Town: 50},\r\n            money: 1840,\r\n        },\r\n        repeatable_reward: {\r\n            traders: [{trader: \"suspicious trader 2\", skip_message: true}],\r\n            textlines: [{dialogue: \"suspicious man\", lines: [\"defeated gang\"]}],\r\n            locks: {\r\n                traders: [\"suspicious trader\"],\r\n                locations: [\"Gang hideout\"],\r\n                textlines: { \"suspicious man\": [\"behave 2\"] }\r\n            }, \r\n            move_to: {location: \"Slums\"},\r\n            quest_progress: [{quest_id: \"Light in the darkness\", task_index: 1}],\r\n        },\r\n        temperature_range_modifier: 0.6,\r\n        is_under_roof: true,\r\n    });\r\n    locations[\"Slums\"].connected_locations.push({location: locations[\"Gang hideout\"], travel_time: 10});\r\n\r\n    locations[\"Town square\"] = new Location({ \r\n        connected_locations: [{location: locations[\"Town outskirts\"], travel_time: 40}],\r\n        description: \"The town's center of life, connected to all the markets, guilds, and other important places\",\r\n        name: \"Town square\",\r\n        is_unlocked: false,\r\n        getBackgroundNoises: function() {\r\n            let noises = [];\r\n            return noises;\r\n        },\r\n    });\r\n\r\n    locations[\"Town outskirts\"].connected_locations.push(\r\n                                                        {location: locations[\"Town farms\"], travel_time: 60}, \r\n                                                        {location: locations[\"Slums\"], travel_time: 60}, \r\n                                                        {location: locations[\"Town square\"], travel_time: 40}\r\n                                                    );\r\n\r\n    locations[\"Cat caf\u00E9\"] = new Location({ \r\n        connected_locations: [{location: locations[\"Town square\"], travel_time: 4}],\r\n        description: `A cat caf\u00E9 in the center of town. There are multiple kitties of all kinds, but two females especially catch your eyes\r\n - a chubby mackerel tabby with a white belly and neck, and a slender tortoishell that seems blind on the right eye. There's a single worker in the caf\u00E9, a person of ambiguous gender with with long ponytail and glasses.`,\r\n        name: \"Cat caf\u00E9\",\r\n        is_unlocked: true,\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"Meow\", \"Nya\", \"Mrrr\", \"Mrrrp meow\", \"*A cat jumps on your lap*\", \"*A cat brushes on your leg*\"];\r\n            return noises;\r\n        },\r\n        is_under_roof: true,\r\n        is_temperature_static: true,\r\n        static_temperature: 20,\r\n    });\r\n\r\n    locations[\"Town square\"].connected_locations.push({location: locations[\"Cat caf\u00E9\"], travel_time: 4});\r\n\r\n    locations[\"Mountain path\"] = new Location({\r\n        connected_locations: [{location: locations[\"Nearby cave\"], custom_text: \"Climb down to [Nearby Cave]\", travel_time: 20, travel_time_skills: [\"Climbing\"]}],\r\n        description: \"A treacherous path high above the village\",\r\n        name: \"Mountain path\",\r\n        is_unlocked: false,\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"You hear a rock tumble and fall down. It takes a very long time to hit the ground...\", \"Strong wind whooshes past you\"];\r\n            return noises;\r\n        },\r\n        temperature_modifier: -2,\r\n        unlock_text: \"Thanks to your hard effort, you reached a narrow safe spot where you can rest a bit\",\r\n    });\r\n    locations[\"Nearby cave\"].connected_locations.push({location: locations[\"Mountain path\"], custom_text: \"Climb up to [Mountain path]\", travel_time: 60, travel_time_skills: [\"Climbing\"]});\r\n\r\n    locations[\"Small flat area in mountains\"] = new Location({\r\n        connected_locations: [{location: locations[\"Mountain path\"], travel_time: 120}],\r\n        description: \"A piece of flatland somewhere in the mountains, very high above the village. It's not that big, but more than enough for a camp\",\r\n        name: \"Small flat area in mountains\",\r\n        is_unlocked: false,\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"You hear a rock tumble and fall down. It takes a very long time to hit the ground...\", \"Strong wind whooshes past you\", \"A pair of birds flies right above you\"];\r\n            return noises;\r\n        },\r\n        temperature_modifier: -2,\r\n        unlock_text: \"You finally got to a place where a camp can be established\",\r\n    });\r\n    locations[\"Mountain path\"].connected_locations.push({location: locations[\"Small flat area in mountains\"], travel_time: 120});\r\n    \r\n    locations[\"Mountain camp\"] = new Location({\r\n        connected_locations: [{location: locations[\"Nearby cave\"], custom_text: \"Climb down to [Nearby cave]\", travel_time: 140, travel_time_skills: [\"Climbing\", \"Running\"]}],\r\n        description: \"A nice safe camp with a crackling fire and a rainproof tent, created by you to be a perfect base for further exploration\",\r\n        name: \"Mountain camp\",\r\n        housing: {\r\n            is_unlocked: true,\r\n            sleeping_xp_per_tick: 8,\r\n            text_to_sleep: \"Take a nap on the bedroll\",\r\n        },\r\n        is_unlocked: false,\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"You hear a rock tumble and fall down. It takes a very long time to hit the ground...\", \"Strong wind whooshes past you\", \"A pair of birds flies right above you\"];\r\n            return noises;\r\n        },\r\n        temperature_range_modifier: 0.5,\r\n        is_under_roof: true,\r\n    });\r\n    locations[\"Nearby cave\"].connected_locations.push({location: locations[\"Mountain camp\"], travel_time: 140, travel_time_skills: [\"Climbing\", \"Running\"]});\r\n    locations[\"Mountain path\"].connected_locations.push({location: locations[\"Mountain camp\"], travel_time: 120});\r\n\r\n    locations[\"Gentle mountain slope\"] = new Combat_zone({\r\n        description: \"A surprisingly gentle clearing, with a herd of angry goats protecting it\",\r\n        enemies_list: [\"Angry mountain goat\"],\r\n        enemy_count: 50,\r\n        enemy_group_size: [3,4],\r\n        is_unlocked: false,\r\n        enemy_stat_variation: 0.2,\r\n        name: \"Gentle mountain slope\", \r\n        types: [{type: \"open\", stage: 1, xp_gain: 5}, {type: \"thin air\", stage: 1, xp_gain: 3}],\r\n        parent_location: locations[\"Mountain camp\"],\r\n        first_reward: {\r\n            xp: 1000,\r\n            flags: [\"is_strength_proved\"],\r\n        },\r\n        repeatable_reward: {\r\n            xp: 500,\r\n        },\r\n        temperature_modifier: -2,\r\n    });\r\n    locations[\"Mountain camp\"].connected_locations.push({location: locations[\"Gentle mountain slope\"], travel_time: 120});\r\n\t\r\n    locations[\"Downstream from the village\"] = new Location({       //start of the new content\r\n        connected_locations: [{location: locations[\"Village\"], custom_text: \"Make the long hike back to the [Village]\", travel_time: 2160}], \r\n        description: \"The chittering clicks of crabs tell you that you're headed in the right direction. As you make your way closer to the riverbank's shore, you stumble across what you think at first is a boulder the size of a small building blocking your path. That is, until you notice it start to move...\",\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"*You hear the waves crashing along the shoreline*\", \"*Splash*\", \"*You hear the chittering clicks of dozens of crabs*\"];\r\n            return noises;\r\n        },\r\n        temperature_modifier: 0.5,\r\n        name: \"Downstream from the village\",\r\n        is_unlocked: false,\r\n    });\r\n    locations[\"Village\"].connected_locations.push({location: locations[\"Downstream from the village\"], custom_text: \"Hike down the river\", travel_time: 2160});\r\n\r\n    locations[\"Riverbank\"] = new Location({ \r\n        connected_locations: [{location: locations[\"Village\"], custom_text: \"Make the long hike back to the [Village]\", travel_time: 2160}], \r\n        getDescription: function() {\r\n\t\tif(locations[\"Riverbank shore\"].enemy_groups_killed >= 10 * locations[\"Riverbank shore\"].enemy_count) { \r\n                return \"While there are still an abundance of crabs on the river's shore, they don't appear to be interested in climbing any higher onto the riverbank. It shouldn't be difficult to move past them at this point\";\r\n            } else if(locations[\"Riverbank shore\"].enemy_groups_killed >= 5 * locations[\"Riverbank shore\"].enemy_count) {\r\n                return \"There is an abundance of crabs on the river's shore, but you should be able to get around them and further down the riverbank with a little bit of effort\";\r\n            } else {\r\n                return \"You manage to deal a wounding crack to the giant crab's shell, driving it into a rage as it flees through the forest.\"\r\n                        +\" With a moment of peace, you take stock of your surroundings. And if the amount of crabs on the river's shore are any indication,\"\r\n                        +\" this might be the enormous crab nest you had heard about. You can't even tell where the shore meets the riverbank with the amount of crabs around here.\"\r\n                        +\" The giant crab's trail is easy to spot, but it's just not possible to follow it without getting attacked by the smaller crabs. You will likely nead to get through \"\r\n                        +\" multiple groups of them on your way\";\r\n            }},\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"*You hear the waves crashing along the shoreline*\", \"*Splash*\", \"*You hear the chittering clicks of dozens of crabs*\"];\r\n            return noises;\r\n        },\r\n        temperature_modifier: 1,\r\n        name: \"Riverbank\",\r\n        is_unlocked: false,\r\n    });\r\n    locations[\"Village\"].connected_locations.push({location: locations[\"Riverbank\"], custom_text: \"Hike down the river\", travel_time: 2160});\r\n  \r\n\tlocations[\"Downstream from the village\"].connected_locations.push({location: locations[\"Riverbank\"], custom_text: \"Move down to the [Riverbank]\", travel_time: 30});\r\n\r\n    locations[\"Riverbank shore\"] = new Combat_zone({\r\n        description: \"As your eyes scan the shoreline, you see nothing but crabs across the horizon\", \r\n        enemy_count: 50, \r\n        types: [{type: \"open\", stage: 1,  xp_gain: 2}, {type: \"rough\", stage: 1,  xp_gain: 1}],\r\n        enemies_list: [\"River crab\"],\r\n        enemy_group_size: [2,4],\r\n        enemy_stat_variation: 0.2,\r\n        is_unlocked: true, \r\n        name: \"Riverbank shore\", \r\n        leave_text: \"Climb off the beach and back to safety\",\r\n        parent_location: locations[\"Riverbank\"],\r\n        temperature_range_modifier: 0.5,\r\n        first_reward: {\r\n            xp: 1800,\r\n        },\r\n        repeatable_reward: {\r\n\t\t\txp: 900,\r\n        },\r\n        rewards_with_clear_requirement: [\r\n            {\r\n                required_clear_count: 5,\r\n                locations: [{location: \"Further downstream\"}]\r\n            },\r\n        ],\r\n    });\r\n    locations[\"Riverbank\"].connected_locations.push({location: locations[\"Riverbank shore\"], custom_text: \"Climb down to the [Riverbank shore]\", travel_time: 15});\r\n\t\r\n    locations[\"Further downstream\"] = new Location({ \r\n        connected_locations: [{location: locations[\"Riverbank\"], custom_text: \"Go back along the path you've made to the [Riverbank]\", travel_time: 240}], \r\n        description: \"While it wasn't hard to spot the giant crab's trail, following after it proved to be a different story. You made your way through the thick forest bush until the woods gave way to a moderately large lake overlooking a great basin, where you finally spotted the crab in a frenzy at it's nest. You consider going back and telling the guards, but by the time they'd arrive, the crab might have chosen a new nesting ground -- and you decide you have to end it now. Despite the cracks you've caused in it's shell, it seems more dangerous than when you fought it earlier, and the loose sand is only going to make this fight harder...\",\r\n        getBackgroundNoises: function() {\r\n            let noises = [];\r\n            if(current_game_time.hour > 4 && current_game_time.hour <= 20) {\r\n                noises.push(\"*You hear the roar of rushing water in the distance*\", \"*The hum of insects buzz in your ear*\", \"*Birds are singing, flowers are blooming...*\"); //reference to sans undertale\r\n            } else {\r\n                noises.push(\"*You hear the roar of rushing water in the distance*\", \"*The hum of insects buzz in your ear*\");\r\n            }\r\n            return noises;\r\n        },\r\n        temperature_range_modifier: 0.8,\r\n        name: \"Further downstream\",\r\n        is_unlocked: false,\r\n    });\r\n    locations[\"Riverbank\"].connected_locations.push({location: locations[\"Further downstream\"], custom_text: \"Follow the giant crab's trail\", travel_time: 240});\r\n\r\n    locations[\"Lake beach\"] = new Location({ \r\n        connected_locations: [{location: locations[\"Riverbank\"], custom_text: \"Go back along the path you've made to the [Riverbank]\", travel_time: 180, travel_time_skills: [\"Scrambling\"]}], \r\n        description: \"The winding river lead to a peaceful lake on the edge of the forest overlooking a great basin. The surface of the lake ripples from the current of the river feeding into it. Animals occasionally come up and lap at the edge of the lake before running back off into the woods. On the far end, the lake feeds into a waterfall\",\r\n        getBackgroundNoises: function() {\r\n            let noises = [];\r\n            if(current_game_time.hour > 4 && current_game_time.hour <= 20) {\r\n                noises.push(\"*You hear the roar of rushing water nearby*\", \"*The hum of insects buzz in your ear*\", \"*Birds are singing, flowers are blooming...*\");\r\n            } else {\r\n                noises.push(\"*You hear the roar of rushing water nearby*\", \"*The hum of insects buzz in your ear*\");\r\n            }\r\n            return noises;\r\n        },\r\n        temperature_modifier: 1.5,\r\n        unlock_text: \"It's just a shame no one will ever believe you caught one ~this~ big\",        //intended to show up after beating the giant crab for the second time, playing off the old \"fisherman lying about the size of his catch\" trope\r\n        name: \"Lake beach\",\r\n        is_unlocked: false,\r\n    });\r\n    locations[\"Riverbank\"].connected_locations.push({location: locations[\"Lake beach\"], custom_text: \"Go to the [Lake beach]\",  travel_time: 180, travel_time_skills: [\"Scrambling\"]});\r\n  \r\n    locations[\"Further downstream\"].connected_locations.push({location: locations[\"Lake beach\"], custom_text: \"Go to the [Lake beach]\", travel_time: 240}); //Pretty sure \"Further downstream\" should be locked by this point, but if it's not or if it gets unlocked, it should reconnect I suppose\r\n\r\n\r\n    locations[\"Lake camp\"] = new Location({\r\n        connected_locations: [{location: locations[\"Lake beach\"], custom_text: \"Go back out to the [Lake beach]\", travel_time: 5}],\r\n        description: \"A pleasant little encampment built in the remains of the giant crab's nest. With a crackling firepit and comfortable cot, it was created by you to be the perfect lakeside rest and relaxation spot\",\r\n        name: \"Lake camp\",\r\n        housing: {\r\n            is_unlocked: true,\r\n            sleeping_xp_per_tick: 8,\r\n            text_to_sleep: \"Take a nap on the cot\",\r\n        },\r\n        is_unlocked: false,\r\n        getBackgroundNoises: function() {\r\n            let noises = [];\r\n            if(current_game_time.hour > 4 && current_game_time.hour <= 20) {\r\n                noises.push(\"*You hear the roar of rushing water nearby*\", \"*The hum of insects buzz in your ear*\", \"*Birds are singing, flowers are blooming...*\");\r\n            } else {\r\n                noises.push(\"*You hear the roar of rushing water nearby*\", \"*The hum of insects echoes across the lakebed*\", \"*The fire crackles in the middle of your camp*\");\r\n            }\r\n            return noises;\r\n        },\r\n        temperature_range_modifier: 0.8,\r\n        temperature_modifier: 1,\r\n    });\r\n    locations[\"Lake beach\"].connected_locations.push({location: locations[\"Lake camp\"], custom_text: \"Go to your camp on the lakeside\", travel_time: 5});\r\n\r\n\r\n    locations[\"Waterfall basin\"] = new Location({ \r\n        connected_locations: [{location: locations[\"Lake beach\"], custom_text: \"Climb up the cliffside and return to the [Lake beach]\", travel_time: 80, travel_time_skills: [\"Climbing\"]}], \r\n        getDescription: function() {\r\n            if(locations[\"Crab spawning grounds\"].enemy_groups_killed >= 6 * locations[\"Crab spawning grounds\"].enemy_count) { \r\n                return \"The waterfall at the bottom of the lake. Cool rushing waters and a sense of serene harmony make the area ideal for training your mind and body. Large crabs almost indistinguishable from the stone can be found along the shore of the basin. Off in the distance, you can just barely make out the overgrown remains of a old trail leading off into a swampy field\";\r\n            } else if(locations[\"Crab spawning grounds\"].enemy_groups_killed >= 3 * locations[\"Crab spawning grounds\"].enemy_count) {\r\n                return \"The waterfall at the bottom of the lake. Large crabs almost indistinguishable from the stone inhabit the shore. The sound of roaring water echoing through the rock shelters provides a calming noise that you figure would make it easier to focus your mind\";\r\n            } else {\r\n                return \"The waterfall at the bottom of the lake. Large crabs almost indistinguishable from the stone inhabit the shore and nearby rock shelters. You consider that the cool rushing waters from overhead might be an good way to train your body to endure tougher situations\";\r\n            }\r\n        },\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"*You hear the roar of thousands of gallons of water crashing down*\"];\r\n            return noises;\r\n        },\r\n        temperature_modifier: 2,\r\n        name: \"Waterfall basin\",\r\n        is_unlocked: false,\r\n    });\r\n    locations[\"Lake beach\"].connected_locations.push({location: locations[\"Waterfall basin\"], custom_text: \"Rappel down to the [Waterfall basin]\", travel_time: 40, travel_time_skills: [\"Climbing\"]});\r\n\r\n    locations[\"Crab spawning grounds\"] = new Combat_zone({\r\n        description: \"First an enormous crab nest, then an enormous crab's nest, and now this??\",       //final punchline to the \"big crab nest/big crabs' nest/big crab's nest\" setup\r\n        enemy_count: 50, \r\n        types: [{type: \"open\", stage: 2, xp_gain: 10}, {type: \"rough\", stage: 1, xp_gain: 3}, {type: \"wet\", stage: 1}],\r\n        enemies_list: [\"Stone crab\"],\r\n        enemy_group_size: [3,5],\r\n        enemy_stat_variation: 0.2,\r\n        is_unlocked: true, \r\n        name: \"Crab spawning grounds\", \r\n        leave_text: \"Leave the crab spawning grounds\",\r\n        parent_location: locations[\"Waterfall basin\"],\r\n        temperature_modifier: 1,\r\n        first_reward: {\r\n            xp: 4000,\r\n        },\r\n        repeatable_reward: {\r\n\t\t\txp: 2000,\r\n        },\r\n        rewards_with_clear_requirement: [\r\n            {\r\n                required_clear_count: 3,\r\n                activities: [{location:\"Waterfall basin\", activity:\"meditating\"}],\r\n            },\r\n            {\r\n                required_clear_count: 6,\r\n                locations: [{location: \"Swampland fields\"}]\r\n            }]\r\n        });\r\n    locations[\"Waterfall basin\"].connected_locations.push({location: locations[\"Crab spawning grounds\"], travel_time: 20});\r\n\t\r\n    locations[\"Swampland fields\"] = new Location({ \r\n        connected_locations: [{location: locations[\"Waterfall basin\"], custom_text: \"Crawl through the muck and brush and return to the [Waterfall basin]\", travel_time: 45, travel_time_skills: [\"Scrambling\"]}], \r\n        getDescription: function() {\r\n          if(locations[\"The swamplands\"].enemy_groups_killed >= 100 * locations[\"The swamplands\"].enemy_count) { //10000 enemies killed\r\n                  return \"The swamplands are filled with everpresent danger. Only an experienced warrior such as yourself is capable of withstanding the threats that lie within its boggy depths\";\r\n              } else if(locations[\"The swamplands\"].enemy_groups_killed >= 10 * locations[\"The swamplands\"].enemy_count) {\r\n                  return \"The swamplands are difficult to navigate and dangerous to traverse, but after scouting it for what feels like a few months, you begin to find that the bog feels smaller and emptier\";\r\n              } else if(locations[\"The swamplands\"].enemy_groups_killed >= 3 * locations[\"The swamplands\"].enemy_count) {\r\n                  return \"The swamplands are difficult to navigate and dangerous to traverse, but after travelling across it for what feels like a few weeks, you managed to find an actual solid pathway leading to a small settlement. It seems that somehow, some folks have managed to find a way to survive out here\";\r\n              } else {\r\n                  return \"A disgusting boggy marsh lies before you. Most of the ground, or at least what you can make out through the reeds, is covered in filthy water halfway up to your knees, and what isn't submerged has rotted into compost or is the nest of some unknown creature. You think you see something out of the corner of your eye, but as you turn to look, all you catch is a ripple in the reeds\";\r\n          }\r\n        },\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"*Gnats and mosquitos pick at your exposed skin*\", \"*fwoosh* *thump*\", \"*You hear something moving around you, but you can't see it*\", \"*The buzz of insects throb in your ears*\", \"*gurgle gurgle*\", \"*You feel something moving next you, but you can't see it*\", \"*snap* *crunch*\", \"*You hear the rythmic swish-swash of something swimming nearby*\", \"*hssssssssssss*\", \"*slither*\"];\r\n            return noises;\r\n        },\r\n        temperature_range_modifier: 0.5,\r\n        temperature_modifier: 3,\r\n        unlock_text: \"You can just barely make out the overgrown remains of a old trail leading off into a swampy field as an ill omen passes over you\",\r\n        name: \"Swampland fields\",\r\n        is_unlocked: false,\r\n    });\r\n    locations[\"Waterfall basin\"].connected_locations.push({location: locations[\"Swampland fields\"], custom_text: \"Crawl through the muck and brush to the [Swampland fields]\", travel_time: 45, travel_time_skills: [\"Scrambling\"]});\r\n\r\n    locations[\"The swamplands\"] = new Combat_zone({\r\n        description: \"The swamplands are hot, wet, and smell of rot. Water impedes your every movement, and vicious predators lie beneath it's surface\", \r\n        enemy_count: 100, \r\n        types: [{type: \"rough\", stage: 2, xp_gain: 7}, {type: \"wet\", stage: 1}],\r\n        enemies_list: [\"Alligator\", \"Snapping turtle\", \"Giant snake\"],\r\n        enemy_stat_variation: 0.2,\r\n        is_unlocked: true, \r\n        name: \"The swamplands\", \r\n        leave_text: \"Slink away to some higher, dryer ground\",\r\n        parent_location: locations[\"Swampland fields\"],\r\n        temperature_modifier: 5.5,\r\n        temperature_range_modifier: 0.5,\r\n        first_reward: {\r\n            xp: 8000,\r\n        },\r\n        repeatable_reward: {\r\n\t\t\txp: 4000,\r\n        },\r\n        rewards_with_clear_requirement: [\r\n            {\r\n                required_clear_count: 3,\r\n                locations: [{location: \"Swampland tribe\"}]\r\n            }\r\n        ]\r\n    });\r\n    locations[\"Swampland fields\"].connected_locations.push({location: locations[\"The swamplands\"], custom_text: \"Wander randomly in the swamplands\", travel_time: 45});\r\n\r\n    locations[\"Swampland tribe\"] = new Location({\r\n        connected_locations: [{location: locations[\"Swampland fields\"], custom_text: \"Leave the safety of the settlement and return to the [Swampland fields]\", travel_time: 90, travel_time_skills: [\"Scrambling\", \"Running\"]}], \r\n        getDescription: function() {\r\n            return \"Very small fortified settlement, built on a stretch of dry, stable ground. There are a few small huts and a single building built into the back of the encampment. As small as the settlement is, the fortifications surrounding it suggest that it once was larger\";\r\n        },\r\n        getBackgroundNoises: function() {\r\n            let noises = [\"*You hear some rustling*\", \"*The hum of insects buzz in your ear*\", \"*Gnats and mosquitos pick at your exposed skin*\", \"*fwoosh* *thump*\", \"*gurgle gurgle*\", \"*snap* *crunch*\", \"*You hear the rythmic swish-swash of something swimming nearby*\"];\r\n            return noises;\r\n        },\r\n        temperature_modifier: 2,\r\n        temperature_range_modifier: 0.5,\r\n        dialogues: [\"swampland chief\", \"swampland cook\", \"swampland tailor\", \"swampland tanner\"],\r\n        traders: [\"swampland trader\", \"swampland trader 2\"],\r\n        market_region: \"Swamp\",\r\n        name: \"Swampland tribe\", \r\n        is_unlocked: false,\r\n        crafting: {\r\n            is_unlocked: false,\r\n            use_text: \"Use the tribe's workhuts to craft something\", \r\n            tiers: {\r\n                crafting: 2,\r\n                forging: 1,\r\n                smelting: 1,\r\n                cooking: 2,\r\n                alchemy: 2,\r\n                butchering: 2,\r\n                woodworking: 2,\r\n            }\r\n        },\r\n        entrance_rewards: {\r\n            quests: [\"In Times of Need\"],\r\n        }\r\n    });\r\n    locations[\"Swampland fields\"].connected_locations.push({location: locations[\"Swampland tribe\"], travel_time: 90, travel_time_skills: [\"Scrambling\", \"Running\"]});\r\n\t\r\n    locations[\"Longhouse\"] = new Location({\r\n        connected_locations: [{location: locations[\"Swampland tribe\"], custom_text: \"Go back out to the [Swampland tribe]\", travel_time: 5}],\r\n        description: \"A communal building that members of the settlement rest, eat, and recover in. The only other person in here right now is a wounded young woman, lying in a cot next to the door. The air smells faintly of rot and you can't help but notice there's far more cots than needed\",\r\n        name: \"Longhouse\",\r\n        is_unlocked: false,\r\n        housing: {\r\n            is_unlocked: true,\r\n            text_to_sleep: \"Lie down on an open cot\",\r\n            sleeping_xp_per_tick: 3\r\n        },\r\n        temperature_modifier: 1.5,\r\n        temperature_range_modifier: 0.5,\r\n        dialogues: [\"swampland scout\"],\r\n        is_under_roof: true,\r\n    });\r\n\r\n    locations[\"Swampland tribe\"].connected_locations.push({location: locations[\"Longhouse\"], travel_time: 5});\r\n})();\r\n\r\n\r\n\r\n//challenge zones\r\n(function(){\r\n    locations[\"Sparring with the village guard (heavy)\"] = new Challenge_zone({\r\n        description: \"She's showing you a technique that makes her attacks slow but deadly\",\r\n        enemy_count: 1, \r\n        enemies_list: [\"Village guard (heavy)\"],\r\n        enemy_group_size: [1,1],\r\n        is_unlocked: false, \r\n        name: \"Sparring with the village guard (heavy)\", \r\n        leave_text: \"Give up\",\r\n        parent_location: locations[\"Village\"],\r\n        first_reward: {\r\n            xp: 30,\r\n            reputation: {Village: 10},\r\n        },\r\n        repeatable_reward: {\r\n            textlines: [{dialogue: \"village guard\", lines: [\"heavy\"]}],\r\n        },\r\n        unlock_text: \"You can now spar with the guard (heavy stance) in the Village\"\r\n    });\r\n    locations[\"Sparring with the village guard (quick)\"] = new Challenge_zone({\r\n        description: \"She's showing you a technique that makes her attacks fast but weaker\",\r\n        enemy_count: 1, \r\n        enemies_list: [\"Village guard (quick)\"],\r\n        enemy_group_size: [1,1],\r\n        is_unlocked: false, \r\n        name: \"Sparring with the village guard (quick)\", \r\n        leave_text: \"Give up\",\r\n        parent_location: locations[\"Village\"],\r\n        first_reward: {\r\n            xp: 30,\r\n            reputation: {Village: 10},\r\n        },\r\n        repeatable_reward: {\r\n            textlines: [{dialogue: \"village guard\", lines: [\"quick\"]}],\r\n        },\r\n        unlock_text: \"You can now spar with the guard (quick stance) in the Village\"\r\n    });\r\n    locations[\"Village\"].connected_locations.push(\r\n        {location: locations[\"Sparring with the village guard (heavy)\"], custom_text: \"Spar with the guard [heavy]\", travel_time: 0},\r\n        {location: locations[\"Sparring with the village guard (quick)\"], custom_text: \"Spar with the guard [quick]\", travel_time: 0}\r\n    );\r\n\r\n    locations[\"Suspicious wall\"] = new Challenge_zone({\r\n        description: \"It can be broken with enough force, you can feel it\", \r\n        enemy_count: 1, \r\n        types: [],\r\n        enemies_list: [\"Suspicious wall\"],\r\n        enemy_group_size: [1,1],\r\n        enemy_stat_variation: 0,\r\n        is_unlocked: false, \r\n        name: \"Suspicious wall\", \r\n        leave_text: \"Leave it for now\",\r\n        parent_location: locations[\"Nearby cave\"],\r\n        repeatable_reward: {\r\n            locations: [{location: \"Hidden tunnel\"}],\r\n            textlines: [{dialogue: \"village elder\", lines: [\"new tunnel\"]}],\r\n            xp: 20,\r\n            quests: [\"The Infinite Rat Saga\"],\r\n        },\r\n        unlock_text: \"At some point, one of wolf rats tries to escape through a previously unnoticed hole in a nearby wall. There might be another tunnel behind it!\",\r\n        is_under_roof: true,\r\n        temperature_range_modifier: 0.8,\r\n    });\r\n    locations[\"Nearby cave\"].connected_locations.push({location: locations[\"Suspicious wall\"], custom_text: \"Try to break the suspicious wall\", travel_time: 0});\r\n\r\n    locations[\"Fight off the assailant\"] = new Challenge_zone({\r\n        description: \"He attacked you out of nowhere\", \r\n        enemy_count: 1, \r\n        types: [],\r\n        enemies_list: [\"Suspicious man\"],\r\n        enemy_group_size: [1,1],\r\n        enemy_stat_variation: 0,\r\n        is_unlocked: false, \r\n        name: \"Fight off the assailant\", \r\n        leave_text: \"Run away for now\",\r\n        parent_location: locations[\"Slums\"],\r\n        repeatable_reward: {\r\n            textlines: [{dialogue: \"suspicious man\", lines: [\"defeated\"]}],\r\n            xp: 40,\r\n        },\r\n        unlock_text: \"Defend yourself!\"\r\n    });\r\n    locations[\"Slums\"].connected_locations.push({location: locations[\"Fight off the assailant\"], custom_text: \"Fight off the suspicious man\", travel_time: 0});\r\n\r\n    locations[\"Fight the angry mountain goat\"] = new Challenge_zone({\r\n        description: \"It won't let you pass...\",\r\n        enemy_count: 1, \r\n        types: [{type: \"narrow\", stage: 1, xp_gain: 1}, {type: \"thin air\", stage: 1, xp_gain: 3}],\r\n        enemies_list: [\"Angry-looking mountain goat\"],\r\n        enemy_group_size: [1,1],\r\n        enemy_stat_variation: 0,\r\n        is_unlocked: false, \r\n        name: \"Fight the angry mountain goat\", \r\n        leave_text: \"Run away and hope it won't follow\",\r\n        parent_location: locations[\"Mountain path\"],\r\n        repeatable_reward: {\r\n            locations: [{location: \"Small flat area in mountains\"}],\r\n            xp: 500,\r\n        },\r\n        unlock_text: \"A very angry goat blocks your way!\",\r\n        temperature_modifier: -2,\r\n    });\r\n    locations[\"Mountain path\"].connected_locations.push({location: locations[\"Fight the angry mountain goat\"], custom_text: \"Fight the angry goat\", travel_time: 0});\r\n\r\n    locations[\"Fight the giant crab\"] = new Challenge_zone({\r\n        //crab 1\r\n        description: \"The village elder told you to be cautious...\",\r\n        enemy_count: 1, \r\n        types: [{type: \"open\", stage: 1, xp_gain: 2}],\r\n        enemies_list: [\"Giant crab\"],\r\n        enemy_stat_variation: 0,\r\n        is_unlocked: true, \r\n        name: \"Fight the giant crab\", \r\n        leave_text: \"Scramble away and hide!\",\r\n        parent_location: locations[\"Downstream from the village\"],\r\n        repeatable_reward: {\r\n            locations: [{location: \"Riverbank\"}],\r\n            xp: 2000,\r\n            move_to: {location: \"Riverbank\"},\r\n            quest_progress: [{quest_id: \"Giant Enemy Crab\", task_index: 0}],\r\n            locks: {locations: [\"Downstream from the village\"]}, \r\n        },\r\n        unlock_text: \"Is this what the village elder meant when he said an enormous crab nest??\",\r\n        temperature_modifier: 0.6,\r\n    });\r\n    locations[\"Downstream from the village\"].connected_locations.push({location: locations[\"Fight the giant crab\"], custom_text: \"Fight the giant crab\", travel_time: 5});\r\n\r\n\r\n    locations[\"Fight the giant crab again\"] = new Challenge_zone({      //crab 2\r\n        description: \"This time, you can't let it get away\",\r\n        enemy_count: 1, \r\n        types: [{type: \"open\", stage: 2, xp_gain: 5}, {type: \"rough\", stage: 1, xp_gain: 3}],\r\n        enemies_list: [\"Enraged giant crab\"],\r\n        enemy_stat_variation: 0,\r\n        is_unlocked: true, \r\n        name: \"Fight the giant crab again!\", \r\n        leave_text: \"Scramble away and hide!\",\r\n        parent_location: locations[\"Further downstream\"],\r\n        repeatable_reward: {\r\n            locations: [{location: \"Lake beach\"}],\r\n            xp: 5000,\r\n            move_to: {location: \"Lake beach\"},\r\n            quest_progress: [{quest_id: \"Giant Enemy Crab\", task_index: 1}],\r\n            locks: {locations: [\"Further downstream\"]}, \r\n        },\r\n        unlock_text: \"It's wounded, but in spite of that it looks more dangerous than before\",\r\n        temperature_modifier: 1,\r\n    });\r\n    locations[\"Further downstream\"].connected_locations.push({location: locations[\"Fight the giant crab again\"], custom_text: \"Fight the giant crab again\", travel_time: 5});\r\n  \r\n    locations[\"Forest den traversal\"] = new Challenge_zone({\r\n        description: \"A relatively large cave in the depths of the forest, filled with hordes of direwolves. You are trying to find out what's on the other side.\",\r\n        enemies_list: [\"Direwolf\"],\r\n        enemy_count: 50,\r\n        enemy_group_size: [2,3],\r\n        enemy_groups_list: [{enemies: [\"Direwolf hunter\"]}],\r\n        predefined_lineup_on_nth_group: 4,\r\n        is_unlocked: false,\r\n        enemy_stat_variation: 0.2,\r\n        name: \"Forest den traversal\",\r\n        types: [{type: \"narrow\", stage: 2, xp_gain: 5}, {type: \"dark\", stage: 2, xp_gain: 5}],\r\n        parent_location: locations[\"Forest road\"],\r\n        repeatable_reward: {\r\n            xp: 1000,\r\n            messages: [\"You reach a wall of water and push through\"],\r\n            locations: [{ location: \"Forest lake\" }],\r\n            move_to: {location: \"Forest lake\"}\r\n        },\r\n        temperature_range_modifier: 0.8,\r\n        is_under_roof: true,\r\n    });\r\n    locations[\"Forest road\"].connected_locations.push({location: locations[\"Forest den traversal\"], custom_text: \"Try to get to the other side of the [Forest den]\", travel_time: 90});\r\n})();\r\n\r\n//add activities\r\n(function(){\r\n    locations[\"Village\"].activities = {\r\n        \"fieldwork\": new LocationActivity({\r\n            activity_name: \"fieldwork\",\r\n            starting_text: \"Work on the fields\",\r\n            get_payment: () => {\r\n                return 15 + Math.round(25 * get_total_skill_level(\"Farming\")/skills[\"Farming\"].max_level);\r\n            },\r\n            is_unlocked: false,\r\n            working_period: 60*2,\r\n            availability_time: {start: 6, end: 20},\r\n            availability_seasons: [\"Spring\",\"Summer\",\"Autumn\"],\r\n            skill_xp_per_tick: 1, \r\n        }),\r\n        \"running\": new LocationActivity({\r\n            activity_name: \"running\",\r\n            starting_text: \"Go for a run around the village\",\r\n            skill_xp_per_tick: 1,\r\n            is_unlocked: false,\r\n        }),\r\n        \"weightlifting\": new LocationActivity({\r\n            activity_name: \"weightlifting\",\r\n            starting_text: \"Try to carry some bags of grain\",\r\n            skill_xp_per_tick: 1,\r\n            is_unlocked: false,\r\n        }),\r\n        \"swimming\": new LocationActivity({\r\n            activity_name: \"swimming\",\r\n            starting_text: \"Swim in the river\",\r\n            infinite: false,\r\n            availability_seasons: [\"Spring\", \"Summer\", \"Autumn\"],\r\n            skill_xp_per_tick: 1,\r\n            is_unlocked: true,\r\n            applied_effects: [{effect: \"Wet\", duration: 30}],\r\n        }),\r\n        \"balancing\": new LocationActivity({\r\n            activity_name: \"balancing\",\r\n            starting_text: \"Try to keep your balance on rocks in the river\",\r\n            unlock_text: \"All this fighting while surrounded by stone and rocks gives you a new idea\",\r\n            skill_xp_per_tick: 1,\r\n            is_unlocked: false,\r\n        }),\r\n        \"meditating\": new LocationActivity({\r\n            activity_name: \"meditating\",\r\n            starting_text: \"Sit down and meditate\",\r\n            skill_xp_per_tick: 1,\r\n            is_unlocked: true,\r\n        }),\r\n        \"patrolling\": new LocationActivity({\r\n            activity_name: \"patrolling\",\r\n            starting_text: \"Go on a patrol around the village.\",\r\n            get_payment: () => {return 50},\r\n            is_unlocked: false,\r\n            working_period: 60*2,\r\n            skill_xp_per_tick: 1\r\n        }),\r\n        \"woodcutting\": new LocationActivity({\r\n            activity_name: \"woodcutting\",\r\n            starting_text: \"Gather wood on the outskirts\",\r\n            skill_xp_per_tick: 1,\r\n            is_unlocked: true,\r\n            gained_resources: {\r\n                resources: [{name: \"Piece of rough wood\", ammount: [[1,1], [1,3]], chance: [0.5, 1]}], \r\n                time_period: [20, 10],\r\n                skill_required: [0, 10],\r\n                scales_with_skill: true,\r\n            },\r\n            require_tool: true,\r\n        }),\r\n        \"sand\": new LocationActivity({\r\n            activity_id: \"sand\",\r\n            activity_name: \"digging\",\r\n            starting_text: \"Dredge up some sand from the riverbed\",\r\n            skill_xp_per_tick: 1,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [{ name: \"Silica Sand\", ammount: [[1, 1], [1, 3]], chance: [0.4, 1.0] }],\r\n                time_period: [120, 60],\r\n                skill_required: [0, 10],\r\n                scales_with_skill: true,\r\n            },\r\n            require_tool: true,\r\n            unlock_text: \"You realize that the river near the village might contain the type of sand you need\",\r\n        }),\r\n        \"fishing\": new LocationActivity({\r\n            activity_name: \"fishing\",\r\n            starting_text: \"Try fishing in the river\",\r\n            availability_seasons: [\"Spring\", \"Summer\", \"Autumn\"],\r\n            skill_xp_per_tick: 1,\r\n            is_unlocked: true,\r\n            gained_resources: {\r\n                resources: [\r\n                    {name: \"Ratfish\", chance: [0.3, 0.5]},\r\n                    {name: \"Minnow\", chance: [0.1, 0.5]},\r\n                    {name: \"Trout\", chance: [0.01, 0.20]},\r\n                    {name: \"Mackerel shark\", chance: [0.001, 0.05]}\r\n                ], \r\n                time_period: [120, 30],\r\n                skill_required: [0, 10],\r\n                scales_with_skill: true,\r\n            },\r\n            require_tool: true,\r\n        })\r\n    };\r\n    locations[\"Nearby cave\"].activities = {\r\n        \"weightlifting\": new LocationActivity({\r\n            activity_name: \"weightlifting\",\r\n            starting_text: \"Try lifting some of the rocks\",\r\n            skill_xp_per_tick: 4,\r\n            is_unlocked: false,\r\n            unlock_text: \"After the fight, you realize there's quite a lot of rocks of different sizes that could be used for exercises\",\r\n        }),\r\n        \"climbing\": new LocationActivity({\r\n            activity_name: \"climbing\",\r\n            starting_text: \"Attempt climbing the mountain walls outside\",\r\n            skill_xp_per_tick: 1,\r\n            is_unlocked: true,\r\n        }),\r\n        \"meditating\": new LocationActivity({\r\n            activity_name: \"meditating\",\r\n            starting_text: \"Sit down and meditate in front of the gate\",\r\n            skill_xp_per_tick: 4,\r\n            is_unlocked: false,\r\n            unlock_text: \"As you finish fighting your enemies and it becomes quiet, you feel a strange sense of tranquility. This spot in front of the mysterious gate, surrounded by calm and darkness, seems perfect to sit down and focus your mind.\"\r\n        }),\r\n        \"mining\": new LocationActivity({\r\n            activity_name: \"mining\",\r\n            starting_text: \"Mine the strange looking iron vein\",\r\n            skill_xp_per_tick: 1,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [{name: \"Low quality iron ore\", ammount: [[1,1], [1,3]], chance: [0.4, 0.8]}], \r\n                time_period: [60, 30],\r\n                skill_required: [0, 10],\r\n                scales_with_skill: true,\r\n            },\r\n            unlock_text: \"As you clear the area of wolf rats, you notice a vein of an iron ore\",\r\n        }),\r\n        \"mining2\": new LocationActivity({\r\n            activity_name: \"mining\",\r\n            starting_text: \"Mine the deeper iron vein\",\r\n            skill_xp_per_tick: 5,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [{name: \"Iron ore\", ammount: [[1,1], [1,3]], chance: [0.3, 0.7]}],\r\n                time_period: [90, 40],\r\n                skill_required: [7, 17],\r\n                scales_with_skill: true,\r\n            },\r\n            unlock_text: \"Going deeper, you find a vein of an iron ore that seems to be of much higher quality\",\r\n        }),\r\n        \"mining3\": new LocationActivity({\r\n            activity_name: \"mining\",\r\n            starting_text: \"Mine the atratan vein\",\r\n            skill_xp_per_tick: 12,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [{name: \"Atratan ore\", ammount: [[1,1], [1,3]], chance: [0.3, 0.7]}],\r\n                time_period: [120, 60],\r\n                skill_required: [12, 25],\r\n                scales_with_skill: true,\r\n            },\r\n            unlock_text: \"As you finish the fight and get a time to look around, you notice a metal vein of different color than iron. You recall another ore called Atratan, this must be it.\",\r\n        }),\r\n    };\r\n    locations[\"Forest road\"].activities = {\r\n        \"running\": new LocationActivity({\r\n            activity_name: \"running\",\r\n            starting_text: \"Go for a run through the forest\",\r\n            skill_xp_per_tick: 4,\r\n        }),\r\n        \"woodcutting\": new LocationActivity({\r\n            activity_name: \"woodcutting\",\r\n            starting_text: \"Gather wood from nearby trees\",\r\n            skill_xp_per_tick: 5,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [{name: \"Piece of wood\", ammount: [[1,1], [1,3]], chance: [0.3, 1]}],\r\n                time_period: [90, 40],\r\n                skill_required: [7, 17],\r\n                scales_with_skill: true,\r\n            },\r\n        }),\r\n        \"woodcutting2\": new LocationActivity({\r\n            activity_name: \"woodcutting\",\r\n            starting_text: \"Gather wood from sturdy trees\",\r\n            skill_xp_per_tick: 12,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [{name: \"Piece of ash wood\", ammount: [[1,1], [1,3]], chance: [0.3, 1]}],\r\n                time_period: [120, 60],\r\n                skill_required: [12, 25],\r\n                scales_with_skill: true,\r\n            },\r\n            unlock_text: \"Finishing your fight, you notice that the trees on the side of the clearing look really healthy and sturdy, they could be a useful material.\",\r\n        }),\r\n        \"herbalism\": new LocationActivity({\r\n            activity_name: \"herbalism\",\r\n            starting_text: \"Gather useful herbs throughout the forest\",\r\n            skill_xp_per_tick: 2,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [\r\n                    {name: \"Oneberry\", chance: [0.1, 0.5]},\r\n                    {name: \"Golmoon leaf\", chance: [0.1, 0.7]},\r\n                    {name: \"Belmart leaf\", chance: [0.1, 0.7]}\r\n                ], \r\n                time_period: [120, 45],\r\n                skill_required: [0, 10],\r\n                scales_with_skill: true,\r\n            },\r\n            require_tool: true,\r\n        }),\r\n    };\r\n    locations[\"Town outskirts\"].activities = {\r\n        \"herbalism\": new LocationActivity({\r\n            activity_name: \"herbalism\",\r\n            starting_text: \"Search for useful herbs by the roadside\",\r\n            skill_xp_per_tick: 4,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [\r\n                    {name: \"Cooking herbs\", ammount: [[1,1], [1,3]], chance: [0.1, 0.8]},\r\n                ], \r\n                time_period: [120, 50],\r\n                skill_required: [5, 15],\r\n                scales_with_skill: true,\r\n            },\r\n            require_tool: true,\r\n            unlock_text: \"You learned that some useful herbs can be found right under your nose.\"\r\n        }),\r\n    };\r\n    locations[\"Town farms\"].activities = {\r\n        \"fieldwork\": new LocationActivity({\r\n            activity_name: \"fieldwork\",\r\n            starting_text: \"Work on the fields\",\r\n            get_payment: () => {\r\n                return 30 + Math.round(30 * get_total_skill_level(\"Farming\")/skills[\"Farming\"].max_level);\r\n            },\r\n            is_unlocked: false,\r\n            working_period: 60*2,\r\n            availability_time: {start: 6, end: 20},\r\n            availability_seasons: [\"Spring\", \"Summer\", \"Autumn\"],\r\n            skill_xp_per_tick: 2,\r\n        }),\r\n        \"animal care\": new LocationActivity({\r\n            activity_name: \"animal care\",\r\n            starting_text: \"Take care of local sheep in exchange for some wool\",\r\n            skill_xp_per_tick: 3,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [\r\n                    {name: \"Wool\", ammount: [[1,1], [1,3]], chance: [0.1, 1]},\r\n                ], \r\n                time_period: [120, 60],\r\n                skill_required: [0, 10],\r\n                scales_with_skill: true,\r\n            },\r\n        }),\r\n    };\r\n    locations[\"Mountain path\"].activities = {\r\n        \"balancing\": new LocationActivity({\r\n            activity_name: \"balancing\",\r\n            starting_text: \"Stupidly risk your life by trying to balance on some stones on the very edge of the cliff\",\r\n            skill_xp_per_tick: 4,\r\n            is_unlocked: true,\r\n        }),\r\n    };\r\n    locations[\"Mountain camp\"].activities = {\r\n        \"herbalism\": new LocationActivity({\r\n            activity_name: \"herbalism\",\r\n            starting_text: \"Search for useful herbs on the mountainside\",\r\n            skill_xp_per_tick: 6,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [\r\n                    { name: \"Silver thistle\", chance: [0.1, 0.5] },\r\n                ],\r\n                time_period: [120, 60],\r\n                skill_required: [7, 17],\r\n                scales_with_skill: true,\r\n            },\r\n            require_tool: true,\r\n        }),\r\n        \"balancing\": new LocationActivity({\r\n            activity_name: \"balancing\",\r\n            starting_text: \"Stupidly risk your life by trying to balance on some stones on the very edge of the cliff\",\r\n            skill_xp_per_tick: 4,\r\n            is_unlocked: true,\r\n        }),\r\n        \"climbing\": new LocationActivity({\r\n            activity_name: \"climbing\",\r\n            starting_text: \"Take a lesson from the goats and try to climb a wall near the camp\",\r\n            skill_xp_per_tick: 4,\r\n            is_unlocked: true,\r\n        }),\r\n    }\r\n\t\r\n    locations[\"Riverbank\"].activities = {\r\n        \"herbalism\": new LocationActivity({\r\n            activity_name: \"herbalism\",\r\n            starting_text: \"Harvest flax from around the riverbank\",\r\n            skill_xp_per_tick: 9,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [{name: \"Flax\", ammount: [[1,1], [1,3]], chance: [0.4, 0.8]}], \r\n                time_period: [120, 60],\r\n                skill_required: [20, 30],\r\n                scales_with_skill: true,\r\n            },\r\n            require_tool: true,\r\n        }),\r\n    };\r\n\t\r\n    locations[\"Lake beach\"].activities = {\r\n        \"swimming\": new LocationActivity({\r\n            activity_name: \"swimming\",\r\n            starting_text: \"Swim against the current\",\r\n            infinite: false,\r\n            availability_seasons: [\"Spring\", \"Summer\", \"Autumn\"],\r\n            skill_xp_per_tick: 7,\r\n            is_unlocked: true,\r\n            applied_effects: [{effect: \"Wet\", duration: 30}],\r\n        }),\r\n        \"sand\": new LocationActivity({\r\n            activity_id: \"sand\",\r\n            activity_name: \"digging\",\r\n            starting_text: \"Dig for clams around the lake beach\",\r\n            skill_xp_per_tick: 10,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [{ name: \"Clam\", ammount: [[1, 3], [1, 3]], chance: [0.34, 1.0] }],\r\n                time_period: [60, 30],\r\n                skill_required: [10, 20],\r\n                scales_with_skill: true,\r\n            },\r\n            require_tool: true,\r\n        }),\r\n        \"climbing\": new LocationActivity({\r\n            activity_name: \"climbing\",\r\n            starting_text: \"Practice rappelling down the cliff face\",\r\n            skill_xp_per_tick: 10,\r\n            is_unlocked: false,\r\n        }),\r\n        \"weightlifting\": new LocationActivity({\r\n            activity_name: \"weightlifting\",\r\n            starting_text: \"Sled pull a boulder\",\r\n            skill_xp_per_tick: 10,\r\n            is_unlocked: false,\r\n        }),\r\n        \"running\": new LocationActivity({\r\n            activity_name: \"running\",\r\n            starting_text: \"Run along the shore\",\r\n            skill_xp_per_tick: 10,\r\n            is_unlocked: true,\r\n        }),\r\n    };\r\n\r\n    locations[\"Forest lake\"].activities = {\r\n        \"swimming\": new LocationActivity({\r\n            activity_name: \"swimming\",\r\n            starting_text: \"Go diving in the lake waters\",\r\n            skill_xp_per_tick: 4,\r\n            is_unlocked: true,\r\n            infinite: false,\r\n            availability_seasons: [\"Spring\", \"Summer\", \"Autumn\"],\r\n            applied_effects: [{ effect: \"Wet\", duration: 30 }],\r\n        }),\r\n        \"balancing\": new LocationActivity({\r\n            activity_name: \"balancing\",\r\n            starting_text: \"Try to keep your balance on top of the waterfall as water rushes around your feet\",\r\n            skill_xp_per_tick: 7,\r\n            is_unlocked: true,\r\n            applied_effects: [{ effect: \"Wet\", duration: 30 }],\r\n        }),\r\n        \"mining\": new LocationActivity({\r\n            activity_name: \"mining\",\r\n            starting_text: \"Mine the the shiny underwater vein\",\r\n            skill_xp_per_tick: 1,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [{name: \"Silver ore\", ammount: [[1,1], [1,3]], chance: [0.3, 0.7]}],\r\n                time_period: [100, 50],\r\n                skill_required: [10, 20],\r\n                scales_with_skill: true,\r\n            },\r\n            unlock_text: \"You discover a vein of silver at the bottom of the lake!\",\r\n        }),\r\n        \"fishing\": new LocationActivity({\r\n            activity_name: \"fishing\",\r\n            starting_text: \"Try fishing in the lake\",\r\n            skill_xp_per_tick: 4,\r\n            is_unlocked: true,\r\n            gained_resources: {\r\n                resources: [\r\n                    { name: \"Ratfish\", chance: [0.2, 0.8] },\r\n                    { name: \"Carp\", chance: [0.1, 0.5] },\r\n                    { name: \"Mackerel shark\", chance: [0.05, 0.2] },\r\n                    { name: \"Catfish\", chance: [0.01, 0.1] }\r\n                ],\r\n                time_period: [120, 30],\r\n                skill_required: [10, 20],\r\n                scales_with_skill: true,\r\n            },\r\n            require_tool: true,\r\n        }),\r\n    };\r\n\t\r\n    locations[\"Waterfall basin\"].activities = {\r\n        \"enduring\": new LocationActivity({\r\n            activity_name: \"enduring\",\r\n            starting_text: \"Harden your resolve by sitting underneath the waterfall\",\r\n            skill_xp_per_tick: 2,\r\n            applied_effects: [{effect: \"Wet\", duration: 30}],\r\n            infinite: false,\r\n            availability_seasons: [\"Spring\", \"Summer\", \"Autumn\"],\r\n        }),\r\n        \"meditating\": new LocationActivity({\r\n            activity_name: \"meditating\",\r\n            starting_text: \"Sit in the rock shelter behind the waterfall and focus your mind\",\r\n            skill_xp_per_tick: 8,\r\n            is_unlocked: false,\r\n            unlock_text: \"As you finish driving the stone crabs from the rock shelter behind the waterfall, you feel a strange sense of serenity from the sounds bouncing off the rocks. This spot, surrounded by soft noise and solid stone, seems perfect to sit down and focus your mind\",\r\n        }),\r\n    };\r\n\t\r\n    locations[\"Swampland tribe\"].activities = {\r\n        \"herbalism\": new LocationActivity({\r\n            activity_name: \"herbalism\",\r\n            starting_text: \"Forage for wild herbs and vegetables in the swamplands\",\r\n            skill_xp_per_tick: 14,\r\n            is_unlocked: false,\r\n            gained_resources: {\r\n                resources: [\r\n                    {name: \"Wild onion\", chance: [0.2, 0.65]},\r\n                    {name: \"Wild garlic\", chance: [0.2, 0.65]},\r\n                    {name: \"Wild potato\", ammount: [[1,1], [1,2]], chance: [0.3, 0.6]},\r\n                    {name: \"Cooking herbs\", ammount: [[1,1], [1,2]], chance: [0.3, 0.6]}\r\n                ], \r\n                time_period: [90, 45],\r\n                skill_required: [25, 35],\r\n            }\r\n        }),\r\n    };\r\n})();\r\n\r\n//add actions\r\n(function(){\r\n    locations[\"Village\"].actions = {\r\n        \"search for delivery\": new GameAction({\r\n            action_id: \"search for delivery\",\r\n            starting_text: \"Search the village for the missing grain delivery\",\r\n            description: \"It might take some time, but it has to be somewhere\",\r\n            action_text: \"Searching the village\",\r\n            success_text: \"There it is! You see a cart loaded with grain bags, an annoyed driver, and a horse ignoring everything and calmly munching on grass\",\r\n            failure_texts: {\r\n                random_loss: [\r\n                    \"You look around for some time, but end up with nothing. Keep searching!\",\r\n                ],\r\n                conditional_loss: [\r\n                    \"You are not perceptive enough for this...\",\r\n                ]\r\n            },\r\n            conditions: [\r\n                {\r\n                    skills: {\r\n                        \"Perception\": 1,\r\n                    }\r\n                },\r\n                {\r\n                    skills: {\r\n                        \"Perception\": 5,\r\n                    }\r\n                }\r\n            ],\r\n            attempt_duration: 15,\r\n            success_chances: [0.5, 1],\r\n            rewards: {\r\n                actions: [{location: \"Village\", action: \"carry grain\"}, {location: \"Village\", action: \"pull cart\"}, {location: \"Village\", action: \"convince horse\"}],\r\n                skill_xp: {\r\n                    Perception: 100,\r\n                }\r\n            },\r\n        }),\r\n        \"carry grain\": new GameAction({\r\n            action_id: \"carry grain\",\r\n            starting_text: \"Try to carry the grain bags yourself\",\r\n            description: \"It won't be quick...\",\r\n            action_text: \"Carrying bags\",\r\n            success_text: \"After a few hours of slow and heavy work, you place the final bag in front of the storehouse. You should let that mischievous duo know that the task is done.\",\r\n            failure_texts: {\r\n                unable_to_begin: [\"You try for a bit, but you quickly realize you are not fit enough for this task.\"],\r\n            },\r\n            check_conditions_on_finish: false,\r\n            attempt_duration: 480,\r\n            success_chances: [1],\r\n            keep_progress: true,\r\n            conditions: [\r\n                {\r\n                    stats: {\r\n                        strength: 20,\r\n                        max_stamina: 80,\r\n                    }\r\n                },\r\n            ],\r\n            rewards: {\r\n                move_to: {location: \"Eastern mill\"},\r\n                skill_xp: {Weightlifting: 300},\r\n                textlines: [{dialogue: \"village millers\", lines: [\"delivered\"]}],\r\n                locks: {\r\n                    actions: [{location: \"Village\", action: \"pull cart\"}, {location: \"Village\", action: \"convince horse\"}],\r\n                },\r\n            },\r\n        }),\r\n        \"pull cart\": new GameAction({\r\n            action_id: \"pull cart\",\r\n            starting_text: \"Attempt to pull the cart by yourself\",\r\n            description: \"It own't be easy, but at least will be somewhat quick\",\r\n            action_text: \"Pulling the cart\",\r\n            success_text: \"Lo and behold, the cart begins moving as you pull it. Slow but steady, after some time you reach the storehouse. You should let that mischievous duo know that the task is done.\",\r\n            failure_texts: {\r\n                unable_to_begin: [\"You try and try, but it won't budge\"],\r\n            },\r\n            check_conditions_on_finish: false,\r\n            attempt_duration: 60,\r\n            success_chances: [1],\r\n            keep_progress: true,\r\n            conditions: [\r\n                {\r\n                    stats: {\r\n                        strength: 45,\r\n                    }\r\n                },\r\n            ],\r\n            rewards: {\r\n                move_to: {location: \"Eastern mill\"},\r\n                skill_xp: {Weightlifting: 300},\r\n                textlines: [{dialogue: \"village millers\", lines: [\"delivered\"]}],\r\n                locks: {\r\n                    actions: [{location: \"Village\", action: \"carry grain\"}, {location: \"Village\", action: \"convince horse\"}],\r\n                },\r\n            },\r\n        }),\r\n        \"convince horse\": new GameAction({\r\n            action_id: \"convince horse\",\r\n            starting_text: \"Try to convince the horse to go back to its work\",\r\n            description: \"Getting that animal back to work is the fastest way to be done\",\r\n            action_text: \"Being nice\",\r\n            success_text: \"The horse seems to understand you, as it abandons its snack and obediently pulls the cart towards the storehouse. You should let that mischievous duo know that the task is done.\",\r\n            failure_texts: {\r\n                conditional_loss: [\"No matter what you try, the horse does not care. Maybe if you had some actual experience with animals...\"],\r\n            },\r\n            attempt_duration: 10,\r\n            success_chances: [1],\r\n            conditions: [\r\n                {\r\n                    skills: {\r\n                        \"Animal handling\": 8,\r\n                    }\r\n                },\r\n            ],\r\n            rewards: {\r\n                move_to: {location: \"Eastern mill\"},\r\n                skill_xp: {\"Animal handling\": 300},\r\n                textlines: [{dialogue: \"village millers\", lines: [\"delivered\"]}],\r\n                locks: {\r\n                    actions: [{location: \"Village\", action: \"pull cart\"}, {location: \"Village\", action: \"carry grain\"}],\r\n                },\r\n            },\r\n        }),\r\n        \"hike down river\": new GameAction({\r\n            action_id: \"hike down river\",\r\n            starting_text: \"Attempt to hike through the wilderness alongside the riverbank\",\r\n            description: \"It might take a really long time, but it's the only way you're going to find those enormous crabs' nest. Or was it that enormous crab's nest?\",\r\n            action_text: \"Hiking through the wilderness, attempting to follow the river\",\r\n            success_text: \"After hiking for well over a day, you finally come across a relatively clear point on the river with recognizable landmarks and signs of crabs.\"\r\n                        + \" It feels like a long way off from the village, but you're confident that you can get back here again, and faster too\",\r\n            attempt_duration: 2160,\r\n            success_chances: [1],\r\n            rewards: {\r\n                locations: [{location: \"Downstream from the village\"}],\r\n                move_to: {location: \"Downstream from the village\"},\r\n            },\r\n        }),\r\n    };\r\n    locations[\"Nearby cave\"].actions = {\r\n        \"open the gate\": new GameAction({\r\n            action_id: \"open the gate\",\r\n            starting_text: \"Try to push the mysterious gate open\",\r\n            description: \"It's an ancient massive gate, but maybe with enough strength and training you could actually manage to push it at least a tiny bit to create enough space to walk through.\",\r\n            action_text: \"Huffing and puffing\",\r\n            success_text: \"When you are almost ready to give up, you hear the ancient hinges creak, as the gate slowly moves. Finally, you can continue deeper!\",\r\n            failure_texts: {\r\n                conditional_loss: [\"Despite trying your best, you can feel that you are just too weak for it. You should get stronger first.\"],\r\n            },\r\n            conditions: [\r\n                {\r\n                    stats: {\r\n                        strength: 200,\r\n                    }\r\n                }\r\n            ],\r\n            attempt_duration: 10,\r\n            success_chances: [1],\r\n            rewards: {\r\n                locations: [{location: \"Writhing tunnel\"}],\r\n                quest_progress: [\r\n                    {quest_id: \"The Infinite Rat Saga\", task_index: 1},\r\n                ]\r\n            },\r\n        }),\r\n        \"climb the mountain\": new GameAction({\r\n            action_id: \"climb the mountain\",\r\n            starting_text: \"Try to climb up the mountain\",\r\n            description: \"It is an ardous task that will require some good long rope and actual skill in climbing, together with good physical abilities. It will take some time, so you need to make sure you won't run out of energy halfway through.\",\r\n            action_text: \"Climbing up\",\r\n            success_text: \"Somehow you did it, you climbed all the way up! Thanks to the rope you tied on your way, further trips up and down will be much easier.\",\r\n            failure_texts: {\r\n                conditional_loss: [\"Despite trying your best, you can feel that you won't manage to do it without more training\"],\r\n                random_loss: [\r\n                    \"You almost had it, but at some point you grabbed a rock that turned out to be unstable. Be more careful next time!\", \r\n                    \"You were really close, but a gust of wind at a bad moment knocked you off balance.\",\r\n                    \"You failed to notice a falling rock and got knocked down.\"\r\n                ],\r\n                unable_to_begin: [\"While seemingly prepared, you realize you're missing an important accessory - some nice long rope is gonna be a necessity for this, especially if you want to go back down at some point.\"],\r\n            },\r\n            required: {\r\n                items_by_id: {\"Coil of rope\": {count: 1, remove_on_success: true}},\r\n            },\r\n            conditions: [\r\n                {\r\n                    skills: {\r\n                        \"Climbing\": 7,\r\n                    },\r\n                    stats: {\r\n                        strength: 50,\r\n                        agility: 50,\r\n                        max_stamina: 50,\r\n                    }\r\n                },\r\n                {\r\n                    skills: {\r\n                        \"Climbing\": 12,\r\n                    },\r\n                    stats: {\r\n                        strength: 120,\r\n                        agility: 120,\r\n                        max_stamina: 50,\r\n                    }\r\n                }\r\n            ],\r\n            attempt_duration: 60,\r\n            success_chances: [0.3, 1],\r\n            rewards: {\r\n                locations: [{location: \"Mountain path\"}],\r\n                move_to: {location: \"Mountain path\"},\r\n                skill_xp: {\r\n                    \"Climbing\": 1000,\r\n                }\r\n            },\r\n        }),\r\n    };\r\n    locations[\"Mountain path\"].actions = {\r\n        \"explore\": new GameAction({\r\n            action_id: \"explore\",\r\n            starting_text: \"Explore the area\",\r\n            description: \"Now that you are here, it's time to find if there's anything worthy of your time. Too bad you couldn't do it beforehand.\",\r\n            action_text: \"Looking around\",\r\n            success_text: \"The good news: you noticed a nice little piece of flat land that would be perfect for a camp. The bad news: there's a very angry-looking mountain goat blocking your way.\",\r\n            failure_texts: {\r\n                random_loss: [\r\n                    \"You looked under rocks and between the bushes, but you found nothing. Keep looking!\", \r\n                    \"You looked and looked, but you couldn't find anything. Rest a bit and go back to it!\",\r\n                ],\r\n            },\r\n            conditions: [],\r\n            is_unlocked: true,\r\n            attempt_duration: 60,\r\n            success_chances: [0.6],\r\n            rewards: {\r\n                locations: [{location: \"Fight the angry mountain goat\"}],\r\n            },\r\n        }),\r\n    };\r\n    locations[\"Small flat area in mountains\"].actions = {\r\n        \"create camp\": new GameAction({\r\n            action_id: \"create camp\",\r\n            starting_text: \"Establish a camp here\",\r\n            description: \"Prepare a tent, a fireplace, and a storage here to create a new base. It will be necessary before exploring further up the mountains.\",\r\n            action_text: \"Working\",\r\n            success_text: \"After a few hours of hard work, your camp is ready. You can rest here before venturing further in the mountains\",\r\n            conditions: [\r\n                {\r\n                    items_by_id: {\"Camping supplies\": {count: 1, remove: true}},\r\n                }\r\n            ],\r\n            is_unlocked: true,\r\n            check_conditions_on_finish: false,\r\n            failure_texts: {\r\n                conditional_loss: [\"You lack camping supplies!\"],\r\n            },\r\n            attempt_duration: 180,\r\n            success_chances: [1],\r\n            rewards: {\r\n                locations: [{location: \"Mountain camp\"}],\r\n                move_to: {location: \"Mountain camp\"},\r\n                locks: {\r\n                    locations: [\"Mountain path\", \"Small flat area in mountains\"],\r\n                }\r\n            },\r\n        }),\r\n    },\r\n    locations[\"Mountain camp\"].actions = {\r\n        \"explore1\": new GameAction({\r\n            action_id: \"explore1\",\r\n            starting_text: \"Explore the area further\",\r\n            description: \"With the camp created, it's time to keep exploring\",\r\n            action_text: \"Looking around\",\r\n            success_text: \"You find a reasonably gentle mountain slope with green grass and... more angry goats. At least they seem slightly smaller.\",\r\n            failure_texts: {\r\n                random_loss: [\r\n                    \"You looked under rocks and between the bushes, but you found nothing. Keep looking!\", \r\n                    \"You looked and looked, but you couldn't find anything. Rest a bit and go back to it!\",\r\n                ],\r\n            },\r\n            conditions: [],\r\n            is_unlocked: true,\r\n            attempt_duration: 60,\r\n            success_chances: [0.6],\r\n            rewards: {\r\n                locations: [{location: \"Gentle mountain slope\"}],\r\n                actions: [{location:\"Mountain camp\", action: \"explore2\"}]\r\n            },\r\n        }),\r\n        \"explore2\": new GameAction({\r\n            action_id: \"explore2\",\r\n            starting_text: \"Keep exploring\",\r\n            description: \"You have a feeling that there must be something more of value than just goats.\",\r\n            action_text: \"Looking around\",\r\n            success_text: \"You notice some plants, that you soon recognize as a potent healing ingredient that was mentioned to you by that old craftsman. It's gonna be useful if you know proper recipes.\",\r\n            failure_texts: {\r\n                random_loss: [\r\n                    \"You looked under rocks and between the bushes, but you found nothing. Keep looking!\", \r\n                    \"You looked and looked, but you couldn't find anything. Rest a bit and go back to it!\",\r\n                ],\r\n                conditional_loss: [\r\n                    \"You spot a lot of curious plants. You have a hunch that at least some of them must be useful for something, but you fail to recognize any of them. If only you knew more about herbs...\"\r\n                ]\r\n            },\r\n            conditions: [\r\n                {\r\n                        \r\n                    skills: {\r\n                            \"Herbalism\": 6,\r\n                        },\r\n                },\r\n                {\r\n                        skills: {\r\n                            \"Herbalism\": 10,\r\n                        },\r\n                }\r\n            ],\r\n            is_unlocked: false,\r\n            attempt_duration: 60,\r\n            success_chances: [0.5],\r\n            rewards: {\r\n                activities: [{location:\"Mountain camp\", activity:\"herbalism\"}],\r\n            },\r\n        }),\r\n    }\r\n    locations[\"Forest road\"].actions = {\r\n        \"search for boars\": new GameAction({\r\n            action_id: \"search for boars\",\r\n            starting_text: \"Search forest for the clearing with boars\",\r\n            description: \"It might take some time and a few attempts, but you are sure you can manage\",\r\n            action_text: \"Searching the forest\",\r\n            success_text: \"There they are! You see a clearing with tall grass and hear unmistakeable grunts and squeals\",\r\n            failure_texts: {\r\n                random_loss: [\r\n                    \"You search for some time, but end up with nothing. Next time you will try a slightly different direction\",\r\n                ],\r\n                conditional_loss: [\r\n                    \"You are not perceptive enough for this...\",\r\n                ]\r\n            },\r\n            conditions: [\r\n                {\r\n                    skills: {\r\n                        \"Perception\": 1,\r\n                    }\r\n                },\r\n                {\r\n                    skills: {\r\n                        \"Perception\": 8,\r\n                    }\r\n                }\r\n            ],\r\n            attempt_duration: 90,\r\n            success_chances: [0.5, 1],\r\n            rewards: {\r\n                locations: [{location: \"Forest clearing\"}],\r\n                skill_xp: {\r\n                    Perception: 100,\r\n                }\r\n            },\r\n        }),\r\n        \"follow the trail\": new GameAction({\r\n            action_id: \"follow the trail\",\r\n            starting_text: \"Follow the mysterious trail deeper into the forest...\",\r\n            description: \"It doesn't seem to be a smart thing to do\",\r\n            action_text: \"Following the trail\",\r\n            success_text: \"The trail leads you to a large cave. There are some broken bones lying around the entrance\",\r\n            failure_texts: {\r\n                random_loss: [\r\n                    \"At some point you got distracted and lost your way\",\r\n                ],\r\n            },\r\n            attempt_duration: 180,\r\n            success_chances: [0.7],\r\n            rewards: {\r\n                locations: [{location: \"Forest den\"}],\r\n            },\r\n            unlock_text: \"At some point during your fights, you notice a path trodden by animals. There's a lot of footprints that look like wolf's, except much larger...\"\r\n        }),\r\n        \"search predator\": new GameAction({\r\n            action_id: \"search predator\",\r\n            starting_text: \"Search for the predator that hunts direwolves\",\r\n            description: \"It's a terrible idea\",\r\n            action_text: \"Searching for the predator\",\r\n            success_text: \"You end up finding another large cave. There's a lot of bones around the entrance, some belonging to direwolves and boars\",\r\n            failure_texts: {\r\n                random_loss: [\r\n                    \"At some point you got distracted and lost your way\",\r\n                ],\r\n                conditional_loss: [\r\n                    \"You are not perceptive enough for this...\",\r\n                ]\r\n            },\r\n            attempt_duration: 180,\r\n            success_chances: [0.4, 1],\r\n            conditions: [\r\n                {\r\n                    skills: {\r\n                        \"Perception\": 1,\r\n                    }\r\n                },\r\n                {\r\n                    skills: {\r\n                        \"Perception\": 10,\r\n                    }\r\n                }\r\n            ],\r\n            rewards: {\r\n                locations: [{location: \"Bears' den\"}],\r\n                skill_xp: {\r\n                    Perception: 200,\r\n                }\r\n            },\r\n            unlock_text: \"At some point during your fights you notice a direwolf with terrible scars, clearly inflicted by an even larger predator. What could have it been?\",\r\n        }),\r\n    };\r\n    locations[\"Town farms\"].actions = {\r\n        \"dig for ants 1\": new GameAction({\r\n            action_id: \"dig for ants 1\",\r\n            action_name: \"Search for ant nests\",\r\n            starting_text: \"Dig in search of red ant nests\",\r\n            description: \"They live somewhere down there\",\r\n            action_text: \"Digging\",\r\n            success_text: \"You find an ant tunnel, just barely wide enough for you to enter\",\r\n            attempt_duration: 180,\r\n            success_chances: [1],\r\n            rewards: {\r\n                locations: [{location: \"Red ant nest 1\"}],\r\n                skill_xp: {Digging: 20},\r\n            },\r\n        }),\r\n        \"dig for ants 2\": new GameAction({\r\n            action_id: \"dig for ants 2\",\r\n            action_name: \"Search for ant nests\",\r\n            starting_text: \"Dig in search of red ant nests\",\r\n            description: \"They live somewhere down there\",\r\n            action_text: \"Digging\",\r\n            success_text: \"You find an ant tunnel, just barely wide enough for you to enter\",\r\n            attempt_duration: 240,\r\n            success_chances: [1],\r\n            rewards: {\r\n                locations: [{location: \"Red ant nest 2\"}],\r\n                skill_xp: {Digging: 30},\r\n            },\r\n        }),\r\n        \"dig for ants 3\": new GameAction({\r\n            action_id: \"dig for ants 3\",\r\n            action_name: \"Search for ant nests\",\r\n            starting_text: \"Dig in search of red ant nests\",\r\n            description: \"They live somewhere down there\",\r\n            action_text: \"Digging\",\r\n            success_text: \"You find an ant tunnel, just barely wide enough for you to enter\",\r\n            attempt_duration: 300,\r\n            success_chances: [1],\r\n            rewards: {\r\n                locations: [{location: \"Red ant nest 3\"}],\r\n                skill_xp: {Digging: 40},\r\n            },\r\n        }),\r\n        \"follow ant trail\": new GameAction({\r\n            action_id: \"follow ant trail\",\r\n            action_name: \"Follow ant trail towards the forest\",\r\n            starting_text: \"Follow ant trail towards the forest\",\r\n            description: \"There must be other nests out there\",\r\n            action_text: \"Searching\",\r\n            success_text: \"You find a massive complex of ant tunnels, just barely wide enough for you to enter\",\r\n            attempt_duration: 600,\r\n            success_chances: [1],\r\n            failure_texts: {\r\n                unable_to_begin: [\"You can't do that without a shovel!\"],\r\n            },\r\n            conditions: [{\r\n                tools_by_slot: [\"shovel\"],\r\n            }],\r\n            rewards: {\r\n                locations: [{location: \"Forest ant nest\"}],\r\n                move_to: {location: \"Forest road\"},\r\n                skill_xp: {Digging: 50},\r\n            },\r\n            unlock_text: \"While your task is finished, it seems that you might be able to find more ants away from the farms\",\r\n        }),\r\n    };\r\n    locations[\"Lake beach\"].actions = {\r\n        \"rappel waterfall\": new GameAction({\r\n            action_id: \"rappel waterfall\",\r\n            starting_text: \"Try to rappel down the cliffside next to the waterfall\",\r\n            description: \"It doesn't look that difficult, but it's still a strenuous task that will require some good long rope and proficiency in climbing, together with a fit physique. It will take a great deal of time, so make sure to prepare yourself for the task ahead\",\r\n            action_text: \"Rappelling down the cliff\",\r\n            success_text: \"It was slow, methodical work, but you've managed to secure a safe and stable pathway across the cliff face. That should make subsequent trips back up and down significantly faster in the future\",\r\n            failure_texts: {\r\n                conditional_loss: [\"Despite telling yourself that scaling down the cliff would be easy, you realize that the path is far more dangerous that you initially expected. Perhaps a more experienced mountain climber would be able to manage the hazards\"],\r\n                random_loss: [\"The routing looked easier from up top, but the slick rock wall and poor footing put you on a path to failure shortly after beginning\"],\r\n                unable_to_begin: [\"While mentally prepared, you realize you're missing an important accessory -- the rope! Rope is kind of a necessity for this, especially if you want to survive the landing!\"],\r\n            },\r\n            required: {\r\n                items_by_id: {\"Coil of rope\": {count: 1, remove_on_success: true}},\r\n            },\r\n            conditions: [\r\n              {\r\n                  skills: {\r\n                        \"Climbing\": 17,\r\n                    },\r\n                    stats: {\r\n                        strength: 400,\r\n                        agility: 350,\r\n                        max_stamina: 1000,\r\n                    }\r\n              },\r\n              {\r\n                skills: {\r\n                    \"Climbing\": 25,\r\n                },\r\n                stats: {\r\n                    strength: 600,\r\n                    agility: 1000,\r\n                    max_stamina: 1500,\r\n                },\r\n                },\r\n            ],\r\n            is_unlocked: true,\r\n            attempt_duration: 180,\r\n            success_chances: [0.45, 1],\r\n            rewards: {\r\n                locations: [{location: \"Waterfall basin\"}],\r\n                move_to: {location: \"Waterfall basin\"},\r\n                skill_xp: {\r\n                    \"Climbing\": 50000,\r\n                }\r\n            }\r\n        }),\r\n        \"create lake camp\": new GameAction({\r\n            action_id: \"create lake camp\",\r\n            starting_text: \"Establish a camp on top of the giant crab's nest\",\r\n            description: \"Set a cot, fire pit, and storage chest here to establish a new camp site. It will be necessary if you are going to rest in the area\",\r\n            action_text: \"Building a camp\",\r\n            success_text: \"After a few hours of hard work, your beachside camp is ready. You can rest here instead of returning back to the village\",\r\n            conditions: [\r\n                {\r\n                    items_by_id: {\"Camping supplies\": {count: 1, remove: true}},\r\n                }\r\n            ],\r\n            is_unlocked: true,\r\n            check_conditions_on_finish: false,\r\n            failure_texts: {\r\n                conditional_loss: [\"It's going to be hard to make a camp without camping supplies!\"],\r\n            },\r\n            attempt_duration: 120,\r\n            success_chances: [1],\r\n            rewards: {\r\n                locations: [{location: \"Lake camp\"}],\r\n                move_to: {location: \"Lake camp\"},\r\n            },\r\n        }),\r\n        \"create lake climbing\": new GameAction({\r\n            action_id: \"create lake climbing\",\r\n            starting_text: \"Prepare a rappel practice point\",\r\n            description: \"The cliff face here would make a good place to practice advance climbing techniques such as rappelling\",\r\n            action_text: \"Searching for a safe rappel point\",\r\n            success_text: \"After an hour, you manage to safely secure some rope over a shallow underhang close to the edge of the cliff. You can practice here before trying to make your way down the entire cliffside\",\r\n            conditions: [\r\n                {\r\n                    items_by_id: {\"Coil of rope\": {count: 1, remove: true}},\r\n                },\r\n            ],\r\n            is_unlocked: true,\r\n            check_conditions_on_finish: false,\r\n            failure_texts: {\r\n                conditional_loss: [\"It's going to be hard to rappel without a rope!\"],\r\n            },\r\n            attempt_duration: 60,\r\n            success_chances: [1],\r\n            rewards: {\r\n                activities: [{location:\"Lake beach\", activity: \"climbing\"}],\r\n            },\r\n        }),\r\n        \"create lake weightlifting\": new GameAction({\r\n            action_id: \"create lake weightlifting\",\r\n            starting_text: \"Wrap a boulder for sled pull training\",\r\n            description: \"Looking at the large boulders nearby, you consider that dragging or pulling one around the beach with rope might be good strength training\",\r\n            action_text: \"Wrapping a boulder\",\r\n            success_text: \"After about an hour, you manage to securely wrap a boulder with some rope. Grabbing the end and pulling with all your might, the boulder inches forward with you\",\r\n            conditions: [\r\n                {\r\n                    items_by_id: {\"Coil of rope\": {count: 1, remove: true}},\r\n                },\r\n            ],\r\n            is_unlocked: true,\r\n            check_conditions_on_finish: false,\r\n            failure_texts: {\r\n                conditional_loss: [\"You're going to need some rope before you wrap anything!\"],\r\n            },\r\n            attempt_duration: 60,\r\n            success_chances: [1],\r\n            rewards: {\r\n                activities: [{location:\"Lake beach\", activity: \"weightlifting\"}],\r\n            },\r\n        }),\r\n    };\r\n\r\n    locations[\"Forest lake\"].actions = {\r\n        \"search1\": new GameAction({\r\n            action_id: \"search1\",\r\n            action_name: \"Dive to the bottom of the lake\",\r\n            starting_text: \"Dive to the bottom of the lake\",\r\n            description: \"See what you can discover down there\",\r\n            action_text: \"Exploring\",\r\n            success_text: \"You captured the attention of the lake's true apex predator. It follows you back to the shore\",\r\n            failure_texts: {\r\n                conditional_loss: [\"You need to get more used to water and have lung capacity to go that deep\"],\r\n                random_loss: [\r\n                    \"You run out of breath before you can reach the bottom\",\r\n                    \"Nothing catches your attention this time\",\r\n                ],\r\n            },\r\n            conditions: [\r\n                {\r\n                    skills: {\r\n                        \"Swimming\": 10,\r\n                        \"Breathing\": 10,\r\n                        Perception: 1,\r\n                    }\r\n                },\r\n                {\r\n                    skills: {\r\n                        \"Swimming\": 25,\r\n                        \"Breathing\": 25,\r\n                        Perception: 10,\r\n                    }\r\n                }\r\n            ],\r\n            is_unlocked: true,\r\n            attempt_duration: 120,\r\n            success_chances: [0.2, 1],\r\n            rewards: {\r\n                locations: [{ location: \"Frogs\" }],\r\n                skill_xp: { Swimming: 500, Breathing: 500, Perception: 500, },\r\n            },\r\n        }),\r\n        \"search2\": new GameAction({\r\n            action_id: \"search2\",\r\n            action_name: \"Finish exploring the bottom of the lake\",\r\n            starting_text: \"Finish exploring the bottom of the lake\",\r\n            description: \"See what alse you can discover down there\",\r\n            action_text: \"Exploring\",\r\n            success_text: \"You spot something shining on the lake's bed\",\r\n            failure_texts: {\r\n                conditional_loss: [\"You need to get more used to water and have lung capacity to go that deep\"],\r\n                random_loss: [\r\n                    \"You run out of breath before you can reach the bottom\",\r\n                    \"Nothing catches your attention this time\",\r\n                ],\r\n            },\r\n            conditions: [\r\n                {\r\n                  skills: {\r\n                        \"Swimming\": 10,\r\n                        \"Breathing\": 10,\r\n                        Perception: 2,\r\n                    }\r\n                },\r\n                {\r\n                    skills: {\r\n                        \"Swimming\": 25,\r\n                        \"Breathing\": 25,\r\n                        Perception: 10,\r\n                    }\r\n                }\r\n            ],\r\n            is_unlocked: false,\r\n            attempt_duration: 60,\r\n            success_chances: [0.2, 1],\r\n            rewards: {\r\n                action: [{ location: \"Forest lake\", action: \"mining\" }],\r\n                skill_xp: { Swimming: 800, Breathing: 800, Perception: 800, },\r\n            },\r\n        }),\r\n        \"gaze\": new GameAction({\r\n            action_id: \"gaze\",\r\n            action_name: \"Follow where the river leads\",\r\n            starting_text: \"Follow where the river leads\",\r\n            description: \"...into the darker forest...\",\r\n            action_text: \"Exploring\",\r\n            success_text: \"[TBD]\",\r\n            failure_texts: {\r\n                conditional_loss: [\"You need to get more used to water and have lung capacity to go that deep\"],\r\n                random_loss: [`You may have felt like you can already brave anything this forest can throw at you. But the part stretching before you is more imposing than anything you've seen so far.<br><br>\r\nThe river coming from the lake vanishes in darkness as the foliage is too dense to let in light. The trees there are growing larger, denser... More ancient.<br><br>\r\nYou try to make make out the details of what looks like a bird flying in the distance. It has four legs...`],\r\n            },\r\n            is_unlocked: true,\r\n            success_chances: [0,0],\r\n        }),\r\n    },\t\r\n    locations[\"Longhouse\"].actions = {\r\n        \"learn forage\": new GameAction({\r\n            action_id: \"learn forage\",\r\n            starting_text: \"Ask the scout to teach you about local herbs and vegetables\",\r\n            description: \"The scout had mentioned interesting local plants, maybe she can teach you about them\",\r\n            action_text: \"Learning how to forage from the scout\",\r\n            success_text: \"The scout explains the local herbs, root vegetables and tubers that grow in the outlying swamplands. You feel confident that you could find them yourself at this point\",\r\n            failure_texts: {\r\n                conditional_loss: [\"The scout tries to explain the look and uses of local flora, but you're having a hard time understanding what she's talking about. Maybe if you were a better herbalist, it would be easier\"],\r\n                random_loss: [\r\n                    \"The scout tries to explain the look and uses of local flora, but you just can't really internalize what she's telling you\",\r\n                    \"The scout tries to explain the look and uses of local flora, but throughout the hour, your mind wanders to everything she's told you recently, and you have difficulty focusing on what she's trying to teach you\",\r\n                    \"The scout tries to explain the look and uses of local flora, but her pain is too great to properly teach you anything right now\",\r\n                    \"The scout tries to explain the look and uses of local flora, but nothing she tells you is very helpful\",\r\n                    \"The scout tries to explain the look and uses of local flora, but she's just telling you things you've already learned\",\r\n                    \"The scout tries to explain the look and uses of local flora, but you two get distracted and spend the hour talking about something else. It was nice\",\r\n                        \r\n              ],\r\n            },\r\n            conditions: [\r\n                {\r\n                    skills: {\r\n                        \"Herbalism\": 20,\r\n                    },\r\n                },\r\n                {\r\n                    skills: {\r\n                        \"Herbalism\": 25,\r\n                    },\r\n                },\r\n            ],\r\n            attempt_duration: 60,\r\n            success_chances: [0.45, 1],\r\n            rewards: {\r\n                activities: [{location:\"Swampland tribe\", activity: \"herbalism\"}],\r\n            },\r\n        }),\r\n    };\r\n})();\r\n\r\n//setup ids\r\n(function(){\r\n    Object.keys(locations).forEach(location_key => {\r\n        Object.keys(locations[location_key].activities || {}).forEach(activity_key => {\r\n            locations[location_key].activities[activity_key].activity_id = activity_key;\r\n        });\r\n        locations[location_key].id = location_key;\r\n    });\r\n})();\r\nfill_market_regions();\r\nexport { Location, Combat_zone, LocationActivity, locations, location_types, get_location_type_penalty, favourite_locations };", "\r\nconst effect_templates = {}; \r\n//templates, since some effects will appear across multiple items but with different durations\r\n\r\nclass ActiveEffect {\r\n    /**\r\n     * \r\n     * @param {Object} effect_data\r\n     * @param {String} effect_data.name\r\n     * @param {String} [effect_data.id]\r\n     * @param {Number} effect_data.duration\r\n     * @param {Object} effect_data.effects {stats}\r\n     */\r\n    constructor({name, id, description = null, duration, effects, tags, potency, group_tags, affected_by_travel = true}) {\r\n        this.name = name;\r\n        this.id = id;\r\n        this.description = description;\r\n        this.duration = duration ?? 0;\r\n        this.effects = effects;\r\n        if(!this.effects.bonus_skill_levels) {\r\n            this.effects.bonus_skill_levels = {};\r\n        }\r\n        if(!this.effects.stats) {\r\n            this.effects.stats = {};\r\n        }\r\n        this.affected_by_travel = affected_by_travel;\r\n        this.tags = tags || {};\r\n        this.group_tags = group_tags || {}; //used for grouping and prioritizing highest in group; instead of simple 'true', values are Numbers with higher = more important\r\n        this.tags[\"effect\"] = true;\r\n        this.potency = potency || 0;\r\n        //todo: implement buff/debuff removal; use potency to check if effect A should remove effect B (the stronger survives)\r\n        //or make it work with group_tags instead?\r\n    }\r\n}\r\n\r\n//weather effects\r\n(()=>{\r\n    effect_templates[\"Wet\"] = new ActiveEffect({\r\n        name: \"Wet\",\r\n        effects: {\r\n            stats: {\r\n                cold_tolerance: {flat: -5},\r\n            }\r\n        },\r\n    });\r\n\r\n    effect_templates[\"Cold\"] = new ActiveEffect({\r\n        name: \"Cold\",\r\n        effects: {\r\n            stats: {\r\n                stamina_efficiency: {multiplier: 0.8},\r\n                strength: {multiplier: 0.9},\r\n            }\r\n        },\r\n        group_tags: {cold: 1},\r\n    });\r\n    effect_templates[\"Very cold\"] = new ActiveEffect({\r\n        name: \"Very cold\",\r\n        effects: {\r\n            stats: {\r\n                stamina_efficiency: {multiplier: 0.6},\r\n                dexterity: {multiplier: 0.8},\r\n                agility: {multiplier: 0.8},\r\n                strength: {multiplier: 0.8},\r\n            }\r\n        },\r\n        group_tags: {cold: 2},\r\n    });\r\n    effect_templates[\"Freezing\"] = new ActiveEffect({\r\n        name: \"Freezing\",\r\n        effects: {\r\n            stats: {\r\n                stamina_efficiency: {multiplier: 0.3},\r\n                dexterity: {multiplier: 0.6},\r\n                agility: {multiplier: 0.6},\r\n                strength: {multiplier: 0.6},\r\n                health_regeneration_flat: {multiplier: 0.6},\r\n                health_regeneration_percent: {multiplier: 0.6},\r\n            },\r\n            xp_multipliers: {\r\n                all: 0.6,\r\n            }\r\n        },\r\n        group_tags: {cold: 3},\r\n    });\r\n    effect_templates[\"Hypothermia\"] = new ActiveEffect({\r\n        name: \"Hypothermia\",\r\n        effects: {\r\n            stats: {\r\n                stamina_efficiency: {multiplier: 0.1},\r\n                dexterity: {multiplier: 0.3},\r\n                agility: {multiplier: 0.3},\r\n                strength: {multiplier: 0.4},\r\n                health_regeneration_flat: {multiplier: 0.2},\r\n                health_regeneration_percent: {multiplier: 0.2},\r\n            },\r\n            xp_multipliers: {\r\n                all: 0.3,\r\n            }\r\n        },\r\n        group_tags: {cold: 4},\r\n    });\r\n})();\r\n/////////////////////////////////////////\r\n\r\n//consumables' effects\r\n(()=>{\r\n    effect_templates[\"Basic meal\"] = new ActiveEffect({\r\n        name: \"Basic meal\",\r\n        effects: {\r\n            stats: {\r\n                stamina_regeneration_flat: {flat: 0.5},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"food\": true},\r\n    });\r\n\r\n    effect_templates[\"Well hydrated\"] = new ActiveEffect({\r\n        name: \"Well hydrated\",\r\n        effects: {\r\n            stats: {\r\n                stamina_regeneration_flat: {flat: 1},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"food\": true},\r\n    });\r\n\r\n    effect_templates[\"Weak healing powder\"] = new ActiveEffect({\r\n        name: \"Weak healing powder\",\r\n        effects: {\r\n            stats: {\r\n                health_regeneration_flat: {flat: 2},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"medicine\": true},\r\n    });\r\n    effect_templates[\"Healing powder\"] = new ActiveEffect({\r\n        name: \"Healing powder\",\r\n        effects: {\r\n            stats: {\r\n                health_regeneration_flat: {flat: 5},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"medicine\": true},\r\n    });\r\n    effect_templates[\"Weak healing potion\"] = new ActiveEffect({\r\n        name: \"Weak healing potion\",\r\n        effects: {\r\n            stats: {\r\n                health_regeneration_flat: {flat: 8},\r\n                health_regeneration_percent: {flat: 1},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"medicine\": true},\r\n    });\r\n    effect_templates[\"Healing potion\"] = new ActiveEffect({\r\n        name: \"Healing potion\",\r\n        effects: {\r\n            stats: {\r\n                health_regeneration_flat: {flat: 20},\r\n                health_regeneration_percent: {flat: 2},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"medicine\": true},\r\n    });\r\n    effect_templates[\"Weak healing balm\"] = new ActiveEffect({\r\n        name: \"Weak healing balm\",\r\n        effects: {\r\n            stats: {\r\n                health_regeneration_flat: {flat: 5},\r\n                health_regeneration_percent: {flat: 0.5},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"medicine\": true},\r\n    });\r\n\r\n    effect_templates[\"Cheap meat meal\"] = new ActiveEffect({\r\n        name: \"Cheap meat meal\",\r\n        effects: {\r\n            stats: {\r\n                stamina_regeneration_flat: {flat: 1},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"food\": true},\r\n    });\r\n    effect_templates[\"Simple meat meal\"] = new ActiveEffect({\r\n        name: \"Simple meat meal\",\r\n        effects: {\r\n            stats: {\r\n                stamina_regeneration_flat: {flat: 1},\r\n                health_regeneration_flat: {flat: 1},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"food\": true},\r\n    });\r\n    effect_templates[\"Decent meat meal\"] = new ActiveEffect({\r\n        name: \"Decent meat meal\",\r\n        effects: {\r\n            stats: {\r\n                stamina_regeneration_flat: {flat: 2},\r\n                health_regeneration_flat: {flat: 2},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"food\": true},\r\n    });\r\n    effect_templates[\"Hot meal\"] = new ActiveEffect({\r\n        name: \"Hot meal\",\r\n        effects: {\r\n            stats: {\r\n                cold_tolerance: {flat: 3},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"food\": true},\r\n    });\r\n    effect_templates[\"Slight food poisoning\"] = new ActiveEffect({\r\n        name: \"Slight food poisoning\",\r\n        effects: {\r\n            stats: {\r\n                health_loss_flat: {flat: -0.5},\r\n            }\r\n        },\r\n        tags: {\"debuff\": true, \"poison\": true},\r\n    });\r\n\teffect_templates[\"Tough meat meal\"] = new ActiveEffect({\r\n        name: \"Tough meat meal\",\r\n        effects: {\r\n            stats: {\r\n                stamina_regeneration_flat: {flat: .5},\r\n                health_regeneration_flat: {flat: .1},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"food\": true},\r\n    });\r\n\t\teffect_templates[\"Simple seafood soup\"] = new ActiveEffect({\r\n        name: \"Simple seafood soup\",\r\n        effects: {\r\n            stats: {\r\n                stamina_regeneration_flat: {flat: 1.5},\r\n                health_regeneration_flat: {flat: .5},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"food\": true},\r\n    });\r\n\t\teffect_templates[\"Varied meat meal\"] = new ActiveEffect({\r\n        name: \"Varied meat meal\",\r\n        effects: {\r\n            stats: {\r\n                stamina_regeneration_flat: {flat: 2},\r\n                health_regeneration_flat: {flat: 1},\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"food\": true},\r\n    });\r\n\t\teffect_templates[\"Varied seafood meal\"] = new ActiveEffect({\r\n        name: \"Varied seafood meal\",\r\n        effects: {\r\n            xp_multipliers: {\r\n                all: 1.25\r\n            }\r\n        },\r\n        tags: {\"buff\": true, \"food\": true},\r\n});\r\n})();\r\n\r\n\r\n//combat effects\r\n(()=>{\r\n    effect_templates[\"Irritation\"] = new ActiveEffect({\r\n        name: \"Irritation\",\r\n        description: \"Sensations caused by a foreign substance are making it difficult to concentrate\",\r\n        effects: {\r\n            stats: {\r\n                intuition: {multiplier: 0.75},\r\n            }\r\n        },\r\n        tags: { \"debuff\": true, \"poison\": true },\r\n        group_tags: {psychedelic: 1}\r\n    });\r\n    effect_templates[\"Confusion\"] = new ActiveEffect({\r\n        name: \"Confusion\",\r\n        description: \"An intoxicating substance is making you unable to think clearly\",\r\n        effects: {\r\n            stats: {\r\n                intuition: {multiplier: 0.5},\r\n            }\r\n        },\r\n        tags: {\"debuff\": true, \"poison\": true},\r\n        group_tags: {psychedelic: 2}\r\n        });\r\n    effect_templates[\"Hallucinations\"] = new ActiveEffect({\r\n        name: \"Hallucinations\",\r\n        description: \"A psychedelic substance is making it hard to tell what's real\",\r\n        effects: {\r\n            stats: {\r\n                intuition: {multiplier: 0.25},\r\n            }\r\n        },\r\n        tags: {\"debuff\": true, \"poison\": true},\r\n        group_tags: {psychedelic: 3}\r\n    });\r\n\r\n    effect_templates[\"Sticky\"] = new ActiveEffect({\r\n        name: \"Sticky\",\r\n        description: \"Covered in a sticky substance that restricts your movements\",\r\n        effects: {\r\n            stats: {\r\n                dexterity: { multiplier: 0.75 },\r\n                agility: { multiplier: 0.75 },\r\n                attack_speed: { multiplier: 0.75 }\r\n            }\r\n        },\r\n        tags: { \"debuff\": true },\r\n    });\r\n\r\n    effect_templates[\"Weak necrotizing venom\"] = new ActiveEffect({\r\n        name: \"Weak necrotizing venom\",\r\n        effects: {\r\n            stats: {\r\n                health_loss_flat: {flat: -5},\r\n            }\r\n        },\r\n        tags: { \"debuff\": true, \"poison\": true },\r\n    });\r\n    effect_templates[\"Mild necrotizing venom\"] = new ActiveEffect({\r\n        name: \"Mild necrotizing venom\",\r\n        effects: {\r\n            stats: {\r\n                health_loss_flat: {flat: -15},\r\n            }\r\n        },\r\n        tags: { \"debuff\": true, \"poison\": true },\r\n    });\r\n    effect_templates[\"Paralysing poison\"] = new ActiveEffect({\r\n        name: \"Paralysing poison\",\r\n        effects: {\r\n            stats: {\r\n                attack_speed: { multiplier: 0.5 }\r\n            }\r\n        },\r\n        tags: { \"debuff\": true, \"poison\": true },\r\n    });\r\n    effect_templates[\"Infected lungs\"] = new ActiveEffect({\r\n        name: \"Infected lungs\",\r\n        effects: {\r\n            stats: {\r\n                stamina_efficiency: { multiplier: 0.5 }\r\n            }\r\n        },\r\n        tags: { \"debuff\": true, \"poison\": true },\r\n    });\r\n    effect_templates[\"Convulsive poison\"] = new ActiveEffect({\r\n        name: \"Convulsive poison\",\r\n        description: \"Hands are trembling, making it hard to strike with precision\",\r\n        effects: {\r\n            stats: {\r\n                dexterity: { multiplier: 0.5 },\r\n                crit_rate: { multiplier: 0.5 }\r\n            }\r\n        },\r\n        tags: { \"debuff\": true, \"poison\": true },\r\n    });\r\n})();\r\n\r\neffect_templates[\"Recovering\"] = new ActiveEffect({\r\n    name: \"Recovering\",\r\n    effects: {\r\n        xp_multipliers: {\r\n            all: 0.2,\r\n        }\r\n    },\r\n    tags: {\"debuff\": true},\r\n    affected_by_travel: false,\r\n});\r\n\r\n//export reward\r\neffect_templates[\"Spark of Inspiration\"] = new ActiveEffect({\r\n    name: \"Spark of Inspiration\",\r\n    effects: {\r\n        xp_multipliers: {\r\n            all: 1.5,\r\n        }\r\n    },\r\n    tags: {\"buff\": true},\r\n    affected_by_travel: false,\r\n});\r\n\r\nObject.keys(effect_templates).forEach(effect_key => {\r\n    effect_templates[effect_key].id = effect_key;\r\n});\r\n\r\nexport {effect_templates, ActiveEffect};", "import { InventoryHaver } from \"./inventory.js\";\r\nimport { exit_displayed_storage, update_displayed_storage } from \"./display.js\";\r\nimport { add_to_character_inventory, remove_from_character_inventory, character } from \"./character.js\";\r\n\r\nconst player_storage = new InventoryHaver();\r\nlet storage_open = false;\r\n\r\n/**\r\n * @param {Array} items [{item_key, item_count}]\r\n */\r\nfunction add_to_storage(items) {\r\n    player_storage.add_to_inventory(items);\r\n\r\n    update_displayed_storage();\r\n}\r\n\r\n/**\r\n * @param {Array} items [{item_key, count}]\r\n */\r\nfunction remove_from_storage(items) {\r\n    player_storage.remove_from_inventory(items);\r\n    \r\n    update_displayed_storage();\r\n}\r\n\r\n//kinda pointless but keep it in case there are changes\r\nfunction open_storage(items) {\r\n    update_displayed_storage(items);\r\n    storage_open = true;\r\n}\r\n\r\n//kinda pointless but keep it in case there are changes\r\nfunction close_storage(items) {\r\n    exit_displayed_storage(items);\r\n    storage_open = false;\r\n}\r\n\r\n/**\r\n * @param {Object} item {item_key, count}\r\n */\r\nfunction move_item_to_storage(item) {\r\n    let count = Math.min(item.count, character.inventory[item.item_key].count);\r\n    remove_from_character_inventory([{...item, item_count: count}]);\r\n    add_to_storage([{...item, count}]);\r\n}\r\n\r\n/**\r\n * @param {Array} item [{item_key, item_count}]\r\n */\r\nfunction remove_item_from_storage(item) {\r\n    let count = Math.min(item.count, player_storage.inventory[item.item_key].count);\r\n    add_to_character_inventory([{...item, count}]);\r\n    remove_from_storage([{...item, item_count: count}]);\r\n}\r\n\r\nfunction is_storage_open() {\r\n    return storage_open;\r\n}\r\n\r\nexport {\r\n    player_storage, \r\n    add_to_storage, remove_from_storage, open_storage, close_storage,\r\n    move_item_to_storage, remove_item_from_storage, is_storage_open\r\n}", "\"use strict\";\r\n\r\nimport { add_quest_to_display, log_message, update_displayed_quest, update_displayed_quest_task } from \"./display.js\";\r\nimport { process_rewards } from \"./main.js\";\r\n\r\nconst quests = {};\r\nconst active_quests = {};\r\n\r\nclass QuestTask {\r\n    constructor({\r\n        task_description = \"\", //optional\r\n        task_condition = {}, \r\n        //conditions for task to be completed; can be skipped if it's meant to be achieved via some rewards object  \r\n        task_rewards = {}, //generally skipped in favour of quest reward but could sometimes have something?\r\n        is_hidden = false, //keep it false most of the time, but could be used as a fake way of making quests with no visible requirement for progress\r\n        is_finished = false,\r\n        \r\n    })\r\n    {\r\n        this.task_description = task_description;\r\n        this.task_condition = task_condition;\r\n        this.task_rewards = task_rewards;\r\n        this.is_hidden = is_hidden;\r\n        this.is_finished = is_finished;\r\n\r\n        Object.keys(this.task_condition).forEach(task_group => {\r\n            Object.keys(this.task_condition[task_group]).forEach(task_type => {\r\n                    Object.keys(this.task_condition[task_group][task_type]).forEach(task_target_id => {\r\n                        this.task_condition[task_group][task_type][task_target_id].current = 0;\r\n                    });\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nclass Quest {\r\n    constructor({\r\n                quest_name, //for display, can be skipped if getQuestName covers all possibilites\r\n                quest_id, //can be skipped, will be set by a short script at the end of the file\r\n                quest_description, // -||-\r\n                questline, //questline for grouping or something, skippable\r\n                quest_tasks = [], //an array of tasks that need to be completed one by one\r\n                quest_condition, //conditions for task to be completed; can be skipped if it's meant to be achieved via some rewards object; works the same as in QuestTask\r\n                quest_rewards, //may include a new quest to automatically start\r\n                display_priority = Infinity, //the lower, the higher up it will show\r\n                is_hidden = false, //hidden quests are not visible and are meant to function as additional unlock mechanism; name and description are skipped\r\n                is_finished = false,\r\n                is_repeatable = false, //true => doesn't get locked after completion and can be gained again\r\n                getQuestName = ()=>{return this.quest_name;},\r\n                getQuestDescription = ()=>{return this.quest_description;},\r\n    }) {\r\n        this.quest_name = quest_name;\r\n        this.quest_id = quest_id;\r\n        this.questline = questline;\r\n        this.quest_tasks = quest_tasks;\r\n        this.quest_description = quest_description;\r\n        this.quest_rewards = quest_rewards || {};\r\n        this.display_priority = display_priority; \r\n        this.is_hidden = is_hidden;\r\n        this.is_finished = is_finished;\r\n        this.is_repeatable = is_repeatable;\r\n        this.quest_condition = quest_condition;\r\n        this.getQuestName = getQuestName;\r\n        this.getQuestDescription = getQuestDescription;\r\n    }\r\n\r\n    getCompletedTaskCount(){\r\n        if(this.quest_tasks.length == 0) {\r\n            return 0;\r\n        } else {\r\n            return this.quest_tasks.filter(task => task.is_finished).length;\r\n        }\r\n    }\r\n}\r\n\r\nconst questManager = {\r\n    startQuest({quest_id, should_inform = true}) {\r\n        const quest = quests[quest_id];\r\n        if((!quest.is_finished || quest.is_repeatable) && !this.isQuestActive(quest_id)) {\r\n            active_quests[quest_id] = new Quest(quests[quest_id]);\r\n        }\r\n\r\n        if(!quest.is_hidden) {\r\n            add_quest_to_display(quest_id);\r\n            if(should_inform) {\r\n                log_message(`Started a new quest: ${quests[quest_id].getQuestName()}`);\r\n            }\r\n        }\r\n    },\r\n\r\n    isQuestActive(quest_id) {\r\n        return quest_id in active_quests;\r\n    },\r\n\r\n    isQuestFinished(quest_id) {\r\n        return quests[quest_id].is_finished;\r\n    },\r\n\r\n    finishQuest({quest_id, only_unlocks, is_from_loading, skip_rewards}) {\r\n\r\n        if(this.isQuestActive(quest_id)) {\r\n            let quest = quests[quest_id];\r\n            if(!quest.is_repeatable) {\r\n                quest.is_finished = true;\r\n            }\r\n            delete active_quests[quest_id];\r\n            if(!quests[quest_id].is_hidden) {\r\n                update_displayed_quest(quest_id);\r\n                if(!is_from_loading) {\r\n                    log_message(`Finished a quest: \"${quests[quest_id].getQuestName()}\"`);\r\n                }\r\n            }\r\n\r\n            if(!skip_rewards) {\r\n                process_rewards({rewards: quests[quest_id].quest_rewards, source_type: \"Quest\", source_name: quests[quest_id].getQuestName(), only_unlocks: only_unlocks, is_from_loading});\r\n            }\r\n        }\r\n    },\r\n\r\n    finishQuestTask({quest_id, task_index, only_unlocks, skip_warning = false, allowed_to_finish_quest = true, skip_message = false}) {\r\n        if(this.isQuestActive(quest_id)) {\r\n            let quest = quests[quest_id];\r\n            quest.quest_tasks[task_index].is_finished = true;\r\n            if(!quests[quest_id].is_hidden) {\r\n                //update_displayed_quest_task(quest_id, task_index);\r\n                update_displayed_quest(quest_id);\r\n                if(!skip_message) {\r\n                    if(!quests[quest_id].quest_tasks[task_index].is_hidden) {\r\n                        log_message(`Finished a task for a quest: \"${quests[quest_id].getQuestName()}\"`);\r\n                    } else {\r\n                        log_message(`Made some progress in quest: \"${quests[quest_id].getQuestName()}\"`);\r\n                    }\r\n                }\r\n            }\r\n\r\n            process_rewards({rewards: quest.quest_tasks[task_index].task_rewards, source_type: \"Quest\", source_name: quests[quest_id].getQuestName(), only_unlocks: only_unlocks});\r\n\r\n            const remaining_tasks = active_quests[quest_id].quest_tasks.filter(task => !task.is_finished);\r\n            if(allowed_to_finish_quest && remaining_tasks.length == 0) { //no more tasks\r\n                this.finishQuest({quest_id: quest_id});\r\n                \r\n            }\r\n\r\n        } else {\r\n            if(!skip_warning) {\r\n                console.warn(`Cannot finish task at index ${task_index} for quest \"${quest_id}\", as it's not a currently active quest!`);\r\n            }\r\n        }\r\n    },\r\n\r\n    catchQuestEvent({quest_event_type, quest_event_target, quest_event_count, additional_quest_tags = {}}) {\r\n        Object.keys(active_quests).forEach(active_quest_id => {\r\n            if(!(active_quest_id in active_quests)) {\r\n                //can happen if one quest deletes another\r\n                return;\r\n            }\r\n\r\n            const current_task_index = active_quests[active_quest_id].quest_tasks.findIndex(task => !task.is_finished); //get the first unfinished\r\n            const current_task = active_quests[active_quest_id].quest_tasks[current_task_index];\r\n\r\n            if(!(\"any\" in current_task.task_condition) && !(\"all\" in current_task.task_condition)) {\r\n                //no conditions (meaning it's progressed via rewards), nothing to check\r\n                return;\r\n            }\r\n\r\n            let is_any_met = false;//\"any\" in current_task.task_condition?false:true;\r\n            let is_all_met = true;//\"all\" in current_task.task_condition?true:false;\r\n            Object.keys(current_task.task_condition).forEach(task_group => { //any/all\r\n            /*\r\n                task_group (any/all): {\r\n                    task_type (kill/kill_any/clear/reach_skill/enter_location/something_else?): { <- quest_event_type\r\n                        task_target_id (some related id): { <- quest_event_target\r\n                            target: Number,   //for enter_location, best put it at 1; for reach_skill, value is set to quest_event_count instead of being incremented by it\r\n                            current: Number,\r\n                            requirements: {}, //additional tags needed, like \"weapon: unarmed\" making it required to use unarmed\r\n                            restrictions: {} //opposite of requirements, like \"weapon: unarmed\" making it required to NOT use unarmed\r\n                        }\r\n                    }\r\n                }\r\n\r\n                //\r\n\r\n                any: {\r\n                    kill: { //by id\r\n                            \"Wolf rat\": { target: 10, current: 0, requirements: [],}, \r\n                            \"Wolf\": {target: 5, current: 0, requirements: [],}\r\n                    },\r\n                    kill_any: {\"Pest\": {requirements: [], target: , current: ,}}}, //by tags\r\n                    clear: {\"Infested field\": {}} //by id\r\n                }\r\n                all:{\r\n                    //same\r\n                }\r\n            */\r\n\r\n                \r\n                Object.keys(current_task.task_condition[task_group]).forEach(task_type => { //kill/kill_any/reach_skill/etc\r\n                    Object.keys(current_task.task_condition[task_group][task_type]).forEach(task_target_id => { //\"Village\", \"Wolf\", etc\r\n                        if(!current_task.task_condition[task_group][task_type][task_target_id].current) {\r\n                            current_task.task_condition[task_group][task_type][task_target_id].current = 0;\r\n                        }\r\n\r\n                        //if event is of proper type, check further conditions, increase the count and check if it's completed\r\n                        if(quest_event_type === task_type && quest_event_target === task_target_id) {\r\n\r\n                            let requirements_met = true;\r\n\r\n                            //check if additional requirements are not met (present in additional tags)\r\n                            const requirements = current_task.task_condition[task_group][task_type][task_target_id].requirements;\r\n                            Object.keys(requirements || {}).forEach(requirement => {\r\n                                if(!additional_quest_tags[requirement] || additional_quest_tags[requirement] != requirements[requirement]) {\r\n                                    requirements_met = false;\r\n                                }\r\n                            });\r\n\r\n                            if(requirements_met) {\r\n                                const restrictions = current_task.task_condition[task_group][task_type][task_target_id].restrictions;\r\n                                Object.keys(restrictions || {}).forEach(restriction => {\r\n                                    \r\n                                    if(additional_quest_tags[restriction] && additional_quest_tags[restriction] === restrictions[restriction]) {\r\n                                        requirements_met = false;\r\n                                    }\r\n                                });\r\n                            }\r\n\r\n                            //if they are not met, return without changing .current\r\n                            if(!requirements_met) {\r\n                                is_all_met = false; //set to false as current task_target cannot be possibly fulfilled in this action but the other check wouldn't be reached\r\n                                return;\r\n                            }\r\n\r\n                            if(task_type === \"reach_skill\") {\r\n                                current_task.task_condition[task_group][task_type][task_target_id].current = quest_event_count;\r\n                            } else {\r\n                                current_task.task_condition[task_group][task_type][task_target_id].current += quest_event_count;\r\n                            }\r\n                        }\r\n\r\n                        //any => set to true after first met, as only one is needed\r\n                        //all => set to false after first not met, as all are needed\r\n                        //check if conditions are met, do it irrespectible of quest_event_type/target as is_all_met needs to consider all (duh), instead of just the one type that was passed\r\n                        if(task_group === \"any\" && current_task.task_condition[task_group][task_type][task_target_id].current >= current_task.task_condition[task_group][task_type][task_target_id].target) {\r\n                            is_any_met = true;\r\n                        } else if(task_group === \"all\" && current_task.task_condition[task_group][task_type][task_target_id].current < current_task.task_condition[task_group][task_type][task_target_id].target) {\r\n                            is_all_met = false;\r\n                        }\r\n                    });\r\n                });\r\n            });\r\n\r\n            \r\n            \r\n            if((is_any_met || !(\"any\" in current_task.task_condition)) && (is_all_met || !(\"all\" in current_task.task_condition))) { //completed\r\n                this.finishQuestTask({quest_id: active_quest_id, task_index: current_task_index, allowed_to_finish_quest: false});\r\n            } else {\r\n                if(!active_quests[active_quest_id].is_hidden && !active_quests[active_quest_id].quest_tasks[current_task_index.is_hidden]) {\r\n                    update_displayed_quest_task(active_quest_id, current_task_index);\r\n                }\r\n            }\r\n\r\n            const remaining_tasks = active_quests[active_quest_id].quest_tasks.filter(task => !task.is_finished);\r\n            if(remaining_tasks.length == 0) { //no more tasks\r\n                this.finishQuest({quest_id: active_quest_id});\r\n            }\r\n        });\r\n    },\r\n};\r\n\r\n\r\n//Main story quests\r\n(()=>{\r\n    quests[\"Lost memory\"] = new Quest({\r\n        quest_name: \"Lost memory\",\r\n        display_priority: 0,\r\n        getQuestDescription: ()=>{\r\n            const completed_tasks =  quests[\"Lost memory\"].getCompletedTaskCount(); \r\n            if(completed_tasks == 0) {\r\n                return \"You woke up in some village and you have no idea how you got here or who you are. Just what could have happened?\";\r\n            } else if(completed_tasks == 1) {\r\n                return \"You lost your memories after being attacked by unknown assailants and were rescued by local villagers. You need to find out who, why, and if possible, how to recover them.\";\r\n            }\r\n        },\r\n        questline: \"Lost memory\",\r\n        quest_tasks: [\r\n            new QuestTask({task_description: \"Find out what happened\"}), //talk to elder\r\n            new QuestTask({is_hidden: true}), //so that the 1st task is completed but the next is not yet displayed\r\n            new QuestTask({task_description: \"Help with the wolf rat infestation\"}), //talk to elder after dealing with them\r\n            new QuestTask({task_description: \"Continue your search\"}), //talk to suspicious guy\r\n            new QuestTask({task_description: \"Get into the town (tbc)\"}), //not yet possible\r\n        ]\r\n    });\r\n\r\n    quests[\"The Infinite Rat Saga\"] = new Quest({\r\n        quest_name: \"The Infinite Rat Saga\",\r\n        display_priority: 0,\r\n        getQuestDescription: ()=>{\r\n            return \"You found more rats in the caves. You might as well try getting to the bottom of that issue.\";\r\n        },\r\n        questline: \"The Infinite Rat Saga\",\r\n        quest_tasks: [\r\n            new QuestTask({task_description: \"Go deeper\"}), //beat the 'Mysterious gate'\r\n            new QuestTask({task_description: \"Open the mysterious gate\"}),\r\n            new QuestTask({task_description: \"Get through the corrupted tunnel\"}), \r\n            new QuestTask({task_description: \"Go even deeper (tbc)\"}), //not yet possible to open 2nd gate\r\n        ]\r\n    });\r\n})();\r\n\r\n//General side quests\r\n(()=>{\r\n    quests[\"It won't mill itself\"] = new Quest({\r\n        quest_name: \"It won't mill itself\",\r\n        display_priority: 1,\r\n        getQuestDescription: ()=>{\r\n            if(!quests[\"It won't mill itself\"].quest_tasks[0].is_finished) {\r\n                return `Village elder asked you to check how the \"kids\" running the eastern mill are doing`;\r\n            } else {\r\n                return \"Boys running the eastern mill could use your help\";\r\n            }\r\n        },\r\n        quest_tasks: [\r\n            new QuestTask({task_description: \"Check on the eastern mill\"}), //gained on talking to elder after clearing 'Cave room'\r\n            new QuestTask({task_description: \"Clear the infested storehouse\"}),\r\n            new QuestTask({task_description: \"Find the missing grain delivery and bring it to the mill\"}),\r\n        ],\r\n        quest_rewards: {\r\n            money: 500,\r\n            xp: 250,\r\n            reputation: {\r\n                Village: 100,\r\n            }\r\n        }\r\n    });\r\n\r\n    quests[\"Bonemeal delivery\"] = new Quest({\r\n        quest_name: \"Bonemeal delivery\",\r\n        quest_description: \"The farm supervisor is in a dire need of 50 packs of bonemeal, and he needs the entire order delivered in one go.\",\r\n        quest_tasks: [\r\n            new QuestTask({task_description: \"Bring 50 packs of bonemeal\"}),\r\n        ],\r\n        quest_rewards: {\r\n            money: 6000,\r\n            xp: 5000,\r\n            reputation: {\r\n                Town: 40,\r\n            }\r\n        }\r\n    });\r\n    quests[\"Light in the darkness\"] = new Quest({\r\n        quest_name: \"Light in the darkness\",\r\n        display_priority: 1,\r\n        getQuestDescription: ()=>{\r\n            return \"People of the slums live in suffering and fear. Maybe you could improve their situation at least a bit?\";\r\n        },\r\n        quest_tasks: [\r\n            new QuestTask({is_hidden: true}), //gained on entry\r\n            new QuestTask({task_description: \"Deal with the gang\"}), //gained on talking with sus guy\r\n            new QuestTask({task_description: \"[To be continued]\"}), //next update maybe\r\n        ]\r\n    });\r\n    quests[\"Ploughs to swords\"] = new Quest({\r\n        quest_name: \"Ploughs to swords\",\r\n        display_priority: 1,\r\n        getQuestDescription: ()=>{\r\n            if(!quests[\"Ploughs to swords\"].quest_tasks[1].is_finished) {\r\n                return \"Supervisor of the town's farms seems to have some interesting tasks, but first requires you to be strong enough for it.\";\r\n            } else {\r\n                return \"Supervisor of the town's farms has a need for a capable fighter\";\r\n            }\r\n        },\r\n        quest_tasks: [\r\n            new QuestTask({task_description: \"Prove your strength\"}), //gained on asking about work without having is_strength_proved flag, gained AND finished on asking with having the flag\r\n            new QuestTask({task_description: \"Deal with the boars and then report back\"}),\r\n            new QuestTask({is_hidden: true}), //completed by asking for more work when it's not winter\r\n            new QuestTask({task_description: \"Exterminate the red ants under the farm and then report back\"}),\r\n        ],\r\n        quest_rewards: {\r\n            money: 5000,\r\n            xp: 50000, //50k\r\n            reputation: {\r\n                Town: 60,\r\n            }\r\n        }\r\n    });\r\n})();\r\n\r\n//Hidden quests for unlocks\r\n(()=>{\r\n    quests[\"Swimming/climbing unlock\"] = new Quest({\r\n        //climbing can still be unlocked via fights in the cave\r\n        is_hidden: true,\r\n        quest_tasks: [\r\n            new QuestTask({\r\n                task_condition: {\r\n                    all: {\r\n                        reach_skill: {\r\n                            \"Running\": {target: 12},\r\n                            \"Weightlifting\": {target: 12},\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n        ],\r\n        quest_rewards: {\r\n            textlines: [{dialogue: \"village elder\", lines: [\"more training\"], skip_message: true}],\r\n        }\r\n    });\r\n    quests[\"Swimming alternative unlock\"] = new Quest({\r\n        //climbing can still be unlocked via fights in the cave\r\n        is_hidden: true,\r\n        quest_rewards: {\r\n            global_activities: [\"swimming\"],\r\n            messages: [\"With all the training you have done so far, the idea of submerging yourself in the river passing by the village is really tempting\"],\r\n        },\r\n        quest_tasks: [\r\n            new QuestTask({\r\n                task_condition: {\r\n                    all: {\r\n                        reach_skill: {\r\n                            \"Running\": {target: 15},\r\n                            \"Weightlifting\": {target: 15},\r\n                        }\r\n                    }\r\n                }\r\n            }),\r\n            new QuestTask({\r\n                task_condition: {\r\n                    all: {\r\n                        enter_location: {\r\n                            \"Village\": {\r\n                                target: 1,\r\n                                restrictions: {season: \"Winter\"}, //won't trigger in winter\r\n                            },\r\n                        }\r\n                    }\r\n                }\r\n            }),\r\n        ],\r\n    });\r\n})();\r\n\r\n\r\n//Swampland expansion quests\r\n(()=>{\r\n    quests[\"Giant Enemy Crab\"] = new Quest({            //reference to the old \"Sony E3 2006 / Giant Enemy Crab\" meme\r\n        quest_name: \"Giant Enemy Crab\",\r\n        display_priority: 9,\r\n        getQuestDescription: ()=>{\r\n            if(quests[\"Giant Enemy Crab\"].quest_tasks[1].is_finished) {\r\n                return \"You slew the giant crab nesting at the lake beach. With your task completed, you might as well explore the region further.\";\r\n            } else if(quests[\"Giant Enemy Crab\"].quest_tasks[0].is_finished) {\r\n                return \"You managed to chase the giant crab away, but if you don't finish it off soon, it'll just nest somewhere else and be a problem for somebody else later. And even if someone did find it, would they be strong enough to defeat it? Better just to take care of it yourself now\";\r\n            } else {\r\n                return \"The elder gave you his blessing to investigate the rumors of enormous crab nests somewhere down river. Or was it an enormous crab's nest? Or was it some enormous crabs' nest? Either way, he reminded you to prepare for the journey ahead\";\r\n            }\r\n        },\r\n        questline: \"Giant Enemy Crab\",\r\n        quest_tasks: [\r\n            new QuestTask({task_description: \"Investigate down the river\"}), //beat the crab once\r\n            new QuestTask({task_description: \"Track down the giant crab\"}), //beat the crab twice\r\n        ]\r\n    });\r\n    quests[\"In Times of Need\"] = new Quest({\r\n        quest_name: \"In Times of Need\",\r\n        display_priority: 9,\r\n        getQuestDescription: ()=>{\r\n            if(quests[\"In Times of Need\"].quest_tasks[quests[\"In Times of Need\"].quest_tasks.length-1].is_finished) {    //update upon completion of final task\r\n                return \"You helped the snakefang tribe in their time of need\";\r\n            } else if(quests[\"In Times of Need\"].quest_tasks[0].is_finished) {\r\n                return `You accepted the chief's \"request\" to ask around and see how you could assist the tribe`;\r\n            } else {\r\n                return \"You should introduce yourself to whomever is in charge\";\r\n            }\r\n        },\r\n        questline: \"In Times of Need\",\r\n        quest_tasks: [\r\n            new QuestTask({is_hidden: true}), //Gained on entry\r\n            new QuestTask({task_description: \"Ask around and see how you can help\"}), //From talking to chief\r\n            new QuestTask({task_description: \"Bring the cook 60 pieces of fresh crab meat\"}), //From talking to cook\r\n            new QuestTask({is_hidden: true}), //filler after bringing meat, before being told to talk to tailor\r\n            new QuestTask({task_description: \"Speak to the tailor and see how you can help\"}), //flax delivery part 1\r\n            new QuestTask({task_description: \"Bring the tailor 200 bundles of fresh flax\"}), //flax delivery part 2\r\n            new QuestTask({task_description: \"Speak to the tanner and see how you can help\"}), //tanner delivery part 1\r\n            new QuestTask({task_description: \"Bring the tanner 60 pieces of alligator skin\"}), //tanner delivery part 2\r\n            new QuestTask({is_hidden: true}), //filler after bringing alligator skin, before being told to bring snake skin\r\n            new QuestTask({task_description: \"Bring the tanner 60 pieces of giant snake skin\"}), //tanner delivery part 3\r\n            new QuestTask({task_description: \"Report to the chief\"}), //properly finishes the quest, rewards come in dialogue\r\n        ]\r\n    });\r\n})();\r\n\r\n\r\n/*\r\nquests[\"Test quest\"] = new Quest({\r\n    quest_name: \"Test quest\",\r\n    id: \"Test quest\",\r\n    quest_description: \"Raaaaaaaaaaat ratratratratrat rat rat rat\",\r\n    quest_tasks: [\r\n        new QuestTask({\r\n            task_description: \"task 1 blah blah\",\r\n            task_condition: {\r\n                any: {\r\n                    kill: {\r\n                        \"Wolf rat\": {target: 10}\r\n                    }\r\n                }\r\n            }\r\n        }),\r\n        new QuestTask({\r\n            task_description: \"task 2 blah blah\",\r\n            is_hidden: true,\r\n        }),\r\n        new QuestTask({\r\n            task_description: \"task 3 blah blah\",\r\n            task_condition: {\r\n                any: {\r\n                    kill: {\r\n                        \"Wolf rat\": {target: 20}\r\n                    }\r\n                }\r\n            }\r\n        }),\r\n    ]\r\n});\r\n*/\r\n\r\nObject.keys(quests).forEach(quest => {\r\n    quests[quest].quest_id = quest;\r\n});\r\n\r\nexport { quests, active_quests, questManager};", "\"use strict\";\r\nimport { current_game_time, Game_Time } from \"./game_time.js\";\r\nimport { current_location } from \"./main.js\";\r\nimport { celsius_to_fahrenheit } from \"./misc.js\";\r\n\r\nconst base_temperature = 20; //in celsius\r\n\r\nlet previous_temperature_modifier;\r\n\r\nconst seasonal_temperature_modifiers = {\r\n    Winter: -20,\r\n    Spring: -5,\r\n    Summer: 0,\r\n    Autumn: -8,\r\n};\r\n\r\nconst daytime_temperature_modifiers = {\r\n    Plus: 3, //14:00\r\n    Minus: -8, //5:00\r\n};\r\n\r\n//for additional pseudo-randomization\r\nconst daycount_temperature_modifier = {\r\n    0: 0,\r\n    1: -1,\r\n    2: 0,\r\n    3: -2,\r\n    4: 3,\r\n    5: 6,\r\n    6: 1,\r\n    7: -2,\r\n    8: 0,\r\n    9: -5,\r\n    10: -1,\r\n};\r\n\r\n// 0: no rain; other: rain plus temperature modifier\r\nconst rain_cycle = {\r\n    0: 0,\r\n    1: 0,\r\n    2: 0,\r\n    3: 0,\r\n    4: -1,\r\n    5: -2,\r\n    6: -2,\r\n    7: -2,\r\n    8: 0,\r\n    9: 0,\r\n    10: 0,\r\n    11: -1,\r\n    12: 0,\r\n};\r\n\r\n/**\r\n * \r\n * @param {Game_Time} time \r\n * @returns {String} just \r\n */\r\nfunction get_temperature_peak_time(time) {\r\n        if (time.hour >= 14 || time.hour < 5) return \"Plus\";\r\n        else return \"Minus\";\r\n}\r\n\r\nfunction get_nonlocational_temperature_modifier(time) {    \r\n    return (seasonal_temperature_modifiers[time.getSeason()] \r\n                            + daytime_temperature_modifiers[get_temperature_peak_time(time)] \r\n                            + daycount_temperature_modifier[time.day_count%11]\r\n                            + rain_cycle[time.day_count%13]\r\n                        );\r\n}\r\n\r\nfunction get_temperature_at(time) {\r\n    if(!current_location) {\r\n        throw new Error(`Cannot provide temperature when current_location is '${typeof current_location}'!`);\r\n    }\r\n\r\n    if(current_location?.is_temperature_static) {\r\n        if(current_location.static_temperature !== null) {\r\n           return current_location.static_temperature;\r\n        } else {\r\n            return base_temperature;\r\n        }\r\n    }\r\n    \r\n    const location_modifier = current_location.temperature_range_modifier; //modifier to how much it differs from base, applied before location's flat modifier\r\n\r\n    if(isNaN(location_modifier)) {\r\n        throw new Error(`Temperature modifier for \"${current_location.name}\" is not a number!`);\r\n    }\r\n        \r\n    let total_modifier = current_location.temperature_modifier\r\n                           + location_modifier*(seasonal_temperature_modifiers[time.getSeason()] \r\n                                                 + daytime_temperature_modifiers[get_temperature_peak_time(time)] \r\n                                                 + daycount_temperature_modifier[time.day_count%11]\r\n                                                 + rain_cycle[time.day_count%13]\r\n                                                );\r\n\r\n    return base_temperature + total_modifier;\r\n}\r\n\r\n/**\r\n * @description calculates temperature in a simple deterministic manner, based on time of year, time of day, daycount, and location modifier\r\n */ \r\nfunction get_current_temperature() {\r\n    return get_temperature_at(current_game_time);\r\n}\r\n\r\n/**\r\n * \r\n * @returns temperature that's \"smoothed\" based on current temperature, temperature at next change and time between last and next change\r\n */\r\nfunction get_current_temperature_smoothed() {\r\n\r\n    if(!current_location) {\r\n        return 0;\r\n    }\r\n\r\n    if(!previous_temperature_modifier) {\r\n        previous_temperature_modifier = get_nonlocational_temperature_modifier(current_game_time);\r\n    }\r\n\r\n    let prev_temperature_time;\r\n    let next_temperature_time;\r\n    let total_minutes_betwen_changes;\r\n\r\n    if(current_game_time.hour >= 14) {\r\n        //next change is at 5 next day\r\n        next_temperature_time = {hours: 5, days: 1};\r\n        prev_temperature_time = {hour: 14};\r\n        total_minutes_betwen_changes = 900;\r\n        previous_temperature_modifier = get_nonlocational_temperature_modifier(current_game_time);\r\n    } else if(current_game_time.hour < 5) {\r\n        //next change is at 5 same day\r\n        next_temperature_time = {hours: 5, days: 0};\r\n        prev_temperature_time = {hour: 14};\r\n        total_minutes_betwen_changes = 900;\r\n\r\n    } else if(current_game_time.hour >= 5) {\r\n        //next change is at 14\r\n        next_temperature_time = {hours: 14, days: 0};\r\n        prev_temperature_time = {hour: 5};\r\n        total_minutes_betwen_changes = 540;\r\n        previous_temperature_modifier = get_nonlocational_temperature_modifier(current_game_time);\r\n    }\r\n\r\n    if(current_location.is_temperature_static) {\r\n        return current_location.static_temperature;\r\n    }\r\n\r\n    let minutes_passed;\r\n\r\n    if(current_game_time.hour < prev_temperature_time.hour) {\r\n        //day change occured\r\n        minutes_passed = 60*(24-prev_temperature_time.hour + current_game_time.hour) + current_game_time.minute;\r\n    } else {\r\n        //no day change\r\n        minutes_passed = 60*(current_game_time.hour-prev_temperature_time.hour) + current_game_time.minute;\r\n    }\r\n\r\n    const ratio = minutes_passed/total_minutes_betwen_changes;\r\n    \r\n    //grab the next temperature modifier at adequately incremented time\r\n    const next_temperature_modifier = get_nonlocational_temperature_modifier(new Game_Time({\r\n                                                        year: current_game_time.year,\r\n                                                        month: current_game_time.month,\r\n                                                        day: current_game_time.day + next_temperature_time.days,\r\n                                                        hour: next_temperature_time.hours,\r\n                                                        minute: 0,\r\n                                                        day_count: current_game_time.day_count+next_temperature_time.days,\r\n                                                    }));\r\n\r\n\r\n    const location_modifier = current_location.temperature_range_modifier; //modifier to how much it differs from base, applied before location's flat modifier\r\n\r\n    if(isNaN(location_modifier)) {\r\n        throw new Error(`Temperature modifier for \"${current_location.name}\" is not a number!`);\r\n    }\r\n\r\n    //calculate from prev, next and how close timewise it is, include location modifiers\r\n\r\n    return Math.round(\r\n            10*(\r\n                base_temperature \r\n                + (current_location.temperature_modifier || 0) \r\n                + location_modifier\r\n                    * (previous_temperature_modifier\r\n                        +\r\n                        ratio*(next_temperature_modifier - previous_temperature_modifier)\r\n              )))/10;\r\n}\r\n\r\n/**\r\n * based on a simple 13-long cycle\r\n */\r\nfunction is_raining() {\r\n    return rain_cycle[current_game_time.day_count%13] < 0;\r\n}\r\n\r\nexport {\r\n    get_current_temperature_smoothed, is_raining,\r\n};\r\n", "\"use strict\";\r\n\r\nclass BackgroundParticle {\r\n    constructor({canvas, size}) {\r\n        this.x = Math.random() * (canvas.width - size - 1) + size + 1;\r\n        this.starting_x = this.x;\r\n        this.distance = Math.random()*50 + 1;\r\n        this.opacity = Math.random() * 0.5 + 0.5;\r\n        this.radians = Math.random() * Math.PI * 2;\r\n        this.y = Math.random() * (canvas.height - size - 1) + size + 1;\r\n    }\r\n}\r\n\r\nclass RainParticle extends BackgroundParticle {\r\n    constructor({canvas}) {\r\n        const size = Math.random()*2 + 2;\r\n\r\n        super({canvas, size});\r\n\r\n        this.size = size;\r\n\r\n        this.fall_speed = 10;\r\n\r\n        this.context = canvas.getContext(\"2d\");\r\n\r\n        this.draw = () => {\r\n            if(this.y > canvas.height + this.size) {\r\n                this.y = - this.size; //go back to top after reaching bottom\r\n            } else {\r\n                this.y += this.fall_speed;\r\n            }\r\n\r\n            this.x = this.starting_x + this.distance;\r\n            this.context.fillStyle = `rgba(128,128,255, ${this.opacity})`;\r\n            \r\n            this.context.fillRect(this.x, this.y, this.size, this.size);\r\n        }\r\n    }\r\n}\r\n\r\nclass SnowParticle extends BackgroundParticle {\r\n    constructor({canvas}) {\r\n        const size = Math.random()*2 + 2;\r\n\r\n        super({canvas, size});\r\n\r\n        this.size = size;\r\n\r\n        this.fall_speed = Math.random() * 1.5 + 0.5;\r\n\r\n        this.context = canvas.getContext(\"2d\");\r\n\r\n        this.draw = () => {\r\n            if(this.y > canvas.height + this.size) {\r\n                this.y = - this.size; //go back to top after reaching bottom\r\n            } else {\r\n                this.y += this.fall_speed;\r\n            }\r\n\r\n            this.radians += 0.02;\r\n            this.x = this.starting_x + this.distance * Math.sin(this.radians);\r\n            this.context.fillStyle = `rgba(255,255,255,${this.opacity})`;\r\n            \r\n            this.context.fillRect(this.x, this.y, this.size, this.size);\r\n        }\r\n    }\r\n}\r\n\r\n//not used anywhere\r\nclass StarParticle extends BackgroundParticle {\r\n    constructor({canvas}) {\r\n        const size = Math.random()*3 + 1;\r\n\r\n        super({canvas, size});\r\n\r\n        this.size = size;\r\n\r\n        this.context = canvas.getContext(\"2d\");\r\n\r\n        this.opacity += 0.3;\r\n\r\n        this.draw = () => {\r\n            this.radians += 0.01;\r\n\r\n            this.tempX = this.x + Math.sin(Math.random());\r\n            this.tempY = this.y + Math.sin(Math.random());\r\n\r\n            this.tempSize = Math.max(1,this.size * Math.abs(Math.sin(this.radians)));\r\n\r\n            this.context.fillStyle = `rgba(255,255,100,${this.opacity})`;\r\n            this.context.strokeStyle = \"white\";\r\n            this.context.beginPath();\r\n            this.context.arc(this.tempX, this.tempY, this.tempSize, 0, 2*Math.PI);\r\n            this.context.fill();\r\n            this.context.stroke();\r\n        }\r\n    }\r\n}\r\n\r\nclass PointyStarParticle extends BackgroundParticle {\r\n    constructor({canvas}) {\r\n        const size = Math.random()*6 + 6;\r\n\r\n        super({canvas, size});\r\n\r\n        this.size = size;\r\n\r\n        this.context = canvas.getContext(\"2d\");\r\n\r\n        let degrees = 45;\r\n\r\n        this.draw = () => {\r\n            this.radians += 0.01;\r\n\r\n            this.tempSize = Math.max(4,this.size * Math.abs(Math.sin(this.radians)));\r\n            this.tempX = this.x - this.tempSize/2;\r\n            this.tempY = this.y - this.tempSize/2;\r\n\r\n            this.context.save();\r\n\r\n            this.context.fillStyle = `rgba(255,255,100,${this.opacity})`;\r\n            this.context.fillRect(this.tempX, this.tempY, this.tempSize, this.tempSize);\r\n            \r\n            this.context.translate(this.tempX+this.tempSize/2, this.tempY+this.tempSize/2);\r\n            this.context.rotate(degrees * Math.PI/180);\r\n            this.context.fillStyle = `rgba(255,255,100,${this.opacity})`;\r\n            this.context.fillRect(-this.tempSize/2, -this.tempSize/2, this.tempSize, this.tempSize);\r\n\r\n            this.context.restore();\r\n        }\r\n    }\r\n}\r\n\r\nexport {RainParticle, SnowParticle, StarParticle, PointyStarParticle};\r\n", "\"use strict\";\r\n\r\nconst game_version = \"v0.5.1\";\r\n\r\nfunction get_game_version() {\r\n    return game_version;\r\n}\r\n\r\nexport { game_version, get_game_version }", "\"use strict\";\r\n\r\n\r\n//For now, translations are only used for dialogues\r\n\r\nconst translationManager = {\r\n    getText: (language, text_id) => {\r\n        if(!translations[language]?.[text_id]) {\r\n            //no text\r\n            if(language.startsWith(\"mofu\")) {\r\n                //it's fluffy => use non-fluffy instead if present, otherwise use english\r\n                if(translations[language.replace(\"mofu_\",\"\")]?.[text_id]) {\r\n                    language = language.replace(\"mofu_\",\"\");\r\n                } else {\r\n                    language = \"english\";\r\n                }\r\n            } else {\r\n                //it's non-english => use english instead\r\n                language = \"english\";\r\n            }\r\n        }\r\n        if(!translations[language][text_id]) {\r\n            //still nothing, meaning there's no english either\r\n            //should be covered via verifier instead\r\n            return \"text not found, id: \" +text_id;\r\n        }\r\n        return translations[language][text_id];\r\n    }\r\n};\r\n\r\n\r\nconst translations = {\r\n    english: {\r\n        \"elder description\": \"You see an older man with white hair, but with a still strong posture as if still ready to fight if need be. He eyes you with curiosity.\",\r\n        \"elder hello\": \"Hello?\",\r\n        \"elder hello answ\": \"Hello. Glad to see you got better\",\r\n        \"elder head hurts\": \"My head hurts.. What happened?\",\r\n        \"elder head hurts answ\": `Some of our people found you unconscious in the forest, wounded and with nothing but pants and an old sword, so they brought you to our village. `\r\n                + `It would seem you were on your way to a nearby town when someone attacked you and hit you really hard in the head.`,\r\n        \"elder where\": \"Where am I?\",\r\n        \"elder where answ\": `Some of our people found you unconscious in the forest, wounded and with nothing but pants and an old sword, so they brought you to our village. `\r\n                + `It would seem you were on your way to a nearby town when someone attacked you and hit you really hard in the head.`,\r\n        \"elder remember\": \"I don't remember how I got here, what happened?\",\r\n        \"elder remember answ\": `Some of our people found you unconscious in the forest, wounded and with nothing but pants and an old sword, so they brought you to our village. `\r\n                + `It would seem you were on your way to a nearby town when someone attacked you and hit you really hard in the head.`,\r\n        \"elder who\": \"Who are you?\",\r\n        \"elder who answ\": \"I'm the unofficial leader of this village. If you have any questions, come to me\",\r\n        \"elder leave 1\": \"Great... Thank you for help, but I think I should go there then. Maybe it will help me remember more.\",\r\n        \"elder leave 1 answ\": \"Nearby lands are dangerous and you are still too weak to leave. Do you plan on getting ambushed again?\",\r\n        \"elder need to\": \"But I want to leave\",\r\n        \"elder need to answ\": `You first need to recover, to get some rest and maybe also training, as you seem rather frail... Well, you know what? Killing a few wolf rats could be a good exercise. `\r\n                        +`You could help us clear some field of them, how about that?`,\r\n        \"elder eq\": \"Is there any way I could get a weapon and proper clothes?\",\r\n        \"elder eq answ\": `We don't have anything to spare, but you can check out our market. Just go over there *[points a direction]*, then turn right. It's nowhere near what you can find in a town, but people always have some gear, food, and other useful stuff to sell. `\r\n                        +`If you need money, try selling some rat remains there. Fangs, tails or pelts, people will buy them all. I have no idea what they do with this stuff...`,\r\n        \"elder leave 2\": \"Can I leave the village?\",\r\n        \"elder leave 2 answ\":  \"We talked about this, you are still too weak\",\r\n        \"elder money\": \"Are there other ways to make money?\",\r\n        \"elder money answ\": \"You could help us with some fieldwork. I'm afraid it won't pay too well.\",\r\n        \"elder rats\": \"Are wolf rats a big issue?\",\r\n        \"elder rats answ\": `Oh yes, quite a big one. Not literally, no, though they are much larger than normal rats... `\r\n                        +`They are a nasty vermin that's really hard to get rid of. And with their numbers they can be seriously life-threatening. `\r\n                        +`Only in a group though, single wolf rat is not much of a threat`,\r\n        \"elder cleared 1\":  \"I cleared the field, just as you asked me to\",\r\n        \"elder cleared 1 answ\": `You did? That's good. How about a stronger target? Nearby cave is just full of this vermin. Try yourself against whatever occupies the frontal room, and then also the deeper parts. `\r\n                        +`Before that, maybe get some sleep? Some folks prepared that shack over there for you. It's clean, it's dry, and it will give you some privacy. `\r\n                        +`Oh, and before I forget, our old craftsman wanted to talk to you.`,\r\n        \"elder leave 3\": \"Can I leave the village?\",\r\n        \"elder leave 3 answ\":  \"You still need to get stronger.\",\r\n        \"elder room clear\": \"I dealt with some rats in the cave, but is there anything else to help with?\",\r\n        \"elder room clear answ\": \"Ahh, good to hear you are making progress. Let me think... Could you check on the eastern mill? I'm a bit worried if the two kids running it can manage everything by themselves.\",\r\n        \"elder cave clear\":  \"I cleared the cave. Most of it, at least\",\r\n        \"elder cave clear answ\": `Then I can't call you \"too weak\" anymore, can I? You are free to leave whenever you want, but still, be careful. You might also want to ask the guard for some tips about the outside. She used to be an adventurer.`,\r\n        \"elder leave 4\": \"Can I leave the village?\",\r\n        \"elder leave 4 answ\": \"You are strong enough, you can leave and come whenever you want.\",\r\n        \"elder about guard\": \"So what's the story of that village guard girl?\",\r\n        \"elder about guard answ\": \"Mhm... She left the village as but a kid, looking to become a famous adventurer. She returned over a decade later, covered in scars and unwilling to speak of what she went through.\"\r\n                                 +\" It's a pity that she never gained the fame she dreamt of, but at least she became strong enough to keep her home safe.\",\r\n        \"elder tunnel\": \"I found an even deeper tunnel in the cave\",\r\n        \"elder tunnel answ\": \"The what? I have a very bad feeling about this... You better avoid it until you get better equipment and some solid shield, I can bet it's gonna be a lot more dangerous.\",\r\n        \"elder training\": \"I think I went far enough with basic training, do you have any other suggestions?\",\r\n        \"elder training answ 1\": \"You did? Well, let me think... You could try swimming in the river nearby if you haven't done that yet, just remember not to do it in cold weather. Or you could try some wall climbing, but be sure to start with low heights to be safe.\",\r\n        \"elder training answ 2\": \"You did? Well, let me think... Swimming in the river nearby would be a good exercise, but it's mostly frozen now in winter. You could try some wall climbing though, but be sure to start with low heights to be safe.\",\r\n\t\"elder crab rumors\": \"I had overheard some villagers talking about an enormous crab nest.\", //crab start\r\n\t\"elder crab rumors answ\": \"That seems to have become the rumor of the week. Somebody found a fisherman unconscious in the forest a few weeks ago. He's recovering even now. \"\r\n                +\"His wounds weren't too severe, but they must have gotten infected, because he's been in a fever ever since we found him. In his delirium, he was murmuring something about enormous crab nests. We haven't seen anything nearby, but... \"\r\n                +\"This isn't the first I've heard of crab infestations along the river. Every few decades, their population undergoes a great boom, only to recede the following year.\",\r\n\t\"elder crab where\": \"The fisherman was found in the forest?\",\r\n\t\"elder crab where answ\": \"The river that you see flowing through our village spans a great deal of the forest, and some of the fishermen swear they have better catches out in the woods where it's quieter. \"\r\n                +\"As I understand it, the fisherman was found by a farmhand taking one of the horses out for a ride in the woods. The farmhand didn't mention seeing any rivers nearby, so we don't know if that's where he was injured.\",\r\n\t\"elder crab hunt\": \"I want to search for this enormous crab nest, they could be a danger to the village.\",\r\n\t\"elder crab hunt answ\": \"The guards can handle any crabs that get near the village. And beside, you... \"\r\n                +\"\\n*[The village elder trails off while looking you over, silently staring for a moment before speaking]*\\n \" //The elder is realizing that this isn't about protecting the village, it's about exploring the world and finding their place in it\r\n                +\"It's clear you are much stronger than when you were first brought to recover under my care. \"\r\n                +\"I will not try to convince you otherwise, I can see the determination in your eyes. You have my blessing. But know this: there are dangers in the wilderness that no training can ready you for. \"\r\n                +\"If your current weapon, armor, or method of attack isn't working, it's much better to run away, reassess, and recover your strength instead of unnecessarily risking your life. \"\r\n                +\"Please, be cautious. And consider checking with the village market to get some medicine and supplies. There's no telling how long your journey will take, or what challenges you will face on it. \"\r\n                +\"No matter how far you go, just remember that you always have a home in this village.\",\r\n\t//\r\n        \"craftsman description\": \"You see an old man who clearly experienced a lot in life. He's wearing some handmade accessories. Despite his age, his fingers seem exceptionally nimble.\",\r\n        \"craftsman hello\": \"Hello, I heard you wanted to talk to me?\",\r\n        \"craftsman hello answ\": \"Ahh, good to see you traveler. I just thought of a little something that could be of help for someone like you. See, young people this days \"+\r\n                \"don't care about the good old art of crafting and prefer to buy everything from the store, but I have a feeling that you just might be different. \"+\r\n                \"Would you like a quick lesson?\",\r\n        \"craftsman learn\": \"Sure, I'm in no hurry.\",\r\n        \"craftsman learn answ\": \"Ahh, that's great. Well then... \\n*[Old man spends some time explaining all the important basics of crafting and providing you with tips]*\\n\"+\r\n                \"Ahh, and before I forget, here, take these. They will be helpful for gathering necessary materials.\",\r\n        \"craftsman leave\": \"I'm not interested.\",\r\n        \"craftsman leave answ\": \"Ahh, I see. Maybe some other time then, when you change your mind, hmm?\",\r\n        \"craftsman remind 1\": \"Could you remind me how to create equipment for myself?\",\r\n        \"craftsman remind 1 answ\":  \"Ahh, of course. Unless you are talking about something simple like basic clothing, then you will first need to create components that can then be assembled together. \"+\r\n                \"For weapons, you generally need a part that you use to hit an enemy and a part that you hold in your hand. For armor, you will need some actual armor and then something softer to wear underneath, \"+\r\n                \"which would mostly mean some clothes.\",\r\n        \"craftsman remind 2\": \"Could you remind me how to improve my creations?\",\r\n        \"craftsman remind 2 answ\": \"Ahh, that's simple, you just need more experience. This alone will be a great boon to your efforts. For equipment, you might also want to start with better components. \"+\r\n                \"After all, even with the most perfect assembling you can't turn a bent blade into a legendary sword.\",\r\n        \"craftsman remind 3\": \"Could you remind me how to get crafting materials?\",\r\n        \"craftsman remind 3 answ\": \"Ahh, there's multiple ways of that. You can gain them from fallen foes, you can gather them around, or you can even buy them if you have some spare coin.\",\r\n        \"craftsman remind 4\": \"How do I get better at crafting?\",\r\n        \"craftsman remind 4 answ\": \"Ahh, there aren't any secrets, you just need to keep practicing it. Just don't spend your entire life working on same louse materials, try to work on stronger stuff when you feel confident. There's a limit to how much you can learn by working with rat leather, isn't there?\",\r\n        \"craftsman about guard\": \"So what's the story of that village guard girl?\",\r\n        \"craftsman about guard answ\": \"Ahhh, our little warrioress... She once wanted to be an adventurer, but I believe it didn't work out for her. Hard work is not enough when talent is lacking nor can it allow one to conquer fate, I'm afraid. Still, she's a good girl and keeps us safe now.\",\r\n        //\r\n        \"guard description\": \"You see a woman in a light armor, with a spear in her hand and two daggers on her belt. There's a scar across her face.\",\r\n        \"guard hello\": \"Hello?\",\r\n        \"guard hello answ\": \"Hello. I see you are finally leaving, huh?\",\r\n        \"guard job\": \"Do you maybe have any jobs for me?\",\r\n        \"guard job answ\": \"You are somewhat combat capable now, so how about you help me and the boys on patrolling? Not much happens, but it pays better than working on fields\",\r\n        \"guard tips\": \"Can you give me any tips for the journey?\",\r\n        \"guard tips answ\": `First and foremost, don't rush. It's fine to spend some more time here, to better prepare yourself. `\r\n                +`There's a lot of dangerous animals out there, much stronger than those annoying rats, and in worst case you might even run into some bandits. `\r\n                +`If you see something that is too dangerous to fight, try to run away. There's no shame in staying alive to fight on another day, when chances of survival become better, and it would be a pity if someone with your looks were to die~`,\r\n        \"guard teach\": \"Could you maybe teach me something that would be of use?\",\r\n        \"guard teach answ\":  `Lemme take a look... Yes, it looks like you know some basics. Do you know any proper techniques? No? I thought so. I could teach you the most standard three. `\r\n                +`They might be more tiring than fighting the \"normal\" way, but if used in a proper situation, they will be a lot more effective. Two can be easily presented through `\r\n                + `some sparring, so let's start with it. The third I'll just have to explain. How about that?`,\r\n        \"guard quick\": \"So about the quick stance...\",\r\n        \"guard quick answ\": `It's usually called \"quick steps\". As you have seen, it's about being quick on your feet. `\r\n                        +`While power of your attacks will suffer, it's very fast, making it perfect against more fragile enemies`,\r\n        \"guard heavy\":  \"So about the heavy stance...\",\r\n        \"guard heavy answ\": `It's usually called \"crushing force\". As you have seen, it's about putting all your strength in attacks. ` \r\n                        +`It will make your attacks noticeably slower, but it's a perfect solution if you face an enemy that's too tough for normal attacks`,\r\n        \"guard wide\": \"What's the third technique?\",\r\n        \"guard wide answ\": `It's usually called \"broad arc\". Instead of focusing on a single target, you make a wide swing to hit as many as possible. ` \r\n                +`It might work great against groups of weaker enemies, but it will also significantly reduce the power of your attacks and will be even more tiring than the other two stances.`,\r\n        \"guard hi\": \"Hi again, how's it going?\",\r\n        \"guard hi answ\": \"Hey there. I heard you've been helping around a lot, good job cutie~\\n *[As she says that, she bends forward and pats your head a few times with a surprisingly gentle touch]*\",\r\n        \"guard tips 2\": \"Can you give me any training tips?\",\r\n        \"guard tips 2 answ\": \"It's not always best to focus on singular skill, you might learn more if you come back to training after getting more experienced in other aspects and finding new insights.\"\r\n                        +\" There are also some unconventional training styles that I heard of, like fighting with no weapons or with no armor whatsoever, but I wouldn't recommend it to you, cutie.\"\r\n                        +\" It's enough that one of us is covered in ugly scars.\",\r\n        \"guard scars\": \"I don't think your scar is ugly\",\r\n        \"guard scars answ\": \"*[She doesn't answer you, just looks away. You can see in her facial expression that she appreciates your words, but doesn't really believe them]*\",\r\n        \"guard serious\": \"Can we try a more serious fight?\",\r\n        \"guard serious answ\": \"Ohhh, someone wants to impress the cute guard lady? Sorry, but I'm way too strong for you~\",\r\n        \"guard pats\": \"[Ask for more headpats]\",\r\n        \"guard pats answ\": \"[She smiles and pats your head a few more times]\",\r\n        \"guard try\": \"[Try to pat her head]\",\r\n        \"guard try answ\": '[Nuh uh. She pats your head instead~~~]',\r\n        \"guard teach more\": \"Can you teach me something more?\",\r\n        \"guard teach more answ\": \"I'm sorry, but no, that will have to be enough. Trust me, I'm generally a terrible teacher, I know that from experience. It will be better for you to not get any bad habits because of me.\",\r\n        //\r\n        \"millers description\": \"You see two teenagers with mischievous looks on their faces. It's only with great deal of effort that you manage to recognize them both as males. One of them has red hair, the other gray.\",\r\n        \"millers hello\": \"Hello there\",\r\n        \"millers hello answ\": \"[Red] Hi~! \\n [Gray]: Hello\",\r\n        \"millers how\": \"Are you doing alright? Elder asked me to check on you.\",\r\n        \"millers how answ\": \"[Gray] We are fine, mostly. \\n [Red] Except for rats in the storehouse, especially since we are about to have grain delivery. \\n [Gray] The big rats, like on the fields... \\n [Red] So if you could help us with them, it would be great!\",\r\n        \"millers young\": \"Aren't you two a bit too young to have a job?\",\r\n        \"millers young answ\": \"Nope, we are both adults, even if barely, but we will take that as a compliment~ \\n *[They both smirk as they say that, apparently happy with their looks]*\",\r\n        \"millers sure\": \"Sure, I can deal with them.\",\r\n        \"millers sure answ\": \"[Red] Ehehe, thank you~ \\n [Gray] We will get you some reward for it later. \\n [Red] A bit of money, and maybe a kiss or two~\",\r\n        \"millers cleared\": \"I cleared out your storehouse\",\r\n        \"millers cleared answ\": \"[Red] Nice job! \\n[Gray] Now where is that grain? \\n [Red] Oh right, it was supposed to be delivered by now. \\n[Gray] Could you search the village for a cart loaded with bags of grain that's 'supposed' to be heading our way?\",\r\n        \"millers delivered\": \"Your delivery has arrived.\",\r\n        \"millers delivered answ\": \"[Red] Thanks \\n[Gray] Thank you! \\n[Red] And here's your reward.\",\r\n        \"millers kiss\": \"So about that kiss you promised...\",\r\n        \"millers kiss answ\": \"[Red] Yes? Which one of us do you want it from?\",\r\n        \"millers kiss mouse\": \"How about... your gray-haired friend?\",\r\n        \"millers kiss mouse answ\": \"*[Gray-haired teen slowly approaches you from the side and gives you a gentle smooch on your cheek, then steps back with a slightly shy smile]*\",\r\n        \"millers kiss cat\": \"How about... you?\",\r\n        \"millers kiss cat answ\": \"*[Red-haired teen slowly approaches you from the side and gives a gentle smooch on your cheek, then steps back with a smirk]*\",\r\n        \"millers kiss both\": \"How about... both of you?\",\r\n        \"millers kiss both answ\": \"*[The two slowly approach you from both sides and you receive two simultanous gentle smooches, one of each of your cheek, after which they take a step back]*\",\r\n        \"millers reject nice\": \"I appreciate the offer, but I'm not interested in that kind of thing\",\r\n        \"millers reject nice answ\": \"[Red] Oh well, that's a pity~\",\r\n        \"millers reject mean\": \"Ewww, no, I want you to forget about that whole idea\",\r\n        \"millers reject mean answ\": \"[Red] Whatever you say~\",\r\n        \"millers kiss more\": \"Can I get one more kiss?\",\r\n        \"millers kiss more answ\": \"[Red] Hmmm... should we? \\n[Gray] Maybe some other time. \\n[Red] You heard him~\",\r\n        \"millers how2\": \"So, how's it going?\",\r\n        \"millers how2 answ\": \"[Red] Kinda boring, but at least company is good. \\n[Gray] What he said.\",\r\n        \"millers about guard\": \"Do you know anything about that girl who guards the village?\",\r\n        \"millers about guard answ\": \"[Red] Nope, nothing. She just happens to have same name and looks, as far as oral descriptions go, as one the continent's top ten adventurers who retired just before she returned.\"\r\n                                +\" \\n[Gray] Obviously it's a total coincidence, right? *[The two exchange amused looks]*\"\r\n                                +\" \\n[Red] Jokes aside, no one here besides us managed to make that connection, that's just sooo stupid~\"\r\n                                +\" \\n[Gray] When they hear how there was a powerful adventurer who happens to match her perfectly, they all just assume that it's a pure coincidence and a completely different person.\"\r\n                                +\" \\n[Red] She doesn't seem to care much about it, probably prefers peace and quiet. Let her have them, I'm sure she went through a lot, and with her here we can feel safer than ever.\",\r\n        //\r\n        \"g guard description\": \"You see a massive man in a steel chainmail, with a spear in his hand and a sword on his belt.\",\r\n        \"g guard hello\": \"Hello, can I get in?\",\r\n        \"g guard hello answ\": \"The town is currently closed to everyone who isn't a citizen or a merchant guild's member. No exceptions.\",\r\n        //\r\n        \"sus description 1\": \"You see a young man in shabby clothes and with messy hair, who keeps looking around. He appears to have some nervous ticks, or maybe he's just really stressed. He notices you and stares.\",\r\n        \"sus description 2\": \"You see a young man in shabby clothes and with messy hair, who keeps calmly looking around. The moment he notices you, he appears to get calmer.\",\r\n        \"sus hello\": \"Hello? Why are you looking at me like that?\",\r\n        \"sus hello answ\": \"Y-you! You should be dead! *the man pulls out a dagger*\",\r\n        \"sus defeated\": \"What was that about?\",\r\n        \"sus defeated answ\": \"I... We... It was my group that robbed you. I thought you came back from your grave for revenge... Please, I don't know anything. \"\r\n                +\"If you want answers, ask my ex-boss. He's somewhere in the town.\",\r\n        \"sus behave\": \"Are you behaving yourself?\",\r\n        \"sus behave answ\": \"Y-yes, boss! Please don't beat me again!\",\r\n        \"sus boss\": \"Stop calling me 'boss'\",\r\n        \"sus boss answ\": \"Yes, boss! Sorry, boss!\",\r\n        \"sus situation\": \"By the way, how are things in this slum?\",\r\n        \"sus situation answ\": \"A-as you can see and hear boss, it's pretty b-bad, but it can't be helped without taking out the g-gang...\",\r\n        \"sus gang\": \"What gang?\",\r\n        \"sus gang answ\": \"It's j-just a gang, they don't have any name, boss. Their hideout is over t-there, you should stay away from it. Almost every k-killer and thug around t-the slum is a part of their group...\",\r\n        \"sus gang defeated\": \"That gang you mentioned? I dealt with them.\",\r\n        \"sus gang defeated answ\":  \"I know boss, we all heard the commotion! You're the best! I think the local trader already pulled out some gear he was hiding from them, you should check it out! \\n*[Pauses for a moment]* I wish I had shown you my defensive tricks before that, it might have made your job easier...\",\r\n        \"sus behave 2\": \"Are you behaving yourself?\",\r\n        \"sus behave 2 answ\": \"Y-yes, I didn't do anything bad since the last time, boss!\",\r\n        \"sus behave 3\": \"Are you behaving yourself?\",\r\n        \"sus behave 3 answ\": \"Of course boss!\",\r\n        \"sus tricks\": \"You said something about defensive tricks? Show me\",\r\n        \"sus tricks answ\": \"Sure, boss! So, it's really about focusing on your legs to either jump away faster or to better brace the shield, and... *[He continues explaining for a while]*\",\r\n        \"sus headpat\": \"[Pat his head]\",\r\n        //line above: not reachable without mofu mofu, but needs to be provided here\r\n        \"sus headpat answ\": \"[He smiles like a little puppy]\",\r\n        //line above: theoretically reachable if someone disables mofu mofu while in dialogue?\r\n        //\r\n        \"old description 1\": \"With some safety returned to the area, more folk are now out on the streets. One of them, an elderly lady, is looking at you.\",\r\n        \"old description 2\": \"You see a gentle elderly lady with warm look in her eyes\",\r\n        \"old hello\": \"[Let her approach you.]\",\r\n        \"old hello answ\": \"Hello young warrior. I understand it is you who we have to thank for freeing us from those thugs. Few these days have the gumption, and even fewer the strength to take them on. Well done! Such heroism deserves a reward, and while none of us have much to offer as you can see, but the least I can do is make sure our hero doesn't go hungry. Would you care to join me for dinner?\",\r\n        \"old dinner\": \"[Accept the offer.]\",\r\n        \"old dinner answ\": \"[You join the woman in her shack for a humble, yet satisfying meal. While the main ingredients are simple, they are well flavoured and garnished with herbs.]\",\r\n        \"old ingredients\": \"[Compliment the food and ask where she gets ingredients.]\",\r\n        \"old ingredients answ\": \"Surprised? Live here long enough, and you learn how to get by without a lot of pricey things. No, I'm not talking about stealing - I may be poor, but I still have my pride! No, I'm talking about the plants that grow all around. Most people pass them by, without realizing how useful they can be. Ha! Maybe there IS another way I can reward you! I can teach you what to look for, if you're interested.\",\r\n        //\r\n        \"sup hello\": \"Hello\",\r\n        \"sup hello answ\": \"Hello stranger\",\r\n        \"sup work\":  \"Do you have any work with decent pay?\",\r\n        \"sup work answ\": \"We sure could use more hands. Feel free to help my boys on the fields whenever you have time!\",\r\n        \"sup anything\": \"Is there anything I can help you with?\",\r\n        \"sup anything answ\": \"I don't think so, nothing aside from normal work... Actually there is one thing. We're in a dire need of 50 packs of bonemeal and lost our supplier on top of that, so I'm willing to pay you a triple price. Bad news is, you will have to bring all 50 in a single delivery.\",\r\n        \"sup bonemeal\": \"More bonemeal, you say?\",\r\n        \"sup bonemeal answ\": \"Absolutely! I know the lower price might not be the most appealing, but at least it's stable, unlike the market, and at times might be a lot better than what any trader would pay you for it.\",\r\n        \"sup animals\": \"Do you sell anything?\",\r\n        \"sup animals answ\": \"Sorry, I'm not allowed to. However if you were to help us produce something, I could let you take part of it. It just so happens our sheep need shearing, if you're interested in some free wool.\",\r\n        \"sup fight0\": \"Do you have any task that requires some good old violence?\",\r\n        \"sup fight0 answ\": \"I kinda do, but you don't seem strong enough for that. I'm sorry.\",\r\n        \"sup fight\": \"Do you have any task that requires some good old violence?\",\r\n        \"sup fight answ\": \"Actually yes. There's that annoying group of boars that keep destroying our fields. \"\r\n                + \"They don't do enough damage to cause any serious problems, but I would certainly be calmer if someone took care of them. \"\r\n                + \"Go to the forest and search for a clearing in north, that's where they usually roam when they aren't busy eating our crops. \"\r\n                + \"I will of course pay you for that. 4 silver coins is most I can offer, I'm running on a strict budget here.\",\r\n        \"sup things\": \"How are things around here?\",\r\n        \"sup things answ\": \"Nothing to complain about. Trouble is rare, pay is good, and the soil is as fertile as my wife!\",\r\n        \"sup defeated boars\": \"I took care of those boars\",\r\n        \"sup defeated boars answ\": \"Really? That's great! Here, this is for you.\",\r\n        \"sup troubled\": \"You look troubled\",\r\n        \"sup troubled answ\": \"Troubled? I'm fuming, I'm going insane here! Those damn accursed ants, they keep destroying crops by eating their roots over and over again!\"\r\n                    + \" If I could, I would drop everything, grab a sword and a shovel and go find their damn nests, and then slaughter every last one of them! Not just soldiers and workers, but queens and larvae too!\"\r\n                    + \" Destroy their nests for me and you will have my gratitude, I will even pay you out of my own pocket!... Oh, and you can borrow a shovel from the farm if you don't have your own.\",\r\n        \"sup eliminated\": \"The ants are gone, though there are some trails leading to the forest\",\r\n        \"sup eliminated answ\": \"That's just... thank you, thank you so much! Here, take this, you earned it! As for the forest, I don't really care, as long as they don't come back.\",\r\n        \"sup deliver\": \"[Deliver the bonemeal]\",\r\n        \"sup deliver answ\": \"Thank you very much, here's your money! If you ever want to make more deliveries of this size, we will gladly take them, although it will have to be for the regular price\",\r\n        \"sup deliver not\": \"I'm sorry, but that's not enough\",\r\n        \"sup deliver 2\": \"[Deliver the bonemeal]\",\r\n        \"sup deliver 2 answ\": \"Thank you very much, here's your money! We will gladly take more, whenever you have it!\",\r\n        \"sup deliver 2 not\": \"I'm sorry, but that's not enough\",\r\n        \"sup description\": \"You see a well dressed man with a notebook on his belt and a hat on his head. Despite seeming more like a scribe, he's buff and tanned.\",\r\n        //\r\n        \"swampchief description 1\": \"Looking around the encampment, you see a large hut framed by banners and lit torches. You approach the hut, calling out in greeting, but getting no response. As you step closer, you see a large man in thick scaly armor wielding a great trident emerge. He points the trident at you as he takes a firm stance.\",\r\n        \"swampchief description 2\": \"The chief stands outside his hut, watching you as you move about the encampment with an inscrutable gaze.\", //description changes upon accepting In Times of Need\r\n        \"swampchief description 3\": \"The chief stands outside his hut. He nods at you as your eyes meet.\", //description changes again upon finishing In Times of Need\r\n\t\"swampchief meet\": \"Hel-\",\r\n        \"swampchief meet answ\": \"Intruder! How bold of you to walk so brashly through our grounds! Bold and foolish! To so bluntly insult the honor of the chief of the Snake Fang Tribe! Raise your blade! There is no sport in killing an unarmed foe!\",\r\n        \"swampchief explain\": \"Wait! I'm not your enemy! I was passing through the swamp and saw the fortifications!\",\r\n        \"swampchief explain answ\": \"*[The chief holds for a moment, before relaxing his stance and raising his trident away]*\\n\\n\"\r\n\t\t\t+\"A fool in shoddy garb. You aren't even worth bloodying my spear for. Begone from my sight. We have nothing to offer you, no quarter to give, and no supply to barter. Leave us, and do not return.\",\r\n        \"swampchief help\": \"Perhaps you don't have anything to offer, but maybe I can offer to help your people?\",\r\n        \"swampchief help answ\": \"And for what would we need the help of a stranger from the beyond the bog? Feh! If you wish to pay fealty to our strength, we'll take your tribute. Now begone from my sight.\",\r\n        \"swampchief mid help\": \"I'm going to ask around and see how I can-\",\r\n        \"swampchief mid help answ\": \"I did not ask, stranger. Be gone from my sight before I change my mind.\",\r\n        \"swampchief report\": \"I've been helping out around the tribe.\",\r\n        \"swampchief report answ\": \"Yes. I've been watching you run about. I have heard nothing but high praises of your efforts, even from my more cantankerous charges.\",\r\n        \"swampchief confirm\": \"Times are hard, and this land is dangerous. I've just been trying to give what help I can.\",\r\n        \"swampchief confirm answ\": \"Ever the fool, you are.\"\r\n\t\t\t+\"\\n\\n*[The chief smiles at you]*\\n\\n\"\r\n\t\t\t+\"But fools seem to be in high supply right now, and rarely have I seen one as capable as you. I should know. I'm reminded every time I... \" //\"every time I see myself.\"\r\n\t\t\t+\"\\n\\n*[The chief breaks his gaze, before taking a ring off and presenting it to you]*\\n\\n\"\r\n\t\t\t+\"You have given tribute to the Snake Fang Tribe, graciously and beyond all reason. I would be the greatest of fools to disrespect that. Please, accept this as token of my heartfelt gratitude, and with it, my friendship.\",\r\n        \"swampchief accept\": \"You honor me with your gift.\",\r\n        \"swampchief accept answ\": \"Perhaps if we had allies such as you... I would be humbled if you would become one of our den kin -- that is, consider yourself among my charges. \"\r\n\t\t\t+\"I will send word that our artisans are to share their workhuts with you, if you wish to avail yourself to them. \"\r\n\t\t\t+\"You are welcome to rest in our longhouse. I would only ask that you be mindful of the young woman resting within.\",\r\n\t\"swampchief generic\": \"How are things among the tribe?\",\r\n        \"swampchief generic answ\": \"Challenging, honored friend, in these harsh and dangerous times. But maybe we can make it through if we all band together.\",\r\n\t//\r\n        \"swampcook description 1\": \"As you get closer to the cook's workhut, you're met with a distinctive tune bellowed loudly and an acrid smell emanating from inside. Bracing your nose, you approach to find a short fellow nearly obscured by hanging meats, moving between a rack larger than he is housing thin cuts suspended between grated slats and a large cauldron build into a workbench covered in large slabs of rough leather in various stages of processing. You're surprised to find that he was the source of the singing. Noticing your approach, he stops his song and turns to address you with a smile on his face.\", //before accepted task\r\n        \"swampcook description 2\": \"You approach the cooks's workhut, finding him standing outside next to a small smokehouse in between splitting logs. As before, you can both smell the leather the cook is processing and hear the song that he is singing long before you see him.\", //before finishing delivery\r\n        \"swampcook description 3\": \"As you approach the workhut, you absentmindedly sing along to the cook's song. He notices your singing before turning to you and giving a big nod with a toothy grin before resuming his work.\", //after finishing delivery\r\n\t\"swampcook greeting1\": \"Hello. I'm trying to find ways to... pay tribute?\",\r\n        \"swampcook greeting1 answ\": \"A-ha~! Tribute! Ha-ha~! Very funny, obaru! There is no need to pay tribute to a snake's fangs!\", //\"Obaru\" - in this context means child; stranger; person with no relevance\r\n        \"swampcook greeting2\": \"Not tribute, then. I'm just looking for ways to help out around here.\",\r\n        \"swampcook greeting2 answ\": \"Ahh, help? A-ha~! Snake's fangs are slow to sharpen! But if obaru wants to help, then I will be happy to judge! Now what would I ask of you...! Oh, a-ha~! Yes! Rock meat!\",\r\n        \"swampcook help\": \"Rock meat...? Are you sure you need meat? It looks like you have plenty already.\",\r\n        \"swampcook help answ\": \"Sosso! Obaru has eyes but no ears! I need different meat! You have seen those large walking rocks near the falling water, yes? Crack those rocks and bring me the meat from inside! A-ha~! If I am right, I will need no less than three score rock meat! Bring them to me! And I shall help you to sharpen the snake's fangs!\", //\"Sosso\" - in this context means a foolish person\r\n        \"swampcook deliver\": \"I've got 60 of those, um, 'rock meats' you wanted.\",\r\n        \"swampcook deliver answ\": \"A-ha~! Good job! If kazoku could do this, maybe kazoku can sharpen the snake's fangs! But first, you must know the snake! Only then can you sharpen it's fangs!\", //\"Kazoku\" - in this context means community member, helpful person\r\n\t\"swampcook deliver not\": \"A-ha~! Sosso obaru! I think you may want to check again!\",\r\n        \"swampcook know\": \"Know the snake? Sharpen it's fangs? Are you saying that if I am to help out, I need to know more about who I'm helping?\",\r\n        \"swampcook know answ\": \"Ha-ha~! There are two who could stand to be sharpened! But before kazoku can know of a part, we must talk of the whole! \"\r\n\t\t\t+\"Come, grab a piece of meat! We shall work while we talk! You may even learn something!\",\r\n        \"swampcook yeslore\": \"What can you tell me about, uh, the `whole of the snake?`\",\r\n        \"swampcook yeslore answ\": \"Ah~! It's heart! It's soul! It's head! It's body! What would you like to know?!\",\r\n        \"swampcook history\": \"Tell me about the... heart of the snake?\",\r\n        \"swampcook history answ\": \"Haa~! Heart of the snake lies in it's first head! A strong man! Fierce man! It is said he wore the head of snakes on his fist! It is why we are the snake's fangs!\",\r\n        \"swampcook history1\": \"Okay... so what?\",\r\n        \"swampcook history1 answ\": \"Ahh~! That heart! That drove the next head! And the next! More strong! More fierce! Snake must be bigger! Must be stronger!\",\r\n        \"swampcook history2\": \"So what happened?\",\r\n        \"swampcook history2 answ\": \"The snake grew big, as did it's fangs! But! The prey didn't! The prey grew smaller, until all that was left was snakes! And now!? The zalgo bite at our soul.\",\r\n        \"swampcook history3\": \"I still don't understand what you're trying to say.\",\r\n        \"swampcook history3 answ\": \"Ah~?! Tribe grew too big! Swamp too dangerous now! Now tribe grows small! And danger only stronger!\",\r\n        \"swampcook historyend\": \"I've learned all I think I'm going to about the history of the Snake Fang tribe.\",\r\n        \"swampcook historyend answ\": \"A-ha~! Lesson to be learned! What else would you like to know?!\",\r\n\t\"swampcook surround\": \"Tell me about... the soul of the snake?\",\r\n        \"swampcook surround answ\": \"Ahh~! The lands! They are the soul! But it used to be larger! The mountain! The plains! The woods! The bay! All used to be with the snake's soul!\",\r\n        \"swampcook surround1\": \"Oh, I actually came from the mountains.\",\r\n        \"swampcook surround1 answ\": \"Ha-ha~! Then you know already! Northwest, where the walking rocks and falling water are!\",\r\n        \"swampcook surround2\": \"There are plains around here?\",\r\n        \"swampcook surround2 answ\": \"Ahh~! Yes! Southeast! The snake would hunt! But the snake split! And now no snakes go to the plains!\", //There is a second tribe, of survivors who left the Snake Fang Tribe, and any who go there are banished\r\n        \"swampcook surround3\": \"You're going to have to be a ~lot~ more specific about what woods you're referring to.\",\r\n        \"swampcook surround3 answ\": \"Ha~! You are right! South of the falling water! The wet woods! That was where we gathered! But now?! It is just home of the walking rocks!\",\r\n        \"swampcook surround4\": \"What do you mean, `the bay`?\",\r\n        \"swampcook surround4 answ\": \"A-ha~! Far to the north! Many spice and meat and metal and leather come from there! From very far away! It good place to go! To leave!\",\r\n        \"swampcook surroundend\": \"I've learned enough about the ares surrounding the swamplands.\",\r\n        \"swampcook surroundend answ\": \"A-ha~! Maybe you will see those lands some day!\",\r\n\t\"swampcook chief\": \"What can you tell me about the head of the snake?\",\r\n        \"swampcook chief answ\": \"A-ha~! Very strong! Very agressive! Quick to bite!\",\r\n        \"swampcook chief1\": \"Are you ~just~ telling me about snakes?\",\r\n        \"swampcook chief1 answ\": \"Ha~! Silly kazoku! No! Snake's head used to be calmer! But now a new head!\",\r\n        \"swampcook chief2\": \"A... new head? What happened to the `old` head, then?\",\r\n        \"swampcook chief2 answ\": \"Ha-ha~! The same thing that happens to every head! But the snake laid no eggs! The kin becomes the head!\",\r\n        \"swampcook chief3\": \"So the old, less aggressive chief died? And because they had no children, a sibiling became the new chief?\",\r\n        \"swampcook chief3 answ\": \"Haa~! Kazoku has ears! Yes! And old problems are new again! But the head of the snake just bites back!\",\r\n        \"swampcook chiefend\": \"Okay. I've learned all I think I can understand about the tribe's chief\",\r\n        \"swampcook chiefend answ\": \"Ha~! A dramatic tragedy! But that is life!\",\r\n\t\"swampcook people\": \"What can you tell me about the body of the snake...?\",\r\n        \"swampcook people answ\": \"A-ha~! That is me! You! All of us! Maybe you have already seen our bartermaster?! Or would you rather just learn of the unsharpened fange?!\",\r\n\t\"swampcook cook\": \"Tell me about yourself.\",\r\n        \"swampcook cook answ\": \"A-ha~! I am an open book! But you've already helped me! It would be better to learn of someone else!\",\r\n\t\"swampcook cook2\": \"Can you at least tell me where you get your meat from?\",\r\n        \"swampcook cook2 answ\": \"We kill zalgo! Turtle when we can! Alligator when we must! We do not seek snake! We kill that zalgo that comes! They always do...!\"\r\n                +\"\\n\\n*[The cook abruptly stops talking, then clears his throat and hums questioningly at you]*\", //\"Zalgo\" - in this context means dangerous thing\r\n\t\"swampcook trader\": \"What can you tell me about the... bartermaster?\",\r\n        \"swampcook trader answ\": \"Ahh, she runs the stall near the front of the camp! I give her many meat to barter with! And in return she gives me the local wild to use!\",\r\n        \"swampcook trader1\": \"Most people would just call that a merchant or trader, especially if they're just selling what they were given.\",\r\n        \"swampcook trader1 answ\": \"Ah~, no! Her son gets the wild! Her son didn't have an eye for it! But anyone can learn! He gives some to me! They sell the rest!\",\r\n        \"swampcook trader2\": \"But why, though? It seems to me that you're getting a bad deal. What do you get for giving her so much free meat?\",\r\n        \"swampcook trader2 answ\": \"Ha~! Because we are kazoku! And oh-! When she finds something special! For my eyes first, she says!\",\r\n        \"swampcook trader3\": \"What? How often does the trader find anything special?\",\r\n        \"swampcook trader3 answ\": \"Sometimes! Ha~!\",\r\n        \"swampcook traderend\": \"Thanks... I guess I've learned enough about the trader.\",\r\n        \"swampcook traderend answ\": \"A-ha~! What else can I tell you of?!\",\r\n        \"swampcook fangs\": \"Who are the unsharpened fangs you keep referring to?\",\r\n        \"swampcook fangs answ\": \"Ahh, one would be the leatherworker next door! But first! Across the hutfield is our clothier! He is the first one you should sharpen! The old woman is more likely to break than sharpen, a-ha~!\",\r\n\t\"swampcook tailor\": \"What do I need to know about the clothier?\",\r\n        \"swampcook tailor answ\": \"Ha~! Very stressed man! He makes the cloth!\",\r\n        \"swampcook tailor1\": \"Okay, so you just mean a tailor.\",\r\n        \"swampcook tailor1 answ\": \"Ahh, making cloth is very hard! And he is more than that! He mends, too!\", //mends people, i.e., is the tribe's doctor\r\n        \"swampcook tailor2\": \"I... see. Is there anything more you think I should know, for some reason?\",\r\n        \"swampcook tailor2 answ\": \"He has been many things! Very skilled man! He scouted for years! Then used what he learned to make the cloth! But now?! Too much to do! Not enough hands anymore! Not since he taught his family to leave!\",\r\n        \"swampcook tailorend\": \"I think that's helpful? Maybe? I probably know enough about the tailor, at any rate.\",\r\n        \"swampcook tailorend answ\": \"Ahh?! Maybe I am not telling right?!\",\r\n\t\"swampcook tanner\": \"You had said there's things I should know about the leatherworker?\",\r\n        \"swampcook tanner answ\": \"Ah~! Old woman works skin to leather!\",\r\n        \"swampcook tanner1\": \"I would have just called her a tanner, but okay. What about her?\",\r\n        \"swampcook tanner1 answ\": \"She is hurt! Worn! Breaking! Inside and out! Heart and hands! Age has been cruel! In many ways!\",\r\n        \"swampcook tanner2\": \"That's rough, buddy. Is that why you help process leather for her?\", //reference to Avatar, the Last Airbender\r\n        \"swampcook tanner2 answ\": \"Ha~! Yes! Every piece of bad leather makes her feel bad! I can help! But only so much!\",\r\n        \"swampcook tannerend\": \"Alright. I think I might have an idea of how I can help the tanner.\",\r\n        \"swampcook tannerend answ\": \"A-ha~! Good kazoku! But remember! Help the clothier first!\",\r\n\t\"swampcook peopleend\": \"I think I've learned all I need to about the people of the Snake Fang tribe.\",\r\n        \"swampcook peopleend answ\": \"Ha~! If you are sure! Then I shall tell you no more! Go across the hutfield! Speak to the clothier! Tell him `tumana`! He should listen then! I will talk to the leatherworker! For you!\",\r\n        \"swampcook whycrab\": \"There's just one thing I don't understand, though. How does crab-erm, rock meat help you? There's plenty of cured meats around already.\",\r\n        \"swampcook whycrab answ\": \"A-ha~! A man must have some secrets! A-ha-ha~!\",\r\n        \"swampcook whycrabpress\": \"Oh, knock it off with the fake laughter! Be honest with me, for once! Tell me what's going on!\",\r\n        \"swampcook whycrabpress answ\": \"*[The cook stops smiling and lowers his voice]*\"\r\n                +\"\\n\\nI do not lie. Not with laughter. Not with help. I choose to be here. Now. Living. Helping. If I run away, I am not living. If I am not laughing, I am not living. If I am not helping, I am not living. And if I die here? Die helping? Die laughing? Then I die living. So now you be honest? Not to me. To you. What do you live for? What do you laugh for? What will you die for? I wonder. Will you run away? Or will you smile?\",\r\n\t\"swampcook whycrabdrop\": \"Fine. I doubt I'd understand what you were saying anyway.\",\r\n\t\"swampcook whycrabdrop answ\": \"A-ha~?!\",\r\n        \"swampcook nolore\": \"I really don't think I want to know about whatever it is you're talking about. Can you please just tell me who I can help next?\",\r\n        \"swampcook nolore answ\": \"Sosso! Sad kazoku! But okay! The first is the clothier across the hutfield! Tell them `tumana`! After helping, go to the leatherworker in the hut next door!\",\r\n        \"swampcook liked\": \"How are things going for you?\",\r\n        \"swampcook liked answ\": \"Menaka kazoku! I am good! For you sharpen the snake's fangs! That is all I need!\", //\"Menaka\" - in this context means cute, precious\r\n        \"swampcook noloreteach\": \"Do you think you could teach me how to make the cured meats I've seen hanging around the workhut?\", //for learning the jerky recipes if the player skips lore\r\n        \"swampcook noloreteach answ\": \"A-ha~! Happily, kazoku! Grab a piece! And do as I do!\"\r\n                +\"\\n\\n*[The cook's odd phrases, loud voice, bizarre cadence, and constant singing make it hard to understand what he's saying, but by following along with his actions, you pick up on how to make jerkies from the meats of the swampland cratures.]*\",\r\n        \"swampcook obaru\": \"Uh... obaru? What is obaru?\",\r\n        \"swampcook obaru answ\": \"Ha~! You are obaru! Silly obaru!\",\r\n        \"swampcook kazoku\": \"Okay, what is kazoku?\",\r\n        \"swampcook kazoku answ\": \"A-ha~! We are kazoku! Silly kazoku!\",\r\n        \"swampcook sosso\": \"Are you just going to keep saying words at me I don't understand? What does sosso mean?\",\r\n        \"swampcook sosso answ\": \"Ha~! Okay! In your tongue, sosso means...! Fool?! Yes! Fool! You are being the fool!\",\r\n        \"swampcook zalgo\": \"Are the `zalgo` usually a threat?\",\r\n        \"swampcook zalgo answ\": \"Ahh~, yes! That is what zalgo means! A threat! We must always be ready! But it's harder now! Not that it was ever easy! Ha-ha~!\",\r\n        \"swampcook menaka\": \"Should I even bother trying to ask what menaka means?\",\r\n        \"swampcook menaka answ\": \"A-ha-ha~! Is good thing!\",\r\n        \"swampcook tumana\": \"And just what, pray tell, is tumana?\",\r\n        \"swampcook tumana answ\": \"Tumana! Yes! Tell it to the clothier!\",\r\n\t//\r\n        \"swamptailor description 1\": \"Approaching the tailor's workhut, you glance inside to see an fidgety man quickly moving between multple tasks. He seems to be talking to somebody in hushed tones, but as you get closer, you realize there's nobody else around.\", //setup description for the initial dialogue\r\n        \"swamptailor description 2\": \"As you approach the tailor's workhut, you see he's already putting down whatever task he was working on and moving outside to meet with you.\", //for in between the initial dialogue and completing his portion of the quest\r\n        \"swamptailor description 3\": \"You approach the tailor's workhut, knocking loudly at the door to get his attention over his relentless fretting about the place.\", //for after completing his portion of the quest\r\n\t\"swamptailor interrupt\": \"*[knock on the workhut door]*\", //the tailor will winge to himself until the player makes their presence known\r\n        \"swamptailor interrupt answ\": \"-and how am I- \"\r\n\t\t\t+\"\\n\\n*[Upon realising you're there, the tailor drops what they were doing and dives behind a nearby table, knocking it's contents to the floor. They slowly scramble to their feet while reaching futilely for some sort of weapon]*\\n\\n\"\r\n\t\t\t+\"What? Who are you! Why are you here! How did you get here!\",\r\n        \"swamptailor listen1\": \"*[Wait for the tailor to notice you]*\", //start of the winge loop\r\n        \"swamptailor listen1 answ\": \"-boil the linen, he says, as if that'll- \" //\"Just boil the linen, he says, as if that'll solve the problem\"\r\n\t\t\t+\"\\n\\n*[The tailor puts down some sewing tools and moves to futz with a bubbling pot near the fireplace]*\",\r\n        \"swamptailor listen2\": \"*[Wait for the tailor to notice you]*\",\r\n        \"swamptailor listen2 answ\": \"-if she think's it's so easy why doesn't she-\", //\"If she thinks it's so easy why doesn't she take care of the scout's wounds?\"\r\n        \"swamptailor listen3\": \"*[Wait for the tailor to notice you]*\",\r\n        \"swamptailor listen3 answ\": \"-I'm a tailor, not a doctor, for-\"\t//reference to McCoy's catchphrase in Star Trek: The Original Series\r\n\t\t\t+\"\\n\\n*[The tailor moves away from the pot and to a table where they begin stripping old cloth]*\",\r\n        \"swamptailor listen4\": \"*[Wait for the tailor to notice you]*\",\r\n        \"swamptailor listen4 answ\": \"-not my fault that they-\", //\"It's not my fault that they got ambushed\"\r\n        \"swamptailor listen5\": \"*[Wait for the tailor to notice you]*\",\r\n        \"swamptailor listen5 answ\": \"-if they had better-\" //\"Maybe if they had better armor, they would have survived\"\r\n\t\t\t+\"\\n\\n*[The tailor stops mid-cut to paw through a bundle of plants before turning back around to the pot near the fireplace]*\",\r\n        \"swamptailor listen6\": \"*[Wait for the tailor to notice you]*\",\r\n        \"swamptailor listen6 answ\": \"-think I can just fix-\", //\"Do they think I can just fix her wounds because bandages are made of cloth?\"\r\n        \"swamptailor listen7\": \"*[Wait for the tailor to notice you]*\",\r\n        \"swamptailor listen7 answ\": \"-the others made sure she got-\" //\"At least the others made sure she got away\"\r\n                        +\"\\n\\n*[The tailor turns away from the pot, grabbing some loose nearly strips of cloth and a needle and thread begins trying to stitch them together]*\",\r\n        \"swamptailor listen8\": \"*[Wait for the tailor to notice you]*\", //loop point, just force interrupt at this point if the loop breaks dialogue\r\n        \"swamptailor listen8 answ\": \"-need some fresh cloth, or else-\", //\"We need some fresh cloth, or else the wounds will just get worse\"\r\n        \"swamptailor cookword\": \"Sorry! The cook sent me! He told me to tell you `tumana`!\",\r\n        \"swamptailor cookword answ\": \"Well did he also tell you to scare me half to death!? \"\r\n\t\t\t+\"\\n\\n*[The tailor stops flailing and warily steps out from behind the knocked over table]*\\n\\n\"\r\n\t\t\t+\"A strange ken, dressed strange, smells strange. Just who even are you!? Are you a ken of the cook's?\",\r\n\t\"swamptailor help\": \"His... ken? Not at all. Honestly, it was hard to even understand anything he was telling me half the time, but he said that you'd listen to me if I said that.\",\r\n        \"swamptailor help answ\": \"*[The tailor exhales a deep sigh]*\\n\\n\"\r\n                +\"Oh course he had to do it like this... I have no reason to trust you, but `tumana` means fertile grounds in his tongue, and even if you knew that, there's no reason you'd say that to me. So if I had to guess, I'd think he was trying use that to tell me in his own way that not only has he vetted you and found you at least passingly capable, but that you're going to be the one getting flax for me. Two hundred bundles should be enough to get started on the bare minimum of what I need. Now go on, off with you now, shoo, time is bleeding out.\", //reference to the Adult Swim Infomercial \"Broomshakalaka\"\r\n        \"swamptailor flax\": \"Wait a second! What is flax, and why am I getting it for you?\",\r\n        \"swamptailor flax answ\": \"*[The tailor exhales another deep sigh]*\\n\\n\"\r\n                +\"You break my concentration, put me in a panic, make a mess of my workspace, and now you're saying you don't even know one of the most valuable naturally-growing plants on the upper side of the great river basin? Of course. Why would I expect ~competent~ help. Especially from an outsider like you. Look- \"\r\n                +\"\\n\\n*[The tailor bends down and picks up a long thin plant with blue flowers]*\\n\\n\"\r\n                +\"-THIS is flax. Go up in the mountains, find more, and bring it to me. Two hundred bundles. Thank you goodbye.\",\r\n        \"swamptailor deliver\": \"I've managed to collect all 200 bundles of flax plants that you wanted.\",\r\n        \"swamptailor deliver answ\": \"You did? I... I'm sorry, it was unkind of me, the way I spoke to you before. Please understand, these plants are going to be used to make fresh bandages, and without them... I'm not sure I would have been able to do much of anything trying to reuse fraying rags. I can only hope you were quick enough. I know it's untoward of me to even consider asking this of you after you've already done the hardest part, but could you spare some additional time and help me begin to process these into usable linen cloth? Even if you don't know what do to, which I'm fairly certain you don't, an extra pair of hands makes all the difference in the world, and you might be able to make linen yourself afterwards too. \"\r\n                +\"\\n\\n*[The tailor teaches you how to process flax into linen cloth]*\",\r\n\t\"swamptailor deliver not\": \"You did? Where are they, then? Please, I ~need~ those plants. Every hour counts.\",\r\n        \"swamptailor liked\": \"Is there anything I can do to help you out today?\",\r\n        \"swamptailor liked answ\": \"No, friend, although I appreciate your patience and your concern. As full as my hands are, as full as they always are, I know your time and skills are better spent elsewhere.\",\r\n\t//\r\n        \"swamptanner description 1\": \"You approach the tanner's workhut to find the old woman with a scowl on her face standing next to a rack stretching drying leather. Her hands are visibly shaking, an apparent sign of wear and old age, as she goes about her work.\", //before completing the first delivery.\r\n        \"swamptanner description 2\": \"You approach the tanner's workhut, finding her with meticulously fleshing the alligator skins you brought her earlier. In spite of her clear and deliberate effort, her unsteady hands make deep gouges in the hide like that of an amateur first learning how to clean the skin.\", //for after completing the first part of the delivery\r\n        \"swamptanner description 3\": \"You approach the tanner's workhut. The old woman is sitting down, rubbing her knuckles with a grimace on her face. Piles of partially-processed skins litter the hut, rotting untreated in the heat. As she looks up at you, her expression softens, as if trying to hide her pain.\", //description changes after making the second delivery and finishing her part of In Times of Need\r\n\t\"swamptanner unknown\": \"Excuse me, are you the leatherworker? I was told that I should come see you.\",\r\n        \"swamptanner unknown answ\": \"Yes. That would be me. And I know of you -- but I do not know you, nor do I want your help. I need not the blood of the young on my conscience.\",\r\n        \"swamptanner help\": \"I'm sure I can handle whatever tasks you need of me.\",\r\n        \"swamptanner help answ\": \"Were the young always so eager to die? Fine. If you shan't be wary, then be the fool. Skin five dozen alligators, or feed the bog trying.\",\r\n        \"swamptanner deliver 1\": \"I've got the 60 alligator skins you requested.\",\r\n        \"swamptanner deliver 1 answ\": \"You did!? Ah... \" \r\n                +\"\\n\\n*[The old woman stands up, and with shaky yet strong hands, takes the alligator skins from you, staring at you as she does]*\\n\\n\"\r\n                +\"My eyes are not as good as they used to be. But now that I see you... You have a strength within. A courageous spirit burning bright; a warrior's heart beating strong. She does too.\",\r\n\t\"swamptanner deliver 1 not\": \"My eyes may not be as good as they used to be, but I can still count. This is not five dozen, child.\",\r\n        \"swamptanner known\": \"Who is `she`?\",\r\n        \"swamptanner known answ\": \"The person I needed these skins for. She needs new armor if she's going to survive out there, next time. I will be honest, child: if I am to make her new armor, I am in need of more; these hides can protect, but not alone. I will need the skins of five dozen snakes as well. But I cannot ask you to go and risk your life again for them. I have seen too many children already...\", //\"already die trying.\"\r\n        \"swamptanner deliver 2\": \"You don't need to worry any longer. I have the 60 snake skins you need.\",\r\n        \"swamptanner deliver 2 answ\": \"Child... You truly have a mighty soul.\" \r\n                +\"\\n\\n*[The old woman stands up, and with ever shaky hands, takes the giant snake skins from you, staring at you as she does]*\\n\\n\"\r\n                +\"My eyes are not as good as they used to be. But now that I see your armor... I know not how you survived such brutal attacks. Come. I will teach you how to process the skins you've brought. Surely they will be stronger than whatever it is you're wearing. I may even have some old turtle shells you could practice with. Their shells are very tough, but difficult to... \"\r\n                +\"\\n\\n*[The old woman teaches you what you need to know in order to process alligator and giant snake skins, as well as turtle shells]*\",\r\n\t\"swamptanner deliver 2 not\": \"Child... It is okay, you need not lie nor risk your life. You have done enough already. We will manage. We always have.\",\r\n        \"swamptanner liked\": \"Just checking in. Is there anything more I can do to help you?\",\r\n        \"swamptanner liked answ\": \"Ahh, you are a good child, and a strong warrior. Warriors such as you need not concern yourself with the worries of an old woman.\",\r\n\t//\r\n        \"swampscout description 1\": \"You see a young woman lying in a cot near the door. Her chest is covered in worn bandages stained with old blood,\"\r\n                +\" her arms covered in cuts and abrasions, and her lower half obscured by a blanket. The smell of rot gets stronger as you approach her.\",\r\n        \"swampscout description 2\": \"You see the scout lying in a cot near the door. Her chest is covered in worn bandages stained with fresh blood,\"\r\n                +\" her arms covered in cuts and abrasions, and her lower half obscured by a blanket. The smell of rot gets stronger as you approach her.\", //description changes after meeting her\r\n        \"swampscout description 3\": \"You see the scout lying in a cot near the door. Her chest is covered in fresh bandages stained with fresh blood,\"\r\n                +\" her arms covered in bruises and scars, and her lower half partially obscured by a blanket, revealing empty space where her right leg used to be.\", //description changes after she teaches the player foraging\r\n        \"swampscout description 4\": \"You see the scout lightly sleeping in a cot near the door. Better to just let her rest.\",\r\n\t\"swampscout meet\": \"Hello? Sorry to bother you, I just wanted to introduce myself.\",\r\n        \"swampscout meet answ\": \"*[The young woman listlessly turns her head and smiles meekly at you]*\\n\\n\"\r\n                +\"I've heard of you already. Our leader said we may have a new den kin joining our ranks. It's been a while since... I last saw it happen.\"\r\n                +\" I was just a kid then. And now look... at him, trying to help everyone even now...\",\r\n        \"swampscout lore1\": \"Are you alright?\",\r\n        \"swampscout lore1 answ\": \"Forgive me if my speech is unclear or absurd. I've been in a state of limbo since... I don't even know how long ago it was.\"\r\n                +\" It feels like yesterday. But it also feels... like it was years ago. Like I've been living in this cot forever...\", //refernce to Pathologic\r\n        \"swampscout lore2\": \"What happened?\",\r\n        \"swampscout lore2 answ\": \"Oh. I figured you must had heard... \"\r\n                +\"\\n\\n*[The young woman listlessly turns her head away and stares off into the distance]*\\n\\n\"\r\n                +\"It had been a rough few years: the amount of good... huntable meat in the swamps was dwindling. Natural herbs and vegetables were growing more scarce... \"\r\n                +\"every year. And the snakes were... creeping into the camp more often. We had posted guards, but they were so fast and quiet, we... \"\r\n                +\"often wouldn't notice they were gone until the sun rose.\",\r\n        \"swampscout lore3\": \"*[Let her continue]*\",\r\n        \"swampscout lore3 answ\": \"Our current chief, the brother... to our last chieftan's bondmate and at the former... huntmaster, decided that the best option was\"\r\n        +\" to sent hunting parties out into the... swamp, to find the snake's den, so that we could stop their... attacks in the middle of the night.\"\r\n        +\" The snake attacks had been... intensifying under his time as huntmaster, and he considered it his destiny to... drive them from the swamp.\",\r\n        \"swampscout lore4\": \"*[Let her continue]*\",\r\n        \"swampscout lore4 answ\": \"Weeks went by, with our supplies... dwindling with them. Groups that should've been gathering or...\"\r\n        +\" scouting new hunting spots were searching for snake dens that didn't exist, and deaths... became an almost daily occurance from unskilled scouts pushed to\"\r\n        +\" explore past their bounds. No snakes that big could hide... their nest in a bog this small anyway. We tried to tell him, but no, we dare not...\"\r\n        +\" challenge the chief's honor by questioning his rule. It didn't take long before some people started talking about... leaving for the great plains southeast of here.\",\r\n        \"swampscout lore5\": \"*[Let her continue]*\",\r\n        \"swampscout lore5 answ\": \"The chief was angry. He... banished the lot of them, saying they'd be better off... as bog feed than weakening the tribe.\"\r\n        +\" And so we were split. Many artisans, scouts, and... warriors went that night. My brother went with them, as did our... doctor, our blacksmith, and the tailor's sister.\"\r\n        +\" Even though I'm just... a scout, I had wanted to be a warrior. I was fully loyal to... our chief's vision, at the time. I thought might made right, that force made security.\"\r\n        +\" I wonder... if they survived, if they made something new down there... I wonder what life I could have lived...\",\r\n        \"swampscout lore6\": \"*[Let her continue]*\",\r\n        \"swampscout lore6 answ\": \"Well, with so much of our... people gone, there were less eyes to watch the gate, less hand to hold the... spears, less ears to the ground.\"\r\n        +\" It became necessary to... scale everything down, pull the walls in, and turtle up. Everyone had double- and triple-duty. And yet the hunt... for the snakes continued.\"\r\n        +\" A hunt across the bog with naught but ghosts to watch over us... ...as the snakes bore down on us...\",\r\n        \"swampscout lore7\": \"I'm sorry all that happened.\",\r\n        \"swampscout lore7 answ\": \"I thought myself strong. I thought that... to live meant to be strong. To stand up to... death. But now... Everything that lives is destined to end.\"\r\n        +\" To live in pain, in... a neverending spiral of life and death...\", //reference to the opening of Nier: Automata\r\n        \"swampscout lore8\": \"Wow...\",\r\n        \"swampscout lore8 answ\": \"*[The scout listlessly turns her head towards you]*\\n\\n\"\r\n                +\"I'm sorry. I just met you and I'm rambling about... this of all things. We can talk about something... else. I've spent a lot of time in the...\"\r\n                +\" swamps, there's some interesting things... growing out there.\",\r\n        \"swampscout generic\": \"Is there anything I can do for you?\",\r\n        \"swampscout generic answ\": \"No... No, time is the only help for me at this... point. But sitting and talking with me... helps. Thank you.\",\r\n        \"swampscout help\": \"Here, I brought you a healing potion to help ease your pain.\",\r\n        \"swampscout help answ\": \"Oh... Thank you. Hopefully this'll... help me get some sleep.\",\r\n        \"swampscout help not\": \"I'm sorry, can you... show me what you're giving me?\",\r\n        \"swampscout foraging\": \"I would actually be really interested in hearing about what things are growing in the swamp.\",\r\n        \"swampscout foraging answ\": \"Alright... Sit down on the bed, and I'll tell you... about what I've seen over the years.\",\r\n    },\r\n    mofu_english: {\r\n        \"elder description\": \"You see an older man with curly white hair and dull, heavy horns. Despite his years, he stands with a strong posture, ready to ram any threat to the village. He eyes you with curiosity.\",\r\n        //\r\n        \"craftsman description\": \"You see an old man with a medium length white tail, who clearly experienced a lot in life. His hair is composed of a black and a white part, with the former very dulled by age. He's wearing some handmade accessories. Despite his age and his massive hands, his fingers seem exceptionally nimble.\",\r\n        //\r\n        \"craftsman learn answ\": \"Ahh, that's great. Well then... \\n*[Old man spends some time explaining all the important basics of crafting and providing\"\r\n                +\" you with tips, his large fingers proving to be as nimble as they seemed]*\\n\"\r\n                + \"Ahh, and before I forget, here, take these. They will be helpful for gathering necessary materials.\",\r\n        \"craftsman about guard answ\": \"Ahhh, our fierce she-wolf... She once wanted to be an adventurer, but I believe it didn't work out for her. Hard work is not enough when talent is lacking nor can it allow one to conquer fate. Still, she's a good girl and keeps us safe now.\",\r\n        //\r\n        \"guard description\": \"You see a tall woman in light armor, with a spear in her hand and two daggers on her belt. \"\r\n                +\"Her sharp fuzzy ears rotate every now and then towards any new sound, while her fluffy tail remains motionless. There's a scar across her face.\"\r\n                +\" When she spots you, she looks at you as if you were a prey, but then her expression softens a lot.\",\r\n        \"guard hi answ\": \"Hey there. I heard you've been helping around a lot, good job cutie~ \\n \"\r\n                +\"*[As she says that, she bends forward and pats your head a few times with a surprisingly gentle touch, her tail slightly wagging]*\",\r\n        \"guard serious answ\": \"Ohhh, someone wants to impress the cute fluffy wolf lady? Sorry, but I'm way too strong for you~\",\r\n        //\r\n        //\r\n        \"millers description\": \"You see two teenagers with mischievous looks on their faces. One has cat ears and a fluffy tail, the other mouse ears and a tail with barely any hair on it. It's only with great deal of effort that you manage to recognize them both as males. The cat has red hair, the mouse gray.\",\r\n        \"millers hello answ\": \"[Cat] Hi~! \\n [Mouse]: Hello\",\r\n        \"millers how answ\": \"[Mouse] We are fine, mostly. \\n [Cat] Except for rats in the storehouse, especially since we are about to have grain delivery.\"\r\n                +\" \\n [Mouse] The big rats, like on the fields... \\n [Cat] I would prefer mice, at least those are cute. \\n [Mouse] Shut up. \\n \"\r\n                +\"[Cat] So if you could help us with them, it would be great!\",\r\n        \"millers sure answ\": \"[Cat] Ehehe, thank you~ \\n [Mouse] We will get you some reward for it later. \\n [Cat] A bit of money, and maybe a kiss or two~\",\r\n        \"millers cleared answ\": \"[Cat] Nice job! \\n[Mouse] Now where is that grain? \\n [Cat] Oh right, it was supposed to be delivered by now. \"\r\n                +\"\\n[Mouse] Could you search the village for a cart loaded with bags of grain that's 'supposed' to be heading our way?\",\r\n        \"millers delivered answ\": \"[Cat] Thanks \\n[Mouse] Thank you! \\n[Cat] And here's your reward.\",\r\n        \"millers kiss answ\": \"[Cat] Yes? Which one of us do you want it from?\",\r\n        \"millers kiss mouse answ\": \"*[Mouse teen slowly approaches you from the side and gives you a gentle smooch on your cheek with his tail brushing against your legs,\"\r\n                +\" then steps back with a slightly shy smile]*\",\r\n        \"millers kiss cat answ\": \"*[Cat teen slowly approaches you from the side and gives a gentle smooch on your cheek with his tail brushing against your legs,\"\r\n                +\" then steps back with a smirk]*\",\r\n        \"millers kiss both answ\": \"*[The two slowly approach you from both sides and you receive two simultanous gentle smooches, one of each of your cheek with their\"\r\n                +\" tails brushing against your legs, after which they take a step back]*\",\r\n        \"millers reject nice answ\": \"[Cat] Oh well, that's a pity~\",\r\n        \"millers reject mean answ\": \"[Cat] Whatever you say~\",\r\n        \"millers kiss more answ\": \"[Cat] Hmmm... should we? \\n[Mouse] Maybe some other time. \\n[Mouse] You heard him~\",\r\n        \"millers how2 answ\": \"[Cat] Kinda boring, but at least company is good. \\n[Mouse] What he said.\",\r\n        \"millers about guard answ\": \"[Cat] Nope, nothing. She just happens to have same name and looks, as far as oral descriptions go, as one the continent's top ten adventurers who retired just before she returned.\"\r\n                                +\" \\n[Mouse] Obviously it's a total coincidence, right? Two completely unrelated wolves. *[The two exchange amused looks]*\"\r\n                                +\" \\n[Cat] Jokes aside, no one here besides us managed to make that connection, that's just sooo stupid~\"\r\n                                +\" \\n[Mouse] When they hear how there was a powerful adventurer who happens to match her perfectly, they all just assume that it's a pure coincidence and a completely different person.\"\r\n                                +\" \\n[Cat] She doesn't seem to care much about it, probably prefers peace and quiet. Let her have them, I'm sure she went through a lot, and with her here we can feel safer than ever.\",\r\n        //\r\n        \"g guard description\": \"You see a massive, hairy man with round ears and a tiny tail. He's clad in a steel chainmail, with a spear in his hand and an axe on his belt.\",\r\n        //\r\n        \"sus description 1\": \"You see a young man in shabby clothes and with messy hair, who keeps looking around. He appears to have some nervous ticks, or maybe he's just really\"\r\n                +\" stressed. Both his doggy ears and his tail are lowered and not moving. He notices you and stares.\",\r\n        \"sus description 2\": \"You see a young man in shabby clothes and with messy hair, who keeps calmly looking around, with ears straight up and\"\r\n                +\" occasionally turning towards new sounds. The moment he notices you, he appears to get calmer and his tail starts slowly wagging.\",\r\n        //\r\n        \"sus headpat answ\": \"[He smiles like a little puppy, his tail wagging a lot faster]\",\r\n        //\r\n        \"old description 1\": \"With some safety returned to the area, more folk are now out on the streets. One of them, an elderly tanuki lady, is looking at you.\",\r\n        \"old description 2\": \"You see a gentle elderly tanuki lady with warm look in her eyes\",\r\n        //\r\n        \"sup description\": \"You see a well dressed man with a notebook on his belt and a hat on his head, awkwardly placed between a pair of antlers.\"\r\n                +\" Despite seeming more like a scribe, he's buff and tanned.\",\r\n        //\r\n        \"swampchief description 1\": \"Looking around the encampment, you see a large hut framed by banners and lit torches.\"\r\n                +\" You approach the hut, calling out in greeting, but getting no response.\"\r\n                +\" As you step closer, you see a large man in thick scaly armor wielding a great trident emerge, his thick scaly tail resting behind him.\"\r\n                +\" He points the trident at you as he takes a firm stance.\",\r\n        //\r\n        \"swampcook description 1\": \"As you get closer to the cook's workhut, you're met with a distinctive tune bellowed loudly and an acrid smell emanating from inside.\"\r\n                +\" Bracing your nose, you approach to find a short fellow nearly obscured by hanging meats,\"\r\n                +\" moving between a rack larger than he is housing thin cuts suspended between grated slats and a large cauldron build into a workbench covered in large slabs\"\r\n                +\" of rough leather in various stages of processing.\"\r\n                +\" You're surprised to find that he was the source of the singing.\"\r\n                +\" Noticing your approach, he stops his song and turns to address you with a smile on his face, somehow managing to not hit anything with his scaly tail.\",\r\n        \"swampcook description 3\": \"As you approach the workhut, you absentmindedly sing along to the cook's song.\"\r\n                +\" He notices your singing before turning to you and giving a big nod with a toothy grin before resuming his work, his large tail once again somehow not hitting anything.\",\r\n        \"swampcook peopleend\": \"I think I've learned all I need to about the lizardfolk of the Snake Fang tribe.\",\r\n        //\r\n        \"swamptanner description 1\": \"You approach the tanner's workhut to find the old woman with a scowl on her face standing next to a rack stretching drying leather.\"\r\n                +\" Her hands are visibly shaking while her tail is dull in color and thin, an apparent sign of wear and old age, as she goes about her work.\",\r\n        //\r\n        \"swampscout description 1\": \"You see a young woman lying in a cot near the door. Her chest is covered in worn bandages stained with old blood,\"\r\n                +\" her arms covered in cuts and abrasions, and her lower half obscured by a blanket. The smell of rot gets stronger as you approach her.\",\r\n        \"swampscout description 2\": \"You see the scout lying in a cot near the door. Her chest is covered in worn bandages stained with fresh blood,\"\r\n                +\" her arms covered in cuts and abrasions, and her lower half obscured by a blanket. The smell of rot gets stronger as you approach her.\",\r\n        \"swampscout description 3\": \"You see the scout lying in a cot near the door. Her chest is covered in fresh bandages stained with fresh blood,\"\r\n                +\" her arms covered in bruises and scars, and her lower half partially obscured by a blanket, revealing empty spaces where her tail and right leg used to be.\",\r\n        }\r\n}\r\n\r\n\r\nexport { translationManager, translations };\r\n", "\"use strict\";\r\n\r\nimport { traders } from \"./traders.js\";\r\nimport { current_trader, to_buy, to_sell } from \"./trade.js\";\r\nimport { skills, get_unlocked_skill_rewards, get_next_skill_milestone } from \"./skills.js\";\r\nimport { character, get_skill_xp_gain, get_hero_xp_gain, get_skills_overall_xp_gain, get_total_skill_coefficient, get_total_skill_level, get_effect_with_bonuses, cold_status_temperatures, get_character_cold_tolerance, lowest_tolerable_temperature, get_skill_xp_gain_bonus, tool_slots } from \"./character.js\";\r\nimport { current_enemies, options, \r\n    can_work, current_location, \r\n    active_effects, enough_time_for_earnings, \r\n    get_current_book, last_location_with_bed, \r\n    last_combat_location, faved_stances, \r\n    selected_stance, \r\n    global_flags,\r\n    unlocked_beds,\r\n    favourite_consumables,\r\n    travel_times, \r\n    language,\r\n    favourite_items} from \"./main.js\";\r\nimport { dialogues } from \"./dialogues.js\";\r\nimport { activities } from \"./activities.js\";\r\nimport { format_time, current_game_time, seasons } from \"./game_time.js\";\r\nimport { book_stats, item_templates, Weapon, Armor, Shield, rarity_multipliers, getItemRarity, getItemFromKey } from \"./items.js\";\r\nimport { favourite_locations, get_location_type_penalty, location_types, locations } from \"./locations.js\";\r\nimport { enemy_killcount, enemy_tag_to_skill_mapping, enemy_templates } from \"./enemies.js\";\r\nimport { expo, format_reading_time, stat_names, get_hit_chance, round_item_price, format_working_time, task_type_names, celsius_to_fahrenheit, is_a_older_than_b, select_outline_class } from \"./misc.js\"\r\n//import { stances } from \"./combat_stances.js\";\r\nimport { get_recipe_xp_value, recipes } from \"./crafting_recipes.js\";\r\nimport { effect_templates } from \"./active_effects.js\";\r\nimport { player_storage } from \"./storage.js\";\r\nimport { quests } from \"./quests.js\";\r\nimport { get_current_temperature_smoothed, is_raining } from \"./weather.js\";\r\nimport { PointyStarParticle, RainParticle, SnowParticle } from \"./particles.js\";\r\nimport { get_game_version } from \"./game_version.js\";\r\nimport { process_conditions } from \"./conditions.js\";\r\nimport { translationManager } from \"./translation.js\";\r\nlet activity_anim; //for the activity and gameAction animation interval\r\n\r\nlet location_choice_divs = {}; //for dropdowns\r\nconst action_div = document.getElementById(\"location_actions_div\");\r\nconst trade_div = document.getElementById(\"trade_div\");\r\nconst storage_div = document.getElementById(\"storage_div\");\r\n\r\nconst location_name_span = document.getElementById(\"location_name_span\");\r\nconst location_icon_span = document.getElementById(\"location_icon_span\");\r\nconst location_types_div = document.getElementById(\"location_types_div\");\r\nconst location_tooltip = document.getElementById(\"location_name_tooltip\");\r\n\r\n//for visual effects\r\nlet canvas;\r\nlet context;\r\nlet background_animation;\r\nlet background_animation_timeout;\r\nlet background_animation_particles = [];\r\n\r\n//inventory display\r\nconst inventory_div = document.getElementById(\"inventory_content_div\");\r\nlet item_divs = {};\r\nlet trader_item_divs = {};\r\nlet storage_item_divs = {};\r\nlet item_buying_divs = {};\r\nlet item_selling_divs = {};\r\nconst trader_inventory_div = document.getElementById(\"trader_inventory_div\");\r\nconst storage_inventory_div = document.getElementById(\"storage_inventory_div\");\r\n\r\n//message log\r\nconst message_log = document.getElementById(\"message_box_div\");\r\n\r\n//enemy info\r\nconst combat_div = document.getElementById(\"combat_div\");\r\nconst enemies_div = document.getElementById(\"enemies_div\");\r\n\r\nconst enemy_count_div = document.getElementById(\"enemy_count_div\");\r\nconst clear_count_div = document.getElementById(\"clear_count_div\");\r\n\r\n//enemy onhit animation\r\nconst onhitAnimation = [\r\n    {\r\n        \"backgroundColor\": \"rgba(0, 0, 0, 0)\",\r\n        \"rotate\": \"0deg\",\r\n    },\r\n    {\r\n        \"backgroundColor\": \"rgba(255, 0, 0, 0.2)\",\r\n        \"rotate\": \"0.3deg\",\r\n    }\r\n]\r\nconst onhitAnimationTiming = {\r\n    duration: 100,\r\n\titerations: 2,\r\n    direction: \"alternate\",\r\n}\r\n\r\nconst onstartAnimation = [\r\n    {\r\n        \"opacity\": \"0.2\",\r\n        \"backgroundColor\": \"rgba(0, 124, 17, 0.2)\",\r\n    },\r\n    {\r\n        \"opacity\": \"1\",\r\n    },\r\n]\r\nconst onstartAnimationTiming = {\r\n    duration: 800,\r\n\titerations: 1,\r\n}\r\n\r\nconst enemy_animations = {};\r\n\r\n//character health display\r\nconst current_health_value_div = document.getElementById(\"character_health_value\");\r\nconst current_health_bar = document.getElementById(\"character_healthbar_current\");\r\nconst health_tooltip_div = document.getElementById(\"character_health_tooltip\");\r\n\r\n//character stamina display\r\nconst current_stamina_value_div = document.getElementById(\"character_stamina_value\");\r\nconst current_stamina_bar = document.getElementById(\"character_stamina_bar_current\");\r\nconst stamina_tooltip_div = document.getElementById(\"character_stamina_tooltip\");\r\n\r\n//character xp display\r\nconst character_xp_div = document.getElementById(\"character_xp_div\");\r\nconst character_level_div = document.getElementById(\"character_level_div\");\r\nconst xp_bar_tooltip_div = document.getElementById(\"character_xp_tooltip\");\r\n\r\n//active effects display\r\nconst active_effects_tooltip = document.getElementById(\"effects_tooltip\");\r\nconst active_effect_count = document.getElementById(\"active_effect_count\");\r\n\r\nconst time_field = document.getElementById(\"time_div\");\r\nconst weather_field = document.getElementById(\"weather_div\");\r\n\r\nconst skill_bar_divs = {};\r\nconst skill_list = document.getElementById(\"skill_list\");\r\nconst skill_category_order = [];\r\n\r\nconst stance_bar_divs = {};\r\nconst stance_list = document.getElementById(\"stance_list\");\r\n\r\nconst booklist_entry_divs = {};\r\nconst booklist_list = document.getElementById(\"books_list\");\r\n\r\nconst bestiary_entry_divs = {};\r\nconst bestiary_list = document.getElementById(\"bestiary_list\");\r\n\r\nconst combat_switch = document.getElementById(\"switch_to_combat\")\r\nconst inventory_switch = document.getElementById(\"switch_to_inventory\")\r\n\r\nconst quest_entry_divs = {};\r\nconst quest_list = document.getElementById(\"quest_list\");\r\nconst quest_hiding_button = document.getElementById(\"quest_hiding_button\");\r\n\r\nconst data_entry_divs = {\r\n                            reputation: document.getElementById(\"data_tab_reputation_div\"),\r\n                        };\r\n\r\nlet skill_sorting = \"name\";\r\nlet skill_sorting_direction = \"asc\";\r\n\r\nlet trader_inventory_sorting = \"name\";\r\nlet trader_inventory_sorting_direction = \"asc\";\r\n\r\nlet storage_sorting = \"name\";\r\nlet storage_sorting_direction = \"asc\";\r\n\r\nlet character_inventory_sorting = \"name\";\r\nlet character_inventory_sorting_direction = \"asc\";\r\n\r\nconst message_count = {\r\n    message_combat: 0,\r\n    message_unlocks: 0,\r\n    message_loot: 0,\r\n    message_events: 0,\r\n    message_background: 0,\r\n    message_crafting: 0,\r\n};\r\n\r\nconst stats_divs = {strength: document.getElementById(\"strength_slot\"), agility: document.getElementById(\"agility_slot\"),\r\n                    dexterity: document.getElementById(\"dexterity_slot\"), intuition: document.getElementById(\"intuition_slot\"),\r\n                    magic: document.getElementById(\"magic_slot\"), \r\n                    attack_speed: document.getElementById(\"attack_speed_slot\"), attack_power: document.getElementById(\"attack_power_slot\"), \r\n                    defense: document.getElementById(\"defense_slot\"), crit_rate: document.getElementById(\"crit_rate_slot\"), \r\n                    crit_multiplier: document.getElementById(\"crit_multiplier_slot\")\r\n                    };\r\n\r\nconst other_combat_divs = {attack_points: document.getElementById(\"hit_chance_slot\"), defensive_action: document.getElementById(\"defensive_action_slot\"),\r\n                           defensive_points: document.getElementById(\"defensive_action_chance_slot\")\r\n                          };\r\n\r\nlet effect_divs = {};\r\n\r\nconst character_attack_bar = document.getElementById(\"character_attack_bar\");\r\n\r\n//equipment slots\r\nconst equipment_slots_divs = {head: document.getElementById(\"head_slot\"), torso: document.getElementById(\"torso_slot\"),\r\n                              arms: document.getElementById(\"arms_slot\"), ring: document.getElementById(\"ring_slot\"),\r\n                              weapon: document.getElementById(\"weapon_slot\"), \"off-hand\": document.getElementById(\"off-hand_slot\"),\r\n                              legs: document.getElementById(\"legs_slot\"), feet: document.getElementById(\"feet_slot\"),\r\n                              amulet: document.getElementById(\"amulet_slot\"), artifact: document.getElementById(\"artifact_slot\"),\r\n                              cape: document.getElementById(\"cape_slot\"),\r\n                              pickaxe: document.getElementById(\"pickaxe_slot\"),\r\n                              axe: document.getElementById(\"axe_slot\"),\r\n                              sickle: document.getElementById(\"sickle_slot\"),\r\n                              shovel: document.getElementById(\"shovel_slot\"),\r\n                              fishing_pole: document.getElementById(\"fishing_slot\"),\r\n};\r\n\r\nconst rarity_colors = {\r\n    trash: \"#d3d3d3\",\r\n    common: \"#ffffff\",\r\n    uncommon: \"#90ee90\",\r\n    rare: \"#0000ff\",\r\n    epic: \"#ffc0cb\",\r\n    legendary: \"#800080\",\r\n    mythical: \"#ffa500\"\r\n}\r\n\r\nconst rarity_outlines = {};\r\nObject.keys(rarity_colors).forEach(rarity => {\r\n    rarity_outlines[rarity] = select_outline_class(rarity_colors[rarity]);\r\n});\r\n\r\nconst crafting_pages = {}\r\n\r\nlet selected_crafting_category;\r\nlet selected_crafting_subcategory;\r\n\r\nconst loading_progress_div = document.getElementById(\"loading_screen_loading_progress\");\r\n\r\nconst backup_load_button = document.getElementById(\"backup_load_button\");\r\nconst other_save_load_button = document.getElementById(\"import_other_save_button\");\r\n\r\nconst export_button_tooltip = document.getElementById(\"export_button_tooltip\");\r\n\r\nconst default_dialogue_return_text = \"Nevermind\";\r\n\r\nfunction capitalize_first_letter(some_string) {\r\n    return some_string.charAt(0).toUpperCase() + some_string.slice(1);\r\n}\r\n\r\nfunction create_floating_effect(text, pos) {\r\n    const effect_elem = document.createElement(\"div\");\r\n    pos.x = pos.x + Math.random()*80-40;\r\n\r\n    effect_elem.style.top = pos.y + \"px\";\r\n    effect_elem.style.left = pos.x + \"px\";\r\n    effect_elem.classList.add(\"floating_effect\");\r\n    effect_elem.innerText = text;\r\n\r\n    effect_elem.posX = pos.x;\r\n    effect_elem.posY = pos.y;\r\n\r\n    document.body.appendChild(effect_elem);\r\n    \r\n    let timer = 0;\r\n\r\n    let anim_interval;\r\n    if(Math.random() > 0.5) {\r\n        anim_interval = setInterval(()=> {\r\n            effect_elem.style.top = effect_elem.posY - 2*timer**0.95 + \"px\";\r\n            effect_elem.style.left = effect_elem.posX - Math.sin(timer/10)*20 + \"px\";\r\n            effect_elem.style.opacity = (100-timer**.95)/100;\r\n            timer++;\r\n        }, 30);\r\n    } else {\r\n        anim_interval = setInterval(()=> {\r\n            effect_elem.style.top = effect_elem.posY - 2*timer**0.95 + \"px\";\r\n            effect_elem.style.left = effect_elem.posX - Math.cos(timer/8)*16 + \"px\";\r\n            effect_elem.style.opacity = (100-timer**.95)/100;\r\n            timer++;\r\n        }, 30);\r\n    }\r\n\r\n    setTimeout(()=>{\r\n        clearInterval(anim_interval);\r\n        effect_elem.remove();\r\n    }, 4*1000);\r\n}\r\n\r\nfunction clear_skill_bars() {\r\n    Object.keys(skill_bar_divs).forEach(function(key) {\r\n        delete skill_bar_divs[key];\r\n    });\r\n}\r\n\r\nfunction clear_action_div() {\r\n    while(action_div.lastElementChild) {\r\n        action_div.removeChild(action_div.lastElementChild);\r\n        location_choice_divs = {};\r\n    }\r\n}\r\n\r\n/**\r\n * @param {Item} item\r\n * @param {Object} options\r\n * @param {String} options.class_name\r\n * @param {Boolean} options.skip_quality\r\n * @param {Array} options.quality array with 1 or 2 values (1 - show only it, instead of item's; 2 - show start comparison between the two)\r\n */\r\nfunction create_item_tooltip(item, options = {}, is_trade = false) {\r\n    let item_tooltip = document.createElement(\"span\");\r\n    item_tooltip.classList.add(options?.class_name || \"item_tooltip\");\r\n    item_tooltip.innerHTML = create_item_tooltip_content({item, options, is_trade});\r\n    return item_tooltip;\r\n}\r\n\r\n/**\r\n * @param {Object} params\r\n * @param {Item} params.item\r\n * @param {Object} params.options\r\n * @param {String} params.options.class_name\r\n * @param {String} params.options.trader\r\n * @param {Boolean} params.options.skip_quality\r\n * @param {Array} params.options.quality array with 1 or 2 values (1 - show only it, instead of item's; 2 - show start comparison between the two)\r\n */\r\nfunction create_item_tooltip_content({item, options={}, is_trade = false}) {\r\n    let item_tooltip = \"\";\r\n\r\n    //different function used depending if its in trade (oh the horror...)\r\n    const value_function = is_trade?\"getValue\":\"getBaseValue\";\r\n    \r\n    item_tooltip = `<b>${item.getName()}</b>`;\r\n    if(item.description) {\r\n        item_tooltip += `<br>${item.description}`; \r\n    }\r\n\r\n    let quality = item.quality;\r\n\r\n    //add stats if can be equipped\r\n    if(item.item_type === \"EQUIPPABLE\"){ \r\n        if(options?.quality && options.quality[0]) {\r\n            quality = options.quality[0];\r\n        }\r\n\r\n        if(!item.ignore_quality) {\r\n            if(!options.skip_quality && options?.quality?.length == 2) {\r\n                const outline_class_1 = rarity_outlines[item.getRarity(options.quality[0])];\r\n                const outline_class_2 = rarity_outlines[item.getRarity(options.quality[1])];\r\n                item_tooltip += `<br><br><b>Quality: <span class=\"${outline_class_1}\" style=\"color: ${rarity_colors[item.getRarity(options.quality[0])]}\"> ${options.quality[0]}% </span> - <span class=\"${outline_class_2}\" style=\"color: ${rarity_colors[item.getRarity(options.quality[1])]}\"> ${options.quality[1]}% </span>`;\r\n                item_tooltip += `<br>[<span class=\"${outline_class_1}\" style=\"color: ${rarity_colors[item.getRarity(options.quality[0])]}\">${item.getRarity(options.quality[0])}</span>-<span class=\"${outline_class_2}\" style=\"color: ${rarity_colors[item.getRarity(options.quality[1])]}\">${item.getRarity(options.quality[1])}</span>] </b>`;\r\n            } else {\r\n                const outline_class = rarity_outlines[item.getRarity(quality)];\r\n                item_tooltip += `<br><br><b class=\"${outline_class}\" style=\"color: ${rarity_colors[item.getRarity(quality)]}\">Quality: ${quality}% [${item.getRarity(quality)}]</b>`;\r\n            }\r\n        }\r\n\r\n        if(item.tags.unique) {\r\n            item_tooltip += `<br><br><b class=\"item_unique outline_white\">Unique</b>`;\r\n        }\r\n\r\n\r\n        item_tooltip += `<br><br>Slot: <b>${item.equip_slot}</b>`;\r\n        if(item.equip_slot === \"weapon\") {\r\n            item_tooltip += `<br>Type: <b>${item.weapon_type}</b>`;\r\n        }\r\n\r\n        if(item.components) {\r\n            let component_description = `<br><br><span class=\"item_component_list\">`;\r\n            const components = Object.keys(item.components);\r\n\r\n            if(item.components) {\r\n                component_description += `[${item_templates[item.components[components[0]]].name}]`;\r\n                if(!item.components[components[1]]) {\r\n                    component_description += `<br>+<br>no [${components[1]}]`;\r\n                } else {\r\n                    component_description += `<br>+<br>[${item_templates[item.components[components[1]]].name}]`;\r\n                }\r\n            }\r\n\r\n            component_description += `</span>`;\r\n            item_tooltip += component_description;\r\n        }\r\n\r\n        if(!options.skip_quality && options?.quality?.length == 2) {\r\n            if(item.getAttack) {\r\n                item_tooltip += \r\n                    `<br><br>Attack: ${Math.round(10*item.getAttack(options.quality[0]), true)/10} - ${Math.round(10*item.getAttack(options.quality[1], true))/10}`;\r\n            } else if(item.getDefense) { \r\n                item_tooltip += \r\n                `<br><br>Defense: ${Math.round(10*item.getDefense(options.quality[0]))/10} - ${Math.round(10*item.getDefense(options.quality[1]))/10}`;\r\n            } else if(item.offhand_type === \"shield\") {\r\n                if(item.tags.ignore_skill) {\r\n                    item_tooltip += \r\n                `<br><br>Can block up to: ${Math.round(10*item.getShieldStrength(options.quality[0]))/10} - ${Math.round(10*item.getShieldStrength(options.quality[1]))/10} damage [base: ${item.getShieldStrength(options.quality[0])}-${item.getShieldStrength(options.quality[1])}]`;\r\n                } else {\r\n                    item_tooltip += \r\n                `<br><br>Can block up to: ${Math.round(10*item.getShieldStrength(options.quality[0])*(character.stats.total_multiplier.block_strength))/10} - ${Math.round(10*item.getShieldStrength(options.quality[1])*(character.stats.total_multiplier.block_strength))/10} damage [base: ${item.getShieldStrength(options.quality[0])}-${item.getShieldStrength(options.quality[1])}]`;\r\n                }\r\n            }\r\n\r\n            const equip_stats_0 = item.getStats(options.quality[0]);\r\n            const equip_stats_1 = item.getStats(options.quality[1]);\r\n            if(Object.keys(equip_stats_0).length > 0) {\r\n                item_tooltip += `<br>`;\r\n            }\r\n            Object.keys(equip_stats_0).forEach(effect_key => {\r\n                if(equip_stats_0[effect_key].flat != null) {\r\n                    item_tooltip += \r\n                    `<br>${capitalize_first_letter(effect_key).replace(\"_\",\" \")}: +${equip_stats_0[effect_key].flat} - ${equip_stats_1[effect_key].flat}`;\r\n                }\r\n                if(equip_stats_0[effect_key].multiplier != null) {\r\n                    item_tooltip += \r\n                    `<br>${capitalize_first_letter(effect_key).replace(\"_\",\" \")}: x${equip_stats_0[effect_key].multiplier} - ${equip_stats_1[effect_key].multiplier}`;\r\n                }\r\n            });\r\n        } else {\r\n            if(item.getAttack) {\r\n                item_tooltip += \r\n                    `<br><br>Attack: ${Math.round(10*item.getAttack())/10}`;\r\n            } else if(item.getDefense) { \r\n                item_tooltip += \r\n                `<br><br>Defense: ${Math.round(10*item.getDefense())/10}`;\r\n            } else if(item.offhand_type === \"shield\") {\r\n                if(item.tags.ignore_skill) {\r\n                    item_tooltip += \r\n                `<br><br>Can block up to: ${Math.round(10*item.getShieldStrength())/10} damage [unaffected by skill]`;\r\n                } else {\r\n                    item_tooltip += \r\n                `<br><br>Can block up to: ${Math.round(10*item.getShieldStrength()*(character.stats.total_multiplier.block_strength))/10} damage [base: ${item.getShieldStrength()}]`;\r\n                }\r\n            }\r\n\r\n            const equip_stats = item.getStats();\r\n            if(Object.keys(equip_stats).length > 0) {\r\n                item_tooltip += `<br>`;\r\n            }\r\n            Object.keys(equip_stats).forEach(function(effect_key) {\r\n\r\n                if(equip_stats[effect_key].flat != null) {\r\n                    item_tooltip += \r\n                    `<br>${capitalize_first_letter(effect_key).replace(\"_\",\" \")}: +${equip_stats[effect_key].flat}`;\r\n                }\r\n                if(equip_stats[effect_key].multiplier != null) {\r\n                    item_tooltip += \r\n                    `<br>${capitalize_first_letter(effect_key).replace(\"_\",\" \")}: x${equip_stats[effect_key].multiplier}`;\r\n                }\r\n            });\r\n        }\r\n        const equip_bonus_skill_levels = item.getBonusSkillLevels();\r\n        if(Object.keys(equip_bonus_skill_levels).length > 0) {\r\n            item_tooltip += `<br>`;\r\n        }\r\n        Object.keys(equip_bonus_skill_levels).forEach(skill_key => {\r\n            if(skill_key.includes(\"category_\")) {\r\n                item_tooltip +=  `<br>${skill_key} skills level: +${equip_bonus_skill_levels[skill_key]}`;\r\n            } else {\r\n                item_tooltip +=  `<br>${skills[skill_key].name()} level: +${equip_bonus_skill_levels[skill_key]}`;\r\n            }\r\n        });\r\n\r\n        item_tooltip += \"<br>\";\r\n    } else if (item.item_type === \"USABLE\") {\r\n        item_tooltip += `<br>`;\r\n\r\n        if(item.effects.length > 0) {\r\n            item_tooltip += \"<br>Effects: \"\r\n        }\r\n        for(let i = 0; i < item.effects.length; i++) {\r\n            item_tooltip += create_effect_tooltip({effect_name: item.effects[i].effect, duration: item.effects[i].duration, add_bonus: true}).outerHTML;\r\n        }\r\n    } else if(item.item_type === \"BOOK\") {\r\n        if(!book_stats[item.name].is_finished) {\r\n            item_tooltip += `<br><br>Time to read: ${item.getRemainingTime()} minutes`;\r\n        }\r\n        else {\r\n            item_tooltip += `<br><br>Reading it provided ${character.name} with:`;\r\n            if(Object.keys(book_stats[item.name].bonuses).length > 0) {\r\n                item_tooltip += `<br>- ${format_book_bonuses(book_stats[item.name].bonuses)}`;\r\n            }\r\n            if(book_stats[item.name].rewards?.skills) {\r\n                if(book_stats[item.name].rewards.skills.length == 1) {\r\n                    item_tooltip += `<br>- a new skill`;\r\n                } else {\r\n                    item_tooltip += `<br>- new skills`;\r\n                }\r\n            }\r\n            if(book_stats[item.name].rewards?.recipes) {\r\n                if(book_stats[item.name].rewards.recipes.length == 1) {\r\n                    item_tooltip += `<br>- a new recipe`;\r\n                } else {\r\n                    item_tooltip += `<br>- new recipes`;\r\n                }\r\n            }\r\n        }\r\n        item_tooltip += \"<br>\";\r\n    } else if(item.tags.component) {\r\n        if(options?.quality && options.quality[0]) {\r\n            quality = options.quality[0];\r\n        }\r\n\r\n        if(!options.skip_quality && options?.quality?.length == 2) {\r\n            const outline_class_1 = rarity_outlines[item.getRarity(options.quality[0])];\r\n            const outline_class_2 = rarity_outlines[item.getRarity(options.quality[1])];\r\n            item_tooltip += `<br><br><b>Quality: <span class=\"${outline_class_1}\" style=\"color: ${rarity_colors[item.getRarity(options.quality[0])]}\"> ${options.quality[0]}% </span> - <span class=\"${outline_class_2}\" style=\"color: ${rarity_colors[item.getRarity(options.quality[1])]}\"> ${options.quality[1]}% </span>`;\r\n            item_tooltip += `<br>[<span class=\"${outline_class_1}\" style=\"color: ${rarity_colors[item.getRarity(options.quality[0])]}\"> ${item.getRarity(options.quality[0])}</span> - <span class=\"${outline_class_2}\" style=\"color: ${rarity_colors[item.getRarity(options.quality[1])]}\"> ${item.getRarity(options.quality[1])}</span>]</b>`;\r\n        } else {\r\n            const outline_class = rarity_outlines[item.getRarity(quality)];\r\n            item_tooltip += `<br><br><b class=\"${outline_class}\" style=\"color: ${rarity_colors[item.getRarity(quality)]}\">Quality: ${quality}% [${item.getRarity(quality)}]</b>`;\r\n        }\r\n        if(item.component_tier) {\r\n            item_tooltip += `<br><br>Component tier: ${item.component_tier}`;\r\n        }\r\n        if(Object.keys(item.component_stats).length > 0 || item?.attack_value !== 0 || item?.attack_multiplier !== 1 || item?.defense_value !== 0) {\r\n            item_tooltip += `<br><br>Basic stats: `;\r\n        }\r\n        if(item?.attack_value) {\r\n            item_tooltip += `<br>Attack power: +${item.attack_value}`;\r\n        }\r\n        if(item?.attack_multiplier && item.attack_multiplier !== 1) {\r\n            item_tooltip += `<br>Size-specific attack power: x${item.attack_multiplier}`;\r\n        }\r\n        if(item?.defense_value) {\r\n            item_tooltip += `<br>Defense: +${item.defense_value}`;\r\n        }\r\n\r\n        Object.keys(item.component_stats).forEach(function(effect_key) {\r\n            if(item.component_stats[effect_key].flat != null) {\r\n                item_tooltip += \r\n                `<br>${capitalize_first_letter(effect_key).replace(\"_\",\" \")}: +${item.component_stats[effect_key].flat}`;\r\n            }\r\n            if(item.component_stats[effect_key].multiplier != null) {\r\n                item_tooltip += \r\n                `<br>${capitalize_first_letter(effect_key).replace(\"_\",\" \")}: x${item.component_stats[effect_key].multiplier}`;\r\n            }\r\n        });\r\n        item_tooltip += \"<br>\";\r\n    } else {\r\n        item_tooltip += \"<br>\";\r\n    }\r\n    if(item.material_type) {\r\n        item_tooltip += `<br>Material type: ${item.material_type}<br>`;\r\n    }\r\n\r\n    if(!options.skip_quality && options?.quality?.length == 2) { \r\n        //ignore quality, instead use quality passed as param\r\n        item_tooltip += `<br>Value: ${format_money(\r\n            round_item_price(\r\n                item[value_function]({quality:options.quality[0], region:current_location?.market_region})))} - ${format_money(round_item_price(item.getBaseValue({quality:options.quality[1]})\r\n            ))}`;\r\n    } else {\r\n        item_tooltip += `<br>Value: ${format_money(round_item_price(item[value_function]({quality, region:current_location?.market_region, multiplier: ((options && options.trader) ? traders[current_trader].getProfitMargin(current_location.market_region) : 1)})))}`;\r\n        if(item.saturates_market) {\r\n            item_tooltip += ` [originally ${format_money(round_item_price(item.getBaseValue({quality, region:current_location?.market_region}) * ((options && options.trader) ? traders[current_trader].getProfitMargin(current_location.market_region) : 1) || 1))}]`\r\n        }\r\n    }\r\n\r\n    return item_tooltip;\r\n}\r\n\r\n/** \r\n * @param {Object} item_effect from item effects[]\r\n */\r\nfunction create_effect_tooltip({effect_name, duration, add_bonus=false}) {\r\n    const effect = effect_templates[effect_name];\r\n    const tooltip = document.createElement(\"div\");\r\n\r\n    tooltip.classList.add(\"active_effect_tooltip\");\r\n\r\n    const name_span = document.createElement(\"span\");\r\n    name_span.classList.add(\"active_effect_name\"); \r\n    name_span.innerHTML = `'${effect.name}' : `;\r\n    const duration_span = document.createElement(\"span\");\r\n    duration_span.classList.add(\"active_effect_duration\");\r\n    duration_span.innerText = \"\"+ format_time({time: {minutes: duration}});\r\n    const top_div = document.createElement(\"div\");\r\n    top_div.classList.add(\"active_effect_name_and_duration\");\r\n    top_div.appendChild(name_span);\r\n    top_div.appendChild(duration_span);\r\n    tooltip.appendChild(top_div);\r\n\r\n    if(effect.description) {\r\n        const description_p = document.createElement(\"div\");\r\n        description_p.classList.add(\"active_effect_description\");\r\n        description_p.innerText = effect.description;\r\n        tooltip.appendChild(description_p);\r\n    }\r\n\r\n    const effects_div = document.createElement(\"div\");\r\n\r\n    let effects;\r\n    if(add_bonus) {\r\n        effects = get_effect_with_bonuses(effect);\r\n    } else {\r\n        effects = effect.effects;\r\n    }\r\n\r\n    for(const [key, stat_value] of Object.entries(effects.stats)) {\r\n        tooltip.innerHTML += `<br>${capitalize_first_letter(stat_names[key])}`;\r\n        \r\n        let flat = false;\r\n        if(stat_value.flat) {\r\n            const sign = stat_value.flat > 0? \"+\":\"\";\r\n            tooltip.innerHTML += `: ${sign}${Math.round(100*stat_value.flat)/100}`;\r\n            flat = true;\r\n\r\n            \r\n        }\r\n        if(stat_value.multiplier) {\r\n            if(flat) {\r\n                tooltip.innerHTML += `, x${Math.round(100*stat_value.multiplier)/100}`;\r\n            } else {\r\n                tooltip.innerHTML += `: x${Math.round(100*stat_value.multiplier)/100}`;\r\n            }\r\n        }\r\n    }\r\n\r\n    \r\n    const xp_multipliers = Object.keys(effects.xp_multipliers);\r\n    if(xp_multipliers.length > 0) {\r\n        let name;\r\n        if(xp_multipliers[0] !== \"all\" && xp_multipliers[0] !== \"hero\" && xp_multipliers[0] !== \"all_skill\") {\r\n            name = skills[xp_multipliers[0]].name();\r\n        } else {\r\n            name = xp_multipliers[0].replace(\"_\",\" \");\r\n        }\r\n        name = capitalize_first_letter(name);\r\n        if(tooltip.innerHTML) {\r\n            tooltip.innerHTML += `<br>${name} xp gain: x${effects.xp_multipliers[xp_multipliers[0]]}`;\r\n        } else {\r\n            tooltip.innerHTML = `${name} xp gain: x${effects.xp_multipliers[xp_multipliers[0]]}`;\r\n        }\r\n        for(let i = 1; i < xp_multipliers.length; i++) {\r\n            let name;\r\n            if(xp_multipliers[i] !== \"all\" && xp_multipliers[i] !== \"hero\" && xp_multipliers[i] !== \"all_skill\") {\r\n                name = skills[xp_multipliers[i]].name();\r\n            } else {\r\n                name = xp_multipliers[i].replace(\"_\",\" \");\r\n            }\r\n            tooltip.innerHTML += `<br>${name} xp gain: x${effects.xp_multipliers[xp_multipliers[i]]}`;\r\n        }\r\n    }\r\n\r\n    tooltip.appendChild(effects_div);\r\n    return tooltip;\r\n}\r\n\r\nfunction end_activity_animation(remove) {\r\n    clearInterval(activity_anim);\r\n    const div = document.getElementById(\"action_status_div\");\r\n    if(remove && div) {\r\n        div.innerHTML = \"\";\r\n    }\r\n}\r\n\r\n/**\r\n * writes message to the message log\r\n * @param {String} message_to_add text to display\r\n * @param {String} message_type used for adding proper class to html element\r\n */\r\n function log_message(message_to_add, message_type) {\r\n    if(typeof message_to_add === 'undefined') {\r\n        return;\r\n    }\r\n\r\n    let message = document.createElement(\"div\");\r\n    message.classList.add(\"message_common\");\r\n\r\n    let class_to_add = \"message_default\";\r\n    let group_to_add = \"message_events\";\r\n\r\n    //selects proper class to add based on argument\r\n    switch(message_type) {\r\n        case \"enemy_defeated\":\r\n            class_to_add = \"message_victory\";\r\n            group_to_add = \"message_combat\";\r\n            message_count.message_combat += 1;\r\n            break;\r\n        case \"hero_defeat\":\r\n            class_to_add = \"message_hero_defeated\";\r\n            group_to_add = \"message_combat\";\r\n            message_count.message_combat += 1;\r\n            break;\r\n        case \"enemy_attacked\":\r\n            class_to_add = \"message_enemy_attacked\";\r\n            group_to_add = \"message_combat\";\r\n            message_count.message_combat += 1;\r\n            break;\r\n        case \"enemy_attacked_critically\":\r\n            class_to_add = \"message_enemy_attacked_critically\";\r\n            group_to_add = \"message_combat\";\r\n            message_count.message_combat += 1;\r\n            break;\r\n        case \"hero_attacked\":\r\n            class_to_add = \"message_hero_attacked\";\r\n            group_to_add = \"message_combat\";\r\n            message_count.message_combat += 1;\r\n            break;\r\n        case \"hero_missed\":\r\n            group_to_add = \"message_combat\";\r\n            message_count.message_combat += 1;\r\n            break;\r\n        case \"hero_blocked\":\r\n            group_to_add = \"message_combat\";\r\n            message_count.message_combat += 1;\r\n            break;    \r\n        case \"enemy_missed\":\r\n            group_to_add = \"message_combat\";\r\n            message_count.message_combat += 1;\r\n            break;    \r\n        case \"hero_attacked_critically\":\r\n            class_to_add = \"message_hero_attacked_critically\";\r\n            group_to_add = \"message_combat\";\r\n            message_count.message_combat += 1;\r\n            break;\r\n\r\n        case \"combat_loot\":\r\n            class_to_add = \"message_items_obtained\";\r\n            group_to_add = \"message_loot\";\r\n            message_count.message_loot += 1;\r\n            break;\r\n        case \"gathered_loot\":\r\n            class_to_add = \"message_items_obtained\";\r\n            group_to_add = \"message_loot\";\r\n            message_count.message_loot += 1;\r\n            break;\r\n        case \"total_gathered_loot\":\r\n            class_to_add = \"message_total_items_obtained\";\r\n            group_to_add = \"message_loot\";\r\n            message_count.message_loot += 1;\r\n            break;\r\n        case \"location_reward\":\r\n            group_to_add = \"message_loot\";\r\n            message_count.message_loot += 1;\r\n            break;\r\n\r\n        case \"skill_raised\":\r\n            class_to_add = \"message_skill_leveled_up\";\r\n            group_to_add = \"message_unlocks\";\r\n            message_count.message_unlocks += 1;\r\n            break;\r\n        case \"level_up\":\r\n            group_to_add = \"message_unlocks\";\r\n            message_count.message_unlocks += 1;\r\n            break;\r\n        case \"activity_unlocked\": \r\n            //currently uses default style class\r\n            group_to_add = \"message_unlocks\";\r\n            message_count.message_unlocks += 1;\r\n            break;\r\n        case \"location_unlocked\":\r\n            class_to_add = \"message_location_unlocked\";\r\n            group_to_add = \"message_unlocks\";\r\n            message_count.message_unlocks += 1;\r\n            break;\r\n        case \"dialogue_unlocked\":\r\n            group_to_add = \"message_unlocks\";\r\n            message_count.message_unlocks += 1;\r\n            break;\r\n\r\n        case \"message_travel\":\r\n            class_to_add = \"message_travel\";\r\n            group_to_add = \"message_events\";\r\n            message_count.message_events += 1;\r\n            break;\r\n        case \"export_reward\":\r\n            class_to_add = \"message_export_reward\";\r\n            group_to_add = \"message_events\";\r\n            message_count.message_events += 1;\r\n            break;\r\n        case \"activity_finished\":\r\n            group_to_add = \"message_events\";\r\n            message_count.message_events += 1;\r\n            break;\r\n        case \"activity_money\":\r\n            group_to_add = \"message_events\";\r\n            message_count.message_events += 1;\r\n            break;\r\n        case \"notification\":\r\n            message_count.message_events += 1;\r\n            group_to_add = \"message_events\";\r\n            class_to_add = \"message_notification\";\r\n            break;\r\n        case \"background\":\r\n            message_count.message_background +=1;\r\n            group_to_add = \"message_background\";\r\n            break;\r\n        case \"crafting\":\r\n            message_count.message_crafting +=1;\r\n            group_to_add = \"message_crafting\";\r\n            break;\r\n        case \"message_critical\":\r\n            message_count.message_events += 1;\r\n            group_to_add = \"message_events\";\r\n            class_to_add = \"message_critical\";\r\n            break;\r\n    }\r\n\r\n    if(group_to_add === \"message_combat\" && message_count.message_combat > 80\r\n    || group_to_add === \"message_loot\" && message_count.message_loot > 28\r\n    || group_to_add === \"message_unlocks\" && message_count.message_unlocks > 40\r\n    || group_to_add === \"message_events\" && message_count.message_events > 40\r\n    || group_to_add === \"message_background\" && message_count.message_background > 28\r\n    || group_to_add === \"message_crafting\" && message_count.message_crafting > 28\r\n    ) {\r\n        // find first child with specified group\r\n        // delete it\r\n        message_log.removeChild(message_log.getElementsByClassName(group_to_add)[0]);\r\n    }\r\n\r\n    message.classList.add(class_to_add, group_to_add);\r\n\r\n    message.innerHTML = message_to_add + \"<div class='message_border'> </>\";\r\n\r\n    message_log.appendChild(message);\r\n\r\n\r\n    const button_id = group_to_add.replace(\"_\",\"_show_\"); //not the best way but likelihood of the ids being changed is quite low\r\n    if(document.getElementById(button_id).classList.contains(\"active_selection_button\")) {\r\n        //scroll the message log but only if added message is in a not hidden category\r\n        message_log.scrollTop = message_log.scrollHeight;\r\n    }\r\n}\r\n\r\nfunction format_book_bonuses(bonuses) {\r\n    let formatted = '';\r\n    if(bonuses.stats) {\r\n        const stats = Object.keys(bonuses.stats);\r\n        \r\n        formatted = `+${bonuses.stats[stats[0]]} ${stat_names[stats[0]]}`;\r\n        for(let i = 1; i < stats.length; i++) {\r\n            formatted += `, +${bonuses.stats[stats[i]]} ${stat_names[stats[i]]}`;\r\n        }\r\n    }\r\n\r\n    if(bonuses.multipliers) {\r\n        const multipliers = Object.keys(bonuses.multipliers);\r\n        if(formatted) {\r\n            formatted += `, x${bonuses.multipliers[multipliers[0]]} ${stat_names[multipliers[0]]}`;\r\n        } else {\r\n            formatted = `x${bonuses.multipliers[multipliers[0]]} ${stat_names[multipliers[0]]}`;\r\n        }\r\n\r\n        for(let i = 1; i < multipliers.length; i++) {\r\n            formatted += `, x${bonuses.multipliers[multipliers[i]]} ${stat_names[multipliers[i]]}`;\r\n        }\r\n    }\r\n    if(bonuses.xp_multipliers) {\r\n        const xp_multipliers = Object.keys(bonuses.xp_multipliers);\r\n        let name;\r\n        if(xp_multipliers[0] !== \"all\" && xp_multipliers[0] !== \"hero\" && xp_multipliers[0] !== \"all_skill\") {\r\n            name = skills[xp_multipliers[0]].name();\r\n        } else {\r\n            name = xp_multipliers[0].replace(\"_\",\" \");\r\n        }\r\n\r\n        if(formatted) {\r\n            formatted += `, x${bonuses.xp_multipliers[xp_multipliers[0]]} ${name} xp gain`;\r\n        } else {\r\n            formatted = `x${bonuses.xp_multipliers[xp_multipliers[0]]} ${name} xp gain`;\r\n        }\r\n        for(let i = 1; i < xp_multipliers.length; i++) {\r\n            let name;\r\n            if(xp_multipliers[i] !== \"all\" && xp_multipliers[i] !== \"hero\" && xp_multipliers[i] !== \"all_skill\") {\r\n                name = skills[xp_multipliers[i]].name();\r\n            } else {\r\n                name = xp_multipliers[i].replace(\"_\",\" \");\r\n            }\r\n            formatted += `, x${bonuses.xp_multipliers[xp_multipliers[i]]} ${name} xp gain`;\r\n        }\r\n    }\r\n\r\n    return formatted;\r\n}\r\n\r\nfunction clear_message_log() {\r\n    while(message_log.firstChild) {\r\n        message_log.removeChild(message_log.lastChild);\r\n    }\r\n}\r\n\r\n/**\r\n * @param {Array} loot_list [{item, count},...] \r\n */\r\nfunction log_loot({loot_list, is_combat=false, is_a_summary=false}) {\r\n    \r\n    if(loot_list.length == 0) {\r\n        return;\r\n    }\r\n\r\n    let item;\r\n    if(loot_list[0].item_id) {\r\n        item = item_templates[loot_list[0].item_id];\r\n    } else if(loot_list[0].item_key) {\r\n        item = getItemFromKey(loot_list[0].item_key);\r\n    }\r\n\r\n    let message;\r\n    let message_type;\r\n    if(is_combat) {\r\n        message_type = \"combat_loot\";\r\n        message = 'Looted \"';\r\n    } else if(is_a_summary) {\r\n        message_type = \"total_gathered_loot\";\r\n        message = 'Gained in total: \"';\r\n    } else {\r\n        message_type = \"gathered_loot\";\r\n        message = 'Gained \"';\r\n    }\r\n\r\n    message += item.getName() + `\" x` + loot_list[0][\"count\"];\r\n\r\n    if(loot_list.length > 1) {\r\n        for(let i = 1; i < loot_list.length; i++) {\r\n            if(loot_list[i].item_id) {\r\n                item = item_templates[loot_list[i].item_id];\r\n            } else if(loot_list[i].item_key) {\r\n                item = getItemFromKey(loot_list[i].item_key);\r\n            }\r\n            message += (`, \"` + item.getName() + `\" x` + loot_list[i][\"count\"]);\r\n        }\r\n    }\r\n\r\n    log_message(message, message_type);\r\n}\r\n\r\n/**\r\n * Originally created for activities, despite the name, but is now used for actions as well.\r\n * @param {Object} settings \r\n */\r\nfunction start_activity_animation(settings) {\r\n    end_activity_animation();\r\n    activity_anim = setInterval(() => { //sets a tiny little \"animation\" for activity text\r\n        const action_status_div = document.getElementById(\"action_status_div\");\r\n        let end = \"\";\r\n        if(action_status_div.innerHTML.endsWith(\"...\")) {\r\n            end = \"...\";\r\n        } else if(action_status_div.innerHTML.endsWith(\"..\")) {\r\n            end = \"..\";\r\n        } else if(action_status_div.innerHTML.endsWith(\".\"))\r\n            end = \".\";\r\n\r\n        if(settings?.book_title) {\r\n            action_status_div.innerHTML = action_status_div.innerHTML.split(\",\")[0] + `, ${format_reading_time(item_templates[settings.book_title].getRemainingTime())} left`;\r\n            action_status_div.innerHTML += end;\r\n        }\r\n\r\n        if(end.length < 3){\r\n            action_status_div.innerHTML += \".\";\r\n        } else {\r\n            action_status_div.innerHTML = action_status_div.innerHTML.substring(0, action_status_div.innerHTML.length - 3);\r\n        }\r\n     }, 600);\r\n}\r\n\r\nfunction update_displayed_trader() {\r\n    action_div.style.display = \"none\";\r\n    trade_div.style.display = \"inherit\";\r\n    document.getElementById(\"trader_cost_mult_value\").textContent = `${Math.round(100 * (traders[current_trader].getProfitMargin(current_location.market_region)))}%`\r\n    update_displayed_trader_inventory();\r\n}\r\n\r\nfunction update_displayed_storage() {\r\n    action_div.style.display = \"none\";\r\n    storage_div.style.display = \"inherit\";\r\n    update_displayed_storage_inventory();\r\n}\r\n\r\nfunction update_displayed_money() {\r\n    document.getElementById(\"money_div\").innerHTML = `Your purse contains: ${format_money(character.money)}`;\r\n}\r\n\r\nfunction update_displayed_total_price(total_price) {\r\n    document.getElementById(\"trade_price_value\").innerHTML = format_money(total_price);\r\n}\r\n\r\n/**\r\n * \r\n * @returns {HTMLElement}\r\n */\r\nfunction create_trade_buttons() {\r\n\r\n    const trade_buttons = document.createElement(\"div\");\r\n    trade_buttons.classList.add(\"trade_ammount_buttons\");\r\n\r\n    const trade_button_5 = document.createElement(\"div\");\r\n    trade_button_5.classList.add(\"trade_ammount_button\");\r\n    trade_button_5.innerText = \"5\";\r\n    trade_button_5.setAttribute(\"data-trade_ammount\", 5);\r\n    trade_buttons.appendChild(trade_button_5);\r\n\r\n    const trade_button_10 = document.createElement(\"div\");\r\n    trade_button_10.classList.add(\"trade_ammount_button\");\r\n    trade_button_10.innerText = \"10\";\r\n    trade_button_10.setAttribute(\"data-trade_ammount\", 10);\r\n    trade_buttons.appendChild(trade_button_10);\r\n\r\n    const trade_button_max = document.createElement(\"div\");\r\n    trade_button_max.classList.add(\"trade_ammount_button\");\r\n    trade_button_max.innerText = \"all\";\r\n    trade_button_max.setAttribute(\"data-trade_ammount\", Infinity);\r\n    trade_buttons.appendChild(trade_button_max);\r\n    \r\n    return trade_buttons;\r\n}\r\n\r\nfunction sort_displayed_inventory({sort_by, target = \"character\", change_direction = false}) {\r\n    let plus;\r\n    let minus;\r\n    if(target === \"trader\") {\r\n        if(sort_by){\r\n            if(change_direction) {\r\n                if(sort_by === trader_inventory_sorting) {\r\n                    if(trader_inventory_sorting_direction === \"asc\") {\r\n                        trader_inventory_sorting_direction = \"desc\";\r\n                    } else {\r\n                        trader_inventory_sorting_direction = \"asc\";\r\n                    }\r\n                } else {\r\n                    if(sort_by === \"price\") {\r\n                        trader_inventory_sorting_direction = \"desc\";\r\n                    } else {\r\n                        trader_inventory_sorting_direction = \"asc\";\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            sort_by = trader_inventory_sorting;\r\n        }\r\n\r\n        target = trader_inventory_div;\r\n        plus = trader_inventory_sorting_direction===\"asc\"?1:-1;\r\n        minus = trader_inventory_sorting_direction===\"asc\"?-1:1;\r\n        trader_inventory_sorting = sort_by || \"name\";\r\n\r\n    } else if(target === \"character\") {\r\n        if(sort_by) {\r\n            if(change_direction){\r\n                if(sort_by === character_inventory_sorting) {\r\n                    if(character_inventory_sorting_direction === \"asc\") {\r\n                        character_inventory_sorting_direction = \"desc\";\r\n                    } else {\r\n                        character_inventory_sorting_direction = \"asc\";\r\n                    }\r\n                } else {\r\n                    if(sort_by === \"price\") {\r\n                        character_inventory_sorting_direction = \"desc\";\r\n                    } else {\r\n                        character_inventory_sorting_direction = \"asc\";\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            sort_by = character_inventory_sorting;\r\n        }\r\n        target = inventory_div;\r\n        plus = character_inventory_sorting_direction===\"asc\"?1:-1;\r\n        minus = character_inventory_sorting_direction===\"asc\"?-1:1;\r\n        character_inventory_sorting = sort_by || \"name\";\r\n    } else if(target === \"storage\"){\r\n        if(sort_by) {\r\n            if(change_direction){\r\n                if(sort_by === storage_sorting) {\r\n                    if(storage_sorting_direction === \"asc\") {\r\n                        storage_sorting_direction = \"desc\";\r\n                    } else {\r\n                        storage_sorting_direction = \"asc\";\r\n                    }\r\n                } else {\r\n                    if(sort_by === \"price\") {\r\n                        storage_sorting_direction = \"desc\";\r\n                    } else {\r\n                        storage_sorting_direction = \"asc\";\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            sort_by = storage_sorting;\r\n        }\r\n\r\n        target = storage_inventory_div;\r\n        plus = storage_sorting_direction===\"asc\"?1:-1;\r\n        minus = storage_sorting_direction===\"asc\"?-1:1;\r\n        storage_sorting = sort_by || \"name\";\r\n    } else {\r\n        console.warn(`Something went wrong, no such inventory as '${target}'`);\r\n        return;\r\n    }\r\n\r\n    [...target.children].sort((a,b) => {\r\n        //equipped items on top\r\n        if(a.classList.contains(\"equipped_item_control\") && !b.classList.contains(\"equipped_item_control\")) {\r\n            return -1;\r\n        } else if(!a.classList.contains(\"equipped_item_control\") && b.classList.contains(\"equipped_item_control\")){\r\n            return 1;\r\n        } \r\n\r\n        //traded items on bottom\r\n        if(a.classList.contains(\"item_to_trade\") && !b.classList.contains(\"item_to_trade\")) {\r\n            return 1;\r\n        } else if(!a.classList.contains(\"item_to_trade\") && b.classList.contains(\"item_to_trade\")) {\r\n            return -1;\r\n        }\r\n\r\n        //equippables below non-equippables\r\n        if(a.classList.contains(\"character_item_equippable\") && !b.classList.contains(\"character_item_equippable\")) {\r\n            return 1;\r\n        } else if(!a.classList.contains(\"character_item_equippable\") && b.classList.contains(\"character_item_equippable\")){\r\n            return -1;\r\n        } \r\n        if(a.classList.contains(\"trader_item_equippable\") && !b.classList.contains(\"trader_item_equippable\")) {\r\n            return 1;\r\n        } else if(!a.classList.contains(\"trader_item_equippable\") && b.classList.contains(\"trader_item_equippable\")){\r\n            return -1;\r\n        } \r\n        if(a.classList.contains(\"storage_item_equippable\") && !b.classList.contains(\"storage_item_equippable\")) {\r\n            return 1;\r\n        } else if(!a.classList.contains(\"storage_item_equippable\") && b.classList.contains(\"storage_item_equippable\")){\r\n            return -1;\r\n        } \r\n\r\n        //components below non-components\r\n        if(a.children[0].children[0].children[0].innerText === \"[Comp]\" && b.children[0].children[0].children[0].innerText !== \"[Comp]\") {\r\n            return 1;\r\n        } else if(a.children[0].children[0].children[0].innerText !== \"[Comp]\" && b.children[0].children[0].children[0].innerText === \"[Comp]\") {\r\n            return -1;\r\n        }\r\n\r\n        //books below non-books\r\n        if(a.children[0].children[0].children[0].innerText === \"[Book]\" && b.children[0].children[0].children[0].innerText !== \"[Book]\") {\r\n            return 1;\r\n        } else if(a.children[0].children[0].children[0].innerText !== \"[Book]\" && b.children[0].children[0].children[0].innerText === \"[Book]\") {\r\n            return -1;\r\n        }\r\n\r\n\r\n        const slot_a = a.dataset.item_slot;\r\n        const slot_b = b.dataset.item_slot;\r\n        /*\r\n        //tools above non-tools\r\n        if(!tool_slots.includes(slot_a) && tool_slots.includes(slot_b)) {\r\n            return 1;\r\n        } else if(tool_slots.includes(slot_a) && !tool_slots.includes(slot_b)){\r\n            return -1;\r\n        }\r\n        */\r\n        \r\n        //other items by properties, name or otherwise by value\r\n        if(sort_by === \"type\") {\r\n            //slot\r\n            \r\n            if(slot_a != slot_b) { \r\n                return Object.keys(equipment_slots_divs).indexOf(a.dataset.item_slot) - Object.keys(equipment_slots_divs).indexOf(b.dataset.item_slot);\r\n            }\r\n\r\n            //usable\r\n            if (a.classList.contains(\"character_item_usable\") != b.classList.contains(\"character_item_usable\")) {\r\n                return b.classList.contains(\"character_item_usable\") - a.classList.contains(\"character_item_usable\");\r\n            }\r\n            if (a.classList.contains(\"trader_item_usable\") != b.classList.contains(\"trader_item_usable\")) {\r\n                return b.classList.contains(\"trader_item_usable\") - a.classList.contains(\"trader_item_usable\");\r\n            }\r\n            if (a.classList.contains(\"storage_item_usable\") != b.classList.contains(\"storage_item_usable\")) {\r\n                return b.classList.contains(\"storage_item_usable\") - a.classList.contains(\"storage_item_usable\");\r\n            }\r\n\r\n            let item_template_a = null;\r\n            let item_template_b = null;\r\n\r\n            if (target === inventory_div) {\r\n                item_template_a = item_templates[JSON.parse(a.dataset.character_item).id];\r\n                item_template_b = item_templates[JSON.parse(b.dataset.character_item).id];\r\n            }\r\n            else if (target === trader_inventory_div) {\r\n                item_template_a = item_templates[JSON.parse(a.dataset.trader_item).id];\r\n                item_template_b = item_templates[JSON.parse(b.dataset.trader_item).id];\r\n            }\r\n            else if (target === storage_inventory_div) {\r\n                item_template_a = item_templates[JSON.parse(a.dataset.storage_item).id];\r\n                item_template_b = item_templates[JSON.parse(b.dataset.storage_item).id];\r\n            }\r\n\r\n            if (item_template_a && item_template_b) {\r\n                if (item_template_a.material_type != item_template_b.material_type) { \r\n                    return item_template_a.material_type > item_template_b.material_type ? plus : minus;\r\n                }\r\n                if (item_template_a.component_type != item_template_b.component_type) { \r\n                    return item_template_a.component_type > item_template_b.component_types ? plus : minus;\r\n                }\r\n                if (item_template_a.component_tier != item_template_b.component_tier) { \r\n                    return item_template_a.component_tier > item_template_b.component_tier ? plus : minus;\r\n                }\r\n            }\r\n\r\n            //...otherwise, fall back to sorting by name\r\n        }\r\n\r\n        if(sort_by === \"name\" || sort_by === \"type\") {\r\n\r\n            const name_a = a.children[0].children[1].children[1].innerText.toLowerCase().replaceAll('\"',\"\");\r\n            const name_b = b.children[0].children[1].children[1].innerText.toLowerCase().replaceAll('\"',\"\");\r\n            if(name_a > name_b) {\r\n                return plus;\r\n            } else if(name_a < name_b) {\r\n                return minus;\r\n            } else {\r\n                //if same name, sort based on quality \r\n                //works similar to sorting by value but is more precise\r\n                //(shouldn't be possible to reach this for quality-less items)\r\n                let value_a = Number.parseInt(a.dataset.item_quality);\r\n                let value_b = Number.parseInt(b.dataset.item_quality);\r\n                \r\n                if(value_a > value_b) {\r\n                    return plus;\r\n                } else {\r\n                    return minus;\r\n                }\r\n            }\r\n\r\n        } else if(sort_by === \"price\") {\r\n            \r\n            let value_a = Number.parseInt(a.getAttribute(`data-item_value`));\r\n            let value_b = Number.parseInt(b.getAttribute(`data-item_value`));\r\n      \r\n            if(value_a > value_b) {\r\n                return plus;\r\n            } else {\r\n                if(value_a === value_b && \"item_quality\" in a.dataset && \"item_quality\" in b.dataset) {\r\n                    if(Number.parseInt(a.dataset.item_quality) > Number.parseInt( b.dataset.item_quality)) {\r\n                        return plus;\r\n                    } else {\r\n                        return minus;\r\n                    }\r\n                }\r\n                return minus;\r\n            }\r\n        }\r\n\r\n    }).forEach(node => target.appendChild(node));\r\n}\r\n\r\nfunction update_displayed_trader_inventory({item_key, trader_sorting=\"name\", sorting_direction=\"asc\", was_anything_new_added=false} = {}) {\r\n    const trader = traders[current_trader];\r\n\r\n    //removal of unneeded divs\r\n    if(!item_key){\r\n        Object.keys(trader_item_divs).forEach(div_key => {\r\n            if(!trader.inventory[div_key]) {\r\n                trader_item_divs[div_key].remove();\r\n                delete trader_item_divs[div_key];\r\n            }\r\n        });\r\n        Object.keys(item_selling_divs).forEach(div_key => {\r\n            if(to_sell.items.filter(x => x.item_key === div_key).length === 0){\r\n                //not in trade list - remove\r\n                item_selling_divs[div_key].remove();\r\n                delete item_selling_divs[div_key];\r\n            }\r\n        });\r\n    }\r\n\r\n    //creation of missing divs and updating of others\r\n\r\n    if(item_key) {\r\n        //key passed -> deal only with this singular item\r\n        const item_count = trader.inventory[item_key].count;\r\n\r\n        was_anything_new_added = trader_item_divs[item_key];\r\n        const item_div = create_inventory_item_div({key: item_key, item_count, target: \"trader\", is_trade: true});\r\n\r\n        if(trader_item_divs[item_key]) {\r\n            trader_item_divs[item_key].replaceWith(item_div);\r\n            trader_item_divs[item_key] = item_div;\r\n        } else {\r\n            trader_item_divs[item_key] = item_div;\r\n            trader_inventory_div.appendChild(item_div);\r\n        }\r\n    } else {\r\n        //no key passed - go through all items\r\n\r\n        //go through inventory items\r\n        Object.keys(trader.inventory).forEach(inventory_key => {\r\n            let item_count = trader.inventory[inventory_key].count;\r\n\r\n            //find if item is in to_sell, if so then grab the count and subtract it\r\n            for(let i = 0; i < to_buy.items.length; i++) {\r\n                if(inventory_key === to_buy.items[i].item_key) {\r\n                    item_count -= Number(to_buy.items[i].count);\r\n\r\n                    if(item_count == 0) {\r\n                        trader_item_divs[inventory_key]?.remove();\r\n                        delete trader_item_divs[inventory_key];\r\n                        return;\r\n                    }\r\n                    if(item_count < 0) {\r\n                        //shouldn't be possible to reach but who knows\r\n                        throw new Error('Something is wrong with trader item count');\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if(!trader_item_divs[inventory_key]) {\r\n                //item is not present in display, create a new one\r\n                trader_item_divs[inventory_key] = create_inventory_item_div({key: inventory_key, item_count, target: \"trader\", is_trade: true});\r\n                trader_inventory_div.appendChild(trader_item_divs[inventory_key]);\r\n                was_anything_new_added = true;\r\n            } else {\r\n                //item is present\r\n                \r\n                //grab the displayed count\r\n                let div_count = Number.parseInt(trader_item_divs[inventory_key].getElementsByClassName(\"item_count\")[0].innerText.replace(\"x\",\"\"));\r\n                if(Number.isNaN(div_count)) {\r\n                    div_count = 0;\r\n                }\r\n                //compare displayed count with actual count, update display to proper value if they differ\r\n                if(div_count != item_count) {\r\n                    if(item_count > 1) {\r\n                        trader_item_divs[inventory_key].getElementsByClassName(\"item_count\")[0].innerText = ` x${item_count}`;\r\n                    } else {\r\n                        trader_item_divs[inventory_key].getElementsByClassName(\"item_count\")[0].innerText = ``;\r\n                    }\r\n                }\r\n\r\n                //overwrite tooltip (for displayed prices)\r\n                const tooltip_div = trader_item_divs[inventory_key].querySelector(\".item_tooltip\");\r\n                tooltip_div.replaceWith(create_item_tooltip(trader.inventory[inventory_key].item, {trader: true}, true));\r\n\r\n                const price_span = trader_item_divs[inventory_key].getElementsByClassName(\"item_value\")[0];\r\n                price_span.innerHTML =  `${format_money(round_item_price(trader.inventory[inventory_key].item.getValue({region: current_location.market_region, multiplier: (traders[current_trader].getProfitMargin(current_location.market_region) || 1)})), true)}`;\r\n            }\r\n        });\r\n\r\n        //go through to_sell items\r\n        for(let i = 0; i < to_sell.items.length; i++) {\r\n            const key = to_sell.items[i].item_key;\r\n            if(!item_selling_divs[key]) {\r\n                //item not present - add to display\r\n                item_selling_divs[key] = create_inventory_item_div({target: \"trader\", trade_index: i, is_trade: true});\r\n                trader_inventory_div.appendChild(item_selling_divs[key]);\r\n            } else {\r\n                //verify and update count\r\n                \r\n                let div_count = trader_item_divs[key]?.dataset.item_count ?? 0;\r\n\r\n                let item_count = to_sell.items[i].count;\r\n                if(div_count !== item_count) {\r\n                    if(item_count > 1) {\r\n                        item_selling_divs[key].getElementsByClassName(\"item_count\")[0].innerText = ` x${item_count}`;\r\n                    } else {\r\n                        item_selling_divs[key].getElementsByClassName(\"item_count\")[0].innerText = ``;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    if(was_anything_new_added) {\r\n        sort_displayed_inventory({target: \"trader\", sort_by: trader_sorting, direction: sorting_direction});\r\n    }\r\n}\r\n\r\n/**\r\n * updates displayed inventory of the character (only inventory, worn equipment is managed by separate method)\r\n * \r\n * if item_key/equip_slot is passed, it will instead only update the display of that one item\r\n * \r\n */\r\nfunction update_displayed_character_inventory({item_key, equip_slot, character_sorting, sorting_direction=\"asc\", was_anything_new_added=false, is_trade=false, skip_sorting=false} = {}) {    \r\n    //removal of unneeded divs\r\n    if(!item_key){\r\n        Object.keys(item_divs).forEach(div_key => {\r\n            if(item_divs[div_key].classList.contains(\"equipped_item_control\")) {\r\n                //since equipment is keyed with slots and not item_keys, there might be something different under it, so needs additional check\r\n                //div_key is the slot\r\n                const item_key = item_divs[div_key].dataset.character_item;\r\n                if(!character.equipment[div_key] || item_key !== character.equipment[div_key].getInventoryKey()) {\r\n                    //character has nothing in this slot - remove\r\n                    //character has something else in this slot - remove, will be recreated later\r\n                    item_divs[div_key].remove();\r\n                    delete item_divs[div_key];\r\n                }\r\n            } else {\r\n                if(!character.inventory[div_key]) {\r\n                    item_divs[div_key].remove();\r\n                    delete item_divs[div_key];\r\n                }\r\n            }\r\n        });\r\n\r\n        Object.keys(item_buying_divs).forEach(div_key => {\r\n            if(to_buy.items.filter(x => x.item_key === div_key).length === 0){\r\n                //not in trade list - remove\r\n                item_buying_divs[div_key].remove();\r\n                delete item_buying_divs[div_key];\r\n            }\r\n        });\r\n    }\r\n\r\n    //creation of missing divs and updating of others\r\n    if(item_key) {\r\n        //specific item to be updated\r\n        const item_count = character.inventory[item_key].count;\r\n\r\n        was_anything_new_added = trader_item_divs[item_key];\r\n        const item_div = create_inventory_item_div({key: item_key, item_count, target: \"character\", is_trade: true});\r\n\r\n        if(item_divs[item_key]) {\r\n            item_divs[item_key].replaceWith(item_div);\r\n            item_divs[item_key] = item_div;\r\n        } else {\r\n            item_divs[item_key] = item_div;\r\n            inventory_div.appendChild(item_div);\r\n        }\r\n    } else if(equip_slot){\r\n        //equipped item\r\n        item_divs[equip_slot] = create_inventory_item_div({key: equip_slot, target: \"character\", is_equipped: true, is_trade});\r\n    } else {\r\n        //inventory items\r\n        Object.keys(character.inventory).forEach(inventory_key => {\r\n            let item_count = character.inventory[inventory_key].count;\r\n\r\n            //find if item is in to_sell, if so then grab the count and subtract it\r\n            for(let i = 0; i < to_sell.items.length; i++) {\r\n                if(inventory_key === to_sell.items[i].item_key) {\r\n                    item_count -= Number(to_sell.items[i].count);\r\n\r\n                    if(item_count == 0) {\r\n                        item_divs[inventory_key]?.remove();\r\n                        delete item_divs[inventory_key];\r\n                        return;\r\n                    }\r\n                    if(item_count < 0) {\r\n                        //shouldn't be possible to reach but who knows\r\n                        throw new Error('Something is wrong with character item count');\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if(!item_divs[inventory_key]) {\r\n                //not in display, add it\r\n                item_divs[inventory_key] = create_inventory_item_div({key: inventory_key, item_count, target: \"character\", is_trade});\r\n                inventory_div.appendChild(item_divs[inventory_key]);\r\n                was_anything_new_added = true;\r\n            } else {\r\n                //in display, just update it\r\n                let div_count = Number.parseInt(item_divs[inventory_key].getElementsByClassName(\"item_count\")[0].innerText.replace(\"x\",\"\"));\r\n                if(Number.isNaN(div_count)) {\r\n                    div_count = 0;\r\n                }\r\n                if(div_count != item_count) {\r\n                    if(item_count > 1) {\r\n                        item_divs[inventory_key].getElementsByClassName(\"item_count\")[0].innerText = ` x${item_count}`;\r\n                    } else {\r\n                        item_divs[inventory_key].getElementsByClassName(\"item_count\")[0].innerText = ``;\r\n                    }\r\n                }\r\n\r\n                //overwrite tooltip (for displayed prices)\r\n                const tooltip_div = item_divs[inventory_key].querySelector(\".item_tooltip\");\r\n                tooltip_div.replaceWith(create_item_tooltip(character.inventory[inventory_key].item, {}, is_trade));\r\n\r\n                //grab and update price div, do it for all as trading can affect prices of multiple items\r\n                if(!character.inventory[inventory_key].item.tags.unsellable) {\r\n                    const price_span = item_divs[inventory_key].getElementsByClassName(\"item_value\")[0];\r\n                    if(is_trade) {\r\n                        price_span.innerHTML =  `${format_money(round_item_price(character.inventory[inventory_key].item.getValue({region: current_location.market_region})), true)}`;\r\n                    } else {\r\n                        price_span.innerHTML =  `${format_money(round_item_price(character.inventory[inventory_key].item.getBaseValue()), true)}`;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        Object.keys(character.equipment).forEach(eq_slot => {\r\n            if(!item_divs[eq_slot]) {\r\n                if(character.equipment[eq_slot]) {\r\n                    if(character.equipment[eq_slot]?.tags.tool) {\r\n                        //don't display the equipped tools\r\n                        return;\r\n                    }\r\n    \r\n                    item_divs[eq_slot] = create_inventory_item_div({key: eq_slot, target: \"character\", is_equipped: true,is_trade});\r\n                    inventory_div.appendChild(item_divs[eq_slot]);\r\n                    was_anything_new_added = true;\r\n                }\r\n            }\r\n        });\r\n\r\n        for(let i = 0; i < to_buy.items.length; i++) {\r\n            const key = to_buy.items[i].item_key;\r\n            if(!item_buying_divs[key]) {\r\n                item_buying_divs[key] = create_inventory_item_div({target: \"character\", trade_index: i,is_trade});\r\n                inventory_div.appendChild(item_buying_divs[key]);\r\n            } else {\r\n                //verify and update count\r\n                \r\n                let div_count = item_divs[key]?.dataset.item_count ?? 0;\r\n\r\n                let item_count = to_buy.items[i].count;\r\n                if(div_count !== item_count) {\r\n                    if(item_count > 1) {\r\n                        item_buying_divs[key].getElementsByClassName(\"item_count\")[0].innerText = ` x${item_count}`;\r\n                    } else {\r\n                        item_buying_divs[key].getElementsByClassName(\"item_count\")[0].innerText = ``;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    if(was_anything_new_added && !skip_sorting) {\r\n        sort_displayed_inventory({target: \"character\", sort_by: character_sorting, direction: sorting_direction});\r\n    }\r\n}\r\n\r\nfunction update_displayed_storage_inventory({item_key, storage_sorting=\"name\", sorting_direction=\"asc\", was_anything_new_added=false} = {}) {\r\n\r\n    //removal of unneeded divs\r\n    if(!item_key){\r\n        Object.keys(storage_item_divs).forEach(div_key => {\r\n            if(!player_storage.inventory[div_key]) {\r\n                storage_item_divs[div_key].remove();\r\n                delete storage_item_divs[div_key];\r\n            }\r\n        });\r\n    }\r\n\r\n    //creation of missing divs and updating of others\r\n    if(item_key) {\r\n        const item_count = player_storage.inventory[item_key].count;\r\n        storage_item_divs[item_key].remove();\r\n        delete storage_item_divs[item_key];\r\n        storage_item_divs[item_key] = create_inventory_item_div({key: item_key, item_count, target: \"storage\"});\r\n        storage_inventory_div.appendChild(storage_item_divs[item_key]);\r\n        was_anything_new_added = true;\r\n    } else {\r\n        Object.keys(player_storage.inventory).forEach(inventory_key => {\r\n            let item_count = player_storage.inventory[inventory_key].count;\r\n\r\n\r\n            if(!storage_item_divs[inventory_key]) {\r\n                //not in display, add it\r\n                storage_item_divs[inventory_key] = create_inventory_item_div({key: inventory_key, item_count, target: \"storage\"});\r\n                storage_inventory_div.appendChild(storage_item_divs[inventory_key]);\r\n                was_anything_new_added = true;\r\n            } else {\r\n                //in display, just update it\r\n                let div_count = Number.parseInt(storage_item_divs[inventory_key].getElementsByClassName(\"item_count\")[0].innerText.replace(\"x\",\"\"));\r\n                if(Number.isNaN(div_count)) {\r\n                    div_count = 0;\r\n                }\r\n                if(div_count != item_count) {\r\n                    if(item_count > 1) {\r\n                        storage_item_divs[inventory_key].getElementsByClassName(\"item_count\")[0].innerText = ` x${item_count}`;\r\n                    } else {\r\n                        storage_item_divs[inventory_key].getElementsByClassName(\"item_count\")[0].innerText = ``;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n    }\r\n    \r\n    if(!item_key && was_anything_new_added) {\r\n        sort_displayed_inventory({target: \"storage\", sort_by: storage_sorting, direction: sorting_direction});\r\n    }\r\n}\r\n\r\nfunction exit_displayed_storage() {\r\n    action_div.style.display = \"\";\r\n    storage_div.style.display = \"none\";\r\n}\r\n\r\n/**\r\n * creates a single item div for hero/trader, used to fill displayed inventories\r\n * @param {Object} params\r\n * @param {String} params.key \r\n * @param {Number} params.item_count\r\n * @param {String} params.target character/trader/storage\r\n * @param {Boolean} params.is_equipped\r\n * @param {Number} params.trade_index index in to_buy/to_sell\r\n * @returns \r\n */\r\nfunction create_inventory_item_div({key, item_count, target, is_equipped, trade_index, is_trade = false}) {\r\n\r\n    const item_control_div = document.createElement(\"div\");\r\n    const item_div = document.createElement(\"div\");\r\n    const item_name_div = document.createElement(\"div\");\r\n    const item_additional = document.createElement(\"div\");\r\n    item_additional.classList.add(\"item_additional_content\");\r\n\r\n    let target_item;\r\n    let target_class_name;\r\n    let item_class;\r\n    let options = {};\r\n    let price_multiplier = 1;\r\n    if(target === \"trader\") {\r\n        options.trader = true;\r\n        price_multiplier = traders[current_trader].getProfitMargin(current_location.market_region) || price_multiplier;\r\n    } else if(target === \"storage\") {\r\n        options.storage = true;\r\n    }\r\n\r\n    if(is_equipped) {\r\n        target_item = character.equipment[key];\r\n        item_count = item_count ?? 1;\r\n        item_class = \"equipped_item\";\r\n        target_class_name = \"character_item\";\r\n    } else {\r\n        item_class = \"inventory_item\";\r\n        if(target === \"character\") {\r\n            if(typeof trade_index === \"undefined\") {\r\n                target_item = character.inventory[key].item;\r\n                item_count = item_count || character.inventory[key].count;\r\n            } else {\r\n                target_item = traders[current_trader].inventory[to_buy.items[trade_index].item_key].item;\r\n                item_count = item_count || to_buy.items[trade_index].count;\r\n            }\r\n            target_class_name = \"character_item\";\r\n        } else if(target === \"trader\") {\r\n            if(typeof trade_index === \"undefined\") {\r\n                target_item = traders[current_trader].inventory[key].item;\r\n                item_count = item_count || traders[current_trader].inventory[key].count;\r\n            } else {\r\n                target_item = character.inventory[to_sell.items[trade_index].item_key].item;\r\n                item_count = item_count || to_sell.items[trade_index].count;\r\n            }\r\n            target_class_name = \"trader_item\";\r\n        } else if(target === \"storage\") {\r\n            target_item = player_storage.inventory[key].item;\r\n            item_count = item_count || player_storage.inventory[key].count;\r\n            target_class_name = \"storage_item\";\r\n        } else {\r\n            throw new Error(`\"${target}\" is not a correct inventory owner`);\r\n        }\r\n    }\r\n\r\n    if(\"quality\" in target_item) {\r\n        item_control_div.dataset.item_quality = target_item.quality;\r\n    }\r\n\r\n\r\n    if(target_item.tags?.equippable) {\r\n        if(target_item.tags.tool) {\r\n            item_name_div.innerHTML = `<span class = \"item_slot\" >[tool]</span> <span>${target_item.getName()}</span>`;\r\n        } else {\r\n            item_name_div.innerHTML = `<span class = \"item_slot\" >[${target_item.equip_slot}]</span> <span>${target_item.getName()}</span>`;\r\n        }\r\n        item_name_div.classList.add(`${item_class}_name`);\r\n        item_div.appendChild(item_name_div);\r\n\r\n        item_control_div.classList.add(`${item_class}_control`, `${target_class_name}_control`, `${target_class_name}_equippable`);\r\n        item_control_div.appendChild(item_div);\r\n\r\n        if(typeof trade_index !== \"undefined\") {\r\n            item_div.classList.add(`${item_class}`, `${target_class_name}`, `trade_item_equippable`);\r\n        } else {\r\n            item_div.classList.add(`${item_class}`, `${target_class_name}`, `item_equippable`);\r\n        }\r\n        item_control_div.dataset.item_slot = target_item.equip_slot;\r\n        //\r\n    } else if(target_item.tags.component) {\r\n        //\r\n        item_name_div.innerHTML = `<span class = \"item_category\">[Comp]</span> <span class=\"item_name\">${target_item.getName()}</span>`;\r\n        item_name_div.classList.add(`${item_class}_name`);\r\n        item_div.appendChild(item_name_div);\r\n\r\n        item_control_div.classList.add(`${item_class}_control`, `${target_class_name}_control`, `${target_class_name}_component`);\r\n        item_control_div.appendChild(item_div);\r\n\r\n        item_div.classList.add(`${item_class}`, `${target_class_name}`, \"item_component\");\r\n        //\r\n    } else if(target_item.tags.book) {\r\n        //\r\n        item_name_div.innerHTML = '<span class = \"item_category\">[Book]</span>';\r\n        item_name_div.classList.add(`${item_class}`);\r\n        item_name_div.innerHTML += ` <span class = \"book_name item_name\">\"${target_item.name}\"</span>`;\r\n\r\n        if(book_stats[target_item.name].is_finished) {\r\n            item_div.classList.add(\"book_finished\");\r\n        } else if(get_current_book() === target_item.name) {\r\n            item_control_div.classList.add(\"book_active\");\r\n        }\r\n        //\r\n    } else {\r\n        //\r\n        item_name_div.innerHTML = `<span class = \"item_category\"></span> <span class = \"item_name\">${target_item.getName()}</span>`;\r\n    }\r\n    \r\n    if(item_count > 1) {\r\n        item_name_div.innerHTML += `<span class=\"item_count\"> x${item_count}</span>`;\r\n    } else {\r\n        item_name_div.innerHTML += `<span class=\"item_count\"></span>`;\r\n    }\r\n\r\n    item_name_div.classList.add(`${item_class}_name`);\r\n\r\n    if(target === \"character\") {\r\n        const item_faving_div = document.createElement(\"div\");\r\n        item_faving_div.classList.add(\"item_fav_div\");\r\n        const icon = document.createElement(\"i\");\r\n        icon.classList.add(\"material-icons\", \"item_fav_icon\");\r\n        if(favourite_items[key]) {\r\n            icon.innerText = 'star';\r\n        } else {\r\n            icon.innerText = 'star_border';\r\n        }\r\n        item_faving_div.appendChild(icon);\r\n\r\n        item_div.appendChild(item_faving_div);\r\n    }\r\n\r\n    item_div.appendChild(item_name_div);\r\n\r\n    item_div.classList.add(`${item_class}`, `${target_class_name}`, `item_${target_item.item_type.toLowerCase()}`);\r\n\r\n    item_div.appendChild(create_item_tooltip(target_item, options, is_trade));\r\n\r\n    item_control_div.classList.add(`${item_class}_control`, `${target_class_name}_control`, `${target_class_name}_${target_item.item_type.toLowerCase()}`);\r\n    item_control_div.setAttribute(`data-${target_class_name}`, `${target_item.getInventoryKey()}`);\r\n    item_control_div.setAttribute(\"data-item_count\", `${item_count}`);\r\n    item_control_div.setAttribute(\"data-item_value\", `${target_item.getBaseValue()}`); //is only used as sorting param\r\n    item_control_div.appendChild(item_div);\r\n\r\n    if(target === \"character\") {\r\n        if(target_item.item_type === \"USABLE\") {\r\n            const item_use_button = document.createElement(\"div\");\r\n            item_use_button.classList.add(\"item_use_button\");\r\n            item_use_button.innerText = \"[use]\";\r\n            const item_auto_use_button = document.createElement(\"div\");\r\n            item_auto_use_button.classList.add(\"item_auto_use_button\");\r\n            item_auto_use_button.innerText = \"auto\";\r\n\r\n            if(favourite_consumables[target_item.id]) {\r\n                item_auto_use_button.classList.add(\"item_auto_use_button_active\");\r\n            }\r\n\r\n            item_additional.appendChild(item_use_button);\r\n            item_additional.appendChild(item_auto_use_button);\r\n        } else if(target_item.item_type === \"BOOK\") {\r\n            const item_read_button = document.createElement(\"div\");\r\n            item_read_button.classList.add(\"item_use_button\");\r\n            item_read_button.innerText = \"[read]\";\r\n            item_additional.appendChild(item_read_button);\r\n\r\n            item_div.classList.add(\"item_book\");\r\n        }\r\n        if(typeof trade_index === \"undefined\" && target_item.tags.equippable) {\r\n            if(!is_equipped) {\r\n                let item_equip_span = document.createElement(\"span\");\r\n                item_equip_span.innerHTML = \"[equip]\";\r\n                item_equip_span.classList.add(\"equip_item_button\", \"item_controls\");\r\n                item_additional.appendChild(item_equip_span);\r\n            } else {\r\n                let item_unequip_div = document.createElement(\"div\");\r\n                item_unequip_div.innerHTML = \"[take off]\";\r\n                item_unequip_div.classList.add(\"unequip_item_button\", \"item_controls\");\r\n                item_additional.appendChild(item_unequip_div);\r\n            }\r\n        }\r\n    } \r\n\r\n    let item_value_span = document.createElement(\"span\");\r\n    item_value_span.classList.add(\"item_value\", \"item_controls\");\r\n\r\n    if(!target_item.tags.unsellable) {\r\n        item_additional.appendChild(create_trade_buttons());\r\n        item_value_span.innerHTML = `${format_money(round_item_price(target_item.getValue({region: current_location?.market_region, multiplier: price_multiplier})), true)}`;\r\n    } else {\r\n        item_control_div.setAttribute(\"data-unsellable\", \"true\");\r\n        item_value_span.innerHTML = ``;\r\n    }\r\n\r\n    item_additional.appendChild(item_value_span);\r\n    item_control_div.appendChild(item_additional);\r\n\r\n    if(typeof trade_index !== \"undefined\") {\r\n        item_control_div.classList.add('item_to_trade');\r\n    }\r\n\r\n    return item_control_div;\r\n}\r\n\r\n/**\r\n * updates the displayed worn items + attaches tooltips\r\n */\r\nfunction update_displayed_equipment() {\r\n    Object.keys(equipment_slots_divs).forEach(function(key) {\r\n        let eq_tooltip; \r\n\r\n        if(character.equipment[key] == null) { //no item in slot\r\n            eq_tooltip = document.createElement(\"span\");\r\n            eq_tooltip.classList.add(\"item_tooltip\");\r\n            equipment_slots_divs[key].innerHTML = `${key.replace(\"_\",\" \")} slot`;\r\n            equipment_slots_divs[key].classList.add(\"equipment_slot_empty\");\r\n            eq_tooltip.innerHTML = `Your ${key.replace(\"_\",\" \")} slot`;\r\n        } else {\r\n            equipment_slots_divs[key].innerHTML = character.equipment[key].getName();\r\n            equipment_slots_divs[key].classList.remove(\"equipment_slot_empty\");\r\n            \r\n            eq_tooltip = create_item_tooltip(character.equipment[key]);\r\n        }\r\n        equipment_slots_divs[key].appendChild(eq_tooltip);\r\n    });\r\n}\r\n\r\n/**\r\n * updates displayed star icon to match whether target is in favs or not\r\n * @param {HTMLDivElement} node \r\n * @param {Boolean} is_fav \r\n */\r\nfunction update_fav_display(node, is_fav) {\r\n    if(is_fav) {\r\n        node.children[0].innerText = \"star\";\r\n        node.parentNode.parentNode.classList.add(\"character_item_faved\");\r\n    } else {\r\n        node.children[0].innerText = \"star_border\";\r\n        node.parentNode.parentNode.classList.remove(\"character_item_faved\");\r\n    }\r\n}\r\n\r\nfunction update_displayed_book(book_id) {\r\n    const book = item_templates[book_id];\r\n    const book_key = book.getInventoryKey();\r\n    if(book_stats[book.name].is_finished) {\r\n        item_divs[book_key].classList.add(\"book_finished\");\r\n        item_divs[book_key].classList.remove(\"book_active\");\r\n    } else if(get_current_book() === book.name) {\r\n        item_divs[book_key].classList.add(\"book_active\");\r\n    } else {\r\n        item_divs[book_key].classList.remove(\"book_active\");\r\n    }\r\n\r\n    item_divs[book_key].getElementsByClassName(\"item_tooltip\")[0].remove();\r\n    item_divs[book_key].getElementsByClassName(\"item_book\")[0].appendChild(create_item_tooltip(book));\r\n}\r\n\r\n/**\r\n * sets visibility of divs for enemies (based on how many there are in current combat),\r\n * and enemies' AP / EP\r\n * \r\n * called when new enemies get loaded\r\n */\r\nfunction update_displayed_enemies() {\r\n    for(let i = 0; i < 8; i++) { //go to max enemy count\r\n        if(i < current_enemies.length) {\r\n            enemies_div.children[i].children[0].style.display = null;\r\n            enemies_div.children[i].children[0].children[0].innerHTML = current_enemies[i].name;\r\n\r\n            let disp_speed;\r\n\r\n            if(current_enemies[i].stats.attack_speed > 20) {\r\n                disp_speed = Math.round(current_enemies[i].stats.attack_speed);\r\n            } else if (current_enemies[i].stats.attack_speed > 2) {\r\n                disp_speed = Math.round(current_enemies[i].stats.attack_speed*10)/10;\r\n            } else {\r\n                disp_speed = Math.round(current_enemies[i].stats.attack_speed*100)/100;\r\n            }\r\n\r\n            let hero_hit_chance_modifier = current_enemies.filter(enemy => enemy.is_alive).length**(-1/4); // down to ~ 60% if there's full 8 enemies\r\n            let hero_evasion_chance_modifier = current_enemies.filter(enemy => enemy.is_alive).length**(-1/3); //down to .5 if there's full 8 enemies (multiple attackers make it harder to evade attacks)\r\n\r\n            let target = current_enemies[i];\r\n            Object.keys(target.tags).forEach(enemy_tag => {\r\n                if(enemy_tag_to_skill_mapping[enemy_tag]) {\r\n                    for(let i = 0; i < enemy_tag_to_skill_mapping[enemy_tag].length; i++) {\r\n                        const skill = skills[enemy_tag_to_skill_mapping[enemy_tag][i]];\r\n                        const {modifier_to_hit_chance, modifier_to_evasion} = skill.get_stat_modifiers();\r\n                        hero_hit_chance_modifier *= modifier_to_hit_chance || 1;\r\n                        hero_evasion_chance_modifier *= modifier_to_evasion || 1;\r\n                    }\r\n                }\r\n            });\r\n        \r\n            const evasion_chance = 1 - get_hit_chance(character.stats.full.attack_points*hero_hit_chance_modifier, current_enemies[i].stats.agility * Math.sqrt(current_enemies[i].stats.intuition ?? 1));\r\n            let hit_chance = get_hit_chance(current_enemies[i].stats.dexterity * Math.sqrt(current_enemies[i].stats.intuition ?? 1), character.stats.full.evasion_points*hero_evasion_chance_modifier);\r\n\r\n            if(character.equipment[\"off-hand\"]?.offhand_type === \"shield\") { //has shield\r\n                hit_chance = 1;\r\n            }\r\n\r\n            //enemies_div.children[i].children[0].children[1].innerHTML = `AP : ${Math.round(ap)} | EP : ${Math.round(ep)}`;\r\n            enemies_div.children[i].children[0].children[1].children[0].innerHTML = `Atk: ${current_enemies[i].stats.attack}dmg`;\r\n            if(current_enemies[i].stats.attack_count > 1) {\r\n                enemies_div.children[i].children[0].children[1].children[0].innerHTML+=` x${current_enemies[i].stats.attack_count}`;\r\n            }\r\n            enemies_div.children[i].children[0].children[1].children[1].innerHTML = `Spd: ${disp_speed}`;\r\n            enemies_div.children[i].children[0].children[1].children[2].innerHTML = `Hit: ${Math.min(100,Math.max(0,Math.round(100*hit_chance)))}%`; //100% if shield!\r\n            enemies_div.children[i].children[0].children[1].children[3].innerHTML = `Ddg: ${Math.min(100,Math.max(0,Math.round(100*evasion_chance)))}%`;\r\n            enemies_div.children[i].children[0].children[1].children[4].innerHTML = `Def: ${current_enemies[i].stats.defense}`;\r\n\r\n        } else {\r\n            enemies_div.children[i].children[0].style.display = \"none\"; //just hide it\r\n        }     \r\n    }\r\n}\r\n\r\n/**\r\n * updates displayed health and healthbars of enemies\r\n */\r\nfunction update_displayed_health_of_enemies() {\r\n    for(let i = 0; i < current_enemies.length; i++) {\r\n        if(current_enemies[i].is_alive) {\r\n            enemies_div.children[i].children[0].style.filter = \"brightness(100%)\";\r\n        } else {\r\n            enemies_div.children[i].children[0].style.filter = \"brightness(30%)\";\r\n            update_displayed_enemies();\r\n        }\r\n\r\n        //update size of health bar\r\n        enemies_div.children[i].children[0].children[2].children[0].children[0].style.width = \r\n            Math.max(0, 100*current_enemies[i].stats.health/current_enemies[i].stats.max_health) + \"%\";\r\n\r\n            enemies_div.children[i].children[0].children[2].children[1].innerText = `${Math.ceil(current_enemies[i].stats.health)}/${Math.ceil(current_enemies[i].stats.max_health)} hp`;\r\n\r\n    }\r\n}\r\n\r\nfunction update_displayed_normal_location(location) {\r\n    clear_action_div();\r\n    location_types_div.innerHTML = \"\";\r\n    combat_div.style.display = \"none\";\r\n    location_tooltip.innerText = \"\";\r\n\r\n    document.documentElement.style.setProperty('--location_desc_tooltip_visibility', \"hidden\");\r\n\r\n    enemy_count_div.style.display = \"none\";\r\n    clear_count_div.style.display = \"none\";\r\n    document.documentElement.style.setProperty('--actions_div_height', getComputedStyle(document.body).getPropertyValue('--actions_div_height_default'));\r\n    document.documentElement.style.setProperty('--actions_div_top', getComputedStyle(document.body).getPropertyValue('--actions_div_top_default'));\r\n    \r\n    inventory_switch.click();\r\n    combat_switch.style.pointerEvents = \"none\";\r\n    combat_switch.style.cursor = \"default\";\r\n    combat_switch.style.color = \"gray\";\r\n\r\n    location_name_span.innerText = current_location.name;\r\n    document.getElementById(\"location_description_div\").innerText = current_location.getDescription();\r\n\r\n    update_location_icon(location);\r\n\r\n    /////////////////////////////\r\n    //add button to open crafting\r\n    if(global_flags.is_crafting_unlocked) {\r\n        if(location.crafting?.is_unlocked) {\r\n            const crafting_button = document.createElement(\"div\");\r\n            crafting_button.classList.add(\"location_choices\", \"choice_craft\");\r\n            crafting_button.setAttribute(\"onclick\", 'openCraftingWindow()');\r\n            crafting_button.innerHTML = `<i class=\"material-icons\">construction</i> ${location.crafting.use_text}`;\r\n            action_div.appendChild(crafting_button);\r\n        }\r\n    }\r\n\r\n    ///////////////////////////\r\n    //add button to go to sleep\r\n\r\n    if(location.housing?.is_unlocked) { \r\n        const start_sleeping_div = document.createElement(\"div\");\r\n        \r\n        start_sleeping_div.innerHTML = '<i class=\"material-icons\">bed</i>  ' + location.housing.text_to_sleep;\r\n        start_sleeping_div.id = \"start_sleeping_div\";\r\n        start_sleeping_div.setAttribute('onclick', 'start_sleeping()');\r\n\r\n        const open_storage_div = document.createElement(\"div\");\r\n        \r\n        open_storage_div.innerHTML = '<i class=\"material-icons\">inventory_2</i>  Open your personal chest';\r\n        open_storage_div.id = \"open_storage_div\";\r\n        open_storage_div.setAttribute('onclick', 'openStorage()');\r\n\r\n        action_div.appendChild(start_sleeping_div);\r\n        action_div.appendChild(open_storage_div);\r\n    }\r\n    \r\n    ////////////////////////////////////\r\n    //add buttons for starting dialogues\r\n\r\n    const available_dialogues = location.dialogues.filter(dialogue => {\r\n        if(!dialogues[dialogue].is_unlocked || dialogues[dialogue].is_finished) {\r\n            return false;\r\n        } else {\r\n            let lines_available = false;\r\n            Object.keys(dialogues[dialogue].textlines).forEach(line => {\r\n                if(lines_available) {\r\n                    return;\r\n                } else {\r\n                    lines_available = dialogues[dialogue].textlines[line].is_unlocked && !dialogues[dialogue].textlines[line].is_finished;\r\n                }\r\n            });\r\n            return lines_available;\r\n        }\r\n    });\r\n\r\n    if(available_dialogues.length > 0) {\r\n        location_choice_divs[\"dialogues\"] = create_location_choice_dropdown({name: \"Talk to someone\", icon: \"question_answer\", class_name: \"choice_dialogue\"});\r\n\r\n        location_choice_divs[\"dialogues\"].append(...create_location_choices({location: location, category: \"talk\"}));\r\n    }\r\n\r\n    /////////////////////////\r\n    //add buttons for trading\r\n\r\n    const available_traders = location.traders.filter(trader => traders[trader].is_unlocked && !traders[trader].is_finished);\r\n\r\n    if(available_traders.length > 0) {\r\n        location_choice_divs[\"traders\"] = create_location_choice_dropdown({name: \"Visit a merchant\", icon: \"storefront\", class_name: \"choice_trade\"});\r\n\r\n        location_choice_divs[\"traders\"].append(...create_location_choices({location: location, category: \"trade\"}));\r\n    }\r\n    \r\n\r\n    ///////////////////////////\r\n    //add buttons to start jobs\r\n\r\n    const available_jobs = Object.values(location.activities).filter(activity => activities[activity.activity_name].type === \"JOB\" \r\n                                                                    && activities[activity.activity_name].is_unlocked\r\n                                                                    && activity.is_unlocked\r\n                                                                    && activities[activity.activity_name].base_skills_names.filter(skill => !skills[skill].is_unlocked).length == 0);\r\n    \r\n    if(available_jobs.length > 0) {\r\n        location_choice_divs[\"jobs\"] = create_location_choice_dropdown({name: \"Find work\", icon: \"work_outline\", class_name: \"choice_work\"});\r\n\r\n        location_choice_divs[\"jobs\"].append(...create_location_choices({location: location, category: \"work\"}));\r\n    }\r\n\r\n\r\n    ///////////////////////////////\r\n    //add buttons to start training\r\n\r\n    const available_trainings = Object.values(location.activities).filter(activity => activities[activity.activity_name].type === \"TRAINING\" \r\n                                                                    && activities[activity.activity_name].is_unlocked\r\n                                                                    && activity.is_unlocked\r\n                                                                    && activities[activity.activity_name].base_skills_names.filter(skill => !skills[skill].is_unlocked).length == 0);\r\n    \r\n    if(available_trainings.length > 0) {\r\n        location_choice_divs[\"trainings\"] = create_location_choice_dropdown({name: \"Train\", icon: \"fitness_center\", class_name: \"choice_train\"});\r\n\r\n        location_choice_divs[\"trainings\"].append(...create_location_choices({location: location, category: \"train\"}));\r\n    }\r\n\r\n    ////////////////////////////////\r\n    //add buttons to start gathering\r\n\r\n    if(global_flags.is_gathering_unlocked) {\r\n        const available_gatherings = Object.values(location.activities).filter(activity => activities[activity.activity_name].type === \"GATHERING\" \r\n                                                                        && activities[activity.activity_name].is_unlocked\r\n                                                                        && activity.is_unlocked\r\n                                                                        && activities[activity.activity_name].base_skills_names.filter(skill => !skills[skill].is_unlocked).length == 0);\r\n        \r\n        \r\n        if(available_gatherings.length > 0) {\r\n            location_choice_divs[\"gatherings\"] = create_location_choice_dropdown({name: \"Gather resources\", icon: \"search\", class_name: \"choice_gather\"});\r\n    \r\n            location_choice_divs[\"gatherings\"].append(...create_location_choices({location: location, category: \"gather\"}));\r\n        }\r\n        \r\n    }\r\n\r\n    const available_actions = Object.values(location.actions).filter(action => action.is_unlocked && !action.is_finished);\r\n    if(available_actions.length > 0) {\r\n        location_choice_divs[\"actions\"] = create_location_choice_dropdown({name: \"Take an action\", icon: \"circle\", class_name: \"choice_action\"});\r\n\r\n        location_choice_divs[\"actions\"].append(...create_location_choices({location: location, category: \"action\"}));\r\n    }\r\n\r\n    /////////////////////////////////\r\n    //add butttons to change location\r\n\r\n    const available_locations = location.connected_locations.filter(loc => (loc.location.is_unlocked && !loc.location.is_finished && !loc.location.is_challenge));\r\n    if(available_locations.length > 0) {\r\n        location_choice_divs[\"locations\"] = create_location_choice_dropdown({name: \"Move somewhere else\", icon: \"directions\", class_name: \"choice_travel\"});\r\n\r\n        location_choice_divs[\"locations\"].append(...create_location_choices({location: location, category: \"travel\"}));\r\n    }\r\n\r\n    ////////////////////////////\r\n    //add buttons for challenges\r\n\r\n    const available_challenges = location.connected_locations.filter(loc => (loc.location.is_challenge && loc.location.is_unlocked && !loc.location.is_finished));\r\n    if(available_challenges.length > 0) {\r\n        location_choice_divs[\"challenges\"] = create_location_choice_dropdown({name: \"Take on a challenge\", icon: \"warning_amber\", class_name: \"choice_travel\"});\r\n\r\n        location_choice_divs[\"challenges\"].append(...create_location_choices({location: location, category: \"challenge\"}));\r\n    }\r\n\r\n    /////////////////////////////\r\n    //add buttons for fast travel\r\n\r\n    const available_fast_travel = \r\n    [\r\n        ...Object.keys(favourite_locations).filter(key => (key !== current_location.id)), \r\n        ...Object.keys(unlocked_beds).filter(key => (key !== current_location.id && locations[key].is_unlocked && !locations[key].is_finished))\r\n    ];\r\n\r\n    if((available_fast_travel.length + (last_combat_location?1:0)) > 0) {\r\n        location_choice_divs[\"fast_travel\"] = create_location_choice_dropdown({name: \"Fast travel\", icon: \"directions\", class_name: \"choice_travel\"});\r\n\r\n        location_choice_divs[\"fast_travel\"].append(...create_location_choices({location: location, category: \"fast_travel\"}));\r\n    }\r\n\r\n    action_div.append(...Object.values(location_choice_divs));\r\n}\r\n\r\nfunction update_location_icon() {\r\n    if(current_location.housing && current_location.housing.is_unlocked) {\r\n        location_icon_span.innerHTML = '<i class=\"material-icons location_bed_icon\">bed</i>'\r\n    } else if(favourite_locations[current_location.id]) {\r\n        location_icon_span.innerHTML = '<i class=\"material-icons\">star</i>'\r\n    } else {\r\n        location_icon_span.innerHTML = '<i class=\"material-icons\">star_border</i>'\r\n    }\r\n}\r\n\r\nfunction create_location_choice_dropdown({name, icon, class_name}) {\r\n\r\n    const elem = document.createElement(\"div\");\r\n    elem.innerHTML = `<i class=\"material-icons\">${icon}</i> ${name}`;\r\n    elem.classList.add(\"location_choice_dropdown\", class_name);\r\n\r\n    elem.addEventListener(\"click\", (event)=>{\r\n        let target = event.target;\r\n        if(target.classList.contains(\"material-icons\")) {\r\n            target = target.parentNode;\r\n        }\r\n\r\n        if(target.classList.contains(\"location_choice_dropdown\")) {\r\n            target.classList.toggle(\"location_choice_dropdown_expanded\");\r\n\r\n            //done after toggling class, so it will trigger if class was NOT present when clicked\r\n            if(target.classList.contains(\"location_choice_dropdown_expanded\")) {\r\n                target.scrollIntoView({block: \"end\", inline: \"nearest\", behavior: \"smooth\"});\r\n            }\r\n        }\r\n    });\r\n\r\n    return elem;\r\n}\r\n\r\n/**\r\n * \r\n * @param {*} location \r\n * @param {*} category \r\n * @return {Array} an array of html nodes presenting the available choices\r\n */\r\nfunction create_location_choices({location, category, is_combat = false}) {\r\n    let choice_list = [];\r\n    //that's a lot of ifs for same argument, maybe switch to switch instead?\r\n\r\n    if(category === \"talk\") {\r\n        for(let i = 0; i < location.dialogues.length; i++) { \r\n            if(!dialogues[location.dialogues[i]].is_unlocked || dialogues[location.dialogues[i]].is_finished) { //skip if dialogue is not available\r\n                continue;\r\n            } \r\n\r\n            const lines_available = location.dialogues.filter(dialogue => {\r\n                    let lines_available = false;\r\n                    Object.keys(dialogues[dialogue].textlines).forEach(line => {\r\n                        if(lines_available) {\r\n                            return;\r\n                        } else {\r\n                            lines_available = dialogues[dialogue].textlines[line].is_unlocked && !dialogues[dialogue].textlines[line].is_finished;\r\n                        }\r\n                    });\r\n                    return lines_available;\r\n            }).length > 0;\r\n            if(!lines_available) {\r\n                continue;\r\n            }\r\n            \r\n            const dialogue_div = document.createElement(\"div\");\r\n    \r\n            //if(Object.keys(dialogues[location.dialogues[i]].textlines).length > 0) { //has any textlines\r\n                \r\n            //dialogue_div.innerHTML = add_icons ? `<i class=\"material-icons\">question_answer</i>  ` : \"\";\r\n            dialogue_div.innerHTML += `<i class=\"material-icons location_choice_icon\">check_box_outline_blank</i> ` + dialogues[location.dialogues[i]].getStartingText({is_mofu_mofu_enabled: global_flags.is_mofu_mofu_enabled});\r\n            dialogue_div.classList.add(\"start_dialogue\", \"location_choice\");\r\n            dialogue_div.setAttribute(\"data-dialogue\", location.dialogues[i]);\r\n            dialogue_div.setAttribute(\"onclick\", \"start_dialogue(this.getAttribute('data-dialogue'));\");\r\n            choice_list.push(dialogue_div);\r\n            //}\r\n        }\r\n    } else if (category === \"trade\") {\r\n        for(let i = 0; i < location.traders.length; i++) { \r\n            if(!traders[location.traders[i]].is_unlocked || traders[location.traders[i]].is_finished) { //skip if trader is not available\r\n                continue;\r\n            } \r\n            \r\n            const trader_div = document.createElement(\"div\");  \r\n\r\n            //trader_div.innerHTML = add_icons ? `<i class=\"material-icons\">storefront</i>   ` : \"\";\r\n            trader_div.innerHTML += `<i class=\"material-icons location_choice_icon\">check_box_outline_blank</i> ` + traders[location.traders[i]].trade_text;\r\n            trader_div.classList.add(\"start_trade\", \"location_choice\");\r\n            trader_div.setAttribute(\"data-trader\", location.traders[i]);\r\n            trader_div.setAttribute(\"onclick\", \"startTrade(this.getAttribute('data-trader'));\");\r\n            choice_list.push(trader_div);\r\n        }\r\n    } else if (category === \"work\") {\r\n        Object.keys(location.activities).forEach(key => {\r\n            if(!activities[location.activities[key].activity_name]?.is_unlocked \r\n                || !location.activities[key]?.is_unlocked \r\n                || activities[location.activities[key].activity_name].type !== \"JOB\") \r\n            {\r\n                return;\r\n            }\r\n            \r\n            const activity_div = document.createElement(\"div\");\r\n\r\n            //activity_div.innerHTML = `<i class=\"material-icons\">work_outline</i>  `;\r\n            activity_div.classList.add(\"activity_div\", \"location_choice\");\r\n            activity_div.setAttribute(\"data-activity\", key);\r\n            activity_div.setAttribute(\"onclick\", \"start_activity(this.getAttribute('data-activity'));\");\r\n\r\n            if(can_work(location.activities[key])) {\r\n                activity_div.classList.add(\"start_activity\");\r\n            } else {\r\n                activity_div.classList.add(\"activity_unavailable\");\r\n            }\r\n\r\n            const job_tooltip = document.createElement(\"div\");\r\n            job_tooltip.classList.add(\"job_tooltip\");\r\n            if(!location.activities[key].infinite){\r\n                if(location.activities[key].availability_time) {\r\n                    job_tooltip.innerHTML = `Available from ${location.activities[key].availability_time.start} to ${location.activities[key].availability_time.end} <br>`;\r\n                }\r\n                if(location.activities[key].availability_seasons) {\r\n                    if(location.activities[key].availability_seasons.length === 3) {\r\n                        const unavailable_seasons = seasons.filter(x => !location.activities[key].availability_seasons.includes(x));\r\n                        job_tooltip.innerHTML += `Not available during ${unavailable_seasons.toString().replaceAll(\",\",\", \")} <br>`;\r\n                    } else {\r\n                        job_tooltip.innerHTML += `Available during ${location.activities[key].availability_seasons.toString().replaceAll(\",\",\", \")} <br>`;\r\n                    }\r\n                }\r\n            }\r\n            job_tooltip.innerHTML += `Pays ${format_money(location.activities[key].get_payment())} per every ` +  \r\n                    `${format_working_time(location.activities[key].working_period)} worked`;\r\n            \r\n\r\n            activity_div.appendChild(job_tooltip);\r\n    \r\n            activity_div.innerHTML += `<i class=\"material-icons location_choice_icon\">check_box_outline_blank</i> ` + location.activities[key].starting_text;\r\n            choice_list.push(activity_div);\r\n        });\r\n    } else if (category === \"train\") {\r\n        Object.keys(location.activities).forEach(key => {\r\n            if(!activities[location.activities[key].activity_name]?.is_unlocked \r\n                || !location.activities[key]?.is_unlocked \r\n                || activities[location.activities[key].activity_name].type !== \"TRAINING\"\r\n                || activities[location.activities[key].activity_name].base_skills_names.filter(skill => !skills[skill].is_unlocked).length > 0) \r\n            {\r\n                return;\r\n            }\r\n\r\n            const activity_div = document.createElement(\"div\");\r\n\r\n            //activity_div.innerHTML = `<i class=\"material-icons\">fitness_center</i>  `;\r\n            activity_div.classList.add(\"activity_div\", \"start_activity\", \"location_choice\");\r\n            activity_div.setAttribute(\"data-activity\", key);\r\n            activity_div.setAttribute(\"onclick\", \"start_activity(this.getAttribute('data-activity'));\");\r\n\r\n            if(location.activities[key].availability_seasons) {\r\n                const activity_tooltip = document.createElement(\"div\");\r\n                activity_tooltip.classList.add(\"job_tooltip\");\r\n                if(location.activities[key].availability_seasons.length === 3) {\r\n                    const unavailable_seasons = seasons.filter(x => !location.activities[key].availability_seasons.includes(x));\r\n                    activity_tooltip.innerHTML = `Not available during ${unavailable_seasons.toString().replaceAll(\",\",\", \")} <br>`;\r\n                } else {\r\n                    activity_tooltip.innerHTML = `Available during ${location.activities[key].availability_seasons.toString().replaceAll(\",\",\", \")} <br>`;\r\n                }\r\n                activity_div.appendChild(activity_tooltip);\r\n            }\r\n\r\n            activity_div.innerHTML += `<i class=\"material-icons location_choice_icon\">check_box_outline_blank</i> ` + location.activities[key].starting_text;\r\n            choice_list.push(activity_div);\r\n        });\r\n    } else if (category === \"gather\") {\r\n        Object.keys(location.activities).forEach(key => {\r\n            if(!activities[location.activities[key].activity_name]?.is_unlocked \r\n                || !location.activities[key]?.is_unlocked \r\n                || activities[location.activities[key].activity_name].type !== \"GATHERING\"\r\n                || activities[location.activities[key].activity_name].base_skills_names.filter(skill => !skills[skill].is_unlocked).length > 0) \r\n            {\r\n                return;\r\n            }\r\n\r\n            const activity_div = document.createElement(\"div\");\r\n\r\n            //activity_div.innerHTML = `<i class=\"material-icons\">search</i>  `;\r\n            activity_div.classList.add(\"activity_div\", \"start_activity\", \"location_choice\");\r\n            activity_div.setAttribute(\"data-activity\", key);\r\n            activity_div.setAttribute(\"onclick\", \"start_activity(this.getAttribute('data-activity'));\");\r\n\r\n            activity_div.appendChild(create_gathering_tooltip(location.activities[key]));\r\n    \r\n            activity_div.innerHTML += `<i class=\"material-icons location_choice_icon\">check_box_outline_blank</i> ` + location.activities[key].starting_text;\r\n            choice_list.push(activity_div);\r\n        });\r\n    } else if (category === \"travel\") {\r\n        if(!is_combat){\r\n            for(let i = 0; i < location.connected_locations.length; i++) { \r\n                \r\n                if(!location.connected_locations[i].location.is_unlocked || location.connected_locations[i].location.is_finished) { //skip if not unlocked or if finished\r\n                    continue;\r\n                }\r\n                if(location.connected_locations[i].location.is_challenge) {\r\n                    continue;\r\n                    //challenges displayed separately\r\n                }\r\n\r\n                const action = document.createElement(\"div\");\r\n                \r\n                const travel_time = format_time({time: {minutes: travel_times[location.id][location.connected_locations[i].location.id]}});\r\n\r\n                if(\"connected_locations\" in location.connected_locations[i].location) {// check again if connected location is normal or combat\r\n                    action.classList.add(\"travel_normal\");\r\n                    if(\"custom_text\" in location.connected_locations[i]) {\r\n                        action.innerHTML = `<div class='location_choice_icon_box'><i class=\"material-icons location_choice_icon\">check_box_outline_blank</i></div> ` + location.connected_locations[i].custom_text + \" [\" + travel_time + \"]\";\r\n                    }\r\n                    else {\r\n                        action.innerHTML = `<div class='location_choice_icon_box'><i class=\"material-icons location_choice_icon\">check_box_outline_blank</i></div> ` + \"Go to [\" + location.connected_locations[i].location.name+\"]\"+\" [\" + travel_time + \"]\";\r\n                    }\r\n                } else {\r\n                    action.classList.add(\"travel_combat\");\r\n                    if(\"custom_text\" in location.connected_locations[i]) {\r\n                        action.innerHTML = `<div class='location_choice_icon_box'><i class=\"material-icons\">warning_amber</i></div> ` + location.connected_locations[i].custom_text + \" [\" + travel_time + \"]\";\r\n                    } else {\r\n                        action.innerHTML = `<div class='location_choice_icon_box'><i class=\"material-icons\">warning_amber</i></div>  ` + \"Enter the [\" + location.connected_locations[i].location.name+\"] [\" + travel_time + \"]\";\r\n                    }\r\n                }\r\n            \r\n                action.classList.add(\"action_travel\", \"location_choice\");\r\n                action.setAttribute(\"data-travel\", location.connected_locations[i].location.id);\r\n                action.setAttribute(\"onclick\", \"change_location({location_id: this.getAttribute('data-travel')});\");\r\n        \r\n                choice_list.push(action);\r\n            } \r\n        } else {\r\n            const action = document.createElement(\"div\");\r\n            action.classList.add(\"travel_normal\", \"action_travel\", \"location_choice\");\r\n\r\n            const travel_time = format_time({time: {minutes: travel_times[location.id][location.parent_location.id]}});\r\n            let travel_time_text = \"\";\r\n            if(travel_time) {\r\n                travel_time_text = \" [\" + travel_time + \"]\";\r\n            }\r\n            if(location.leave_text) {\r\n                action.innerHTML = location.leave_text + travel_time_text;\r\n            } else {\r\n                action.innerHTML = \"Go back to [\" + location.parent_location.name + \"]\" + travel_time_text;\r\n            }\r\n            action.setAttribute(\"data-travel\", location.parent_location.id);\r\n            action.setAttribute(\"onclick\", \"change_location({location_id:this.getAttribute('data-travel')});\");\r\n\r\n            choice_list.push(action);\r\n        }\r\n\r\n        if(last_location_with_bed && !location.housing?.is_unlocked && !location.connected_locations) {\r\n            const last_bed = locations[last_location_with_bed];\r\n\r\n            const action = document.createElement(\"div\");\r\n            action.classList.add(\"action_travel\", \"travel_normal\", \"location_choice\");\r\n\r\n            const travel_time = format_time({time: {minutes: travel_times[location.id][last_bed.id]}});\r\n            \r\n            if(!is_combat) {\r\n                action.innerHTML += `<i class=\"material-icons location_choice_icon\">check_box_outline_blank</i> `\r\n            }\r\n            if(travel_time) {\r\n                action.innerHTML += `Quick return to [${last_bed.name}]` +\" [\" + travel_time + \"]\";\r\n            } else {\r\n                action.innerHTML += `Quick return to [${last_bed.name}]`;\r\n            }\r\n\r\n            action.setAttribute(\"data-travel\", last_bed.name);\r\n            action.setAttribute(\"onclick\", \"change_location({location_id:this.getAttribute('data-travel')});\");\r\n    \r\n            choice_list.push(action);\r\n        }\r\n\r\n        choice_list.sort((a,b) => b.classList.contains(\"travel_normal\") - a.classList.contains(\"travel_normal\"));\r\n    } else if (category === \"challenge\") {\r\n        const available_challenges = location.connected_locations.filter(loc => (loc.location.is_challenge && loc.location.is_unlocked && !loc.location.is_finished));\r\n       \r\n        for(let i = 0; i < available_challenges.length; i++) { \r\n            const action = document.createElement(\"div\");\r\n\r\n            action.classList.add(\"travel_combat\", \"location_choice\");\r\n            if(\"custom_text\" in available_challenges[i]) {\r\n                action.innerHTML = `<i class=\"material-icons\">warning_amber</i>  ` + available_challenges[i].custom_text;\r\n            }\r\n            else {\r\n                action.innerHTML = `<i class=\"material-icons\">warning_amber</i>  ` + \"Enter the \" + available_challenges[i].location.name;\r\n            }\r\n            \r\n            action.classList.add(\"action_travel\");\r\n            action.setAttribute(\"data-travel\", available_challenges[i].location.id);\r\n            action.setAttribute(\"onclick\", \"change_location({location_id:this.getAttribute('data-travel')});\");\r\n    \r\n            choice_list.push(action);\r\n        }\r\n    } else if (category === \"action\") {\r\n        Object.keys(location.actions).forEach(key => {\r\n            if(location.actions[key].is_finished || !location.actions[key].is_unlocked) {\r\n                return;\r\n            }\r\n\r\n            const location_action_div = document.createElement(\"div\");\r\n\r\n            //location_action_div.innerHTML = `<i class=\"material-icons\">circle</i>  `;\r\n            location_action_div.classList.add(\"location_action_div\", \"start_game_action\", \"location_choice\");\r\n            location_action_div.setAttribute(\"data-location_action\", key);\r\n            location_action_div.setAttribute(\"onclick\", \"start_game_action(this.getAttribute('data-location_action'));\");\r\n\r\n            location_action_div.appendChild(create_location_action_tooltip(location.actions[key]));\r\n    \r\n            location_action_div.innerHTML += `<i class=\"material-icons location_choice_icon\">check_box_outline_blank</i> ` + location.actions[key].starting_text;\r\n            choice_list.push(location_action_div);\r\n        });\r\n    } else if (category === \"fast_travel\") {\r\n        choice_list = create_fast_travel_choices();\r\n    }\r\n\r\n    return choice_list;\r\n}\r\n\r\nfunction create_fast_travel_choices() {\r\n    let choice_list = [];\r\n\r\n    let available_fast_travel = \r\n    [\r\n        ...Object.keys(favourite_locations).filter(key => (key !== current_location.id)),\r\n        ...Object.keys(unlocked_beds).filter(key => (key !== current_location.id && locations[key].is_unlocked && !locations[key].is_finished))\r\n    ];\r\n\r\n    if(last_combat_location && !available_fast_travel.includes(last_combat_location)) {\r\n        available_fast_travel.push(last_combat_location);\r\n    }\r\n\r\n    available_fast_travel = available_fast_travel.sort((a,b) => {\r\n        if(locations[a].housing?.is_unlocked && !locations[b].housing?.is_unlocked) {\r\n            return -1;\r\n        } else if(!locations[a].housing?.is_unlocked && locations[b].housing?.is_unlocked) {\r\n            return 1;\r\n        } else {\r\n            if(locations[a].tags.safe_zone && !locations[b].tags.safe_zone) {\r\n                return -1;\r\n            } else if(!locations[a].tags.safe_zone && locations[b].tags.safe_zone) {\r\n                return 1;\r\n            } else {\r\n                return 0;\r\n            }\r\n        }\r\n    });\r\n\r\n    for(let i = 0; i < available_fast_travel.length; i++) { \r\n        if(!locations[available_fast_travel[i]].is_unlocked || locations[available_fast_travel[i]].is_finished) { //skip if not unlocked or if finished\r\n            continue;\r\n        }\r\n        if(available_fast_travel[i] === current_location.id) { //do not show current location as a valid destination\r\n            continue;\r\n        }\r\n\r\n        const action = document.createElement(\"div\");\r\n        const travel_time = format_time({time: {minutes: travel_times[current_location.id][available_fast_travel[i]]}});\r\n\r\n        if(locations[available_fast_travel[i]].tags.safe_zone) {\r\n        \r\n            action.classList.add(\"travel_normal\");\r\n\r\n            if(locations[available_fast_travel[i]].housing?.is_unlocked) {\r\n                action.innerHTML = `<i class=\"material-icons\">bed</i> <span class=\"fast_travel_name\">` + \"Travel to [\" + locations[available_fast_travel[i]].name+\"] [\" + travel_time + \"]</span>\";\r\n            } else {\r\n                action.innerHTML = `<i class=\"material-icons location_choice_icon\">check_box_outline_blank</i> <span class=\"fast_travel_name\">` + \"Travel to [\" + locations[available_fast_travel[i]].name+\"] [\" + travel_time + \"]</span>\";\r\n            }\r\n            \r\n            action.classList.add(\"action_travel\", \"location_choice\");\r\n            action.setAttribute(\"data-travel\", locations[available_fast_travel[i]].id);\r\n            action.setAttribute(\"onclick\", \"change_location({location_id:this.getAttribute('data-travel'), event});\");\r\n        } else {            \r\n            action.classList.add(\"travel_combat\");\r\n            \r\n            action.innerHTML = `<i class=\"material-icons\">warning_amber</i> <span class=\"fast_travel_name\">Travel to [${locations[available_fast_travel[i]].name}] [${travel_time}] </span>`;\r\n            \r\n            action.classList.add(\"action_travel\", \"location_choice\");\r\n            action.setAttribute(\"data-travel\", locations[available_fast_travel[i]].id);\r\n            action.setAttribute(\"onclick\", \"change_location({location_id: this.getAttribute('data-travel'), event});\");\r\n        }\r\n\r\n        if(!locations[available_fast_travel[i]].housing?.is_unlocked && locations[available_fast_travel[i]].id !== last_combat_location) {\r\n            const removal_button = document.createElement(\"span\");\r\n            removal_button.innerHTML = `<i class=\"material-icons fast_travel_removal_button\">close</i>`;\r\n            removal_button.setAttribute(\"onclick\",\"remove_location_from_favourites({location_id:this.parentNode.getAttribute('data-travel')})\");\r\n            action.appendChild(removal_button);\r\n        }\r\n\r\n        choice_list.push(action);\r\n    }\r\n    return choice_list;\r\n}\r\n\r\nfunction remove_fast_travel_choice({location_id}) {\r\n    if(!location_choice_divs[\"fast_travel\"]) {\r\n        return;\r\n    }\r\n    \r\n    const element = location_choice_divs[\"fast_travel\"].querySelector(`[data-travel=\"${location_id}\"`);\r\n\r\n    if(!element) {\r\n        return;\r\n    }\r\n\r\n    if(location_id === last_combat_location || locations[location_id].housing?.is_unlocked) {\r\n        //remove only button\r\n        element.getElementsByClassName(\"fast_travel_removal_button\")[0].parentNode.remove();\r\n    } else {\r\n        //remove full element\r\n        element.remove();\r\n    }\r\n}\r\n\r\nfunction update_displayed_combat_location(location) {\r\n\r\n    document.documentElement.style.setProperty('--location_desc_tooltip_visibility', \"visible\");\r\n    clear_action_div();\r\n    location_types_div.innerHTML = \"\";\r\n    let action;\r\n\r\n    update_location_icon(location);\r\n\r\n    clear_count_div.style.display = \"block\";\r\n    enemy_count_div.style.display = \"block\";\r\n    combat_div.style.display = \"block\";\r\n\r\n    if(!options.disable_combat_autoswitch) {\r\n        combat_switch.click();\r\n        combat_switch.classList.add(\"active_selection_button\");\r\n        inventory_switch.classList.remove(\"active_selection_button\");\r\n    } \r\n    combat_switch.style.pointerEvents = \"auto\";\r\n    combat_switch.style.cursor = \"pointer\";\r\n    combat_switch.style.color = \"white\";\r\n\r\n    document.documentElement.style.setProperty('--actions_div_height', getComputedStyle(document.body).getPropertyValue('--actions_div_height_combat'));\r\n    document.documentElement.style.setProperty('--actions_div_top', getComputedStyle(document.body).getPropertyValue('--actions_div_top_combat'));\r\n\r\n\r\n    enemy_count_div.children[0].children[1].innerText = location.enemy_count - location.enemy_groups_killed % location.enemy_count + \" / \" + location.enemy_count;\r\n    clear_count_div.children[0].children[0].innerText = \"Clears: [\" + Math.floor(location.enemy_groups_killed / location.enemy_count) +\"]\";\r\n\r\n    action = create_location_choices({location: location, category: \"travel\", is_combat: true});\r\n\r\n    action_div.append(...action);\r\n\r\n    location_name_span.innerText = current_location.name;\r\n    if(current_location.types.length == 0) {\r\n        document.documentElement.style.setProperty('--location_name_div_width', '390px');\r\n    } else {\r\n        document.documentElement.style.setProperty('--location_name_div_width', '250px');\r\n    }\r\n\r\n    location_tooltip.innerText = current_location.getDescription();\r\n    location_tooltip.classList.add(\"location_tooltip\");\r\n    \r\n    document.getElementById(\"location_description_div\").innerText = current_location.getDescription();\r\n    create_location_types_display(current_location);\r\n}\r\n\r\nfunction update_location_kill_count(location) {\r\n    enemy_count_div.children[0].children[1].innerText = location.enemy_count - location.enemy_groups_killed % location.enemy_count + \" / \" + location.enemy_count;\r\n    clear_count_div.children[0].children[0].innerText = \"Clears: [\" + Math.floor(location.enemy_groups_killed / location.enemy_count) +\"]\";\r\n}\r\n\r\nfunction create_location_types_display(current_location){\r\n    for(let i = 0; i < current_location.types?.length; i++) {\r\n        const type_div = document.createElement(\"div\");\r\n\r\n        type_div.innerHTML = current_location.types[i].type + (current_location.types[i].stage>1?` ${\"I\".repeat(current_location.types[i].stage)}`:\"\");\r\n        type_div.classList.add(\"location_type_div\");\r\n\r\n        const type_tooltip = document.createElement(\"div\");\r\n        type_tooltip.innerHTML = location_types[current_location.types[i].type].stages[current_location.types[i].stage].description;\r\n        type_tooltip.classList.add(\"location_type_tooltip\");\r\n\r\n        const {type, stage} = current_location.types[i];\r\n        const {effects} = location_types[type].stages[stage];\r\n        if(Object.keys(effects || {}).length > 0) {\r\n            type_tooltip.innerHTML += `<br>`;\r\n\r\n            Object.keys(effects).forEach(stat => {\r\n                if(effects[stat].multiplier) {\r\n                    const base = effects[stat].multiplier;\r\n                    const actual = get_location_type_penalty(type, stage, stat, \"multiplier\");\r\n                    type_tooltip.innerHTML += `<br>${stat_names[stat]} x${Math.round(1000*actual)/1000}`;\r\n                    if(base != actual) {\r\n                        type_tooltip.innerHTML += ` [base: x${effects[stat].multiplier}]`;\r\n                    }\r\n                }\r\n                if(effects[stat].flat) {\r\n                    const base = effects[stat].flat;\r\n                    const actual = get_location_type_penalty(type, stage, stat, \"flat\");\r\n                    type_tooltip.innerHTML += `<br>${stat_names[stat]}: ${Math.round(1000*actual)/1000}`;\r\n                    if(base != actual) {\r\n                        type_tooltip.innerHTML += ` [base: ${effects[stat].flat}]`;\r\n                    }\r\n                }\r\n                \r\n            });\r\n\r\n        } //other effects to be done when/if they are added\r\n\r\n        type_div.appendChild(type_tooltip);\r\n        location_types_div.appendChild(type_div);\r\n    }\r\n}\r\n\r\nfunction update_displayed_location_types(current_location){\r\n    location_types_div.innerHTML = \"\";\r\n    create_location_types_display(current_location);\r\n}\r\n\r\nfunction open_crafting_window() {\r\n    action_div.style.display = \"none\";\r\n    document.getElementById(\"crafting_window\").style.display = \"block\";\r\n\r\n    if(!selected_crafting_category || !selected_crafting_subcategory) {\r\n        switch_crafting_recipes_page(\"crafting\");\r\n    }\r\n\r\n    update_displayed_crafting_recipes();\r\n}\r\n\r\nfunction close_crafting_window() {\r\n    action_div.style.display = \"block\";\r\n    document.getElementById(\"crafting_window\").style.display = \"none\";\r\n    update_displayed_normal_location(current_location);\r\n}\r\n\r\n/**\r\n * switches between main pages of crafting menu (crafting, alchemy, cooking, etc)\r\n * @param {String} category \r\n */\r\nfunction switch_crafting_recipes_page(category) {\r\n    selected_crafting_category = category;\r\n\r\n    //only show buttons for subcategories that exist\r\n    const elements = document.getElementById('crafting_subpage_buttons').children;\r\n    for (let i = 0; i < elements.length; i++) {\r\n        elements[i].style.display = recipes[category][elements[i].dataset.crafting_subcategory] ? \"\" : \"none\";\r\n    }\r\n\r\n    elements[0].click();\r\n\r\n    unexpand_displayed_recipes();\r\n}\r\n\r\n/**\r\n * switches between subpages of a crafting page (items-components-equipment)\r\n * @param {String} category \r\n * @param {String} subcategory \r\n */\r\nfunction switch_crafting_recipes_subpage(subcategory) {\r\n    selected_crafting_subcategory = subcategory;\r\n\r\n    const elements = document.querySelectorAll(`[data-crafting_category][data-crafting_subcategory]`);\r\n    for (let i = 0; i < elements.length; i++) {\r\n        if (elements[i].dataset.crafting_category == selected_crafting_category && elements[i].dataset.crafting_subcategory == selected_crafting_subcategory) {\r\n            elements[i].style.display = \"\";\r\n        }\r\n        else {\r\n            elements[i].style.display = \"none\";\r\n        }\r\n    }\r\n\r\n    unexpand_displayed_recipes();\r\n}\r\n\r\nfunction unexpand_displayed_recipes() {\r\n    const classes = [\"selected_recipe\", \"selected_component_list\", \"selected_component_category\"];\r\n    for(let i = 0; i < classes.length; i++) {\r\n        const elements = document.getElementsByClassName(classes[i]);\r\n        for(let j = 0 ; j < elements.length; j++) {\r\n            elements[j].classList.remove(classes[i]);\r\n        }\r\n    }\r\n}\r\n\r\nfunction get_recipe_page(category, subcategory) {\r\n    if (!crafting_pages[category]) {\r\n        crafting_pages[category] = {};\r\n    }\r\n    if (!crafting_pages[category][subcategory]) {\r\n        crafting_pages[category][subcategory] = document.querySelector(`[data-crafting_category=\"${category}\"][data-crafting_subcategory=\"${subcategory}\"]`);\r\n    }\r\n    if (!crafting_pages[category][subcategory]) {\r\n        let new_category = document.createElement('div');\r\n        new_category.classList.add(\"crafting_category\");\r\n        new_category.classList.add(\"crafting_recipe_list\");\r\n        new_category.dataset.crafting_category = category;\r\n        new_category.dataset.crafting_subcategory = subcategory;\r\n\r\n\r\n        crafting_pages[category][subcategory] = document.getElementById(\"recipe_categories\").appendChild(new_category);\r\n    }\r\n\r\n    return crafting_pages[category][subcategory];\r\n}\r\n\r\nfunction create_displayed_crafting_recipes() {\r\n    Object.keys(recipes).forEach(recipe_category => {\r\n        Object.keys(recipes[recipe_category]).forEach(recipe_subcategory => {\r\n            if (recipe_subcategory === \"items\") {\r\n                get_recipe_page(recipe_category, recipe_subcategory).innerHTML = \"\";\r\n            }\r\n            Object.keys(recipes[recipe_category][recipe_subcategory]).forEach(recipe => {\r\n                add_crafting_recipe_to_display({category: recipe_category, subcategory: recipe_subcategory, recipe_id: recipe});\r\n            });\r\n        });\r\n    });\r\n\r\n    update_item_recipe_visibility();\r\n}\r\n\r\nfunction add_crafting_recipe_to_display({category, subcategory, recipe_id}) {\r\n    const recipe = recipes[category][subcategory][recipe_id];\r\n    if(!recipe.is_unlocked) {\r\n        return;\r\n    }\r\n    const recipe_div = document.createElement(\"div\");\r\n\r\n    const recipe_name_span = document.createElement(\"span\");\r\n    recipe_name_span.innerHTML = recipe.name;\r\n\r\n    recipe_div.append(recipe_name_span);\r\n    recipe_div.classList.add(\"recipe_div\");\r\n    recipe_div.dataset.recipe_id = recipe_id;\r\n\r\n    if(subcategory === \"items\") {\r\n        recipe_name_span.classList.add(\"recipe_item_name\");\r\n        recipe_div.children[0].innerHTML = '<i class=\"material-icons icon\" style=\"visibility:hidden\"> keyboard_double_arrow_down </i>' + recipe_div.children[0].innerHTML;\r\n        //invisible icon added just so it properly matches in height and text position with recipes in other subcategories\r\n        if(!recipe.get_availability().available_ammount) {\r\n            recipe_div.classList.add(\"recipe_unavailable\");\r\n        }\r\n\r\n        recipe_div.addEventListener(\"click\", (event)=>{\r\n            if(event.target.classList.contains(\"recipe_item_name\") && !event.target.parentNode.classList.contains(\"recipe_unavailable\")) {\r\n                window.useRecipe(event.target);\r\n            } else if(event.target.classList.contains(\"craft_ammount_button\")) {\r\n                window.useRecipe(event.target.parentNode, Number(event.target.dataset.craft_ammount));\r\n            }\r\n        });\r\n\r\n        const craft_ammount_buttons = document.createElement(\"div\");\r\n        craft_ammount_buttons.classList.add(\"craft_ammount_buttons\");\r\n        \r\n        const button_5 = document.createElement(\"div\");\r\n        button_5.innerHTML = \"5\";\r\n        button_5.dataset.craft_ammount = 5;\r\n        button_5.classList.add(\"craft_ammount_button\");\r\n        craft_ammount_buttons.append(button_5);\r\n\r\n        const button_10 = document.createElement(\"div\");\r\n        button_10.innerHTML = \"10\";\r\n        button_10.dataset.craft_ammount = 10;\r\n        button_10.classList.add(\"craft_ammount_button\");\r\n        craft_ammount_buttons.append(button_10);\r\n\r\n        const button_all = document.createElement(\"div\");\r\n        button_all.innerHTML = \"all\";\r\n        button_all.dataset.craft_ammount = Infinity;\r\n        button_all.classList.add(\"craft_ammount_button\");\r\n\r\n        craft_ammount_buttons.append(button_all);\r\n\r\n        recipe_div.append(craft_ammount_buttons);\r\n\r\n        recipe_div.append(create_recipe_tooltip({category, subcategory, recipe_id}));\r\n    } else if(subcategory === \"components\") {\r\n        recipe_name_span.classList.add(\"recipe_name\");\r\n        recipe_div.children[0].innerHTML = '<i class=\"material-icons icon crafting_dropdown_icon\"> keyboard_double_arrow_down </i>' + recipe_div.children[0].innerHTML;\r\n        const material_selection = document.createElement(\"div\");\r\n        material_selection.classList.add(\"folded_material_list\");\r\n        recipe_div.addEventListener(\"click\", (event)=>{\r\n            if(event.target.classList.contains(\"recipe_name\") || event.target.classList.contains(\"crafting_dropdown_icon\")) {\r\n                window.updateDisplayedMaterialChoice({category, subcategory, recipe_id});\r\n                toggle_exclusive_class({element: recipe_div, class_name: \"selected_recipe\"});\r\n            } \r\n        });\r\n\r\n        recipe_div.append(material_selection);\r\n    } else if(recipe.recipe_type === \"component\" || recipe.recipe_type === \"componentless\") {\r\n        //component but from other category, which generally means clothing, or componentless, which currently means only capes\r\n        \r\n        recipe_name_span.classList.add(\"recipe_name\");\r\n        \r\n        if(recipe.item_type === \"Armor\") {\r\n            recipe_div.classList.add(\"clothing_recipe\");\r\n        }\r\n\r\n        recipe_div.children[0].innerHTML = '<i class=\"material-icons icon crafting_dropdown_icon\"> keyboard_double_arrow_down </i>' + recipe_div.children[0].innerHTML;\r\n        const material_selection = document.createElement(\"div\");\r\n        material_selection.classList.add(\"folded_material_list\");\r\n        recipe_div.addEventListener(\"click\", (event)=>{\r\n            if(event.target.classList.contains(\"recipe_name\") || event.target.classList.contains(\"crafting_dropdown_icon\")) {\r\n\r\n                remove_class_from_all(\"selected_component_list\");\r\n                remove_class_from_all(\"selected_component_category\");\r\n                \r\n                window.updateDisplayedMaterialChoice({category, subcategory, recipe_id});\r\n                toggle_exclusive_class({element: recipe_div, class_name: \"selected_recipe\"});\r\n            } \r\n        });\r\n\r\n        recipe_div.append(material_selection);\r\n    } else if(subcategory === \"equipment\") {\r\n        if(recipe.item_type === \"Armor\") {\r\n            recipe_div.classList.add(\"armor_recipe\");\r\n        } else if(recipe.item_type === \"Weapon\") {\r\n            recipe_div.classList.add(\"weapon_recipe\");\r\n        } else if(recipe.item_type === \"Shield\") {\r\n            recipe_div.classList.add(\"shield_recipe\");\r\n        } else {\r\n            console.warn(`Recipe \"${category}\" -> \"${subcategory}\" -> \"${recipe_id}\" has wrong type of resulting item (\"${recipe.item_type}\")`)\r\n        }\r\n\r\n        recipe_name_span.classList.add(\"recipe_name\");\r\n        \r\n        recipe_div.children[0].innerHTML = '<i class=\"material-icons icon crafting_dropdown_icon\"> keyboard_double_arrow_down </i>' +  recipe_div.children[0].innerHTML;\r\n\r\n        const component_selection_1 = document.createElement(\"div\"); //weapon head or internal armor\r\n        component_selection_1.innerHTML = `<span class=\"crafting_selection\"><i class=\"material-icons icon subcrafting_dropdown_icon\"> keyboard_double_arrow_down </i>Select a [${recipe.components[0]}]</span>`;\r\n        \r\n        const component_1_list = document.createElement(\"div\");\r\n        component_1_list.classList.add(\"folded_crafting_selection\");\r\n        component_selection_1.appendChild(component_1_list);\r\n\r\n        const component_selection_2 = document.createElement(\"div\"); //weapon handle or external armor\r\n        component_selection_2.innerHTML = `<span class=\"crafting_selection\"><i class=\"material-icons icon subcrafting_dropdown_icon\"> keyboard_double_arrow_down </i>Select a [${recipe.components[1]}]</span>`;\r\n        \r\n        const component_2_list = document.createElement(\"div\");\r\n        component_2_list.classList.add(\"folded_crafting_selection\");\r\n        component_selection_2.appendChild(component_2_list);\r\n\r\n        const component_selections = document.createElement(\"div\");\r\n        component_selections.append(component_selection_1);\r\n        component_selections.append(component_selection_2);\r\n\r\n        recipe_div.addEventListener(\"click\", (event)=>{\r\n            if(event.target.classList.contains(\"recipe_name\") || event.target.classList.contains(\"crafting_dropdown_icon\")) {\r\n\r\n                remove_class_from_all(\"selected_component_list\");\r\n                remove_class_from_all(\"selected_component_category\");\r\n                \r\n                toggle_exclusive_class({element: recipe_div, class_name: \"selected_recipe\"});\r\n\r\n                window.updateDisplayedComponentChoice({category, subcategory, recipe_id});\r\n\r\n                update_recipe_tooltip({category, subcategory, recipe_id, components: []});\r\n            }\r\n        });\r\n\r\n        component_selection_1.parentNode.children[0].addEventListener(\"click\", (event)=>{\r\n            //unfold a list for selection; its content already loaded by a different function\r\n            if(event.target.classList.contains(\"crafting_selection\") || event.target.classList.contains(\"subcrafting_dropdown_icon\")) {\r\n                component_selection_1.children[1].classList.toggle(\"selected_component_list\");\r\n                component_selection_1.children[0].classList.toggle(\"selected_component_category\");\r\n                if(recipe_div.querySelectorAll(\".folded_crafting_selection\").item(0).lastChild \r\n                    && !is_element_above_x(recipe_div.querySelectorAll(\".folded_crafting_selection\").item(0).lastChild, document.getElementById(\"exit_crafting_button\"))) \r\n                {\r\n                    recipe_div.querySelectorAll(\".folded_crafting_selection\").item(0).lastChild.scrollIntoView({block: \"end\", inline: \"nearest\"});\r\n                }\r\n            }\r\n        });\r\n        component_selection_2.parentNode.children[1].addEventListener(\"click\", (event)=>{\r\n            //unfold a list for selection; its content already loaded by a different function\r\n            if(event.target.classList.contains(\"crafting_selection\")  || event.target.classList.contains(\"subcrafting_dropdown_icon\")) {\r\n                component_selection_2.children[1].classList.toggle(\"selected_component_list\");\r\n                component_selection_2.children[0].classList.toggle(\"selected_component_category\");\r\n                if(!is_element_above_x(recipe_div.querySelector(\".recipe_creation_button\"), document.getElementById(\"exit_crafting_button\"))) {\r\n                    recipe_div.querySelector(\".recipe_creation_button\").scrollIntoView({block: \"end\", inline: \"nearest\"});\r\n                }\r\n            }\r\n        });\r\n\r\n        const accept_recipe_button = document.createElement(\"div\");\r\n        accept_recipe_button.innerHTML = \"<span class='recipe_creation_span'>Create</span>\";\r\n        accept_recipe_button.classList.add(\"recipe_creation_button\");\r\n\r\n        const craft_ammount_buttons = document.createElement(\"div\");\r\n        craft_ammount_buttons.classList.add(\"craft_ammount_buttons\");\r\n        \r\n        const button_5 = document.createElement(\"div\");\r\n        button_5.innerHTML = \"5\";\r\n        button_5.dataset.craft_ammount = 5;\r\n        button_5.classList.add(\"craft_ammount_button\");\r\n        craft_ammount_buttons.append(button_5);\r\n\r\n        const button_10 = document.createElement(\"div\");\r\n        button_10.innerHTML = \"10\";\r\n        button_10.dataset.craft_ammount = 10;\r\n        button_10.classList.add(\"craft_ammount_button\");\r\n        craft_ammount_buttons.append(button_10);\r\n\r\n        const button_all = document.createElement(\"div\");\r\n        button_all.innerHTML = \"all\";\r\n        button_all.dataset.craft_ammount = Infinity;\r\n        button_all.classList.add(\"craft_ammount_button\");\r\n\r\n        craft_ammount_buttons.append(button_all);\r\n\r\n        accept_recipe_button.append(craft_ammount_buttons);\r\n\r\n        accept_recipe_button.addEventListener(\"click\", (event)=>{\r\n            if(event.target.classList.contains(\"recipe_creation_button\")) {\r\n                window.useRecipe(event.target);\r\n            } else if(!event.target.classList.contains(\"craft_ammount_button\")) {\r\n                window.useRecipe(event.target.parentNode);\r\n            } else {\r\n                window.useRecipe(event.target.parentNode.parentNode, Number(event.target.dataset.craft_ammount));\r\n            }\r\n        });\r\n\r\n        recipe_div.append(component_selections);\r\n        recipe_div.append(accept_recipe_button);\r\n        accept_recipe_button.append(create_recipe_tooltip({category, subcategory, recipe_id, components: []}));\r\n    } else {\r\n        throw new Error(`No such crafting subcategory as \"${subcategory}\"`);\r\n    }\r\n\r\n    get_recipe_page(category, subcategory).appendChild(recipe_div);\r\n}\r\n\r\n/**\r\n * updates all displayed recipes; \r\n * needs to be called whenever something is crafted (in case some recipe became unavailable due to lack of materials) and/or whenever a crafting-related skill levels up\r\n */\r\nfunction update_displayed_crafting_recipes() {\r\n    Object.keys(recipes).forEach(recipe_category => {\r\n        Object.keys(recipes[recipe_category]).forEach(recipe_subcategory => {\r\n            Object.keys(recipes[recipe_category][recipe_subcategory]).forEach(recipe => {\r\n                if(recipes[recipe_category][recipe_subcategory][recipe].is_unlocked){\r\n                    if(crafting_pages[recipe_category][recipe_subcategory].querySelector(`[data-recipe_id=\"${recipe}\"]`)) {\r\n                        update_displayed_crafting_recipe({category: recipe_category, subcategory: recipe_subcategory, recipe_id: recipe});\r\n                    } else {\r\n                        add_crafting_recipe_to_display({category: recipe_category, subcategory: recipe_subcategory, recipe_id: recipe});\r\n                    }\r\n                }\r\n            })\r\n        })\r\n    });\r\n}\r\n\r\n/**\r\n * updates description and display color, based on resource availability and skill lvl\r\n */\r\nfunction update_displayed_crafting_recipe({category, subcategory, recipe_id}) {\r\n    const recipe_div = crafting_pages[category][subcategory].querySelector(`[data-recipe_id=\"${recipe_id}\"]`);\r\n    const recipe = recipes[category][subcategory][recipe_id];\r\n\r\n    if(subcategory === \"items\") {\r\n        if(recipe.get_availability().available_ammount) {\r\n            recipe_div.classList.remove(\"recipe_unavailable\");\r\n        } else {\r\n            recipe_div.classList.add(\"recipe_unavailable\");\r\n        }\r\n        update_recipe_tooltip({category, subcategory, recipe_id});\r\n    } else if(subcategory === \"components\" || recipe.recipe_type === \"component\") {\r\n        update_recipe_tooltip({category, subcategory, recipe_id});\r\n    } else if(subcategory === \"equipment\") {\r\n        //update_recipe_tooltip({category, subcategory, recipe_id, material: null, components: []});\r\n        //shouldn't actually be needed as tooltip already updates when opening recipe and when selecting components\r\n    } else {\r\n        console.error(`No such crafting subcategory as \"${subcategory}\"`);\r\n    }\r\n}\r\n\r\n/**\r\n * creates a tooltip for the >final result<\r\n */\r\nfunction create_recipe_tooltip({category, subcategory, recipe_id, material, components}) {\r\n    const recipe = recipes[category][subcategory][recipe_id];\r\n    const tooltip = document.createElement(\"div\");\r\n    tooltip.classList.add(\"recipe_tooltip\");\r\n    if(subcategory === \"items\") {\r\n        tooltip.innerHTML = create_recipe_tooltip_content({category, subcategory, recipe_id});\r\n        tooltip.classList.add(\"items_recipe_tooltip\");\r\n    } else if(subcategory === \"components\" || recipe.recipe_type === \"component\") {\r\n        if(!material) {\r\n            throw new Error(`Component recipes require passing a material, but recipe \"${category}\" -> \"${subcategory}\" -> \"${recipe_id}\" had none!`);\r\n        }\r\n        tooltip.innerHTML = create_recipe_tooltip_content({category, subcategory, recipe_id, material});\r\n        tooltip.classList.add(\"component_recipe_tooltip\");\r\n    } else if(subcategory === \"equipment\") {\r\n        tooltip.innerHTML = create_recipe_tooltip_content({category, subcategory, recipe_id, material, components});\r\n        tooltip.classList.add(\"equipment_recipe_tooltip\");\r\n    } else {\r\n        console.error(`No such crafting subcategory as \"${subcategory}\"`);\r\n    }\r\n    return tooltip;\r\n}\r\n\r\nfunction update_item_recipe_tooltips() {\r\n    Object.keys(recipes).forEach(recipe_category => {\r\n        Object.keys(recipes[recipe_category]).forEach(recipe_subcategory => {\r\n            if(recipe_subcategory === \"items\") {\r\n                Object.keys(recipes[recipe_category][recipe_subcategory]).forEach(recipe => {\r\n                    if(recipes[recipe_category][recipe_subcategory][recipe].is_unlocked){\r\n                        update_recipe_tooltip({category: recipe_category, subcategory: \"items\", recipe_id: recipe});\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\nfunction update_recipe_tooltip({category, subcategory, recipe_id, components}) {\r\n    const recipe = recipes[category][subcategory][recipe_id];\r\n    if(subcategory === \"items\") {\r\n        const tooltip = crafting_pages[category][subcategory].querySelector(`[data-recipe_id=\"${recipe_id}\"]`).querySelector(`.${subcategory}_recipe_tooltip`);\r\n\r\n        tooltip.innerHTML = create_recipe_tooltip_content({category, subcategory, recipe_id});\r\n    } else if(subcategory === \"components\" || recipe.recipe_type === \"component\" || recipe.recipe_type === \"componentless\") {\r\n        const material_selections_div = crafting_pages[category][subcategory].querySelector(`[data-recipe_id='${recipe_id}']`).children[1];\r\n        for(let i = 0; i < material_selections_div.children.length; i++) {\r\n            const tooltip = material_selections_div.children[i].querySelector(`[data-recipe_id=\"${recipe_id}\"]`)?.querySelector(`.${subcategory}_recipe_tooltip`);\r\n            if(!tooltip) {\r\n                return;\r\n            }\r\n            const material_key = material_selections_div.children[i].dataset.item_key;\r\n            const {id} = JSON.parse(material_key);\r\n            const material_recipe = recipe.materials.filter(material => material.material_id === id);\r\n            \r\n            tooltip.innerHTML = create_recipe_tooltip_content({category, subcategory, recipe_id, material: material_recipe[0]});\r\n        }\r\n    } else if(subcategory === \"equipment\") {\r\n            const tooltip = crafting_pages[category][subcategory].querySelector(`[data-recipe_id=\"${recipe_id}\"]`)?.querySelector(`.${subcategory}_recipe_tooltip`);\r\n            if(!tooltip) {\r\n                return;\r\n            }\r\n            tooltip.innerHTML = create_recipe_tooltip_content({category, subcategory, recipe_id, components});\r\n    } else {\r\n        console.error(`No such crafting subcategory as \"${subcategory}\"`);\r\n    }\r\n}\r\n\r\nfunction create_recipe_tooltip_content({category, subcategory, recipe_id, material, components}) {\r\n    const recipe = recipes[category][subcategory][recipe_id];\r\n    const station_tier = current_location?.crafting?.tiers[category] || 1;\r\n    let tooltip = \"\";\r\n    if(subcategory === \"items\") {\r\n        const success_chance = Math.round(100*recipe.get_success_chance(station_tier));\r\n        tooltip += `Success chance: <b><span style=\"color:${success_chance > 74?\"lime\":success_chance>49?\"yellow\":success_chance>24?\"orange\":\"red\"}\">${success_chance}%</span></b><br><br>Materials required:<br>`;\r\n        for(let i = 0; i < recipe.materials.length; i++) {\r\n            if(recipe.materials[i].material_id) {\r\n                const key = item_templates[recipe.materials[i].material_id].getInventoryKey();\r\n                if(character.inventory[key]?.count >= recipe.materials[i].count) {\r\n                    tooltip += `<span style=\"color:lime\"><b>${item_templates[recipe.materials[i].material_id].getName()} x${character.inventory[key]?.count || 0}/${recipe.materials[i].count}</b></span><br>`;\r\n                } else {\r\n                    tooltip += `<span style=\"color:red\"><b>${item_templates[recipe.materials[i].material_id].getName()} x${character.inventory[key]?.count || 0}/${recipe.materials[i].count}</b></span><br>`;\r\n                }\r\n            } else if(recipe.materials[i].material_type) {\r\n                //check if mat type available, grab all that fit\r\n\r\n                let mats = [];\r\n                Object.keys(character.inventory).forEach(key => {\r\n                    if(character.inventory[key].item.material_type === recipe.materials[i].material_type) {\r\n                        mats.push(character.inventory[key]);\r\n                    }\r\n                });\r\n\r\n                mats = mats.sort((a,b) => a.item.getBaseValue()-b.item.getBaseValue());\r\n                let any_available = false;\r\n                let mat_list = \"\";\r\n                for(let j = 0; j < mats.length; j++) {\r\n                    if(mats[j].count >= recipe.materials[i].count) {\r\n                        any_available = true;\r\n                        mat_list += `<span style=\"color:lime\"><b>${mats[j].item.getName()} x${mats[j].count || 0}/${recipe.materials[i].count}</b></span><br>`;\r\n                    } else {\r\n                        mat_list  += `<span style=\"color:red\"><b>${mats[j].item.getName()} x${mats[j].count || 0}/${recipe.materials[i].count}</b></span><br>`;\r\n                    }\r\n                }\r\n\r\n                if(mats.length > 0) {\r\n                    if(any_available) {\r\n                        tooltip+=`<span style=\"color:lime\"><b>Any ${recipe.materials[i].material_type} x${recipe.materials[i].count}:</b></span><br>`;\r\n                    } else {\r\n                        tooltip+=`<span style=\"color:red\"><b>Any ${recipe.materials[i].material_type} x${recipe.materials[i].count}:</b></span><br>`;\r\n                    }\r\n                    tooltip+=`<div class=\"crafting_tooltip_mat_list\">${mat_list}</div>`;\r\n\r\n                } else {\r\n                    tooltip+=`<span style=\"color:red\"><b>Any ${recipe.materials[i].material_type} x${recipe.materials[i].count}:</b></span><br>`;\r\n                }\r\n            }\r\n        }\r\n        const xp_val_1 = get_recipe_xp_value({category, subcategory, recipe_id});\r\n        tooltip += `<br>XP value: ${xp_val_1}`;\r\n        tooltip += `<br>Result:<br><div class=\"recipe_result\">${create_item_tooltip_content({item: item_templates[recipe.getResult().result_id], options: {skip_quality: true, anchor_tooltip: true}})}</div>`;\r\n    } else if(subcategory === \"components\"  || recipe.recipe_type === \"component\") {\r\n        //some component\r\n\r\n        tooltip += `Material required:<br>`;\r\n        if(character.inventory[item_templates[material.material_id].getInventoryKey()]?.count >= material.count) {\r\n            tooltip += `<span style=\"color:lime\"><b>${item_templates[material.material_id].getName()} x${character.inventory[item_templates[material.material_id].getInventoryKey()]?.count || 0}/${material.count}</b></span><br>`;\r\n        } else {\r\n            tooltip += `<span style=\"color:red\"><b>${item_templates[material.material_id].getName()} x${character.inventory[item_templates[material.material_id].getInventoryKey()]?.count || 0}/${material.count}</b></span><br>`;\r\n        }\r\n\r\n        const quality_range = recipe.get_quality_range(station_tier - item_templates[material.result_id].component_tier);\r\n\r\n        const xp_val_1 = get_recipe_xp_value({category, subcategory, recipe_id, material_count: material.count, result_tier: item_templates[material.result_id].component_tier, rarity_multiplier: rarity_multipliers[getItemRarity(quality_range[0])]});\r\n        const xp_val_2 = get_recipe_xp_value({category, subcategory, recipe_id, material_count: material.count, result_tier: item_templates[material.result_id].component_tier, rarity_multiplier: rarity_multipliers[getItemRarity(quality_range[1])]});\r\n\r\n        tooltip += `<br>XP value: ${xp_val_1} - ${xp_val_2}<br>`;\r\n        tooltip += `<br>Result:<br><div class=\"recipe_result\">${create_item_tooltip_content({item: item_templates[material.result_id], options: {quality: quality_range}})}</div>`;\r\n    } else if(subcategory === \"equipment\") {\r\n        if(!components) {\r\n            //it's a componentless equipment recipe\r\n            tooltip += `Material required:<br>`;\r\n            if(character.inventory[item_templates[material.material_id].getInventoryKey()]?.count >= material.count) {\r\n                tooltip += `<span style=\"color:lime\"><b>${item_templates[material.material_id].getName()} x${character.inventory[item_templates[material.material_id].getInventoryKey()]?.count || 0}/${material.count}</b></span><br>`;\r\n            } else {\r\n                tooltip += `<span style=\"color:red\"><b>${item_templates[material.material_id].getName()} x${character.inventory[item_templates[material.material_id].getInventoryKey()]?.count || 0}/${material.count}</b></span><br>`;\r\n            }\r\n\r\n            const quality_range = recipe.get_quality_range(station_tier - item_templates[material.result_id].item_tier);\r\n            const xp_val_1 = get_recipe_xp_value({category, subcategory, recipe_id, material_count: material.count, result_tier: item_templates[material.result_id].item_tier, rarity_multiplier: rarity_multipliers[getItemRarity(quality_range[0])]});\r\n            const xp_val_2 = get_recipe_xp_value({category, subcategory, recipe_id, material_count: material.count, result_tier: item_templates[material.result_id].item_tier, rarity_multiplier: rarity_multipliers[getItemRarity(quality_range[1])]});\r\n            tooltip += `<br>XP value: ${xp_val_1} - ${xp_val_2}<br>`;\r\n            tooltip += `<br>Result:<br><div class=\"recipe_result\">${create_item_tooltip_content({item: item_templates[material.result_id], options: {quality: quality_range}})}</div>`;\r\n        } else if(components.length < 2) {\r\n            tooltip += `Result:<br><div class=\"recipe_result\">Select one component from each category</div>`;\r\n        } else if(components.length == 2) {\r\n            let item = \"\";\r\n            \r\n            if(recipe.item_type === \"Weapon\") {\r\n                item = new Weapon(\r\n                    {\r\n                        components: {\r\n                            head: components[0].item.id,\r\n                            handle: components[1].item.id,\r\n                        },\r\n                    }\r\n                );\r\n            } else if(recipe.item_type === \"Armor\") {\r\n                item = new Armor(\r\n                    {\r\n                        components: {\r\n                            internal: components[0].item.id,\r\n                            external: components[1].item.id,\r\n                        },\r\n                    }\r\n                );\r\n            } else if(recipe.item_type === \"Shield\") {\r\n                item = new Shield(\r\n                    {\r\n                        components: {\r\n                            shield_base: components[0].item.id,\r\n                            handle: components[1].item.id,\r\n                        },\r\n                    }\r\n                );\r\n            } else {\r\n                throw new Error(`Recipe \"${category}\" -> \"${subcategory}\" -> \"${recipe_id}\" has an incorrect item type \"${recipe.item_type}\"`)\r\n            }\r\n            const quality_range = recipe.get_quality_range(recipe.get_component_quality_weighted(components[0].item, components[1].item), (station_tier-Math.max(components[0].item.component_tier, components[1].item.component_tier)) || 0);\r\n            const xp_val_1 = get_recipe_xp_value({category, subcategory, recipe_id, selected_components: [item_templates[components[0].item.id], item_templates[components[1].item.id]], rarity_multiplier: rarity_multipliers[getItemRarity(quality_range[0])]});\r\n            const xp_val_2 = get_recipe_xp_value({category, subcategory, recipe_id, selected_components: [item_templates[components[0].item.id], item_templates[components[1].item.id]], rarity_multiplier: rarity_multipliers[getItemRarity(quality_range[1])]});\r\n            tooltip += `<br>XP value: ${xp_val_1} - ${xp_val_2}<br>`;\r\n            tooltip += `Result:<br><div class=\"recipe_result\">${create_item_tooltip_content({item, options: {quality: quality_range}})}</div>`;\r\n        } else {\r\n            throw new Error(`Somehow recipe \"${category}\" -> \"${subcategory}\" -> \"${recipe_id}\" received more components than there should be (${components.length} instead of 2)`)\r\n        }\r\n    } else {\r\n        console.error(`No such crafting subcategory as \"${subcategory}\"`);\r\n    }\r\n\r\n    return tooltip;\r\n}\r\n\r\n/**\r\n * updates the list of selectable components for equipment crafting;\r\n * generally called for the recipe that was just used\r\n * component_keys is used for automatically selecting two comps\r\n */\r\nfunction update_displayed_component_choice({category, recipe_id, component_keys = {}}) {\r\n    const recipe_div = crafting_pages[category][\"equipment\"].querySelector(`[data-recipe_id=\"${recipe_id}\"]`);\r\n    const recipe = recipes[category][\"equipment\"][recipe_id];\r\n\r\n    const component_selections_div = crafting_pages[category][\"equipment\"].querySelector(`[data-recipe_id='${recipe_id}']`).children[1].children;\r\n    \r\n    component_selections_div[0].children[1].innerHTML = \"\";\r\n    component_selections_div[1].children[1].innerHTML = \"\";\r\n\r\n    const components = [];\r\n    components.push(Object.values(character.inventory).filter(item=>{\r\n        return recipe.components[0] === item.item.component_type;\r\n    }));\r\n\r\n    components.push(Object.values(character.inventory).filter(item=>{\r\n        return recipe.components[1] === item.item.component_type;\r\n    }));\r\n\r\n    for(let i = 0; i < 2; i++) {\r\n        for(let j = 0; j < components[i].length; j++) {\r\n            const item_div = document.createElement(\"div\");\r\n            item_div.innerHTML = `<i class=\"material-icons icon selected_component_icon\"> check </i>${components[i][j].item.name}, ${components[i][j].item.quality}%, x${components[i][j].count}`;\r\n            item_div.classList.add(\"selectable_component\");\r\n            item_div.dataset.item_key = components[i][j].item.getInventoryKey();\r\n            item_div.dataset.item_quality = components[i][j].item.quality;\r\n            item_div.dataset.item_name = components[i][j].item.getName();\r\n            item_div.dataset.component_tier = components[i][j].item.component_tier;\r\n            item_div.appendChild(create_item_tooltip(components[i][j].item, {class_name: \"recipe_tooltip\"}));\r\n            \r\n            item_div.addEventListener(\"click\", ()=>{\r\n                toggle_exclusive_class({element: item_div, siblings_only: true, class_name: \"selected_component\"});\r\n                const components = [];\r\n                const component_1_key = recipe_div.children[1].children[0].children[1].querySelector(\".selected_component\")?.dataset.item_key;\r\n                if(component_1_key) {\r\n                    components.push(character.inventory[component_1_key]);\r\n                }\r\n\r\n                const component_2_key = recipe_div.children[1].children[1].children[1].querySelector(\".selected_component\")?.dataset.item_key;\r\n                if(component_2_key) {\r\n                    components.push(character.inventory[component_2_key]);\r\n                }\r\n                update_recipe_tooltip({category, subcategory: \"equipment\", recipe_id, components});\r\n            });\r\n                \r\n            component_selections_div[i].children[1].appendChild(item_div);\r\n\r\n            if(component_keys[item_div.dataset.item_key]) {\r\n                item_div.click();\r\n            }\r\n        }\r\n    }\r\n    if(!is_element_above_x(recipe_div.querySelector(\".recipe_creation_button\"), document.getElementById(\"exit_crafting_button\"))) {\r\n        recipe_div.querySelector(\".recipe_creation_button\").scrollIntoView({block: \"end\", inline: \"nearest\"});\r\n    }\r\n    \r\n    for(let i = 0; i < 2; i++) {\r\n        [...component_selections_div[i].children[1].children].sort((a,b) => {\r\n            if(Number.parseInt(a.dataset.component_tier) > Number.parseInt(b.dataset.component_tier)) {\r\n                return -1;\r\n            } else if (Number.parseInt(a.dataset.component_tier) < Number.parseInt(b.dataset.component_tier)) {\r\n                return 1;\r\n            } else if(a.dataset.item_name > b.dataset.item_name) {\r\n                return 1;\r\n            } else if(a.dataset.item_name < b.dataset.item_name) {\r\n                return -1;\r\n            } else if(Number.parseInt(a.dataset.item_quality) > Number.parseInt(b.dataset.item_quality)) {\r\n                return -1;\r\n            } else {\r\n                return 1;\r\n            }\r\n\r\n        }).forEach(node=>component_selections_div[i].children[1].appendChild(node));\r\n    }\r\n}\r\n\r\n/**\r\n * updates the list of selectable materials for component crafting;\r\n * displays only the materials available in inventory; those that are in too low number are grayed out and unselectable\r\n */\r\nfunction update_displayed_material_choice({category, subcategory, recipe_id, refreshing}) {\r\n    const recipe = recipes[category][subcategory][recipe_id];\r\n\r\n    const material_selections_div = crafting_pages[category][subcategory].querySelector(`[data-recipe_id='${recipe_id}']`).children[1];\r\n    \r\n    material_selections_div.innerHTML = \"\";\r\n\r\n    const materials = Object.values(character.inventory).filter(item=>{\r\n        return recipe.materials.filter(material => material.material_id === item.item?.id).length > 0;\r\n    });\r\n\r\n    for(let i = 0; i < materials.length; i++) {\r\n        const material_recipe = recipe.materials.filter(material => material.material_id === materials[i].item.id)[0];\r\n        const item_div = document.createElement(\"div\");\r\n        const name_span = document.createElement(\"span\");\r\n        name_span.innerHTML = `<i class=\"material-icons icon selected_material_icon\"> check </i>${item_templates[material_recipe.result_id].getName()}`;\r\n        name_span.classList.add(\"recipe_comp_name\");\r\n        item_div.append(name_span);\r\n        item_div.classList.add(\"selectable_material\");\r\n        item_div.dataset.item_key = materials[i].item.getInventoryKey();\r\n\r\n        if(material_recipe.count <= materials[i].count) {\r\n            item_div.addEventListener(\"click\", (event)=>{\r\n                item_div.classList.add(\"selected_material\");\r\n                if(event.target.classList.contains(\"selectable_material\")) {\r\n                    window.useRecipe(event.target.parentNode);\r\n                } else if(!event.target.classList.contains(\"craft_ammount_button\")) {\r\n                    window.useRecipe(event.target.parentNode.parentNode);\r\n                } else{\r\n                    window.useRecipe(event.target.parentNode.parentNode.parentNode, Number(event.target.dataset.craft_ammount));\r\n                }\r\n                item_div.classList.remove(\"selected_material\"); //this is so stupid\r\n            });\r\n        } else {\r\n            item_div.classList.add(\"recipe_unavailable\");\r\n        }\r\n\r\n        const craft_ammount_buttons = document.createElement(\"div\");\r\n        craft_ammount_buttons.classList.add(\"craft_ammount_buttons\");\r\n        \r\n        const button_5 = document.createElement(\"div\");\r\n        button_5.innerHTML = \"5\";\r\n        button_5.dataset.craft_ammount = 5;\r\n        button_5.classList.add(\"craft_ammount_button\");\r\n        craft_ammount_buttons.append(button_5);\r\n\r\n        const button_10 = document.createElement(\"div\");\r\n        button_10.innerHTML = \"10\";\r\n        button_10.dataset.craft_ammount = 10;\r\n        button_10.classList.add(\"craft_ammount_button\");\r\n        craft_ammount_buttons.append(button_10);\r\n\r\n        const button_all = document.createElement(\"div\");\r\n        button_all.innerHTML = \"all\";\r\n        button_all.dataset.craft_ammount = Infinity;\r\n        button_all.classList.add(\"craft_ammount_button\");\r\n\r\n        craft_ammount_buttons.append(button_all);\r\n\r\n        item_div.append(craft_ammount_buttons);\r\n\r\n        item_div.append(create_recipe_tooltip({category, subcategory, recipe_id, material: material_recipe}));\r\n        material_selections_div.appendChild(item_div);\r\n    }\r\n    if(!refreshing) {\r\n        material_selections_div.lastChild?.scrollIntoView();\r\n    }\r\n}\r\n\r\nfunction update_item_recipe_visibility() {\r\n    Object.keys(recipes).forEach(recipe_category => {\r\n        Object.keys(recipes[recipe_category]).forEach(recipe_subcategory => {\r\n            if(recipe_subcategory !== \"items\") {\r\n                //no need to deal with other recipe types as they would be folded and will be reloaded on unfolding\r\n                return;\r\n            }\r\n            Object.keys(recipes[recipe_category][recipe_subcategory]).forEach(recipe => {\r\n                if(!recipes[recipe_category][recipe_subcategory][recipe].is_unlocked) {\r\n                    return;\r\n                }\r\n                const recipe_div = crafting_pages[recipe_category][recipe_subcategory].querySelector(`[data-recipe_id=\"${recipe}\"`);\r\n                if(!recipes[recipe_category][recipe_subcategory][recipe].get_availability().available_ammount) {\r\n                    recipe_div.classList.add(\"recipe_unavailable\");\r\n                } else {\r\n                    recipe_div.classList.remove(\"recipe_unavailable\");\r\n                }\r\n            });\r\n        })\r\n    });\r\n}\r\n\r\nfunction create_location_action_tooltip(location_action) {\r\n    const action_tooltip = document.createElement(\"div\");\r\n    action_tooltip.classList.add(\"job_tooltip\",\"location_action_tooltip\");\r\n    action_tooltip.innerText = location_action.description;\r\n    if(location_action.keep_progress) {\r\n        action_tooltip.innerText += \"\\n\\nPausing this task will not waste your progress\";\r\n    }\r\n\r\n    return action_tooltip;\r\n}\r\n\r\n/**\r\n * \r\n * @param {LocationActivity} location_activity \r\n */\r\nfunction create_gathering_tooltip(location_activity) {\r\n    const gathering_tooltip = document.createElement(\"div\");\r\n    gathering_tooltip.classList.add(\"job_tooltip\");\r\n    gathering_tooltip.dataset.job_tooltip = location_activity.activity_id;\r\n\r\n    const {gathering_time_needed, gained_resources} = location_activity.getActivityEfficiency();\r\n\r\n    let skill_names = \"\";\r\n    for(let i = 0; i < activities[location_activity.activity_name].base_skills_names.length; i++) {\r\n        skill_names += skills[activities[location_activity.activity_name].base_skills_names[i]].name();\r\n    }\r\n\r\n    if(location_activity.gained_resources.scales_with_skill) {\r\n        gathering_tooltip.innerHTML = `<span class=\"activity_efficiency_info\">Efficiency scaling:<br>\"${skill_names}\" skill lvl ${location_activity.gained_resources.skill_required[0]} to ${location_activity.gained_resources.skill_required[1]}</span><br><br>`;\r\n    }\r\n\r\n    gathering_tooltip.innerHTML += `Every ${format_time({time: {minutes: gathering_time_needed}, round: false})}, chance to find:`;\r\n    for(let i = 0; i < gained_resources.length; i++) {\r\n        const name = item_templates[gained_resources[i].name].getName();\r\n        gathering_tooltip.innerHTML += `<br>x${gained_resources[i].count[0]===gained_resources[i].count[1]?gained_resources[i].count[0]:`${gained_resources[i].count[0]}-${gained_resources[i].count[1]}`} \"${name}\" at ${Math.round(100*gained_resources[i].chance)}%`;\r\n    }\r\n\r\n    return gathering_tooltip;\r\n}\r\n\r\n/**\r\n * Updates gathering tooltip, both for location view and for an ongoing gathering\r\n * @param {LocationActivity} activity \r\n * @returns \r\n */\r\nfunction update_gathering_tooltip(activity) {\r\n    let parent = document.querySelector(`[data-activity=\"${activity.activity_id}\"]`);\r\n    let gathering_tooltip;\r\n    if(parent) {\r\n        gathering_tooltip = parent.getElementsByClassName(\"job_tooltip\")[0];\r\n    } else {\r\n        gathering_tooltip = document.getElementById(\"gathering_progress_bar_max\")?.querySelector(`[data-job_tooltip=\"${activity.activity_id}\"]`);\r\n    }\r\n\r\n    if(!gathering_tooltip) {\r\n        return;\r\n    }\r\n    \r\n    const {gathering_time_needed, gained_resources} = activity.getActivityEfficiency();\r\n\r\n    let skill_names = \"\";\r\n    for(let i = 0; i < activities[activity.activity_name].base_skills_names.length; i++) {\r\n        skill_names += skills[activities[activity.activity_name].base_skills_names[i]].name();\r\n    }\r\n\r\n    if(activity.gained_resources.scales_with_skill) {\r\n        gathering_tooltip.innerHTML = `<span class=\"activity_efficiency_info\">Efficiency scaling:<br>\"${skill_names}\" skill lvl ${activity.gained_resources.skill_required[0]} to ${activity.gained_resources.skill_required[1]}</span><br><br>`;\r\n    }\r\n    gathering_tooltip.innerHTML += `Every ${format_working_time(gathering_time_needed)}, chance to find:`;\r\n    for(let i = 0; i < gained_resources.length; i++) {\r\n        gathering_tooltip.innerHTML += `<br>x${gained_resources[i].count[0]===gained_resources[i].count[1]?gained_resources[i].count[0]:`${gained_resources[i].count[0]}-${gained_resources[i].count[1]}`} \"${gained_resources[i].name}\" at ${Math.round(100*gained_resources[i].chance)}%`;\r\n    }\r\n}\r\n\r\nfunction update_displayed_health() { //call it when using healing items, resting or getting hit\r\n    current_health_value_div.innerText = Math.ceil(character.stats.full.health) + \"/\" + Math.ceil(character.stats.full.max_health) + \" hp\";\r\n    current_health_bar.style.width = (character.stats.full.health*100/character.stats.full.max_health).toString() +\"%\";\r\n}\r\nfunction update_displayed_stamina() { //call it when eating, resting or fighting\r\n    current_stamina_value_div.innerText = Math.round(character.stats.full.stamina) + \"/\" + Math.round(character.stats.full.max_stamina) + \" stamina\";\r\n    current_stamina_bar.style.width = (character.stats.full.stamina*100/character.stats.full.max_stamina).toString() +\"%\";\r\n}\r\n\r\n/**\r\n * updates displayed stats and their breakdowns (including health and stamina)\r\n */\r\nfunction update_displayed_stats() {\r\n    Object.keys(stats_divs).forEach(function(key){\r\n        if(key === \"crit_rate\" || key === \"crit_multiplier\") {\r\n            stats_divs[key].innerHTML = `${(character.stats.full[key]*100).toFixed(1)}%`;\r\n        } \r\n        else if(key === \"attack_speed\") {\r\n            stats_divs[key].innerHTML = `${(character.get_attack_speed()).toFixed(1)}`;\r\n        }\r\n        else if(key === \"attack_power\") {\r\n            stats_divs[key].innerHTML = `${(character.get_attack_power()).toFixed(1)}`;\r\n        }\r\n        else {\r\n            stats_divs[key].innerHTML = `${(character.stats.full[key]).toFixed(1)}`;\r\n        }\r\n        update_stat_description(key);\r\n    });\r\n\r\n    const attack_stats = document.getElementById(\"attack_stats\");\r\n\r\n    const ap = Math.round(character.stats.full.attack_points);\r\n    other_combat_divs.attack_points.innerHTML = `${ap}`;\r\n\r\n    if(character.equipment[\"off-hand\"] != null && character.equipment[\"off-hand\"].offhand_type === \"shield\") { //HAS SHIELD\r\n        const dp = (character.stats.full.block_chance*100).toFixed(1)\r\n        other_combat_divs.defensive_action.innerHTML = \"Block :\";\r\n        other_combat_divs.defensive_points.innerHTML = `${dp}%`;\r\n        other_combat_divs.defensive_points.parentNode.children[2].children[0].innerHTML = \"Chance to block an attack\";\r\n\r\n        attack_stats.children[3].innerHTML = `Block : ${Math.round(dp)}%`;\r\n    }\r\n    else { //NO SHIELD\r\n        const ep = Math.round(character.stats.full.evasion_points);\r\n        other_combat_divs.defensive_action.innerHTML = \"EP : \";\r\n        other_combat_divs.defensive_points.innerHTML = `${ep}`;\r\n        other_combat_divs.defensive_points.parentNode.children[2].children[0].innerHTML = \r\n        \"Evasion points, a total value of everything that contributes to the evasion chance, except for some situational skills and modifiers\";\r\n\r\n        attack_stats.children[3].innerHTML = `EP: ${Math.round(ep)} `;\r\n    }\r\n\r\n    update_stat_description(\"defensive_points\");\r\n    update_stat_description(\"attack_points\");\r\n    update_bar_tooltips();\r\n\r\n    let atk = character.get_attack_power();\r\n    if(atk > 100) {\r\n        atk = Math.round(atk);\r\n    } else {\r\n        atk = Math.round(10*atk)/10;\r\n    }\r\n    attack_stats.children[0].innerText = `Atk: ${atk}`;\r\n    attack_stats.children[1].innerText = `Spd: ${Math.round(character.get_attack_speed()*100)/100}`;\r\n    attack_stats.children[2].innerText = `AP:  ${Math.round(ap)}`;\r\n    attack_stats.children[4].innerText = `Def: ${Math.round(character.stats.full.defense)} `;\r\n}\r\n\r\nfunction update_stat_description(stat) {\r\n    let target;\r\n\r\n    if(stats_divs[stat]){\r\n        target = stats_divs[stat].parentNode.children[2].children[1];\r\n    } else if(other_combat_divs[stat] && stat !== \"defensive_action\") {\r\n        target = other_combat_divs[stat].parentNode.children[2].children[1]; \r\n    } else {\r\n        return;\r\n    }\r\n\r\n    target.innerHTML = create_stat_breakdown(stat);\r\n    \r\n    return;\r\n}\r\n\r\nfunction update_bar_tooltips(){\r\n    update_health_bar_tooltip();\r\n    update_stamina_bar_tooltip();\r\n    update_xp_bar_tooltip();\r\n}\r\n\r\n/**\r\n * health bar tooltip, max health only\r\n */\r\nfunction update_health_bar_tooltip() {\r\n    let html_content = \"<b>Max health:</b> \" + Math.round(character.stats.full.max_health) + \"<br>\";\r\n    html_content += create_stat_breakdown(\"max_health\");\r\n\r\n    if(character.stats.full.health_regeneration_flat) {\r\n        html_content += \"<br>------------------------<br><b>Health regen (flat):</b> \" + Math.round(10*character.stats.full.health_regeneration_flat)/10 + \"<br>\";\r\n        html_content += create_stat_breakdown(\"health_regeneration_flat\");\r\n    }\r\n\r\n    if(character.stats.full.health_regeneration_percent) {\r\n        html_content += \"<br>------------------------<br><b>Health regen (%):</b> \" + Math.round(10*character.stats.full.health_regeneration_percent)/10 + \"<br>\";\r\n        html_content += create_stat_breakdown(\"health_regeneration_percent\");\r\n    }\r\n\r\n    if(character.stats.full.health_loss_flat) {\r\n        html_content += \"<br>------------------------<br><b>Health loss (flat):</b> \" + Math.round(10*character.stats.full.health_loss_flat)/10 + \"<br>\";\r\n        html_content += create_stat_breakdown(\"health_loss_flat\");\r\n    }\r\n\r\n    if(character.stats.full.health_loss_percent) {\r\n        html_content += \"<br>------------------------<br><b>Health loss (%):</b> \" + Math.round(10*character.stats.full.health_loss_percent)/10 + \"<br>\";\r\n        html_content += create_stat_breakdown(\"health_loss_percent\");\r\n    }\r\n\r\n    const health_recovery_balance = character.stats.full.health_regeneration_flat + character.stats.full.health_loss_flat + character.stats.full.max_health * (character.stats.full.health_regeneration_percent + character.stats.full.health_loss_percent);\r\n\r\n    html_content += \"<br>------------------------<br><b>Total health balance:</b> \" + Math.round(10*health_recovery_balance)/10 + \"<br>\";\r\n\r\n    health_tooltip_div.innerHTML = html_content;\r\n}\r\n\r\n/**\r\n * stamina bar tooltip, max and efficiency only\r\n */\r\nfunction update_stamina_bar_tooltip() {\r\n    stamina_tooltip_div.innerHTML = \"<b>Max stamina:</b> \" + Math.round(character.stats.full.max_stamina) + \"<br>\";\r\n    stamina_tooltip_div.innerHTML += create_stat_breakdown(\"max_stamina\");\r\n\r\n    if(character.stats.full.stamina_efficiency != 1) {\r\n        stamina_tooltip_div.innerHTML += \"<br>------------------------<br><b>Stamina efficiency:</b> \" + Math.round(100*character.stats.full.stamina_efficiency)/100 + \"<br>\";\r\n        stamina_tooltip_div.innerHTML += create_stat_breakdown(\"stamina_efficiency\");\r\n    }\r\n\r\n    if(character.stats.full.stamina_regeneration_flat) {\r\n        stamina_tooltip_div.innerHTML += \"<br>------------------------<br><b>Stamina regen (flat):</b> \" + Math.round(10*character.stats.full.stamina_regeneration_flat)/10 + \"<br>\";\r\n        stamina_tooltip_div.innerHTML += create_stat_breakdown(\"stamina_regeneration_flat\");\r\n    }\r\n\r\n    if(character.stats.full.stamina_regeneration_percent) {\r\n        stamina_tooltip_div.innerHTML += \"<br>------------------------<br><b>Stamina regen (%):</b> \" + Math.round(10*character.stats.full.stamina_regeneration_percent)/10 + \"<br>\";\r\n        stamina_tooltip_div.innerHTML += create_stat_breakdown(\"stamina_regeneration_percent\");\r\n    }\r\n}\r\n\r\nfunction update_xp_bar_tooltip() {\r\n\r\n\r\n    let html_content = \"\";\r\n    if(character.xp_bonuses.total_multiplier.all != 1) {\r\n        html_content += \"<b>Global xp multiplier:</b> \" + Math.round(100*character.xp_bonuses.total_multiplier.all)/100 + \"<br>\";\r\n        html_content += create_xp_bonus_breakdown(\"all\", false);\r\n    } else {\r\n        html_content += \"<b>No global xp multipliers</b><br>\";\r\n    }\r\n\r\n    if(character.xp_bonuses.total_multiplier.hero != 1) {\r\n        html_content += \"<br>------------------------<br><b>Hero xp multiplier:</b> \" + Math.round(100*character.xp_bonuses.total_multiplier.hero)/100 \r\n                                        + \" (with global: \" + Math.round(get_hero_xp_gain()*100)/100 +\")<br>\";\r\n        html_content += create_xp_bonus_breakdown(\"hero\", false);\r\n    }\r\n\r\n    if(character.xp_bonuses.total_multiplier.all_skill != 1) {\r\n        html_content += \"<br>------------------------<br><b>Skill xp multiplier:</b> \" + Math.round(100*character.xp_bonuses.total_multiplier.all_skill)/100\r\n                                        + \" (with global: \" + Math.round(get_skills_overall_xp_gain()*100)/100 +\")<br>\";\r\n        html_content += create_xp_bonus_breakdown(\"all_skill\", false);\r\n    }\r\n\r\n    xp_bar_tooltip_div.innerHTML = html_content;\r\n}\r\n\r\n/**\r\n * creates full breakdown for provided stat\r\n * @param {} stat \r\n * @returns \r\n */\r\nfunction create_stat_breakdown(stat) {\r\n    let html_string = \"\";\r\n\r\n    if(stat === \"attack_power\") {\r\n        html_string += \r\n        `<br>Breakdown:\r\n        <br>Base value (weapon * str/10): ${Math.round(100* character.stats.total_flat.attack_power)/100}`;\r\n    } else if (stat === \"attack_points\"){\r\n        html_string += \r\n        `<br>Breakdown:\r\n        <br>Base value: ${Math.round(100* character.stats.total_flat.attack_points)/100}`;\r\n    } else if(stat === \"defensive_points\"){\r\n        if(character.equipment[\"off-hand\"] != null && character.equipment[\"off-hand\"].offhand_type === \"shield\") {\r\n            stat = \"block_chance\";\r\n        } else {\r\n            stat = \"evasion_points\";\r\n        }\r\n        html_string += \r\n            `<br>Breakdown:\r\n            <br>Base value: ${Math.round(100 * character.stats.total_flat[stat])/100}`;\r\n    } else {\r\n       html_string += \r\n        `<br>Breakdown:\r\n        <br>Base value: ${Math.round(100*character.base_stats[stat])/100}`;\r\n    }\r\n\r\n    Object.keys(character.stats.flat).forEach(stat_type => {\r\n        if(character.stats.flat[stat_type][stat] && character.stats.flat[stat_type][stat] !== 0) {\r\n            const sign = character.stats.flat[stat_type][stat]>=0?\"+\":\"\";\r\n            html_string +=  `<br>${capitalize_first_letter(stat_type.replace(\"_\",\" \"))}: ${sign}${Math.round(100*character.stats.flat[stat_type][stat])/100}`;\r\n        }\r\n    });\r\n\r\n    Object.keys(character.stats.multiplier).forEach(stat_type => {\r\n        if(character.stats.multiplier[stat_type][stat] && character.stats.multiplier[stat_type][stat] !== 1) {\r\n            html_string +=  `<br>${capitalize_first_letter(stat_type.replace(\"_\",\" \"))}: x${Math.round(100*character.stats.multiplier[stat_type][stat])/100}`;\r\n        }\r\n    });\r\n\r\n    return html_string;\r\n}\r\n\r\n/**\r\n * creates full breakdown for provided bonus category (skill id, skill category, all, all skill, hero)\r\n * @param {*} bonus \r\n * @param {*} include_multipliers \r\n * @returns \r\n */\r\nfunction create_xp_bonus_breakdown(bonus, include_multipliers) {\r\n    let html_string = \"\";\r\n    let xp_bonus_value = 1;\r\n\r\n    if(include_multipliers) {\r\n        if(bonus !== \"all\") {\r\n            if(bonus !== \"all_skill\" && bonus !== \"hero\") {\r\n                xp_bonus_value = get_skill_xp_gain_bonus(bonus);\r\n            } else {\r\n                xp_bonus_value *= (character.xp_bonuses.total_multiplier.all || 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    html_string += `<br>Breakdown:\r\n        <br>Base value: ${Math.round(100*xp_bonus_value)/100}`;\r\n    \r\n    Object.keys(character.xp_bonuses.multiplier).forEach(bonus_type => {\r\n        if(character.xp_bonuses.multiplier[bonus_type]?.[bonus] && character.xp_bonuses.multiplier[bonus_type]?.[bonus] !== 1) {\r\n            html_string +=  `<br>${capitalize_first_letter(bonus_type.replace(\"_\",\" \"))}: x${Math.round(100*character.xp_bonuses.multiplier[bonus_type][bonus])/100}`;\r\n        }\r\n    });\r\n\r\n    return html_string;\r\n}\r\n\r\nfunction update_displayed_effects() {\r\n    const effect_count = Object.keys(active_effects).length;\r\n    active_effect_count.innerText = effect_count;\r\n    if(effect_count > 0) {\r\n        //effects exist, refresh the whole displayed content\r\n        active_effects_tooltip.innerHTML = '';\r\n        \r\n        Object.values(effect_divs).forEach(eff => {\r\n            eff.remove();\r\n        });\r\n\r\n        effect_divs = {};\r\n        Object.values(active_effects).forEach(effect => {\r\n            effect_divs[effect.name] = create_effect_tooltip({effect_name: effect.name, duration: effect.duration, add_bonus: true});\r\n            active_effects_tooltip.appendChild(effect_divs[effect.name]);\r\n        });\r\n    } else {\r\n        //no effects\r\n        active_effects_tooltip.innerHTML = 'No active effects';\r\n        effect_divs = {};\r\n    }\r\n    update_displayed_effect_durations();\r\n}\r\n\r\nfunction update_displayed_effect_durations() {\r\n    Object.keys(effect_divs).forEach(key => {\r\n        if(!active_effects[key]?.duration) {\r\n            effect_divs[key].remove();\r\n            delete effect_divs[key];\r\n        } else {\r\n            effect_divs[key].querySelector(\".active_effect_duration\").innerText = format_time({time: {minutes: active_effects[key].duration}, round: false});\r\n        }\r\n    });\r\n}\r\n\r\nfunction update_displayed_time() {\r\n    let time_of_the_day = current_game_time.getTimeOfDaySimple();\r\n\r\n    //color coding like it used to be done with icon?\r\n\r\n    time_field.innerHTML = current_game_time.toString() + \", <b>\" + time_of_the_day + \"</b>\";\r\n}\r\n\r\nfunction update_displayed_temperature() {\r\n    const temperature = get_current_temperature_smoothed();\r\n    let displayed_temperature = options.use_uncivilised_temperature_scale?celsius_to_fahrenheit(temperature):temperature;\r\n\r\n    const temperature_unit = options.use_uncivilised_temperature_scale?\"\u00B0F\":\"\u00B0C\";\r\n\r\n    //whether temperature is low enough to give any cold effect\r\n    const is_cold = temperature < (cold_status_temperatures[0]-get_character_cold_tolerance())?true:false;\r\n    let temperature_class = \"normal_temperature\";\r\n    if(is_cold) {\r\n        temperature_class = \"cold_temperature\";\r\n    }\r\n\r\n    displayed_temperature = displayed_temperature.toString();\r\n    if(!displayed_temperature.includes(\".\")) {\r\n        //checks if there's a decimal, adds a trailing zero if not\r\n        displayed_temperature += \".0\";\r\n    }\r\n\r\n    if(current_location.is_under_roof) {\r\n        weather_field.innerHTML = displayed_temperature +temperature_unit;\r\n    } else {\r\n        if(is_raining()) {\r\n            if(temperature > 0) {\r\n                //rain/clouds\r\n                weather_field.innerHTML = `<span class=\"material-icons icon\">cloud</span><span class=\"${temperature_class}\">` + displayed_temperature +temperature_unit+\"</span>\";\r\n            } else {\r\n                //snow\r\n                weather_field.innerHTML = `<span class=\"material-icons icon\">ac_unit</span><span class=\"${temperature_class}\">` + displayed_temperature +temperature_unit+\"</span>\";\r\n            }\r\n        } else {\r\n            //normal weather, no icon\r\n            weather_field.innerHTML = `<span class=\"${temperature_class}\">` + displayed_temperature +temperature_unit+\"</span>\";\r\n        }\r\n    }\r\n\r\n    weather_field.appendChild(create_temperature_tooltip());\r\n}\r\n\r\nfunction create_temperature_tooltip() {\r\n    const tooltip = document.createElement(\"div\");\r\n\r\n    tooltip.id = \"temperature_tooltip\";\r\n    if(!options.use_uncivilised_temperature_scale) {\r\n         tooltip.innerHTML = `Lowest tolerable temperature: <strong>${Math.round(10*(lowest_tolerable_temperature - get_character_cold_tolerance()))/10}</strong>`;\r\n        tooltip.innerHTML += `<br>(<strong>${lowest_tolerable_temperature}</strong> base minus <strong>${Math.round(10*get_character_cold_tolerance())/10}</strong> cold protection)<br>`;\r\n        tooltip.innerHTML += create_stat_breakdown(\"cold_tolerance\");\r\n    } else {\r\n        tooltip.innerHTML = `Lowest tolerable temperature: <strong>${Math.round(10*(celsius_to_fahrenheit(lowest_tolerable_temperature - get_character_cold_tolerance())))/10}</strong>`;\r\n        tooltip.innerHTML += `<br>(<strong>${Math.round(10*celsius_to_fahrenheit(lowest_tolerable_temperature))/10}</strong> base minus <strong>${Math.round(10*celsius_to_fahrenheit(get_character_cold_tolerance())-320)/10}</strong> cold protection)<br>`;\r\n        tooltip.innerHTML += create_stat_breakdown(\"cold_tolerance\");\r\n        tooltip.innerHTML += `<br>Scale conversion: x1.8`;\r\n    }\r\n\r\n    return tooltip;\r\n}\r\n\r\n/** \r\n * formats money to a nice string in form x..x G xx S xx C (gold/silver/copper) \r\n * @param {Number} num value to be formatted\r\n * @param {Boolean} round if the value should be rounded a bit\r\n */\r\nfunction format_money(num) {\r\n    let value;\r\n    const sign = num >= 0 ? '' : '-';\r\n    num = Math.abs(num);\r\n    \r\n    if(num > 0) {\r\n        value = (num%10 != 0 ? `${num%10}<span class=\"coin coin_wood\">W</span>` : '');\r\n\r\n        if(num > 9) {\r\n            value = (Math.floor(num/10)%100 != 0?`${Math.floor(num/10)%100}<span class=\"coin coin_copper\">C</span>${value?\" \":\"\"}` :'') + value;\r\n            if(num > 999) {\r\n                value = (Math.floor(num/1000)%100 != 0?`${Math.floor(num/1000)%100}<span class=\"coin coin_silver\">S</span>${value?\" \":\"\"}` :'') + value;\r\n                if(num > 99999) {\r\n                    value = `${Math.floor(num/100000)}<span class=\"coin coin_gold\">G</span>${value?\" \":\"\"}` + value;\r\n                }\r\n            \r\n            }  \r\n        }\r\n\r\n        return sign + value;\r\n\r\n    } else {\r\n        return 'nothing';\r\n    }\r\n}\r\n\r\nfunction update_displayed_character_xp(did_level = false) {\r\n    /*\r\n    character_xp_div\r\n        character_xp_bar_max\r\n            character_xp_bar_current\r\n        charaxter_xp_value\r\n    */\r\n    character_xp_div.children[0].children[0].style.width = `${100*character.xp.current_xp/character.xp.xp_to_next_lvl}%`;\r\n    character_xp_div.children[1].innerText = `${expo(character.xp.current_xp)} / ${expo(character.xp.xp_to_next_lvl)} xp`;\r\n\r\n    if(did_level) {\r\n        character_level_div.innerText = `Level: ${character.xp.current_level}`;\r\n        update_displayed_health();\r\n    }\r\n}\r\n\r\nfunction update_displayed_xp_bonuses() {\r\n    update_xp_bar_tooltip();\r\n}\r\n\r\nfunction update_displayed_stamina_efficiency() {\r\n    update_stamina_bar_tooltip();\r\n}\r\n\r\n/**\r\n * updates displayed reputation, only showing regions where value is > 0\r\n */\r\nfunction update_displayed_reputation() {\r\n    data_entry_divs.reputation.innerHTML = \"\";\r\n\r\n    Object.keys(character.reputation).forEach(reputation_region => {\r\n        if(character.reputation[reputation_region] > 0) {\r\n            const rep_div = document.createElement(\"div\");\r\n            const rep_name_span = document.createElement(\"span\");\r\n            const rep_value_span = document.createElement(\"span\");\r\n            rep_div.classList.add(\"data_entry\");\r\n            rep_name_span.classList.add(\"data_entry_name\");\r\n            rep_value_span.classList.add(\"data_entry_value\");\r\n\r\n            rep_name_span.innerHTML = capitalize_first_letter(reputation_region) + \" reputation\";\r\n            rep_value_span.innerHTML = character.reputation[reputation_region];\r\n\r\n            rep_div.appendChild(rep_name_span);\r\n            rep_div.appendChild(rep_value_span);\r\n\r\n            data_entry_divs.reputation.appendChild(rep_div);\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * \r\n * @param {String} dialogue_key \r\n * @param {Object} textlines that still belong to the dialogue, but are to be displayed alone for some reason (i.e. because they are from dialogue branching)\r\n * @param {String} origin - the key of textline that created a dialogue branch, ignored if textlines is not passed\r\n */\r\nfunction update_displayed_dialogue({dialogue_key, textlines, origin}) {\r\n    const dialogue = dialogues[dialogue_key];\r\n    \r\n    clear_action_div();\r\n    const dialogue_name_div = document.createElement(\"div\");\r\n    dialogue_name_div.innerHTML = capitalize_first_letter(dialogues[dialogue_key].getName({is_mofu_mofu_enabled: global_flags.is_mofu_mofu_enabled}));\r\n    dialogue_name_div.id = \"dialogue_name_div\";\r\n    action_div.appendChild(dialogue_name_div);\r\n\r\n    const dialogue_answer_div = document.createElement(\"div\");\r\n    dialogue_answer_div.id = \"dialogue_answer_div\";\r\n    action_div.appendChild(dialogue_answer_div);\r\n    if(!textlines) {\r\n        Object.keys(dialogue.textlines).forEach(key => { //add buttons for textlines\r\n            if(dialogue.textlines[key].is_unlocked && !dialogue.textlines[key].is_finished && !dialogue.textlines[key].is_branch_only && process_conditions(dialogue.textlines[key].display_conditions, character)) { \r\n                //do only if text_line is not unavailable and not a branch\r\n                if(dialogue.textlines[key].required_flags) {\r\n                    if(dialogue.textlines[key].required_flags.yes && !Array.isArray(dialogue.textlines[key].required_flags.yes) || dialogue.textlines[key].required_flags.no && !Array.isArray(dialogue.textlines[key].required_flags.no)) {\r\n                        console.error(`Textline \"${key}\" in dialogue \"${dialogue_key}\" has required flag passed as a single value but it should be an array!`)\r\n                    }\r\n                    if(dialogue.textlines[key].required_flags.yes) {\r\n                        for(let i = 0; i < dialogue.textlines[key].required_flags.yes.length; i++) {\r\n                            \r\n                            if(!global_flags[dialogue.textlines[key].required_flags.yes[i]]) {\r\n                                return;\r\n                            }\r\n                        }\r\n                    }\r\n                    if(dialogue.textlines[key].required_flags.no) {\r\n                        for(let i = 0; i < dialogue.textlines[key].required_flags.no.length; i++) {\r\n                            if(global_flags[dialogue.textlines[key].required_flags.no[i]]) {\r\n                                return;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                \r\n                const textline_div = document.createElement(\"div\");\r\n                textline_div.innerHTML = `\"${translationManager.getText(language,dialogue.textlines[key].name)}\"`;\r\n                textline_div.classList.add(\"dialogue_textline\");\r\n                textline_div.setAttribute(\"data-textline\", key);\r\n                textline_div.setAttribute(\"onclick\", `start_textline(this.getAttribute('data-textline'))`);\r\n                action_div.appendChild(textline_div);\r\n            }\r\n        });\r\n\r\n        Object.keys(dialogue.actions).forEach(key => { //add buttons for actions\r\n            if(dialogue.actions[key].is_unlocked && !dialogue.actions[key].is_finished && dialogue.actions[key].can_be_displayed(character)) { \r\n                const dialogue_action_div = document.createElement(\"div\");\r\n                dialogue_action_div.innerHTML = `${translationManager.getText(language,dialogue.actions[key].starting_text)}`;\r\n                dialogue_action_div.classList.add(\"dialogue_textline\");\r\n                dialogue_action_div.setAttribute(\"data-location_action\", key);\r\n                dialogue_action_div.setAttribute(\"onclick\", `start_game_action(this.getAttribute('data-location_action'), event)`);\r\n                action_div.appendChild(dialogue_action_div);\r\n            }\r\n        });\r\n\r\n        if(dialogue.trader) {\r\n            const trade_div = document.createElement(\"div\");\r\n            trade_div.innerHTML = `<i class=\"material-icons\">storefront</i>  ` + traders[dialogue.trader].trade_text;\r\n            trade_div.classList.add(\"dialogue_trade\")\r\n            trade_div.setAttribute(\"data-trader\", dialogue.trader);\r\n            trade_div.setAttribute(\"onclick\", \"startTrade(this.getAttribute('data-trader'))\")\r\n            action_div.appendChild(trade_div);\r\n        }\r\n\r\n        const end_dialogue_div = document.createElement(\"div\");\r\n\r\n        end_dialogue_div.innerHTML = \"<i class='material-icons'>arrow_back</i> \" + dialogue.ending_text;\r\n        end_dialogue_div.classList.add(\"end_dialogue_button\");\r\n        end_dialogue_div.setAttribute(\"onclick\", \"end_dialogue()\");\r\n\r\n        action_div.appendChild(end_dialogue_div);\r\n    } else {\r\n        //textlines are passed, use only them instead of all the dialogue has (minus branches)\r\n        for(let i = 0; i < textlines.length; i++) {\r\n            const key = textlines[i];\r\n            //get key from passed array, read relevant entry from dialogue\r\n            if(dialogue.textlines[key].is_unlocked && !dialogue.textlines[key].is_finished && process_conditions(dialogue.textlines[key].display_conditions, character)) { //do only if text_line is not unavailable\r\n                if(dialogue.textlines[key].required_flags) {\r\n                    if(dialogue.textlines[key].required_flags.yes && !Array.isArray(dialogue.textlines[key].required_flags.yes) || dialogue.textlines[key].required_flags.no && !Array.isArray(dialogue.textlines[key].required_flags.no)) {\r\n                        console.error(`Textline \"${key}\" in dialogue \"${dialogue_key}\" has required flag passed as a single value but it should be an array!`)\r\n                    }\r\n                    if(dialogue.textlines[key].required_flags.yes) {\r\n                        for(let i = 0; i < dialogue.textlines[key].required_flags.yes.length; i++) {\r\n                            \r\n                            if(!global_flags[dialogue.textlines[key].required_flags.yes[i]]) {\r\n                                return;\r\n                            }\r\n                        }\r\n                    }\r\n                    if(dialogue.textlines[key].required_flags.no) {\r\n                        for(let i = 0; i < dialogue.textlines[key].required_flags.no.length; i++) {\r\n                            if(global_flags[dialogue.textlines[key].required_flags.no[i]]) {\r\n                                return;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                \r\n                const textline_div = document.createElement(\"div\");\r\n                textline_div.innerHTML = `\"${translationManager.getText(language,dialogue.textlines[key].name)}\"`;\r\n                textline_div.classList.add(\"dialogue_textline\");\r\n                textline_div.setAttribute(\"data-textline\", key);\r\n                textline_div.setAttribute(\"onclick\", `start_textline(this.getAttribute('data-textline'), ${origin})`); //additional param compared to when there's no textlines passed\r\n                action_div.appendChild(textline_div);\r\n            }\r\n        }\r\n\r\n        const backstep_dialogue_div = document.createElement(\"div\");\r\n\r\n        backstep_dialogue_div.innerHTML = \"<i class='material-icons'>arrow_back</i> \" + default_dialogue_return_text;\r\n        backstep_dialogue_div.classList.add(\"backstep_dialogue_button\");\r\n        backstep_dialogue_div.setAttribute(\"onclick\", `start_dialogue(\"${dialogue_key}\")`);\r\n\r\n        action_div.appendChild(backstep_dialogue_div);\r\n    }\r\n}\r\n\r\nfunction update_displayed_textline_answer({text, is_description}) {\r\n    text = translationManager.getText(language, text);\r\n    \r\n    if(is_description) {\r\n        document.getElementById(\"dialogue_answer_div\").innerText =  \"*\"+text+\"*\";\r\n        document.getElementById(\"dialogue_answer_div\").classList.remove(\"italic\");\r\n    } else {\r\n        document.getElementById(\"dialogue_answer_div\").innerText = text;\r\n        document.getElementById(\"dialogue_answer_div\").classList.add(\"italic\");\r\n    }\r\n}\r\n\r\nfunction exit_displayed_trade() {\r\n    action_div.style.display = \"\";\r\n    trade_div.style.display = \"none\";\r\n}\r\n\r\nfunction start_activity_display(current_activity) {\r\n    clear_action_div();\r\n    const action_status_div = document.createElement(\"div\");\r\n    action_status_div.innerText = activities[current_activity.activity_name].action_text;\r\n    action_status_div.id = \"action_status_div\";\r\n    const action_xp_div = document.createElement(\"div\");\r\n    if(activities[current_activity.activity_name].base_skills_names) {\r\n\r\n        const percent_xp = get_total_skill_level(activities[current_activity.activity_name].base_skills_names) == skills[activities[current_activity.activity_name].base_skills_names].max_level? \"Max\": `${Math.round(10000*skills[activities[current_activity.activity_name].base_skills_names].current_xp/skills[activities[current_activity.activity_name].base_skills_names].xp_to_next_lvl)/100}%`\r\n        const curr_xp = get_total_skill_level(activities[current_activity.activity_name].base_skills_names) == skills[activities[current_activity.activity_name].base_skills_names].max_level? \"Max\": `${Math.floor(skills[activities[current_activity.activity_name].base_skills_names].current_xp)}`;\r\n        const needed_xp = get_total_skill_level(activities[current_activity.activity_name].base_skills_names) == skills[activities[current_activity.activity_name].base_skills_names].max_level? \"Max\": `${Math.ceil(skills[activities[current_activity.activity_name].base_skills_names].xp_to_next_lvl)}`;\r\n\r\n        if(activities[current_activity.activity_name].type !== \"GATHERING\") {\r\n            action_xp_div.innerText = `Getting ${current_activity.skill_xp_per_tick} base xp per in-game minute to `;\r\n        } else {\r\n            action_xp_div.innerText = `Getting ${current_activity.skill_xp_per_tick} base xp per gathering cycle to `;\r\n        }\r\n        \r\n        if(curr_xp !== \"Max\") {\r\n            action_xp_div.innerText += ` ${skills[activities[current_activity.activity_name].base_skills_names].name()} (${percent_xp}  [${expo(curr_xp)} / ${expo(needed_xp)}])`;\r\n        } else {\r\n            action_xp_div.innerText += ` ${skills[activities[current_activity.activity_name].base_skills_names].name()} (Maxxed out!)`;\r\n        }\r\n\r\n        if(activities[current_activity.activity_name].type !== \"GATHERING\") {\r\n            const time_needed = Math.ceil((needed_xp-curr_xp)/(current_activity.skill_xp_per_tick*get_skill_xp_gain(skills[activities[current_activity.activity_name].base_skills_names].skill_id)));\r\n            if(!isNaN(time_needed)) {\r\n                action_xp_div.innerHTML += `<br>Next level in ${format_reading_time(time_needed)} (${format_time({time: {minutes: time_needed/60}, long_names: true})}realtime)`;\r\n            }\r\n        } else {\r\n            const time_needed = Math.ceil(current_activity.gathering_time_needed * (needed_xp-curr_xp)/(current_activity.skill_xp_per_tick*get_skill_xp_gain(skills[activities[current_activity.activity_name].base_skills_names].skill_id)));\r\n            if(!isNaN(time_needed)) {\r\n                action_xp_div.innerHTML += `<br>Next level in ${format_reading_time(time_needed)} (${format_time({time: {minutes: time_needed/60}, long_names: true})}realtime)`;\r\n            }\r\n        }\r\n            \r\n    } else {\r\n        console.warn(`Activity \"${current_activity.activity_name}\" has no skills assigned!`);\r\n    }\r\n    action_xp_div.id = \"action_xp_div\";\r\n\r\n    const action_end_div = document.createElement(\"div\");\r\n    action_end_div.setAttribute(\"onclick\", \"end_activity()\");\r\n    action_end_div.id = \"action_end_div\";\r\n\r\n\r\n    const action_end_text = document.createElement(\"div\");\r\n    action_end_text.innerText = `Finish ${current_activity.activity_name}`;\r\n    action_end_text.id = \"action_end_text\";\r\n\r\n\r\n    action_end_div.appendChild(action_end_text);\r\n\r\n    if(activities[current_activity.activity_name].type === \"JOB\") {\r\n        const action_end_earnings = document.createElement(\"div\");\r\n        action_end_earnings.innerHTML = `(earnings: ${format_money(0)})`;\r\n        action_end_earnings.id = \"action_end_earnings\";\r\n\r\n        action_end_div.appendChild(action_end_earnings);\r\n    }\r\n\r\n    action_div.appendChild(action_status_div);\r\n    action_div.appendChild(action_xp_div);\r\n\r\n    if(current_activity.gained_resources) {\r\n        const action_progress_bar_max = document.createElement(\"div\");\r\n        const action_progress_bar = document.createElement(\"div\");\r\n        action_progress_bar_max.appendChild(action_progress_bar);\r\n        action_progress_bar.id = \"gathering_progress_bar\";\r\n        action_progress_bar.style.width = 385*current_activity.gathering_time/current_activity.gathering_time_needed+\"px\";\r\n        action_progress_bar_max.id = \"gathering_progress_bar_max\";\r\n        action_div.appendChild(action_progress_bar_max);\r\n        action_progress_bar_max.appendChild(create_gathering_tooltip(current_activity));\r\n    }\r\n    \r\n    action_div.appendChild(action_end_div);\r\n\r\n    if(activities[current_activity.activity_name].type === \"JOB\") \r\n    {\r\n        const time_info_div = document.createElement(\"div\");\r\n        time_info_div.id = \"time_for_earnings_div\";\r\n\r\n        if(!enough_time_for_earnings(current_activity)) {\r\n            time_info_div.innerHTML = `There's not enough time left to earn more, but ${character.name} might still learn something...`;\r\n        }\r\n        else {\r\n            time_info_div.innerHTML = `Next earnings in: ${format_working_time(current_activity.working_period - current_activity.working_time)}`;\r\n        }\r\n        action_div.insertBefore(time_info_div, action_div.children[2]);\r\n    }\r\n\r\n    start_activity_animation();\r\n}\r\n\r\nfunction update_displayed_ongoing_activity(current_activity, is_job){\r\n    if(is_job) {\r\n        document.getElementById(\"action_end_earnings\").innerHTML = `(earnings: ${format_money(current_activity.earnings)})`\r\n        const time_info_div = document.getElementById(\"time_for_earnings_div\");\r\n        \r\n        if(!enough_time_for_earnings(current_activity)) {\r\n            time_info_div.innerHTML = `There's not enough time left to earn more, but ${character.name} might still learn something...`;\r\n        } else {\r\n            time_info_div.innerHTML = `Next earnings in: ${format_working_time(current_activity.working_period - current_activity.working_time%current_activity.working_period)}`;\r\n        }\r\n    }\r\n    const action_xp_div = document.getElementById(\"action_xp_div\");\r\n    if(!action_xp_div) {\r\n        console.warn(`Failed to find htmlElement with id \"action_xp_div\" for activity \"${current_activity.activity_id}\"`);\r\n        return;\r\n    }\r\n\r\n    const percent_xp = get_total_skill_level(activities[current_activity.activity_name].base_skills_names) == skills[activities[current_activity.activity_name].base_skills_names].max_level? \"Max\": `${Math.round(10000*skills[activities[current_activity.activity_name].base_skills_names].current_xp/skills[activities[current_activity.activity_name].base_skills_names].xp_to_next_lvl)/100}%`\r\n    const curr_xp = get_total_skill_level(activities[current_activity.activity_name].base_skills_names) == skills[activities[current_activity.activity_name].base_skills_names].max_level? \"Max\": `${Math.floor(skills[activities[current_activity.activity_name].base_skills_names].current_xp)}`;\r\n    const needed_xp = get_total_skill_level(activities[current_activity.activity_name].base_skills_names) == skills[activities[current_activity.activity_name].base_skills_names].max_level? \"Max\": `${Math.ceil(skills[activities[current_activity.activity_name].base_skills_names].xp_to_next_lvl)}`;\r\n    \r\n    if(activities[current_activity.activity_name].type !== \"GATHERING\") {\r\n        action_xp_div.innerText = `Getting ${current_activity.skill_xp_per_tick} base xp per in-game minute to `;\r\n    } else {\r\n        action_xp_div.innerText = `Getting ${current_activity.skill_xp_per_tick} base xp per gathering cycle to `;\r\n    }\r\n\r\n    if(curr_xp !== \"Max\") {\r\n        action_xp_div.innerText += ` ${skills[activities[current_activity.activity_name].base_skills_names].name()} (${percent_xp}  [${expo(curr_xp)} / ${expo(needed_xp)}])`;\r\n    } else {\r\n        action_xp_div.innerText += ` ${skills[activities[current_activity.activity_name].base_skills_names].name()} (Maxxed out!)`;\r\n    }\r\n\r\n    if(activities[current_activity.activity_name].type !== \"GATHERING\") {\r\n        const time_needed = Math.ceil((needed_xp-curr_xp)/(current_activity.skill_xp_per_tick*get_skill_xp_gain(skills[activities[current_activity.activity_name].base_skills_names].skill_id)));\r\n        if(!isNaN(time_needed)) {\r\n            action_xp_div.innerHTML += `<br>Next level in ${format_reading_time(time_needed)} (${format_time({time: {minutes: time_needed/60}, long_names: true})}realtime)`;\r\n        }\r\n    } else {\r\n        const time_needed = Math.ceil(current_activity.gathering_time_needed * (needed_xp-curr_xp)/(current_activity.skill_xp_per_tick*get_skill_xp_gain(skills[activities[current_activity.activity_name].base_skills_names].skill_id)));\r\n        if(!isNaN(time_needed)) {\r\n            action_xp_div.innerHTML += `<br>Next level in ${format_reading_time(time_needed)} (${format_time({time: {minutes: time_needed/60}, long_names: true})}realtime)`;\r\n        }\r\n    }\r\n\r\n    if(current_activity.gained_resources) {\r\n        document.getElementById(\"gathering_progress_bar\").style.width = 385*current_activity.gathering_time/current_activity.gathering_time_needed+\"px\";\r\n    }\r\n}\r\n\r\nfunction start_game_action_display(dialogue_key, action_key) {\r\n    clear_action_div();\r\n\r\n    let action;\r\n    if(dialogue_key) {\r\n        action = dialogues[dialogue_key].actions[action_key];\r\n    } else {\r\n        action = current_location.actions[action_key];\r\n        \r\n    }\r\n    const action_status_div = document.createElement(\"div\");\r\n    action_status_div.innerText = action.action_text;\r\n    action_status_div.id = \"action_status_div\";\r\n    action_div.appendChild(action_status_div);\r\n\r\n    const action_progress_bar_max = document.createElement(\"div\");\r\n    const action_progress_bar = document.createElement(\"div\");\r\n    action_progress_bar_max.appendChild(action_progress_bar);\r\n    action_progress_bar.id = \"action_progress_bar\";\r\n    action_progress_bar.style.width = \"0px\";\r\n    action_progress_bar_max.id = \"action_progress_bar_max\";\r\n    action_div.appendChild(action_progress_bar_max);\r\n\r\n    const action_end_div = document.createElement(\"div\");\r\n    action_end_div.setAttribute(\"onclick\", \"end_game_action()\");\r\n    action_end_div.id = \"action_end_div\";\r\n\r\n\r\n    const action_end_text = document.createElement(\"div\");\r\n    action_end_text.innerText = `Give up for now`;\r\n    action_end_text.id = \"action_end_text\";\r\n\r\n\r\n    action_end_div.appendChild(action_end_text);\r\n    action_div.appendChild(action_end_div);\r\n\r\n\r\n    start_activity_animation();\r\n}\r\n\r\nfunction update_game_action_progress_bar(percent) {\r\n    document.getElementById(\"action_progress_bar\").style.width = 385*percent+\"px\";\r\n}\r\n\r\nfunction set_game_action_finish_text(text) {\r\n    document.getElementById(\"action_status_div\").innerHTML = text;\r\n}\r\n\r\nfunction update_game_action_finish_button() {\r\n    document.getElementById(\"action_end_div\").innerHTML = \"Finish\";\r\n}\r\n\r\n/**\r\n * Pseudo-generalized function for updating displayed content\r\n * @param {*} param0 \r\n */\r\nfunction fill_action_box({content_type, data}) {\r\n\r\n    let text = '';\r\n    if(data.special?.upstack_result_message) {\r\n        text = data.special.upstack_result_message;\r\n    }\r\n\r\n    if(content_type === \"dialogue\") {\r\n        update_displayed_dialogue({dialogue_key: data.dialogue_key});\r\n        if(!text) {\r\n            text = dialogues[data.dialogue_key].getDescription();\r\n        }\r\n        //if(!document.getElementById(\"dialogue_answer_div\").innerText) { //probably pointless to check?\r\n        update_displayed_textline_answer({text, is_description: true});\r\n        //}\r\n    } else if(content_type === \"dialogue_answer\") {\r\n        update_displayed_dialogue({dialogue_key: data.dialogue_key});\r\n        if(!text) {\r\n            text = data.text;\r\n        }\r\n        update_displayed_textline_answer({text});\r\n    } else if(content_type === \"dialogue_branch\") {\r\n        update_displayed_dialogue({dialogue_key: data.dialogue_key, textlines: data.textlines});\r\n        if(!text) {\r\n            text = data.text;\r\n        }\r\n        update_displayed_textline_answer({text});\r\n    } else if(content_type === \"action\") {\r\n        start_game_action_display(data.dialogue_key, data.action_key);\r\n    } else if(content_type === \"activity\") {\r\n        start_activity_display(data.activity);\r\n    } else {\r\n        throw new Error(`Error on filling action box content: no such content type as \"${content_type}\"`);\r\n    }\r\n\r\n    //call stack addition in starting dialogues / textlines / actions / activities\r\n    //pass proper data as param\r\n    //do whatever is needed, like setting 'current_x' values\r\n    //then call fill_action_box with proper data\r\n}\r\n\r\nfunction start_sleeping_display(){\r\n    clear_action_div();\r\n\r\n    const action_status_div = document.createElement(\"div\");\r\n    action_status_div.innerText = \"Sleeping...\";\r\n    action_status_div.id = \"action_status_div\";\r\n\r\n    const action_end_div = document.createElement(\"div\");\r\n    action_end_div.setAttribute(\"onclick\", \"end_sleeping()\");\r\n    action_end_div.id = \"action_end_div\";\r\n\r\n\r\n    const action_end_text = document.createElement(\"div\");\r\n    action_end_text.innerText = `Wake up`;\r\n    action_end_text.id = \"action_end_text\";\r\n\r\n    \r\n    action_end_div.appendChild(action_end_text);\r\n\r\n    action_div.appendChild(action_status_div);\r\n    action_div.appendChild(action_end_div);\r\n    start_activity_animation();\r\n}\r\n\r\nfunction start_reading_display(title) {\r\n    clear_action_div();\r\n\r\n    const action_status_div = document.createElement(\"div\");\r\n    action_status_div.innerText = `Reading the book, ${format_reading_time(item_templates[title].getRemainingTime())} left`;\r\n    action_status_div.id = \"action_status_div\";\r\n\r\n    const action_end_div = document.createElement(\"div\");\r\n    action_end_div.setAttribute(\"onclick\", \"end_reading()\");\r\n    action_end_div.id = \"action_end_div\";\r\n\r\n\r\n    const action_end_text = document.createElement(\"div\");\r\n    action_end_text.innerText = `Stop reading for now`;\r\n    action_end_text.id = \"action_end_text\";\r\n\r\n    action_end_div.appendChild(action_end_text);\r\n\r\n    action_div.appendChild(action_status_div);\r\n    action_div.appendChild(action_end_div);\r\n    start_activity_animation({book_title: title});\r\n}\r\n\r\n/**\r\n * //creates new skill bar\r\n * @param {Skill} skill \r\n */\r\nfunction create_new_skill_bar(skill) {\r\n    if(!skill_bar_divs[skill.category]) {\r\n        skill_bar_divs[skill.category] = {};\r\n\r\n        const skill_category_div = document.createElement(\"div\");\r\n        skill_category_div.innerHTML = `<i class=\"material-icons icon skill_dropdown_icon\"> keyboard_double_arrow_down </i>${skill.category} skills`;\r\n        skill_category_div.dataset.skill_category = skill.category;\r\n        skill_category_div.classList.add(\"skill_category_div\");\r\n\r\n        //add reordering buttons\r\n        const btn_up = document.createElement('a');\r\n        btn_up.className = \"material-icons icon\";\r\n        btn_up.style.float = 'right';\r\n        btn_up.innerHTML = 'keyboard_arrow_up';\r\n        btn_up.addEventListener(\"click\", (event) => {\r\n            let idx = skill_category_order.indexOf(skill.category);\r\n            if (idx > 0) {\r\n                [skill_category_order[idx], skill_category_order[idx - 1]] = [skill_category_order[idx - 1], skill_category_order[idx]];\r\n                sort_displayed_skill_categories();\r\n                update_skill_category_order();\r\n            }\r\n        });\r\n        const btn_down = document.createElement('a');\r\n        btn_down.className = \"material-icons icon\";\r\n        btn_down.style.float = 'right';\r\n        btn_down.innerHTML = 'keyboard_arrow_down';\r\n        btn_down.addEventListener(\"click\", (event) => {\r\n            let idx = skill_category_order.indexOf(skill.category);\r\n            if (idx < skill_category_order.length - 1) {\r\n                [skill_category_order[idx], skill_category_order[idx + 1]] = [skill_category_order[idx + 1], skill_category_order[idx]];\r\n                sort_displayed_skill_categories();\r\n                update_skill_category_order();\r\n            }\r\n        });\r\n        skill_category_div.appendChild(btn_up);\r\n        skill_category_div.appendChild(btn_down);\r\n\r\n        const skill_category_skills = document.createElement(\"div\");\r\n        skill_category_skills.dataset.skill_category_skills = true;\r\n        skill_category_div.appendChild(skill_category_skills);\r\n        \r\n        skill_list.appendChild(skill_category_div);\r\n\r\n        skill_category_div.addEventListener(\"click\", (event)=>{\r\n            if(event.target.classList.contains(\"skill_category_div\")) {\r\n                event.target.classList.toggle(\"skill_category_expanded\");\r\n            } else if(event.target.classList.contains(\"skill_dropdown_icon\")) {\r\n                event.target.parentNode.classList.toggle(\"skill_category_expanded\");\r\n            }\r\n        })\r\n\r\n        if(skill_category_order.indexOf(skill.category) == -1) {\r\n            skill_category_order.push(skill.category);\r\n        }\r\n    }\r\n    if(skill_bar_divs[skill.category][skill.skill_id]) {\r\n        console.trace(`Tried to create a skillbar for skill \"${skill.skill_id}\", but it already has one!`);\r\n        return;\r\n    }\r\n    skill_bar_divs[skill.category][skill.skill_id] = document.createElement(\"div\");\r\n\r\n    const skill_bar_max = document.createElement(\"div\");\r\n    const skill_bar_current = document.createElement(\"div\");\r\n    const skill_bar_text = document.createElement(\"div\");\r\n    const skill_bar_name = document.createElement(\"div\");\r\n    const skill_bar_xp = document.createElement(\"div\");\r\n\r\n    const skill_tooltip = document.createElement(\"div\");\r\n    const tooltip_xp = document.createElement(\"div\");\r\n    const tooltip_xp_gain = document.createElement(\"div\");\r\n    const tooltip_desc = document.createElement(\"div\");\r\n    const tooltip_effect = document.createElement(\"div\");\r\n    const tooltip_milestones = document.createElement(\"div\");\r\n    const tooltip_next = document.createElement(\"div\");\r\n    \r\n    skill_bar_max.classList.add(\"skill_bar_max\");\r\n    skill_bar_current.classList.add(\"skill_bar_current\");\r\n    skill_bar_text.classList.add(\"skill_bar_text\");\r\n    skill_bar_name.classList.add(\"skill_bar_name\");\r\n    skill_bar_xp.classList.add(\"skill_bar_xp\");\r\n    skill_tooltip.classList.add(\"skill_tooltip\");\r\n    tooltip_next.classList.add(\"skill_tooltip_next_milestone\");\r\n\r\n    skill_bar_text.appendChild(skill_bar_name);\r\n    skill_bar_text.append(skill_bar_xp);\r\n\r\n    tooltip_xp_gain.classList.add(\"skill_xp_gain\");\r\n\r\n    skill_tooltip.appendChild(tooltip_xp);\r\n    skill_tooltip.appendChild(tooltip_xp_gain);\r\n    skill_tooltip.appendChild(tooltip_desc);\r\n    skill_tooltip.appendChild(tooltip_effect); \r\n    skill_tooltip.appendChild(tooltip_milestones);\r\n    skill_tooltip.appendChild(tooltip_next);\r\n\r\n    tooltip_desc.innerHTML = `<span class=\"skill_id\">id: \"${skill.skill_id}\"</span><br><br>${skill.description}<br>`;\r\n    if(skill.flavour_text) {\r\n        tooltip_desc.innerHTML += `<br><span class=\"skill_flavour_text\">\"${skill.flavour_text}\"</span>`;\r\n    }\r\n\r\n    if(skill.parent_skill) {\r\n        tooltip_desc.innerHTML += `<br>Parent skill: ${skill.parent_skill}<br><br>`; \r\n    }\r\n    \r\n    skill_bar_max.appendChild(skill_bar_text);\r\n    skill_bar_max.appendChild(skill_bar_current);\r\n    skill_bar_max.appendChild(skill_tooltip);\r\n\r\n    skill_bar_divs[skill.category][skill.skill_id].appendChild(skill_bar_max);\r\n    skill_bar_divs[skill.category][skill.skill_id].setAttribute(\"data-skill\", skill.skill_id);\r\n    skill_bar_divs[skill.category][skill.skill_id].classList.add(\"skill_div\");\r\n    skill_list.querySelector(`[data-skill_category=${skill.category}]`).querySelector(\"[data-skill_category_skills]\").appendChild(skill_bar_divs[skill.category][skill.skill_id]);\r\n\r\n    //sorts skill_list div alphabetically\r\n    sort_displayed_skills({});\r\n    sort_displayed_skill_categories();\r\n    update_displayed_skill_xp_gain(skill);\r\n}\r\n\r\n/**\r\n * \r\n * @param {Skill} skill \r\n * @param {Boolean} leveled_up \r\n * @returns \r\n */\r\nfunction update_displayed_skill_bar(skill, leveled_up=true) {\r\n    /*\r\n    skill_bar divs: \r\n        skill -> children (1): \r\n            skill_bar_max -> children(3): \r\n                skill_bar_text -> children(2):\r\n                    skill_bar_name,\r\n                    skill_bar_xp\r\n                skill_bar_current, \r\n                skill_tooltip -> children(5):\r\n                    tooltip_xp,\r\n                    tooltip_xp_gain,\r\n                    tooltip_desc,\r\n                    tooltip_effect,\r\n                    tooltip_milestones,\r\n                    tooltip_next\r\n    */\r\n\r\n    if(!skill_bar_divs[skill.category][skill.skill_id]) {\r\n        return;\r\n    }\r\n\r\n    update_displayed_skill_level(skill);\r\n\r\n    if (skill.current_xp !== \"Max\") {\r\n        skill_bar_divs[skill.category][skill.skill_id].children[0].classList.remove(\"skill_bar_capped\");\r\n        skill_bar_divs[skill.category][skill.skill_id].children[0].children[0].children[1].innerHTML = `${100*Math.floor(skill.current_xp/skill.xp_to_next_lvl*1000)/1000}%`;\r\n        skill_bar_divs[skill.category][skill.skill_id].children[0].children[2].children[0].innerHTML = `${expo(skill.current_xp)} / ${expo(skill.xp_to_next_lvl)}`;\r\n\r\n    } else {\r\n        skill_bar_divs[skill.category][skill.skill_id].children[0].classList.add(\"skill_bar_capped\");\r\n        skill_bar_divs[skill.category][skill.skill_id].children[0].children[0].children[1].innerHTML = `Max!`;\r\n        skill_bar_divs[skill.category][skill.skill_id].children[0].children[2].children[0].innerHTML = `Maxed out!`;\r\n    }\r\n    //skill_bar_xp && tooltip_xp\r\n\r\n    skill_bar_divs[skill.category][skill.skill_id].children[0].children[1].style.width = `${100*skill.current_xp/skill.xp_to_next_lvl}%`;\r\n    //skill_bar_current\r\n\r\n    if(get_unlocked_skill_rewards(skill.skill_id)) {\r\n        skill_bar_divs[skill.category][skill.skill_id].children[0].children[2].children[4].innerHTML  = `<br>${get_unlocked_skill_rewards(skill.skill_id)}`;\r\n    }\r\n\r\n    if(typeof get_next_skill_milestone(skill.skill_id) !== \"undefined\") {\r\n        skill_bar_divs[skill.category][skill.skill_id].children[0].children[2].children[5].innerHTML  = `lvl ${get_next_skill_milestone(skill.skill_id)}: ???`;\r\n    } else {\r\n        skill_bar_divs[skill.category][skill.skill_id].children[0].children[2].children[5].innerHTML = \"\";\r\n    }\r\n\r\n    if(typeof skill.get_effect_description !== \"undefined\") {\r\n        skill_bar_divs[skill.category][skill.skill_id].children[0].children[2].children[3].innerHTML = `${skill.get_effect_description()}`;\r\n        //tooltip_effect\r\n    }\r\n    \r\n    if(leveled_up) {\r\n        sort_displayed_skills({sort_by: skill_sorting}); //in case of a name change on levelup\r\n    }\r\n}\r\n\r\nfunction update_displayed_skill_level(skill) {\r\n    if(!skill_bar_divs[skill.category]?.[skill.skill_id]) {\r\n        return;\r\n    }\r\n\r\n    skill_bar_divs[skill.category][skill.skill_id].children[0].children[0].children[0].innerHTML = `${skill.name()} : level ${skill.current_level}/${skill.max_level}`;\r\n    const bonus = character.bonus_skill_levels.full[skill.skill_id];\r\n    if(bonus != 0) {\r\n        if(bonus > 0) {\r\n            skill_bar_divs[skill.category][skill.skill_id].children[0].children[0].children[0].innerHTML += ` <b>[+${bonus}]</b>`;\r\n        } else {\r\n            skill_bar_divs[skill.category][skill.skill_id].children[0].children[0].children[0].innerHTML += ` <b>[${bonus}]</b>`;\r\n        }\r\n    }\r\n}\r\n\r\nfunction update_displayed_skill_description(skill) {\r\n    if(!skill_bar_divs[skill.category][skill.skill_id]) {\r\n        return;\r\n    }\r\n    skill_bar_divs[skill.category][skill.skill_id].children[0].children[2].children[3].innerHTML = `${skill.get_effect_description()}`;\r\n}\r\n\r\nfunction update_displayed_skill_xp_gain(skill) {\r\n    if(!skill_bar_divs[skill.category] || !skill_bar_divs[skill.category][skill.skill_id]){\r\n        return;\r\n    }\r\n    const xp_gain = Math.round(100*skill.get_parent_xp_multiplier()*get_skill_xp_gain(skill.skill_id))/100 || 1;\r\n    skill_bar_divs[skill.category][skill.skill_id].children[0].children[2].children[1].innerHTML = `XP gain: x${xp_gain}<br><span>XP cost scaling: x${skill.xp_scaling}</span>`;\r\n}\r\n\r\nfunction update_all_displayed_skills_xp_gain(){\r\n    Object.keys(skill_bar_divs).forEach(category => {\r\n        Object.keys(skill_bar_divs[category]).forEach(skill_id => {\r\n            update_displayed_skill_xp_gain(skills[skill_id]);\r\n        });\r\n    });\r\n}\r\n\r\nfunction sort_displayed_skills({sort_by=\"name\", change_direction=false}) {\r\n    if(change_direction){\r\n        if(sort_by && sort_by === skill_sorting) {\r\n            if(skill_sorting_direction === \"asc\") {\r\n                skill_sorting_direction = \"desc\";\r\n            } else {\r\n                skill_sorting_direction = \"asc\";\r\n            }\r\n        } else {\r\n            if(sort_by === \"level\") {\r\n                skill_sorting_direction = \"desc\";\r\n            } else {\r\n                skill_sorting_direction = \"asc\";\r\n            }\r\n        }\r\n    }\r\n\r\n    skill_sorting = sort_by;\r\n\r\n    let plus = skill_sorting_direction==\"asc\"?1:-1;\r\n    let minus = skill_sorting_direction===\"asc\"?-1:1;\r\n    for(let i = 0; i < skill_list.children.length; i++) {\r\n        \r\n        [...skill_list.children[i].querySelector(\"[data-skill_category_skills]\").children].sort((a,b) => {\r\n            let elem_a;\r\n            let elem_b;\r\n            if (sort_by === \"level\") {\r\n                skill_sorting = sort_by;\r\n                elem_a = skills[a.getAttribute(\"data-skill\")].current_level;\r\n                elem_b = skills[b.getAttribute(\"data-skill\")].current_level;\r\n            } else if (sort_by === \"progress\") {\r\n                if (isNaN(skills[a.getAttribute(\"data-skill\")].current_xp)) return 1;\r\n                if (isNaN(skills[b.getAttribute(\"data-skill\")].current_xp)) return -1;\r\n\r\n                elem_a = -skills[a.getAttribute(\"data-skill\")].current_xp / skills[a.getAttribute(\"data-skill\")].xp_to_next_lvl;\r\n                elem_b = -skills[b.getAttribute(\"data-skill\")].current_xp / skills[b.getAttribute(\"data-skill\")].xp_to_next_lvl ;\r\n            } else {\r\n                elem_a = skills[a.getAttribute(\"data-skill\")].name();\r\n                elem_b = skills[b.getAttribute(\"data-skill\")].name();\r\n                skill_sorting = \"name\";\r\n            }\r\n    \r\n            if(elem_a > elem_b) {\r\n                return plus;\r\n            } else {\r\n                return minus;\r\n            }\r\n    \r\n    \r\n        }).forEach(node=>skill_list.children[i].querySelector(\"[data-skill_category_skills\").appendChild(node));\r\n    }\r\n}\r\n\r\n/**\r\n * sorts displayed skill categories alphabeticaly\r\n */\r\nfunction sort_displayed_skill_categories() {\r\n    [...skill_list.children].sort((a, b) => {\r\n\r\n        let pos_a = skill_category_order.indexOf(a.dataset.skill_category);\r\n        let pos_b = skill_category_order.indexOf(b.dataset.skill_category);\r\n\r\n        if (pos_a == -1 || pos_b == -1) {\r\n            //if it doesn't have a specific position assigned, place it alphabetically\r\n            return a.dataset.skill_category > b.dataset.skill_category ? 1 : -1;\r\n        }\r\n        else {\r\n            return pos_a > pos_b ? 1 : -1;\r\n        }\r\n    }).forEach(node=>skill_list.appendChild(node));\r\n}\r\n\r\nfunction update_skill_category_order() {\r\n    skill_category_order.length = 0;\r\n    [...skill_list.children].forEach((elem, idx) => {\r\n        skill_category_order[idx] = elem.dataset.skill_category;\r\n    });\r\n}\r\n\r\n/**\r\n * @description updates the list of stances, \r\n */\r\nfunction update_displayed_stance_list(stances, current_stance, fav_stances) {\r\n    while(stance_list.firstChild) {\r\n        stance_list.removeChild(stance_list.lastChild);\r\n    }\r\n    Object.keys(stance_bar_divs).forEach(bar => {\r\n        delete stance_bar_divs[bar];\r\n    })\r\n\r\n    stance_list.innerHTML = \r\n    `<tr class=\"stance_list_entry stance_list_header\">\r\n        <th class=\"stance_list_header stance_list_header_fav\">Fav</th>\r\n        <th class=\"stance_list_header stance_list_header_select\">Select</th>\r\n        <th class=\"stance_list_header stance_list_header_name\">Name</th>\r\n    </tr>`\r\n\r\n    Object.keys(stances).forEach(stance => {\r\n        if(stances[stance].is_unlocked) {\r\n            stance_bar_divs[stance] = document.createElement(\"tr\");\r\n            stance_bar_divs[stance].classList.add(\"stance_list_entry\");\r\n            stance_bar_divs[stance].dataset.stance = stance;\r\n\r\n            const fav_selection = `<td class=\"stances_button stances_button_checkbox\"><input type=\"checkbox\" id=\"stances_fav_${stance}\" name=\"stance_fav_selection\" onclick=\"fav_stance('${stance}')\"></td>`;\r\n            const stance_selection = `<td class=\"stances_button stances_button_radio\"><input type=\"radio\" id=\"stances_select_${stance}\" name=\"stance_list_selection\" onclick=\"select_stance('${stance}')\"></td>`;\r\n            const stance_info = \r\n                `<td class=\"stances_name\"><label for=\"stances_select_${stance}\">${stances[stance].name}</td>`\r\n\r\n            stance_bar_divs[stance].innerHTML = fav_selection;\r\n            stance_bar_divs[stance].innerHTML += stance_selection;\r\n            stance_bar_divs[stance].innerHTML += stance_info\r\n            \r\n            const stance_tooltip_row = document.createElement(\"td\");\r\n            \r\n            stance_tooltip_row.appendChild(create_stance_tooltip(stances[stance]));\r\n            stance_bar_divs[stance].appendChild(stance_tooltip_row);\r\n            stance_list.append(stance_bar_divs[stance]);\r\n        }\r\n    });\r\n\r\n    //different stamina cost: cheaper first; same stamina cost: sort alphabetically\r\n    [...stance_list.children].sort((a,b)=>{\r\n        const stance_a = stances[a.getAttribute(\"data-stance\")];\r\n        const stance_b = stances[b.getAttribute(\"data-stance\")];\r\n        if(!stance_b) {\r\n            return 1;\r\n        } else if(!stance_a) {\r\n            return -1;\r\n        }\r\n\r\n        if(!stance_a || !stance_b || !stance_a.is_unlocked || !stance_b.is_unlocked) {\r\n            console.error(`No such stance as either '${stance_a}' or '${stance_b}', or at least one of them is not yet unlocked!`);\r\n        }\r\n        \r\n        if(stance_a.stamina_cost < stance_b.stamina_cost) {\r\n            return -1;\r\n        } else if(stance_a.stamina_cost > stance_b.stamina_cost) {\r\n            return 1;\r\n        } else {\r\n            if(stance_a.name > stance_b.name) {\r\n                return 1;\r\n            } else {\r\n                return -1;\r\n            }\r\n        }\r\n    }).forEach(node=>stance_list.appendChild(node));\r\n\r\n    update_displayed_stance(current_stance);\r\n    update_displayed_faved_stances(fav_stances);\r\n}\r\n\r\nfunction create_stance_tooltip(stance) {\r\n    const tooltip_div = document.createElement(\"div\");\r\n    tooltip_div.classList.add(\"stance_tooltip\");\r\n    tooltip_div.innerHTML = \r\n    `<div>${stance.name}</div><br>\r\n    <div>${stance.getDescription()}</div><br>\r\n    <div>Stamina cost: ${stance.stamina_cost}</div>\r\n    <div class='stance_tooltip_stats'>${create_stance_tooltip_stats(stance)}</div`;\r\n\r\n    let target_count = stance.target_count;\r\n    if(target_count > 1 && stance.related_skill) {\r\n        target_count = target_count + Math.round(target_count * get_total_skill_level(stance.related_skill)/skills[stance.related_skill].max_level);\r\n    }\r\n\r\n    if(target_count > 1) {\r\n        tooltip_div.innerHTML += `\r\n        <br><div class='stance_tooltip_hitcount'>${stance.randomize_target_count?\"Randomly hits up to\":\"Hits up to\"} ${target_count} enemies</div>`;\r\n    }\r\n\r\n    return tooltip_div;\r\n}\r\n\r\nfunction create_stance_tooltip_stats(stance) {\r\n    let desc = \"\";\r\n    const stats = stance.getStats()\r\n    Object.keys(stats).forEach(stat => {\r\n        desc += `<br>x${Math.round(100*stats[stat])/100} ${stat_names[stat]}`;\r\n    });\r\n\r\n    return desc;\r\n}\r\n\r\nfunction update_stance_tooltip(stance) {\r\n    stance_bar_divs[stance.id].querySelector(\".stance_tooltip_stats\").innerHTML = create_stance_tooltip_stats(stance);\r\n\r\n    let target_count = stance.target_count;\r\n    if(target_count > 1){\r\n        if(stance.related_skill) {\r\n            target_count = target_count + Math.round(target_count * get_total_skill_level(stance.related_skill)/skills[stance.related_skill].max_level);\r\n        }\r\n        stance_bar_divs[stance.id].querySelector(\".stance_tooltip_hitcount\").innerHTML = `${stance.randomize_target_count?\"Randomly hits up to\":\"Hits up to\"} ${target_count} enemies</div>`;\r\n    } \r\n}\r\n\r\n/**\r\n * \r\n * @param {Stance} stance current stance \r\n */\r\nfunction update_displayed_stance(stance) {\r\n    stance_bar_divs[stance.id].children[1].children[0].checked = true;\r\n    document.getElementById(\"character_stance_name\").children[0].innerHTML = stance.name;\r\n\r\n    const selection = document.getElementById(\"character_stance_selection\");\r\n\r\n    if(selection.children) {\r\n        if(selection.querySelector(`[data-stance='${stance.id}']`)) {\r\n            selection.querySelector(`[data-stance='${stance.id}']`).children[0].checked = true;\r\n        } else if(!faved_stances[stance.id] && selection.querySelector('[data-stance] :checked')) {\r\n            selection.querySelector('[data-stance] :checked').checked = false;\r\n        }\r\n    }\r\n}\r\n\r\nfunction update_displayed_faved_stances(stances) {\r\n    \r\n    const list = document.getElementById(\"character_stance_selection\");\r\n    list.innerHTML = \"\";\r\n    Object.keys(faved_stances).forEach(stance => {\r\n        stance_bar_divs[stance].children[0].children[0].checked = true;\r\n\r\n        const node = \r\n        `<div data-stance=\"${stance}\"><input type=\"radio\" id=\"stances_quick_select_${stance}\" name=\"stance_quick_selection\" onclick=\"select_stance('${stance}')\">\r\n         <label for=\"stances_quick_select_${stance}\">${stances[stance].name}</div>`;\r\n        list.innerHTML += node;\r\n    });\r\n\r\n    //different stamina cost: cheaper first; same stamina cost: sort alphabetically\r\n    [...list.children].sort((a,b)=>{\r\n        const stance_a = stances[a.getAttribute(\"data-stance\")];\r\n        const stance_b = stances[b.getAttribute(\"data-stance\")];\r\n\r\n        if(!stance_a || !stance_b) {\r\n            console.error(`No such stance as either '${stance_a}' or '${stance_b}'!`);\r\n        }\r\n        \r\n        if(stance_a.stamina_cost < stance_b.stamina_cost) {\r\n            return -1;\r\n        } else if(stance_a.stamina_cost > stance_b.stamina_cost) {\r\n            return 1;\r\n        } else {\r\n            if(stance_a.name > stance_b.name) {\r\n                return 1;\r\n            } else {\r\n                return -1;\r\n            }\r\n        }\r\n    }).forEach(node=>list.appendChild(node));\r\n\r\n    //mark selected stance as checked in quick selection\r\n\r\n    const selection = document.getElementById(\"character_stance_selection\");\r\n    if(selection.children && selection.querySelector(`[data-stance='${selected_stance}']`)) {\r\n        selection.querySelector(`[data-stance='${selected_stance}']`).children[0].checked = true;\r\n    }\r\n}\r\n\r\n/**\r\n * creates a new bestiary entry;\r\n * called when a new enemy is killed (or, you know, loading a save)\r\n * @param {String} enemy_name \r\n */\r\nfunction create_new_bestiary_entry(enemy_name) {\r\n    const enemy = enemy_templates[enemy_name];\r\n    bestiary_entry_divs[enemy_name] = document.createElement(\"div\");\r\n    \r\n    bestiary_entry_divs[enemy_name].innerHTML = create_bestiary_entry_content(enemy_name);\r\n\r\n    bestiary_entry_divs[enemy_name].setAttribute(\"data-bestiary_rank\", enemy.rank);\r\n    bestiary_entry_divs[enemy_name].classList.add(\"bestiary_entry_div\");\r\n    bestiary_list.appendChild(bestiary_entry_divs[enemy_name]);\r\n\r\n    //sorts bestiary_list div by enemy rank\r\n    [...bestiary_list.children].sort((a,b)=> {\r\n        const rank_a = parseInt(a.getAttribute(\"data-bestiary_rank\"));\r\n        const rank_b = parseInt(b.getAttribute(\"data-bestiary_rank\"));\r\n        if(rank_a != rank_b) {\r\n            return rank_a - rank_b;\r\n        } else {\r\n            const name_a = a.querySelector(\".bestiary_entry_name\").innerText;\r\n            const name_b = b.querySelector(\".bestiary_entry_name\").innerText;\r\n            if(name_a > name_b) {\r\n                return 1;\r\n            } else {\r\n                return -1;\r\n            }\r\n        }\r\n    }).forEach(node=>bestiary_list.appendChild(node));\r\n}\r\n\r\nfunction create_bestiary_entry_content(enemy_name) {\r\n    const entry_div = document.createElement(\"div\");\r\n\r\n    const name_div = document.createElement(\"div\");\r\n    name_div.innerHTML = enemy_name;\r\n    name_div.classList.add(\"bestiary_entry_name\");\r\n    const kill_counter = document.createElement(\"div\");\r\n    kill_counter.innerHTML = enemy_killcount[enemy_name];\r\n    kill_counter.classList.add(\"bestiary_entry_kill_count\");\r\n    \r\n    entry_div.appendChild(name_div);\r\n    entry_div.appendChild(kill_counter);\r\n    entry_div.appendChild(create_bestiary_entry_tooltip(enemy_name));\r\n    return entry_div.innerHTML;\r\n}\r\n\r\nfunction create_bestiary_entry_tooltip(enemy_name) {\r\n    const enemy = enemy_templates[enemy_name];\r\n    const bestiary_tooltip = document.createElement(\"div\");\r\n    bestiary_tooltip.classList.add(\"bestiary_entry_tooltip\");\r\n\r\n    const tooltip_xp = document.createElement(\"div\"); //base xp enemy gives\r\n    tooltip_xp.innerHTML = `<br>Base xp value: ${enemy.xp_value} <br><br>`;\r\n    const tooltip_desc = document.createElement(\"div\"); //enemy description\r\n    tooltip_desc.innerHTML = enemy.description;\r\n\r\n    const tooltip_tags = document.createElement(\"div\"); //enemy description\r\n\r\n    Object.keys(enemy.tags).forEach(tag => {\r\n        tooltip_tags.innerHTML += `[${tag}] `\r\n    });\r\n    tooltip_tags.innerHTML += \"<br><br>\";\r\n\r\n    const tooltip_stats = document.createElement(\"div\"); //base enemy stats\r\n    tooltip_stats.innerHTML = \"Stats: <br>\"\r\n\r\n    const stat_line_0 = document.createElement(\"div\");\r\n    stat_line_0.classList.add(\"grid_container\");\r\n    stat_line_0.append(create_bestiary_stat_entry(enemy, \"Health\"), create_bestiary_stat_entry(enemy, \"Defense\"));\r\n\r\n    const stat_line_2 = document.createElement(\"div\");\r\n    stat_line_2.classList.add(\"grid_container\");\r\n    stat_line_2.append(create_bestiary_stat_entry(enemy, \"Attack power\"), create_bestiary_stat_entry(enemy, \"Attack speed\"));\r\n\r\n    const stat_line_4 = document.createElement(\"div\");\r\n    stat_line_4.classList.add(\"grid_container\");\r\n    stat_line_4.append(create_bestiary_stat_entry(enemy, \"AP\"), create_bestiary_stat_entry(enemy, \"EP\"));\r\n    \r\n    tooltip_stats.appendChild(stat_line_0);\r\n    tooltip_stats.appendChild(stat_line_2);\r\n    tooltip_stats.appendChild(stat_line_4);\r\n\r\n    const tooltip_drops = document.createElement(\"div\"); //enemy drops\r\n    tooltip_drops.classList.add(\"loot_slots_div\");\r\n    if(enemy.loot_list.length > 0) {\r\n        tooltip_drops.appendChild(create_bestiary_loot_line());\r\n    }\r\n\r\n    for(let i = 0; i < enemy.loot_list.length; i++) {\r\n        tooltip_drops.appendChild(create_bestiary_loot_line(enemy, enemy.loot_list[i]));\r\n    }\r\n    \r\n    bestiary_tooltip.appendChild(tooltip_desc);\r\n    bestiary_tooltip.appendChild(tooltip_xp);\r\n    bestiary_tooltip.appendChild(tooltip_tags);\r\n    bestiary_tooltip.appendChild(tooltip_stats);\r\n    bestiary_tooltip.appendChild(tooltip_drops);\r\n\r\n    return bestiary_tooltip;\r\n}\r\n\r\nfunction update_bestiary_entry_tooltip(enemy_name) {\r\n    const tooltip = bestiary_entry_divs[enemy_name].querySelector(\".bestiary_entry_tooltip\");\r\n    tooltip.replaceWith(create_bestiary_entry_tooltip(enemy_name));\r\n}\r\n\r\n\r\n/**\r\n * updates the entire bestiary entry of an enemy\r\n * @param {String} enemy_name \r\n */\r\nfunction update_bestiary_entry(enemy_name) {\r\n    bestiary_entry_divs[enemy_name].innerHTML = create_bestiary_entry_content(enemy_name);\r\n}\r\n\r\n/**\r\n * @param {String} enemy_name \r\n */\r\nfunction update_bestiary_entry_killcount(enemy_name) {\r\n    bestiary_entry_divs[enemy_name].children[1].innerHTML = enemy_killcount[enemy_name];\r\n}\r\n\r\nfunction create_bestiary_loot_line(enemy, loot) {\r\n    const loot_line = document.createElement(\"div\");\r\n    const loot_name = document.createElement(\"div\");\r\n    const loot_chance = document.createElement(\"div\");\r\n    const loot_chance_base = document.createElement(\"div\");\r\n    const loot_chance_current = document.createElement(\"div\");\r\n\r\n    loot_line.classList.add(\"loot_slot_div\");\r\n    loot_name.classList.add(\"loot_name\");\r\n    loot_chance.classList.add(\"loot_chance\");\r\n    loot_chance_base.classList.add(\"loot_chance_base\");\r\n    loot_chance_current.classList.add(\"loot_chance_current\");\r\n\r\n    if(enemy) {\r\n        //create based on data passed\r\n        loot_name.innerHTML = `${loot.item_name}`;\r\n        loot_chance_base.innerHTML = `[${loot.chance*100}%]`;\r\n        loot_chance_current.innerHTML = `${Math.round(10000*loot.chance*enemy.get_droprate_modifier())/100}%`;\r\n        loot_chance.append(loot_chance_current, loot_chance_base);\r\n        loot_line.append(loot_name, loot_chance);\r\n    } else {\r\n        //create a header line\r\n        loot_name.innerHTML = `Item name`;\r\n        loot_chance_base.innerHTML = `base %`;\r\n        loot_chance_current.innerHTML = `current %`;\r\n        loot_chance.append(loot_chance_current, loot_chance_base);\r\n        loot_line.append(loot_name, loot_chance);\r\n    }\r\n\r\n    return loot_line;\r\n}\r\n\r\nfunction create_bestiary_stat_entry(enemy, stat_name) {\r\n    const stat_entry = document.createElement(\"div\");\r\n    const stat_name_div = document.createElement(\"div\");\r\n    const stat_value_div = document.createElement(\"div\");\r\n\r\n    stat_entry.classList.add(\"stat_slot_div\");\r\n    stat_name_div.classList.add(\"stat_name\");\r\n    stat_value_div.classList.add(\"stat_value\");\r\n\r\n\r\n    switch(stat_name) {\r\n        case \"Health\": \r\n            stat_name_div.innerHTML = \"Health:\";\r\n            stat_value_div.innerHTML = `${enemy.stats.health}`;\r\n            stat_entry.append(stat_name_div, stat_value_div);\r\n        break;\r\n        case \"Defense\":\r\n            stat_name_div.innerHTML = `Defense:`;\r\n            stat_value_div.innerHTML = `${enemy.stats.defense}`;\r\n            stat_entry.append(stat_name_div, stat_value_div);\r\n        break;\r\n        case \"Attack power\":\r\n            stat_name_div.innerHTML = \"Attack power:\";\r\n            stat_value_div.innerHTML = `${enemy.stats.attack}`;\r\n            if(enemy.stats.attack_count > 1) {\r\n                stat_value_div.innerHTML += `x${enemy.stats.attack_count}`;\r\n            }\r\n            stat_entry.append(stat_name_div, stat_value_div);\r\n        break;\r\n        case \"Attack speed\":\r\n            stat_name_div.innerHTML = `Attack speed:`;\r\n            stat_value_div.innerHTML = `${enemy.stats.attack_speed}`;\r\n            stat_entry.append(stat_name_div, stat_value_div);\r\n        break;\r\n        case \"AP\":\r\n            stat_name_div.innerHTML = \"AP:\";\r\n            stat_value_div.innerHTML = `${Math.round(enemy.stats.dexterity * Math.sqrt(enemy.stats.intuition || 1))}`;\r\n            stat_entry.append(stat_name_div, stat_value_div);\r\n        break;\r\n        case \"EP\":\r\n            stat_name_div.innerHTML = \"EP:\";\r\n            stat_value_div.innerHTML = `${Math.round(enemy.stats.agility * Math.sqrt(enemy.stats.intuition || 1))}`;\r\n            stat_entry.append(stat_name_div, stat_value_div);\r\n        break;\r\n    }\r\n\r\n    return stat_entry;\r\n}\r\n\r\nfunction clear_bestiary() {\r\n    Object.keys(bestiary_entry_divs).forEach((enemy) => {\r\n        delete bestiary_entry_divs[enemy];\r\n    });\r\n}\r\n\r\n/**\r\n * creates a new booklist entry;\r\n * called when a new enemy is killed (or, you know, loading a save)\r\n * @param {String} enemy_name \r\n */\r\nfunction create_new_booklist_entry(book_name) {\r\n    booklist_entry_divs[book_name] = document.createElement(\"div\");\r\n    \r\n    let book = item_templates[book_name];\r\n\r\n    let name_div = document.createElement(\"div\");\r\n    name_div.innerHTML = book_name;\r\n    name_div.classList.add(\"anthology_entry_name\");\r\n\r\n    let tooltip = create_item_tooltip(book);//document.createElement(\"div\");\r\n    tooltip.classList.add(\"anthology_entry_tooltip\")\r\n    //tooltip.appendChild(create_item_tooltip(book));\r\n\r\n    booklist_entry_divs[book_name].appendChild(name_div);\r\n    booklist_entry_divs[book_name].appendChild(tooltip);\r\n    booklist_entry_divs[book_name].setAttribute(\"data-book\", book_name);\r\n    booklist_entry_divs[book_name].classList.add(\"anthology_entry_div\");\r\n\r\n    booklist_list.appendChild(booklist_entry_divs[book_name]);\r\n\r\n    //sorts booklist_list div by book title\r\n    [...booklist_list.children].sort((a,b)=>a.getAttribute(\"data-book\") - b.getAttribute(\"data-book\"))\r\n                                .forEach(node=>booklist_list.appendChild(node));\r\n}\r\n\r\n/**\r\n * updates the anthology entry of a book (style and tooltip);\r\n * @param {String} book_name \r\n */\r\nfunction update_booklist_entry(book_name, read) {\r\n    if(!booklist_entry_divs[book_name]) {\r\n        create_new_booklist_entry(book_name);\r\n    }\r\n\r\n    booklist_entry_divs[book_name].children[1].innerHTML = create_item_tooltip_content({item: item_templates[book_name]});\r\n    booklist_entry_divs[book_name].style.display = read ? \"flex\" : \"none\";\r\n}\r\n\r\nfunction clear_booklist() {\r\n    Object.keys(booklist_entry_divs).forEach((book) => {\r\n        delete booklist_entry_divs[book];\r\n    });\r\n}\r\n\r\nfunction clear_skill_list(){\r\n    while(skill_list.firstChild) {\r\n        skill_list.removeChild(skill_list.lastChild);\r\n    } //remove skill bars from display\r\n\r\n}\r\n\r\nfunction update_enemy_attack_bar(enemy_id, num) {\r\n    enemies_div.children[enemy_id].querySelector(\".enemy_attack_bar\").style.width = `${Math.min(num*100,100)}%`;\r\n}\r\n\r\nfunction do_enemy_onhit_animation(enemy_id) {\r\n    const enemy_div = enemies_div.children[enemy_id];\r\n    enemy_animations[enemy_id]?.cancel(); //almost certainly unnecessary\r\n    enemy_animations[enemy_id] = enemy_div.animate(onhitAnimation, onhitAnimationTiming);\r\n}\r\n\r\nfunction remove_enemy_onhit_animation(enemy_id) {\r\n    enemy_animations[enemy_id]?.cancel();\r\n}\r\n\r\nfunction do_enemy_onstart_animation(enemy_id) {\r\n    const enemy_div = enemies_div.children[enemy_id];\r\n    enemy_animations[enemy_id]?.cancel(); //almost certainly unnecessary\r\n    enemy_animations[enemy_id] =  enemy_div.animate(onstartAnimation, onstartAnimationTiming);\r\n}\r\n\r\nfunction update_character_attack_bar(num) {\r\n    character_attack_bar.style.width = `${Math.min(num*100,100)}%`;\r\n}\r\n\r\n/**\r\n * Adds quest to display\r\n * @param {String} quest_id \r\n * @returns \r\n */\r\nfunction add_quest_to_display(quest_id) {\r\n    if(quest_entry_divs[quest_id]) {\r\n        console.warn(`Tried to add quest \"${quest_id}\" to display, but it's already there!`);\r\n        return;\r\n    } else if(quests[quest_id].is_hidden) {\r\n        //do not display hidden quests (that's the whole point)\r\n        console.warn(`Tried to add quest \"${quest_id}\" to display, but it's a hidden quest!`);\r\n        return;\r\n    }\r\n\r\n    const quest = quests[quest_id];\r\n\r\n    const quest_div = create_displayed_quest_content(quest_id);\r\n    quest_entry_divs[quest_id] = quest_div;\r\n    quest_list.appendChild(quest_div);\r\n\r\n    if(quest.is_finished) {\r\n        quest_div.classList.add(\"quest_finished\");\r\n    }\r\n\r\n    sort_displayed_quests();\r\n}\r\n\r\n/**\r\n * updates name, description and task list\r\n * @param {*} quest_id \r\n * @returns \r\n */\r\nfunction update_displayed_quest(quest_id) {\r\n    \r\n    if(quests[quest_id].is_hidden) {\r\n        console.warn(`Tried to update display of quest \"${quest_id}\", but it's a hidden quest!`);\r\n        console.trace()\r\n        return;\r\n    } else if(!quest_entry_divs[quest_id]) {\r\n        console.warn(`Tried to update display of quest \"${quest_id}\", but it's not in display!`);\r\n        return;\r\n    }\r\n\r\n    const quest = quests[quest_id];\r\n\r\n    const quest_div = document.querySelector(`[data-quest_id=\"${quest_id}\"]`);\r\n    const quest_name_div = quest_div.querySelector(\".quest_name_div\");\r\n    quest_name_div.innerHTML = quest.getQuestName();\r\n\r\n    const quest_description_div = quest_div.querySelector(\".quest_description_div\");\r\n    quest_description_div.innerHTML = quest.getQuestDescription() ?? \"\";\r\n\r\n    if(quest.is_finished) {\r\n        quest_div.classList.add(\"quest_finished\");\r\n    }\r\n    \r\n    update_displayed_quest_tasks(quest_id);\r\n\r\n    sort_displayed_quests();\r\n}\r\n\r\nfunction sort_displayed_quests() {\r\n        [...quest_list.children].sort((a,b) => {\r\n            let quest_a = quests[a.getAttribute(\"data-quest_id\")];\r\n            let quest_b = quests[b.getAttribute(\"data-quest_id\")];\r\n            if(quest_a.is_finished && !quest_b.is_finished) {\r\n                return 1;\r\n            } else if(!quest_a.is_finished && quest_b.is_finished) {\r\n                return -1;\r\n            } else {\r\n                if(quest_a.display_priority !== quest_b.display_priority) {\r\n                    return quest_a.display_priority - quest_b.display_priority;\r\n                } else {\r\n                    if(quest_a.getQuestName() > quest_b.getQuestName()) {\r\n                        return 1;\r\n                    } else {\r\n                        return -1;\r\n                    }\r\n                }\r\n            }\r\n    \r\n        }).forEach(node=>quest_list.appendChild(node));\r\n    \r\n}\r\n\r\n/**\r\n * Creates and returns a quest div to be used by other functions\r\n * @param {String} quest_id \r\n * @returns {HTMLDivElement}\r\n */\r\nfunction create_displayed_quest_content(quest_id) {\r\n\r\n    const quest = quests[quest_id];\r\n\r\n    const quest_div = document.createElement(\"div\");\r\n    quest_div.dataset.quest_id = quest_id;\r\n    const quest_description_div = document.createElement(\"div\");\r\n    const quest_name_div = document.createElement(\"div\");\r\n    quest_div.classList.add(\"quest_div\");\r\n    //add an icon to show whether finished or active\r\n    //add a dropdown icon\r\n\r\n    quest_name_div.innerHTML = quest.getQuestName();\r\n    quest_name_div.classList.add(\"quest_name_div\");\r\n\r\n    quest_description_div.innerHTML = quest.getQuestDescription();\r\n    quest_description_div.classList.add(\"quest_description_div\");\r\n\r\n    quest_div.appendChild(quest_name_div);\r\n    quest_div.appendChild(quest_description_div);\r\n    quest_div.appendChild(create_displayed_quest_tasks_content(quest_id));\r\n\r\n    quest_div.addEventListener(\"click\", (event) => {\r\n        if(event.target.classList.contains(\"quest_name_div\")) {\r\n            quest_div.classList.toggle(\"quest_div_expanded\");\r\n        }\r\n    });\r\n\r\n    return quest_div;\r\n}\r\n\r\nfunction create_displayed_quest_tasks_content(quest_id) {\r\n    const quest = quests[quest_id];\r\n    const quest_tasks_div = document.createElement(\"div\");\r\n    quest_tasks_div.classList.add(\"quest_task_list_div\");\r\n    //put task description and tasks into it\r\n    //set color based on completion status\r\n\r\n    let unfinished_index = quest.quest_tasks.findIndex(x => !x.is_finished);\r\n    unfinished_index = unfinished_index==-1?quest.quest_tasks.length:unfinished_index;\r\n\r\n    for(let i = 0; i < unfinished_index; i++) {\r\n        if(!quest.quest_tasks[i].is_hidden) {\r\n            quest_tasks_div.appendChild(create_displayed_quest_task(quest_id, i));\r\n        }\r\n    }\r\n\r\n    if(unfinished_index !== quest.quest_tasks.length) {\r\n        //there should still be an unfinished task left, add it do display as well\r\n        if(!quest.quest_tasks[unfinished_index].is_hidden) {\r\n            quest_tasks_div.appendChild(create_displayed_quest_task(quest_id, unfinished_index));\r\n        }\r\n    }\r\n\r\n    return quest_tasks_div;\r\n}\r\n\r\nfunction create_displayed_quest_task(quest_id, task_index) {\r\n    const task = quests[quest_id].quest_tasks[task_index];\r\n    const task_div = document.createElement(\"div\");\r\n    task_div.classList.add(\"quest_task_div\");\r\n\r\n    const task_status_icon_span = document.createElement(\"span\");\r\n    task_status_icon_span.classList.add(\"task_status_icon\");\r\n    if(task.is_finished) {\r\n        task_div.classList.add(\"task_finished\");\r\n        task_status_icon_span.innerHTML = '<i class=\"material-icons\">check_box</i>';\r\n    } else {\r\n        task_status_icon_span.innerHTML = '<i class=\"material-icons\">check_box_outline_blank</i>';\r\n    }\r\n\r\n    const task_desc_div = document.createElement(\"div\");\r\n    task_desc_div.classList.add(\"task_description_div\");\r\n    task_desc_div.innerHTML = task.task_description;\r\n\r\n    const task_conditions_div = document.createElement(\"div\");\r\n\r\n    /*\r\n    task_group (any/all): {\r\n        task_type (kill/kill_any/clear/something_else?): { <- quest_event_type\r\n            task_target_id (some related id): { <- quest_event_target\r\n                target: Number,\r\n                current: Number,\r\n                requirements: [], //additional triggers needed, like \"weapon_unarmed\"\r\n    */\r\n    //goes through the properties and sets up display\r\n    let total_tasks = 0;\r\n    Object.keys(task.task_condition).forEach(task_group => {\r\n        if(Object.keys(task.task_condition[task_group]).length) {\r\n            const task_condition_div = document.createElement(\"div\");\r\n            task_condition_div.classList.add(\"task_condition_div\");\r\n            task_condition_div.innerHTML += task_group + \":\";\r\n            Object.keys(task.task_condition[task_group]).forEach(task_type => {\r\n                const task_type_div = document.createElement(\"div\");\r\n                task_type_div.classList.add(\"task_type_div\");\r\n                task_type_div.innerHTML += task_type_names[task_type] +\":\";\r\n                Object.keys(task.task_condition[task_group][task_type]).forEach(task_target_id => {\r\n                    const task_target_div = document.createElement(\"div\");\r\n                    task_target_div.classList.add(\"task_target_div\");\r\n                    task_target_div.innerHTML += task_target_id + \": \" + task.task_condition[task_group][task_type][task_target_id].current +\"/\"+task.task_condition[task_group][task_type][task_target_id].target;\r\n                    task_type_div.appendChild(task_target_div);\r\n                    total_tasks++;\r\n                });\r\n                task_condition_div.appendChild(task_type_div);\r\n            });\r\n\r\n            task_conditions_div.appendChild(task_condition_div);\r\n        }\r\n    });\r\n    \r\n    if(total_tasks == 1) {\r\n        //hides the \"any\"/\"all\" texts if there's only 1 task, as there's no point in displaying them in this specific case\r\n        const divs = task_conditions_div.getElementsByClassName(\"task_condition_div\");\r\n        for(let i = 0; i < divs.length; i++) {\r\n            divs.item(i).innerHTML = divs.item(i).innerHTML.replace(\"any:\",\"\").replace(\"all:\",\"\");\r\n        }\r\n    }\r\n\r\n    task_div.appendChild(task_status_icon_span);\r\n    task_div.appendChild(task_desc_div);\r\n    task_div.appendChild(task_conditions_div);\r\n    return task_div;\r\n}\r\n\r\nfunction update_displayed_quest_task(quest_id, task_index) {\r\n    const quest = quests[quest_id];\r\n    if(quest.quest_tasks[task_index].is_hidden || quest.is_hidden) {\r\n        return;\r\n    }\r\n\r\n    const quest_div = document.querySelector(`[data-quest_id=\"${quest_id}\"]`);\r\n    const quest_task_list_div = quest_div.querySelector(\".quest_task_list_div\");\r\n    const task_div = quest_task_list_div.children.item(task_index) || quest_task_list_div.children.item(task_index-1);\r\n\r\n    task_div.replaceWith(create_displayed_quest_task(quest_id, task_index));\r\n}\r\n\r\nfunction update_displayed_quest_tasks(quest_id) {\r\n    const quest_div = document.querySelector(`[data-quest_id=\"${quest_id}\"]`);\r\n    const tasks_div = quest_div.querySelector(\".quest_task_list_div\");\r\n    tasks_div.replaceWith(create_displayed_quest_tasks_content(quest_id)); //replace task list\r\n    tasks_div.remove();\r\n    //might need to go deeper with tasks if their content becomes foldable\r\n}\r\n\r\nfunction change_completed_quest_visibility() {\r\n    if(quest_hiding_button.checked) {\r\n        document.documentElement.style.setProperty(\"--completed_quest_display\", \"none\");\r\n    } else {\r\n        document.documentElement.style.setProperty(\"--completed_quest_display\", \"block\");\r\n    }\r\n}\r\n\r\nfunction start_rain_animation() {\r\n    start_background_animation(\"rain\");\r\n}\r\n\r\nfunction start_snow_animation() {\r\n    start_background_animation(\"snow\");\r\n}\r\n\r\n\r\nfunction start_stars_animation() {\r\n    start_background_animation(\"stars\");\r\n}\r\n\r\nfunction start_background_animation(type) {\r\n    \r\n    \r\n    stop_background_animation();\r\n\r\n    let particle_class;\r\n    switch(type) {\r\n        case \"snow\":\r\n            particle_class = SnowParticle;\r\n            canvas = document.getElementById(\"foreground_canvas\");\r\n            break;\r\n        case \"rain\":\r\n            particle_class = RainParticle;\r\n            canvas = document.getElementById(\"foreground_canvas\");\r\n            break;\r\n        case \"stars\":\r\n            particle_class = PointyStarParticle;\r\n            canvas = document.getElementById(\"background_canvas\");\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n\r\n    \r\n    context = canvas.getContext(\"2d\");\r\n    canvas.width = context.canvas.clientWidth;\r\n    \r\n    canvas.height = context.canvas.clientHeight;\r\n    background_animation_particles = [];\r\n    for(let i = 0; i < Math.ceil((canvas.width*canvas.height)/5000); i++) {\r\n        background_animation_particles.push(new particle_class({canvas}));\r\n    }\r\n\r\n    do_background_animation();\r\n}\r\n\r\nfunction stop_background_animation() {\r\n    canvas = canvas || document.getElementById(\"foreground_canvas\");\r\n    context = context || canvas.getContext(\"2d\");\r\n    context.clearRect(0, 0, canvas.width, canvas.height);\r\n    cancelAnimationFrame(background_animation);\r\n    clearTimeout(background_animation_timeout);\r\n}\r\n\r\nfunction do_background_animation() {\r\n    background_animation_timeout = setTimeout(() => {\r\n        background_animation = requestAnimationFrame(do_background_animation);\r\n        context.clearRect(0,0,canvas.width, canvas.height);\r\n        for(let i = 0; i < background_animation_particles.length; i++) {\r\n            background_animation_particles[i].draw();\r\n        }\r\n    }, 1000/60);\r\n}\r\n\r\nfunction update_export_button_tooltip(time_passed, time_until_reward) {\r\n    if(time_passed > time_until_reward) {\r\n        //just say reward is available\r\n        export_button_tooltip.innerHTML = \"Reward available!\";\r\n    } else {\r\n        //calculate irl time needed until reward\r\n        let time_needed = time_until_reward - time_passed;\r\n        time_needed /= 1000;\r\n        const seconds = Math.floor(time_needed%60);\r\n        time_needed = Math.floor(time_needed/60);\r\n        const minutes = Math.floor(time_needed%60);\r\n        time_needed = Math.floor(time_needed/60);\r\n        const hours = time_needed;\r\n\r\n        export_button_tooltip.innerHTML = `Reward available in: ${hours}:${minutes}:${seconds} real time`;\r\n    }\r\n}\r\n\r\nfunction update_backup_load_button(date_string){\r\n    if(date_string) {\r\n        backup_load_button.innerText = `Load the backup autosave [${date_string.replaceAll(\"_\",\":\")}]`;\r\n        backup_load_button.style[\"background-image\"] = `var(--options_gradient);`;\r\n        backup_load_button.style[\"background-color\"] = \"transparent\";\r\n        backup_load_button.style.color = \"white\";\r\n        backup_load_button.style.cursor = \"pointer\";\r\n    } else {\r\n        backup_load_button.style[\"background-image\"] = \"none\";\r\n        backup_load_button.style[\"background-color\"] = \"#181818\";\r\n        backup_load_button.style.color = \"gray\";\r\n        backup_load_button.style.cursor = \"not-allowed\";\r\n    }\r\n}\r\n\r\nfunction update_other_save_load_button(date_string, is_dev) {\r\n    if(is_dev) {\r\n        other_save_load_button.innerText = `Import save from main version`;\r\n    } else {\r\n        other_save_load_button.innerText = `Import save from dev version`;\r\n    }\r\n    if(date_string !== undefined) {\r\n        other_save_load_button.style[\"background-image\"] = `var(--options_gradient);`;\r\n        other_save_load_button.style[\"background-color\"] = \"transparent\";\r\n        other_save_load_button.style.color = \"white\";\r\n        other_save_load_button.style.cursor = \"pointer\";\r\n        if(date_string) {\r\n            other_save_load_button.innerText += ` [${date_string.replaceAll(\"_\",\":\")}]`;\r\n        } else {\r\n            other_save_load_button.innerText += ` [unknown date]`;\r\n        }\r\n    } else {\r\n        other_save_load_button.style[\"background-image\"] = \"none\";\r\n        other_save_load_button.style[\"background-color\"] = \"#181818\";\r\n        other_save_load_button.style.color = \"gray\";\r\n        other_save_load_button.style.cursor = \"not-allowed\";\r\n    }\r\n    \r\n}\r\n\r\nfunction hide_loading_screen() {\r\n    document.getElementById(\"loading_screen\").style.visibility = \"hidden\";\r\n}\r\n\r\nfunction set_loading_screen_versions(save_version) {\r\n    const loading_screen = document.getElementById(\"loading_screen_version_info\");\r\n    const current_version = get_game_version();\r\n    loading_screen.innerHTML = \r\n    `Save game version: ${save_version || \"none\"}<br>\r\n Current game version: ${current_version}<br>`;\r\n    if(save_version) {\r\n      if(save_version === current_version) {\r\n        loading_screen.innerHTML += \"<div class='top_border'>No changes since the last time you played~</div>\"\r\n        } else if(is_a_older_than_b(save_version, current_version)) {\r\n            loading_screen.innerHTML += \"<div class='top_border'>Game has been updated since the last time you played, check the changelog for more details</div>\";\r\n        } else {\r\n            loading_screen.innerHTML += \"<div class='top_border'>Your save is from a newer version of the game. Continuing is likely to lead to multiple issues!</div>\";\r\n        }\r\n    }\r\n}\r\n\r\nfunction set_loading_screen_progress(message) {\r\n    loading_progress_div.innerHTML = message;\r\n}\r\n\r\nfunction hide_loading_text() {\r\n    document.getElementById(\"loading_screen_loading_text\").classList.add(\"fade\");\r\n}\r\n\r\nfunction set_loading_screen_errors_warning() {\r\n    const loading_screen_errors_field = document.getElementById(\"loading_screen_status\");\r\n    loading_screen_errors_field.classList.remove('loading_screen_status_warnings');\r\n    loading_screen_errors_field.classList.add('loading_screen_status_errors');\r\n\r\n    loading_screen_errors_field.innerHTML = 'An error has occured on loading! Please open the browser console to check for details and then let the developer know!';\r\n}\r\n\r\nfunction set_loading_screen_warnings_warning() {\r\n    const loading_screen_errors_field = document.getElementById(\"loading_screen_status\");\r\n    loading_screen_errors_field.classList.add('loading_screen_status_warnings');\r\n    loading_screen_errors_field.innerHTML = \"A potential issue has occured on loading. Please open the browser console to check for details.\";\r\n}\r\n\r\nfunction show_play_button() {\r\n    const play_button = document.getElementById(\"loading_screen_play_button\");\r\n    play_button.classList.remove(\"none_display\");\r\n    play_button.classList.add(\"fade_in\");\r\n}\r\n\r\nfunction set_play_button_text(text) {\r\n    const play_button = document.getElementById(\"loading_screen_play_button\");\r\n    play_button.innerText = text;\r\n}\r\n\r\n/**\r\n * Toggles a specificed class for target 'element', removing it from any other element that might have had it.\r\n * If 'siblings_only' is true, class will be removed only from siblings\r\n * @param {Object} params\r\n * @param {HTMLElement} params.element\r\n * @param {Boolean} [params.siblings_only]\r\n * @param {String} params.class_name\r\n */\r\nfunction toggle_exclusive_class({element, siblings_only=false, class_name}) {\r\n    const elems = siblings_only?element.parentNode.querySelectorAll(`.${class_name}`):document.getElementsByClassName(class_name);\r\n    const has_class = element.classList.contains(class_name);\r\n    for(let i = 0; i < elems.length; i++) {\r\n        elems[i].classList.remove(class_name);\r\n    }\r\n\r\n    if(!has_class) {\r\n        element.classList.add(class_name);\r\n    }\r\n}\r\nfunction remove_class_from_all(class_name) {\r\n    const elems = document.getElementsByClassName(class_name);\r\n    while(elems.length > 0) {\r\n        elems.item(0).classList.remove(class_name);\r\n    }\r\n}\r\n\r\nfunction is_element_above_x(element, x) {\r\n    const rect = element.getBoundingClientRect();\r\n    const rect2 = x.getBoundingClientRect();\r\n\r\n    return rect.bottom <= rect2.top;\r\n}\r\n\r\nexport {\r\n    fill_action_box,\r\n    start_activity_animation, end_activity_animation,\r\n    update_displayed_trader, update_displayed_trader_inventory, update_displayed_character_inventory, sort_displayed_inventory,\r\n    create_item_tooltip,\r\n    update_displayed_money,\r\n    log_message,\r\n    clear_action_div,\r\n    update_displayed_enemies, update_displayed_health_of_enemies, update_displayed_normal_location, update_displayed_combat_location,\r\n    log_loot,\r\n    update_displayed_equipment, update_displayed_health, update_displayed_stamina, update_displayed_stats, update_displayed_effects, update_displayed_effect_durations,\r\n    capitalize_first_letter,\r\n    format_money,\r\n    update_displayed_time, update_displayed_temperature,\r\n    update_displayed_character_xp,\r\n    update_displayed_dialogue, update_displayed_textline_answer,\r\n    exit_displayed_trade,\r\n    start_activity_display, start_sleeping_display,\r\n    create_new_skill_bar, update_displayed_skill_bar, update_displayed_skill_description, update_displayed_skill_level,\r\n    update_displayed_skill_xp_gain,\r\n    update_all_displayed_skills_xp_gain,\r\n    clear_skill_bars,\r\n    update_displayed_ongoing_activity,\r\n    clear_skill_list,\r\n    update_character_attack_bar,\r\n    clear_message_log,\r\n    update_enemy_attack_bar, \r\n    do_enemy_onhit_animation, remove_enemy_onhit_animation, do_enemy_onstart_animation,\r\n    remove_fast_travel_choice,\r\n    create_new_bestiary_entry, update_bestiary_entry, update_bestiary_entry_killcount, clear_bestiary, update_bestiary_entry_tooltip,\r\n    start_reading_display,\r\n    sort_displayed_skills,\r\n    update_displayed_xp_bonuses, update_displayed_stance_list, update_displayed_stamina_efficiency, \r\n    update_displayed_stance, update_displayed_faved_stances, update_stance_tooltip,\r\n    update_gathering_tooltip,\r\n    update_displayed_location_types,\r\n    open_crafting_window, close_crafting_window,\r\n    switch_crafting_recipes_page, switch_crafting_recipes_subpage,\r\n    create_displayed_crafting_recipes, \r\n    update_displayed_component_choice, update_displayed_material_choice, \r\n    update_recipe_tooltip, update_displayed_crafting_recipes,\r\n    update_item_recipe_visibility, update_item_recipe_tooltips,\r\n    update_displayed_book,\r\n    update_backup_load_button, update_other_save_load_button,\r\n    start_game_action_display,\r\n    set_game_action_finish_text,\r\n    update_game_action_progress_bar, update_game_action_finish_button,\r\n    update_displayed_storage, exit_displayed_storage, update_displayed_storage_inventory,\r\n    update_location_icon, update_location_kill_count,\r\n    skill_list,\r\n    update_booklist_entry, booklist_entry_divs,\r\n    add_quest_to_display, update_displayed_quest, update_displayed_quest_task, change_completed_quest_visibility,\r\n    start_rain_animation, start_snow_animation, start_stars_animation, stop_background_animation,\r\n    update_displayed_total_price,\r\n    skill_category_order,\r\n    update_export_button_tooltip,\r\n    update_displayed_reputation,\r\n    hide_loading_screen, set_loading_screen_versions, set_loading_screen_errors_warning, \r\n    set_loading_screen_progress, hide_loading_text, show_play_button, set_loading_screen_warnings_warning, set_play_button_text,\r\n    create_floating_effect,\r\n    update_fav_display\r\n}", "\"use strict\";\r\n\r\nimport { InventoryHaver } from \"./inventory.js\";\r\nimport { skill_categories, skills, weapon_type_to_skill } from \"./skills.js\";\r\nimport { update_displayed_character_inventory, update_displayed_equipment, \r\n         update_displayed_stats,\r\n         update_displayed_health, update_displayed_stamina, \r\n         update_displayed_skill_xp_gain, update_all_displayed_skills_xp_gain,\r\n         update_displayed_skill_level, \r\n         update_displayed_xp_bonuses, \r\n         update_displayed_stamina_efficiency} from \"./display.js\";\r\nimport { active_effects, current_location, current_stance, favourite_consumables, remove_consumable_from_favourites } from \"./main.js\";\r\nimport { current_game_time, is_night } from \"./game_time.js\";\r\nimport { item_templates } from \"./items.js\";\r\nimport { skill_consumable_tags } from \"./misc.js\";\r\n\r\nconst base_block_chance = 0.75; //+20 from the skill\r\nconst base_xp_cost = 10;\r\n\r\nconst tool_slots = [\"axe\", \"pickaxe\", \"sickle\", \"shovel\", \"fishing_pole\"];\r\n\r\n\r\n//stupid little thing for a stupid easter egg\r\nconst is_rat = () => character.name.match(/\\b(?<![\\w])rat\\b/i);\r\n\r\n\r\n//6 things below: for weather; why here? because it's related to the hero, I guess\r\nconst time_until_wet = 10; //snowing accumulates it at a slower rate\r\nconst time_until_cold = 60;\r\nconst time_until_cold_when_wet = 20;\r\n\r\n//temperatures for effects 'cold','very cold','freezing','hypothermia'\r\n//not exactly realistic\r\nconst cold_status_temperatures = [14,8,2,-4];\r\nconst lowest_tolerable_temperature = cold_status_temperatures[0];\r\n//array for matching the names of aforementioned effects\r\nconst cold_status_effects = [\"Cold\",\"Very cold\",\"Freezing\",\"Hypothermia\"];\r\n\r\nclass Hero extends InventoryHaver {\r\n        constructor() {\r\n                super();\r\n                this.base_stats = {\r\n                        max_health: 50, \r\n                        health: 50,\r\n                        health_regeneration_flat: 0, //in combat\r\n                        health_regeneration_percent: 0, //in combat\r\n                        health_loss_flat: 0, //despite the name, it's values below 0 that mean actual health loss\r\n                        health_loss_percent: 0,\r\n                        max_stamina: 50,\r\n                        stamina: 50,\r\n                        stamina_regeneration_flat: 0, //in combat\r\n                        stamina_regeneration_percent: 0, //in combat\r\n                        stamina_efficiency: 1,\r\n                        max_mana: 0, //currently useless\r\n                        mana: 0, //currently useless\r\n                        mana_regeneration_flat: 0, //in combat //currently useless\r\n                        mana_regeneration_percent: 0, //in combat //currently useless\r\n                        mana_efficiency: 1, //currently useless\r\n                        strength: 10, \r\n                        agility: 10, \r\n                        dexterity: 10, \r\n                        intuition: 10,\r\n                        magic: 0, \r\n                        attack_speed: 1, \r\n                        crit_rate: 0.05, \r\n                        crit_multiplier: 1.3,\r\n                        attack_power: 0, \r\n                        defense: 0,\r\n                        block_strength: 0,\r\n                        block_chance: 0,\r\n                        evasion_points: 0, //EP\r\n                        attack_points: 0, //AP\r\n                        heat_tolerance: 0, //currently useless\r\n                        cold_tolerance: 0,\r\n                        unarmed_power: 1, //base damage for unarmed, as it has no weapon dmg to scale with\r\n                        armor_penetration: 0,\r\n                };\r\n                this.name = \"Hero\";\r\n                this.titles = {};\r\n                this.stats = {\r\n                        full: {...this.base_stats}, \r\n                        total_flat: {},\r\n                        total_multiplier: {},\r\n                        flat: {\r\n                                level: {},\r\n                                skills: {},\r\n                                equipment: {},\r\n                                skill_milestones: {},\r\n                                books: {},\r\n                                light_level: {},\r\n                                environment: {},\r\n                        },\r\n                        multiplier: {\r\n                                skills: {},\r\n                                skill_milestones: {},\r\n                                equipment: {},\r\n                                books: {},\r\n                                stance: {},\r\n                                light_level: {},\r\n                                environment: {},\r\n                        }\r\n                };\r\n                this.reputation = { //effects would go up to 1000?\r\n                        Village: 0,\r\n                        Slums: 0,\r\n                        Town: 0,\r\n                };\r\n                this.bonus_skill_levels = {\r\n                        full: {\r\n                                //all skills added in main.js in setup()\r\n                        },\r\n                        flat: {\r\n                                equipment: {},\r\n                                active_effects: {},\r\n                                skills: {}, //for some rare cases, generally bonuses should be limited to \"temporary\" sources\r\n                        }\r\n                };\r\n                this.xp_bonuses = {\r\n                        total_multiplier: {\r\n                                hero: 1,\r\n                                all: 1,\r\n                                all_skill: 1,\r\n                                //then all skills and categories added in main.js in setup()\r\n                        },\r\n                        multiplier: {\r\n                                levels: {},\r\n                                skills: {},\r\n                                //equipment: {},\r\n                                books: {},\r\n                                active_effects: {},\r\n                        }\r\n                };\r\n                this.equipment = {\r\n                        head: null, torso: null, \r\n                        arms: null, ring: null, \r\n                        weapon: null, \"off-hand\": null,\r\n                        legs: null, feet: null, \r\n                        amulet: null, artifact: null,\r\n                        cape: null,\r\n                \r\n                        axe: null, \r\n                        pickaxe: null,\r\n                        sickle: null,\r\n                        shovel: null,\r\n                        fishing_pole: null\r\n                };\r\n                this.money = 0;\r\n                this.xp = {\r\n                        current_level: 0, total_xp: 0, current_xp: 0, xp_to_next_lvl: base_xp_cost, \r\n                        total_xp_to_next_lvl: base_xp_cost, base_xp_cost: base_xp_cost, xp_scaling: 1.6,\r\n                }\r\n        }\r\n        add_xp({xp_to_add, use_bonus = true}) {\r\n                if(use_bonus) {\r\n                        xp_to_add *= (character.xp_bonuses.total_multiplier.hero || 1) * (character.xp_bonuses.total_multiplier.all || 1);\r\n                }\r\n                character.xp.total_xp += xp_to_add;\r\n        \r\n                if(xp_to_add + character.xp.current_xp < character.xp.xp_to_next_lvl) { // no levelup\r\n                        character.xp.current_xp += xp_to_add;\r\n                }\r\n                else { //levelup\r\n                        let level_after_xp = 0;\r\n                        \r\n                        while(character.xp.total_xp >= character.xp.total_xp_to_next_lvl) {\r\n                                level_after_xp += 1;\r\n                                \r\n                                character.xp.total_xp_to_next_lvl = Math.round(character.xp.base_xp_cost * (1 - character.xp.xp_scaling ** (level_after_xp + 1))/(1 - character.xp.xp_scaling));\r\n                        } //calculates lvl reached after adding xp\r\n        \r\n                        let total_xp_to_previous_lvl = Math.round(character.xp.base_xp_cost * (1 - character.xp.xp_scaling ** level_after_xp)/(1 - character.xp.xp_scaling));\r\n                        //xp needed for current lvl, same formula but for n-1\r\n        \r\n                        const gains = character.get_level_bonus(level_after_xp);\r\n        \r\n                        character.xp.xp_to_next_lvl = character.xp.total_xp_to_next_lvl - total_xp_to_previous_lvl;\r\n                        character.xp.current_level = level_after_xp;\r\n                        character.xp.current_xp = character.xp.total_xp - total_xp_to_previous_lvl;\t\t\r\n                        \r\n                        return `${character.name} is getting stronger. Reached level ${character.xp.current_level} ${gains}`;\r\n                }\r\n        }\r\n\r\n        /**\r\n         * gets bonuses to stats based on current level and level passed as param\r\n         * @param {Number} level \r\n         * @returns stats bonuses from leveling\r\n         */\r\n        get_level_bonus(level) {\r\n\r\n                let gained_hp = 0;\r\n                let gained_stamina = 0;\r\n                let gained_str = 0;\r\n                let gained_agi = 0;\r\n                let gained_dex = 0;\r\n                let gained_int = 0;\r\n        \r\n                const gained_skill_xp_multiplier = 1.03;\r\n                let total_skill_xp_multiplier = 1;\r\n        \r\n                for(let i = character.xp.current_level + 1; i <= level; i++) {\r\n                        if(i % 2 == 1) {\r\n                                gained_str += Math.ceil(i/10);\r\n                                gained_int += Math.ceil(i/10);\r\n                        } else {\r\n                                gained_agi += Math.ceil(i/10);\r\n                                gained_dex += Math.ceil(i/10);\r\n                        }\r\n        \r\n                        gained_hp += 10 * Math.ceil(i/10);\r\n                        gained_stamina += 5; //5 * Math.ceil(i/10) ?;\r\n                        total_skill_xp_multiplier = total_skill_xp_multiplier * gained_skill_xp_multiplier;\r\n                }\r\n        \r\n                character.stats.flat.level.max_health = (character.stats.flat.level.max_health || 0) + gained_hp;\r\n                character.stats.flat.level.health = character.stats.flat.level.max_health;\r\n                character.stats.flat.level.max_stamina = (character.stats.flat.level.max_stamina || 0) + gained_stamina;\r\n                character.stats.flat.level.stamina = character.stats.flat.level.max_stamina;\r\n                character.stats.flat.level.strength = (character.stats.flat.level.strength || 0) + gained_str;\r\n                character.stats.flat.level.intuition = (character.stats.flat.level.intuition || 0) + gained_int;\r\n                character.stats.flat.level.agility = (character.stats.flat.level.agility || 0) + gained_agi;\r\n                character.stats.flat.level.dexterity = (character.stats.flat.level.dexterity || 0) + gained_dex;\r\n        \r\n                character.xp_bonuses.multiplier.levels.all_skill = (character.xp_bonuses.multiplier.levels.all_skill || 1) * total_skill_xp_multiplier;\r\n\r\n                let gains = `<br>HP increased by ${gained_hp}<br>Stamina increased by ${gained_stamina}`;\r\n                if(gained_str > 0) {\r\n                        gains += `<br>Strength increased by ${gained_str}`;\r\n                }\r\n                if(gained_agi > 0) {\r\n                        gains += `<br>Agility increased by ${gained_agi}`;\r\n                }\r\n                if(gained_dex > 0) {\r\n                        gains += `<br>Dexterity increased by ${gained_dex}`;\r\n                }\r\n                if(gained_int > 0) {\r\n                        gains += `<br>Intuition increased by ${gained_int}`;\r\n                }\r\n        \r\n                gains += `<br>Skill xp gains increased by ${Math.round((gained_skill_xp_multiplier-1)*100)}%`;\r\n                \r\n                return gains;\r\n        }\r\n}\r\n\r\nconst character = new Hero();\r\n\r\n//todo: move all remaining stuff to the class\r\n\r\n/**\r\n * adds skill milestone bonuses to character stats\r\n * called when a new milestone is reached\r\n * @param {{flats, multipliers}} bonuses \r\n */\r\ncharacter.stats.add_skill_milestone_bonus = function ({stats = {}, xp_multipliers = {}}) {\r\n        Object.keys(stats).forEach(stat => {\r\n                if(stats[stat].flat) {\r\n                        character.stats.flat.skill_milestones[stat] = (character.stats.flat.skill_milestones[stat] || 0) + stats[stat].flat;\r\n                }\r\n                if(stats[stat].multiplier) {\r\n                        character.stats.multiplier.skill_milestones[stat] = (character.stats.multiplier.skill_milestones[stat] || 1) * stats[stat].multiplier;\r\n                }\r\n        });\r\n\r\n        if(xp_multipliers?.hero) {\r\n                character.xp_bonuses.multiplier.skills.hero = (character.xp_bonuses.multiplier.skills.hero || 1) * xp_multipliers.hero;\r\n        }\r\n        if(xp_multipliers?.all) {\r\n                character.xp_bonuses.multiplier.skills.all = (character.xp_bonuses.multiplier.skills.all || 1) * xp_multipliers.all;\r\n        }\r\n        if(xp_multipliers?.all_skill) {\r\n                character.xp_bonuses.multiplier.skills.all_skill = (character.xp_bonuses.multiplier.skills.all_skill || 1) * xp_multipliers.all_skill;\r\n        }\r\n\r\n        Object.keys(skills).forEach(skill => {\r\n                if(xp_multipliers[skill]) {\r\n                        character.xp_bonuses.multiplier.skills[skill] = (character.xp_bonuses.multiplier.skills[skill] || 1) * xp_multipliers[skill];\r\n                }\r\n        });\r\n        Object.keys(skill_categories).forEach(category => {\r\n                const cat = \"category_\"+category;\r\n                if(xp_multipliers[cat]) {\r\n                        character.xp_bonuses.multiplier.skills[cat] = (character.xp_bonuses.multiplier.skills[cat] || 1) * xp_multipliers[cat];\r\n                }\r\n        });\r\n}\r\n\r\n/**\r\n * adds skill milestone bonuses to character stats\r\n * called when a new milestone is reached\r\n * @param {{flats, multipliers}} bonuses \r\n */\r\ncharacter.stats.add_book_bonus = function ({multipliers = {}, xp_multipliers = {}}) {\r\n        Object.keys(character.base_stats).forEach(stat => {\r\n                if(multipliers[stat]) {\r\n                        character.stats.multiplier.books[stat] = (character.stats.multiplier.books[stat] || 1) * multipliers[stat];\r\n                }\r\n        });\r\n       \r\n        if(xp_multipliers?.hero) {\r\n                character.xp_bonuses.multiplier.books.hero = (character.xp_bonuses.multiplier.books.hero || 1) * xp_multipliers.hero;\r\n        }\r\n        if(xp_multipliers?.all) {\r\n                character.xp_bonuses.multiplier.books.all = (character.xp_bonuses.multiplier.books.all || 1) * xp_multipliers.all;\r\n        }\r\n        if(xp_multipliers?.all_skill) {\r\n                character.xp_bonuses.multiplier.books.all_skill = (character.xp_bonuses.multiplier.books.all_skill || 1) * xp_multipliers.all_skill;\r\n        }\r\n\r\n        Object.keys(skills).forEach(skill => {\r\n                if(xp_multipliers[skill]) {\r\n                        character.xp_bonuses.multiplier.books[skill] = (character.xp_bonuses.multiplier.books[skill] || 1) * xp_multipliers[skill];\r\n                }\r\n        });\r\n}\r\n\r\ncharacter.stats.add_active_effect_bonus = function() {\r\n        character.stats.flat.active_effects = {};\r\n        character.stats.multiplier.active_effects = {};\r\n        character.bonus_skill_levels.flat.active_effects = {};\r\n        character.xp_bonuses.multiplier.active_effects = {};\r\n\r\n        Object.keys(active_effects).forEach(effect_key => {\r\n                let multiplier = 1;\r\n\r\n                let effects = get_effect_with_bonuses(active_effects[effect_key]);\r\n                for(const [key, value] of Object.entries(effects.stats)) {\r\n                        if(value.flat) {\r\n                                character.stats.flat.active_effects[key] = (character.stats.flat.active_effects[key] || 0) + value.flat*multiplier;\r\n                        }\r\n\r\n                        if(value.multiplier) {\r\n                                character.stats.multiplier.active_effects[key] = (character.stats.multiplier.active_effects[key] || 1) * value.multiplier*multiplier;\r\n                        }\r\n                }\r\n                for(const [key, value] of Object.entries(effects.bonus_skill_levels)) {\r\n                        character.bonus_skill_levels.flat.active_effects[key] = (character.bonus_skill_levels.flat.active_effects[key] || 0) + value;\r\n                }\r\n                for(const [key, value] of Object.entries(effects.xp_multipliers)) {\r\n                        character.xp_bonuses.multiplier.active_effects[key] = (character.xp_bonuses.multiplier.active_effects[key] || 1) * value;\r\n                }\r\n        });\r\n}\r\n\r\n/**\r\n * add all stat bonuses from equipment, including def/atk\r\n * called on equipment changes\r\n */\r\ncharacter.stats.add_all_equipment_bonus = function() {\r\n        \r\n        //reset as they will be recalculated\r\n        character.stats.flat.equipment = {};\r\n        character.stats.multiplier.equipment = {};\r\n        character.bonus_skill_levels.flat.equipment = {};\r\n\r\n        //iterate over slots\r\n        Object.keys(character.equipment).forEach(slot => {\r\n                if(!character.equipment[slot]) {\r\n                        return;\r\n                }\r\n                \r\n                if(character.equipment[slot].getDefense) {\r\n                        character.stats.flat.equipment.defense = (character.stats.flat.equipment.defense || 0) + character.equipment[slot].getDefense();\r\n                }\r\n                const stats = character.equipment[slot].getStats();\r\n                const bonuses = character.equipment[slot].getBonusSkillLevels();\r\n                //iterate over stats in slotted item\r\n                Object.keys(stats).forEach(stat => {\r\n                        if(stats[stat].flat) {\r\n                                character.stats.flat.equipment[stat] = (character.stats.flat.equipment[stat] || 0) + stats[stat].flat;\r\n                        }\r\n\r\n                        if(stats[stat].multiplier) {\r\n                                character.stats.multiplier.equipment[stat] = (character.stats.multiplier.equipment[stat] || 1) * stats[stat].multiplier;\r\n                        }\r\n                });\r\n\r\n                Object.keys(bonuses).forEach(bonus => {\r\n                        if(bonuses[bonus]) {\r\n                                character.bonus_skill_levels.flat.equipment[bonus] = (character.bonus_skill_levels.flat.equipment[bonus] || 0) + bonuses[bonus];\r\n                        }\r\n                });\r\n        });\r\n\r\n        character.stats.add_weapon_type_bonuses(); //add weapon speed bonus (technically a bonus related to equipment, so its in this function)\r\n}\r\n\r\ncharacter.stats.add_weapon_type_bonuses = function() {\r\n        if(character.equipment.weapon == null) {\r\n                character.stats.multiplier.skills.attack_power = get_total_skill_coefficient({skill_id:\"Unarmed\"});\r\n                character.stats.multiplier.skills.attack_speed = get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id:\"Unarmed\"})**0.3333;\r\n                character.stats.multiplier.skills.attack_points = get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id:\"Unarmed\"})**0.3333;\r\n                character.stats.multiplier.skills.evasion_points = get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id:\"Unarmed\"})**0.3333;\r\n        } else {\r\n                character.stats.multiplier.skills.attack_speed = 1;\r\n                character.stats.multiplier.skills.attack_power = get_total_skill_coefficient({skill_id:weapon_type_to_skill[character.equipment.weapon.weapon_type]});\r\n                character.stats.multiplier.skills.attack_points = get_total_skill_coefficient({skill_id:weapon_type_to_skill[character.equipment.weapon.weapon_type]})**0.3333;\r\n                character.stats.multiplier.skills.evasion_points = 1;\r\n        }\r\n}\r\n\r\n/**\r\n * add all non-milestone stat bonuses from skills\r\n * called in update_stats()\r\n * only a few skills really matter here\r\n */\r\ncharacter.stats.add_all_skill_level_bonus = function() {\r\n        character.stats.flat.skills.defense = get_total_level_bonus(\"Iron skin\");\r\n\r\n        character.stats.multiplier.skills.stamina_efficiency = get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Running\"});\r\n\r\n        character.stats.multiplier.skills.strength = get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Weightlifting\"}) \r\n                                                        * get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Climbing\"})\r\n                                                        * get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Breathing\"});\r\n\r\n        character.stats.multiplier.skills.block_strength = 1 + 5*get_total_level_bonus(\"Shield blocking\");\r\n\r\n        character.stats.multiplier.skills.agility = get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Equilibrium\"}) \r\n                                                        * get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Climbing\"})\r\n                                                        * get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Breathing\"})\r\n                                                        * get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Swimming\"});\r\n        \r\n        character.stats.multiplier.skills.dexterity = get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Climbing\"});                                                \r\n\r\n        character.stats.multiplier.skills.max_stamina = get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Breathing\"})\r\n                                                                * get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Swimming\"});\r\n\r\n        character.stats.multiplier.skills.max_health = get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Fortitude\"});\r\n\r\n        character.stats.multiplier.skills.intuition = get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: \"Meditation\"});\r\n\r\n        character.stats.flat.skills.unarmed_power = skills[\"Unarmed\"].current_level * 0.1;\r\n\r\n        character.stats.flat.skills.crit_rate = Math.min(skills[\"Perception\"].max_level, get_total_skill_level(\"Perception\"))/100;\r\n\r\n        character.stats.add_weapon_type_bonuses();\r\n        character.stats.flat.skills.cold_tolerance = 0.5 * get_total_skill_level(\"Cold resistance\");\r\n}\r\n\r\n/**\r\n * add all stat bonuses/penalties from stances\r\n * called in update_stats()\r\n * multipliers only \r\n */\r\ncharacter.stats.add_all_stance_bonus = function() {\r\n        const multipliers = current_stance.getStats();\r\n        Object.keys(character.base_stats).forEach(stat => {\r\n                if(multipliers[stat]) {\r\n                        character.stats.multiplier.stance[stat] = multipliers[stat] || 1;\r\n                        //replacing instead of multiplying, since these come from singular source\r\n                } else {\r\n                        character.stats.multiplier.stance[stat] = 1;\r\n                }\r\n        });\r\n}\r\n\r\n/**\r\n * only supports multiplicative penalties for now\r\n */\r\ncharacter.stats.add_location_penalties = function() {\r\n        let effects = {};\r\n        let light_modifier = 1;\r\n        \r\n        if(current_location) {\r\n                if(!(\"connected_locations\" in current_location)) {\r\n                        effects = current_location.get_total_effect().hero_penalty;\r\n                }\r\n\r\n                if(current_location.light_level === \"dark\" || current_location.light_level === \"normal\" && is_night(current_game_time)) {\r\n                        light_modifier = 0.5 + 0.5* get_total_skill_level(\"Night vision\")/skills[\"Night vision\"].max_level;\r\n                        character.stats.multiplier.light_level.evasion_points = light_modifier;\r\n                        character.stats.multiplier.light_level.attack_points = light_modifier;\r\n                } else {\r\n                        character.stats.multiplier.light_level.evasion_points = 1;\r\n                        character.stats.multiplier.light_level.attack_points = 1;\r\n                }\r\n        }\r\n\r\n        character.stats.multiplier.environment = {};\r\n        character.stats.flat.environment = {};\r\n        Object.keys(effects.multipliers || {}).forEach(effect => {\r\n                character.stats.multiplier.environment[effect] = effects.multipliers[effect];\r\n        });\r\n        Object.keys(effects.flats || {}).forEach(effect => {\r\n                character.stats.flat.environment[effect] = effects.flats[effect];\r\n        });\r\n}\r\n\r\n/**\r\n * \r\n * @returns character temperature tolerance; a stub for now, to be based on clothing worn\r\n */\r\ncharacter.get_character_cold_tolerance = function(){\r\n        return character.stats.full.cold_tolerance;\r\n}\r\n\r\ncharacter.get_character_heat_tolerance = function(){\r\n        return character.stats.full.heat_tolerance;\r\n}\r\n\r\n/**\r\n * full stat recalculation, call whenever something changes\r\n */\r\ncharacter.update_stats = function () {\r\n    const missing_health = Math.max((character.stats.full[\"max_health\"] - character.stats.full[\"health\"]), 0) || 0;   \r\n    const missing_stamina = Math.max((character.stats.full[\"max_stamina\"] - character.stats.full[\"stamina\"]), 0) || 0;   \r\n    const missing_mana = Math.max((character.stats.full[\"max_mana\"] - character.stats.full[\"mana\"]), 0) || 0;   \r\n    //to avoid fully restoring all whenever this function is called\r\n\r\n    character.stats.add_all_skill_level_bonus();\r\n    character.stats.add_all_stance_bonus();\r\n\r\n    Object.keys(character.stats.full).forEach(stat => {\r\n        let stat_sum = 0;\r\n        let stat_mult = 1;\r\n\r\n        if(stat === \"block_chance\") {\r\n                stat_sum = base_block_chance + Math.round(get_total_level_bonus(\"Shield blocking\") * 10000)/10000;\r\n        } else if(stat === \"attack_points\") {\r\n                stat_sum = Math.sqrt(character.stats.full.intuition) * character.stats.full.dexterity * get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id:\"Combat\"});\r\n        } else if(stat === \"evasion_points\") {\r\n                stat_sum = character.stats.full.agility * Math.sqrt(character.stats.full.intuition) * get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id:\"Evasion\"});\r\n        } else {\r\n                //just sum all flats\r\n                Object.values(character.stats.flat).forEach(piece => {\r\n                        stat_sum += (piece[stat] || 0);\r\n                });\r\n        }\r\n\r\n        Object.values(character.stats.multiplier).forEach(piece => {\r\n                stat_mult *= (piece[stat] || 1);\r\n        });\r\n\r\n        character.stats.full[stat] = (character.base_stats[stat] + stat_sum) * stat_mult;\r\n\r\n        character.stats.total_flat[stat] =  character.base_stats[stat] + stat_sum;\r\n        character.stats.total_multiplier[stat] = stat_mult || 1;\r\n\r\n        if(stat === \"health\") {\r\n                character.stats.full.health = Math.max(0, character.stats.full[\"max_health\"] - missing_health);\r\n        } else if(stat === \"stamina\") {\r\n                character.stats.full.stamina = Math.max(0, character.stats.full[\"max_stamina\"] - missing_stamina);\r\n        } else if(stat === \"mana\") {\r\n                character.stats.full.mana = Math.max(0, character.stats.full[\"max_mana\"] - missing_mana);\r\n        }\r\n    });\r\n\r\n     \r\n    if(character.equipment.weapon != null) { \r\n        //has weapon\r\n        character.stats.full.attack_power = (character.stats.full.strength/10) * character.equipment.weapon.getAttack() * character.stats.total_multiplier.attack_power;\r\n    } else {\r\n        //has no weapon\r\n        //character.stats.full.attack_power = (character.stats.full.strength/10) * (1+skills[\"Unarmed\"].current_level*0.1) * character.stats.total_multiplier.attack_power;\r\n        character.stats.full.attack_power = (character.stats.full.strength/10) * character.stats.total_multiplier.attack_power * character.stats.full.unarmed_power;\r\n    }\r\n    \r\n    character.stats.total_flat.attack_power = character.stats.full.attack_power/character.stats.total_multiplier.attack_power;\r\n    Object.keys(character.xp_bonuses.total_multiplier).forEach(bonus_target => {\r\n        character.xp_bonuses.total_multiplier[bonus_target] = \r\n                  (character.xp_bonuses.multiplier.levels[bonus_target] || 1)\r\n                * (character.xp_bonuses.multiplier.skills[bonus_target] || 1)\r\n                * (character.xp_bonuses.multiplier.books[bonus_target] || 1)\r\n                * (character.xp_bonuses.multiplier.active_effects[bonus_target] || 1);\r\n\r\n        const bonus = character.xp_bonuses.total_multiplier[bonus_target];\r\n\r\n        if(bonus != 1){\r\n                if(bonus_target !== \"hero\") {\r\n                        if(bonus_target === \"all\" || bonus_target === \"all_skill\" || bonus_target.includes(\"category_\")) {\r\n                                update_all_displayed_skills_xp_gain();\r\n                        } else {\r\n                                update_displayed_skill_xp_gain(skills[bonus_target]);\r\n                        }\r\n                }\r\n                if(bonus_target === \"hero\" || bonus_target === \"all\") {\r\n                        update_displayed_xp_bonuses();\r\n                }\r\n        }\r\n    });\r\n\r\n    Object.keys(character.bonus_skill_levels.full).forEach(bonus_target => {\r\n        if(bonus_target.includes(\"category_\")) {\r\n                return;\r\n        }\r\n        const category = \"category_\"+skills[bonus_target].category;\r\n        character.bonus_skill_levels.full[bonus_target] = \r\n                  (character.bonus_skill_levels.flat.equipment[bonus_target] || 0) \r\n                + (character.bonus_skill_levels.flat.active_effects[bonus_target] || 0) \r\n                + (character.bonus_skill_levels.flat.skills[bonus_target] || 0)\r\n                + (character.bonus_skill_levels.flat.equipment[category] || 0) \r\n                + (character.bonus_skill_levels.flat.active_effects[category] || 0) \r\n                + (character.bonus_skill_levels.flat.skills[category] || 0);\r\n        \r\n        const bonus = character.bonus_skill_levels.full[bonus_target];\r\n\r\n        if(bonus != 0){\r\n                update_displayed_skill_level(skills[bonus_target]);\r\n        }        \r\n    });\r\n}\r\n\r\ncharacter.get_stamina_multiplier = function () {\r\n        if(character.stats.full.stamina == 0) {\r\n                return 0.5 + get_total_level_bonus(\"Persistence\");\r\n        }\r\n        return 1;\r\n}\r\n\r\ncharacter.get_attack_speed = function () {\r\n        let spd = character.stats.full.attack_speed * character.get_stamina_multiplier();\r\n        return spd;\r\n}\r\n\r\ncharacter.get_attack_power = function () {\r\n        return character.stats.full.attack_power * character.get_stamina_multiplier();\r\n}\r\n\r\ncharacter.wears_armor = function () {\r\n        return  (character.equipment.head && character.equipment.head.getDefense() !== 0) ||\r\n                (character.equipment.torso && character.equipment.torso.getDefense() !== 0) ||\r\n                (character.equipment.arms && character.equipment.arms.getDefense() !== 0) ||\r\n                (character.equipment.legs && character.equipment.legs.getDefense() !== 0) ||\r\n                (character.equipment.feet && character.equipment.feet.getDefense() !== 0) ||\r\n                (character.equipment.cape && character.equipment.cape.getDefense() !== 0);\r\n}\r\n\r\n/**\r\n * \r\n * @param {*}\r\n * @returns [actual damage taken; Boolean if character should faint] \r\n */\r\ncharacter.take_damage = function ({damage_values, can_faint = true, give_skill_xp = true, defense_modifier = 0}) {\r\n        /*\r\n        TODO:\r\n                - damage types: \"physical\", \"elemental\", \"magic\"\r\n                - each with it's own defense on equipment (and potentially spells)\r\n                - damage elements (for elemental damage type)\r\n                - resistance skills\r\n        */\r\n        let fainted;\r\n\r\n        damage_values = damage_values.map(val => {\r\n                if(val < 1) {\r\n                        return Math.max(Math.ceil(10*val)/10, 0);\r\n                } else {\r\n                        return Math.ceil(10*Math.max(val - (character.stats.full.defense + defense_modifier), val*0.05, 1))/10;\r\n                }\r\n        });\r\n        const damage_taken = damage_values.reduce((a,b)=>a+b);\r\n        character.stats.full.health -= damage_taken;\r\n\r\n        if(character.stats.full.health <= 0 && can_faint) {\r\n                fainted = true;\r\n                character.stats.full.health = 0;\r\n        } else {\r\n                fainted = false;\r\n        }\r\n\r\n        if(give_skill_xp) {\r\n                //TODO once they are added, give xp to resistance skills when taking damage\r\n        }\r\n\r\n        return {damage_taken, fainted};\r\n}\r\n\r\ncharacter.get_character_money = function () {\r\n        return character.money;\r\n}\r\n\r\n/**\r\n * @param {Array} items [{item_key or item_id, count},...] \r\n */\r\nfunction add_to_character_inventory(items) {\r\n        const was_anything_new_added = character.add_to_inventory(items);\r\n\r\n        update_displayed_character_inventory({was_anything_new_added});\r\n}\r\n\r\n/**\r\n * @param {Array} items [{item_key, item_count}]\r\n */\r\nfunction remove_from_character_inventory(items) {\r\n        character.remove_from_inventory(items);\r\n        update_displayed_character_inventory();\r\n\r\n        for(let i = 0; i < items.length; i++) {\r\n                if(character.inventory[items[i].item_key]) {\r\n                        continue;\r\n                }\r\n                const {id} = JSON.parse(items[i].item_key);\r\n                if(id && item_templates[id].tags.usable && favourite_consumables[id]) {\r\n                        remove_consumable_from_favourites(id);\r\n                }\r\n        }\r\n}\r\n\r\n/**\r\n * @description equips passed item, doesn't do anything more with it;\r\n * don't call this one directly (except for when loading save data), but via equip_item_from_inventory()\r\n * @param: game item object\r\n */\r\nfunction equip_item(item, skip_sorting) {\r\n\r\n        if(!item) {\r\n                update_displayed_equipment();\r\n                update_displayed_character_inventory({skip_sorting});\r\n                character.stats.add_all_equipment_bonus();\r\n                \r\n                update_character_stats();\r\n                return;\r\n        } else {\r\n                const prev_item = character.equipment[item.equip_slot];\r\n                unequip_item(item.equip_slot, true);\r\n                character.equipment[item.equip_slot] = item;\r\n                \r\n                update_displayed_equipment();\r\n                update_displayed_character_inventory({skip_sorting});\r\n                character.stats.add_all_equipment_bonus();\r\n                \r\n                update_character_stats();\r\n                manage_changed_skill_bonuses(item);\r\n                if(prev_item) {\r\n                        manage_changed_skill_bonuses(prev_item);\r\n                }\r\n        }\r\n}\r\n\r\n/**\r\n * equips item and removes it from inventory\r\n * @param item_key\r\n **/\r\n function equip_item_from_inventory(item_key) {\r\n        if(item_key in character.inventory) { //check if its in inventory, just in case\r\n            //add specific item to equipment slot\r\n            // -> id and name tell which exactly item it is, then also check slot in item object and thats all whats needed\r\n            equip_item(character.inventory[item_key].item);\r\n            remove_from_character_inventory([{item_key}]);\r\n            \r\n            //update_character_stats(); //called in equip_item()\r\n        }\r\n}\r\n    \r\nfunction unequip_item(item_slot, already_calculated=false) {\r\n        if(character.equipment[item_slot] != null) {\r\n                const item = character.equipment[item_slot];\r\n                add_to_character_inventory([{item_key: item.getInventoryKey()}]);\r\n                character.equipment[item_slot] = null;\r\n                update_displayed_equipment();\r\n                update_displayed_character_inventory();\r\n                if(!already_calculated){\r\n                        character.stats.add_all_equipment_bonus();\r\n                        update_character_stats();\r\n                        manage_changed_skill_bonuses(item);\r\n                }\r\n        }\r\n}\r\n\r\nfunction manage_changed_skill_bonuses(item) {\r\n        const bonus_skill_levels = Object.keys(item.getBonusSkillLevels());\r\n        if(bonus_skill_levels.length > 0) {\r\n                for(let i = 0; i < bonus_skill_levels.length; i++) {\r\n                        if(bonus_skill_levels[i].includes(\"category_\")) {\r\n                                continue;\r\n                        }\r\n                        update_displayed_skill_level(skills[bonus_skill_levels[i]]);\r\n                }\r\n        }\r\n}\r\n\r\nfunction add_location_penalties() {\r\n        character.stats.add_location_penalties();\r\n}\r\n\r\nfunction add_weather_effects() {\r\n        //character.stats.add_weather_effects();\r\n}\r\n\r\nfunction get_character_cold_tolerance() {\r\n        return character.get_character_cold_tolerance();\r\n}\r\nfunction get_character_heat_tolerance() {\r\n        return character.get_character_heat_tolerance();\r\n}\r\n\r\n/**\r\n * updates character stats + their display \r\n */\r\nfunction update_character_stats() {\r\n        character.stats.add_location_penalties();\r\n        character.update_stats();\r\n\r\n        update_displayed_stats();\r\n        update_displayed_health();\r\n        update_displayed_stamina();\r\n        update_displayed_stamina_efficiency();\r\n        \r\n        //update_displayed_mana();\r\n}\r\n\r\n/**\r\n * \r\n * @param {*} skill_name \r\n * @returns total xp gains for provided skill \r\n */\r\nfunction get_skill_xp_gain(skill_name) {\r\n        return (character.xp_bonuses.total_multiplier[skill_name] || 1) * get_skill_xp_gain_bonus(skill_name);\r\n}\r\n\r\n/**\r\n * \r\n * @param {*} skill_name \r\n * @returns almost-total multiplier to xp gains of provided skill (everything except things that apply to it by name)\r\n */\r\nfunction get_skill_xp_gain_bonus(skill_name) {\r\n        const category = \"category_\"+skills[skill_name].category;\r\n        return (character.xp_bonuses.total_multiplier.all_skill || 1) \r\n              * (character.xp_bonuses.total_multiplier.all || 1) \r\n              * (character.xp_bonuses.total_multiplier[category] || 1);\r\n}\r\n\r\nfunction get_skills_overall_xp_gain() {\r\n        return (character.xp_bonuses.total_multiplier.all_skill || 1) * (character.xp_bonuses.total_multiplier.all || 1);\r\n}\r\n\r\nfunction get_hero_xp_gain() {\r\n        return (character.xp_bonuses.total_multiplier.hero || 1) * (character.xp_bonuses.total_multiplier.all || 1);\r\n}\r\n\r\nfunction get_total_skill_level(skill_id) {\r\n        return skills[skill_id].current_level + (character.bonus_skill_levels.full[skill_id] || 0);\r\n}\r\n\r\nfunction get_total_level_bonus(skill_id) {\r\n        return skills[skill_id].get_level_bonus(get_total_skill_level(skill_id));\r\n}\r\n\r\nfunction get_total_skill_coefficient({scaling_type, skill_id}) {\r\n        return skills[skill_id].get_coefficient({scaling_type, skill_level: get_total_skill_level(skill_id)});\r\n}\r\n\r\n/**\r\n * @param {*} active_effect \r\n * @returns effects modified by relevant skill bonuses \r\n */\r\nfunction get_effect_with_bonuses(active_effect) {\r\n        let multiplier = 1;\r\n        Object.keys(skill_consumable_tags).forEach(skill_id => {\r\n                if(active_effect.tags[skill_consumable_tags[skill_id]]) {\r\n                        multiplier *= get_total_skill_coefficient({scaling_type: \"multiplicative\", skill_id: skill_id});\r\n                }\r\n        });\r\n\r\n        let boosted = {stats: {}, bonus_skill_levels: {...active_effect.effects.bonus_skill_levels}, xp_multipliers: {...active_effect.effects.xp_multipliers}};\r\n        for(const [key, value] of Object.entries(active_effect.effects.stats)) {\r\n                boosted.stats[key] = {};\r\n                if(value.flat) {\r\n                        if(key.includes(\"_percent\")) {\r\n                                //this exclusively means percent based regeneration and is therefore treated as multiplicative effect\r\n                                boosted.stats[key].flat = value.flat*(multiplier>0?multiplier:1);\r\n                        } else {\r\n                                boosted.stats[key].flat = value.flat*(multiplier>0?multiplier:1)**2;\r\n                        }\r\n                } else if(value.multiplier) {\r\n                        boosted.stats[key].multiplier = value.multiplier*(multiplier>1?multiplier:1);\r\n                }      \r\n        }\r\n        return boosted;\r\n}\r\n\r\nexport {character, add_to_character_inventory, remove_from_character_inventory, equip_item_from_inventory, equip_item, \r\n        unequip_item, update_character_stats, get_skill_xp_gain, get_hero_xp_gain, get_skills_overall_xp_gain, get_skill_xp_gain_bonus, add_location_penalties,\r\n        get_total_skill_level, get_total_level_bonus, get_total_skill_coefficient, get_effect_with_bonuses,\r\n        time_until_wet, time_until_cold, time_until_cold_when_wet, \r\n        cold_status_temperatures, cold_status_effects,\r\n        get_character_cold_tolerance, lowest_tolerable_temperature, is_rat, tool_slots\r\n};\r\n", "\"use strict\";\r\n\r\n/*\r\n    item_templates contain some predefined equipment for easier access (instead of having to create them with proper components each time)\r\n\r\n    equippable are unstackable, other items stack\r\n\r\n    item quality translates into rarity, but also provides another multiplier on top of quality multiplier, starting at uncommon\r\n            quality     rarity         color      additional_multiplier\r\n            0-49%       trash          gray       x1\r\n            50-99%      common         white      x1\r\n            100-129%    uncommon       green      x1.1\r\n            130-159%    rare           blue       x1.3\r\n            160-199%    epic           purple     x1.6\r\n            200-246%    legendary      orange     x2\r\n            247-250%    mythical       ????       x2.5\r\n\r\n            quality affects only attack/defense/max block, while additional multiplier affects all positive stats\r\n            (i.e flat bonuses over 0 and multiplicative bonuses over 1)\r\n\r\n    basic idea for weapons:\r\n\r\n        short blades (daggers/spears) are the fastest but also the weakest, +the most crit rate and crit damage\r\n        blunt heads (blunt weapons) have highest damage, but also lower attack speed\r\n        axe heads have a bit less damage, but a bit less attack speed penalty\r\n        long blades (swords/spears?) have average damage and average attack speed\r\n\r\n        long handles (spears) have higher attack multiplier and lower attack speed (so they counter the effects of the short blades), plus an additional built-in x1.5 attack multiplier\r\n        medium handles (axes/blunt weapons) have them average\r\n        short handles have lowest attack multiplier\r\n\r\n        so, as a result, attack damage goes blunt > axe > spear > sword > dagger\r\n        and attack speed goes               dagger > sword > spear > axe > blunt\r\n        which kinda makes spears very average, but they also get bonus crit so whatever\r\n*/\r\n\r\n//as a note, try to not give dexterity/agility from weapons and instead use attack_points/evasion_points, this is in regards of possible skill checks;\r\n//leaving it on armor seems fine on the other hand, as it makes much more sense for worn clothing to impact such a situation\r\n\r\nimport { round_item_price } from \"./misc.js\";\r\nimport { group_key_prefix, get_item_value_with_market_saturation, get_total_tier_saturation, get_loot_price_multiple} from \"./market_saturation.js\";\r\nimport { is_rat } from \"./character.js\";\r\n\r\nconst rarity_multipliers = {\r\n    trash: 1, //low quality alone makes these so bad that no additional nerf should be needed\r\n    common: 1,\r\n    uncommon: 1.1,\r\n    rare: 1.3,\r\n    epic: 1.6,\r\n    legendary: 2,\r\n    mythical: 2.5\r\n};\r\n\r\nconst item_templates = {};\r\n\r\nfunction getArmorSlot(internal) {\r\n    let equip_slot;\r\n    if(item_templates[internal].component_type === \"helmet interior\") {\r\n        equip_slot = \"head\";\r\n    } else if(item_templates[internal].component_type === \"chestplate interior\") {\r\n        equip_slot = \"torso\";\r\n    } else if(item_templates[internal].component_type === \"leg armor interior\") {\r\n        equip_slot = \"legs\";\r\n    } else if(item_templates[internal].component_type === \"glove interior\") {\r\n        equip_slot = \"arms\";\r\n    } else if(item_templates[internal].component_type === \"shoes interior\") {\r\n        equip_slot = \"feet\";\r\n    } else {\r\n        console.error(`Component type \"${item_templates[internal].component_type}\" doesn't correspond to any armor slot!`);\r\n        return null;\r\n    }\r\n    return equip_slot;\r\n}\r\n\r\nfunction getItemRarity(quality) {\r\n    let rarity;\r\n    if(quality < 50) rarity =  \"trash\";\r\n    else if(quality <= 100) rarity = \"common\";\r\n    else if(quality < 130) rarity = \"uncommon\";\r\n    else if(quality < 160) rarity = \"rare\";\r\n    else if(quality < 200) rarity = \"epic\";\r\n    else if(quality < 246) rarity = \"legendary\";\r\n    else rarity = \"mythical\";\r\n\r\n    return rarity;\r\n}\r\n\r\nfunction getEquipmentValue({components, quality = 100}) {\r\n    let value = 0;\r\n    Object.values(components).forEach(component => {\r\n        value += item_templates[component].value;\r\n    });\r\n    return round_item_price(1.25 * value * (quality/100 ) * rarity_multipliers[getItemRarity(quality)]);\r\n}\r\n\r\nclass Item {\r\n    constructor({name,\r\n                description,\r\n                value = 0,\r\n                tags = {},\r\n                market_saturation_group,\r\n                saturates_market,\r\n                material_type = null,\r\n                quality = null,\r\n                id = null, //passed only on loading, no need to provide it when creating new item objects as it will be filled automatically in that case\r\n                components = null,\r\n                getName = ()=>{return this.name},\r\n                })\r\n    {\r\n        this.name = name;\r\n        if(this.name?.startsWith(group_key_prefix)) {\r\n            throw new Error(`Item name of item \"${this.name}\" starts with a forbidden prefix!`);\r\n        }\r\n        this.id = id;\r\n        this.description = description;\r\n        this.saturates_market = saturates_market ?? true;\r\n\r\n        this.material_type = material_type;\r\n\r\n        this.quality = quality;\r\n        this.components = components; //meaningless unless it's an equippable that's /meant/ to have components\r\n\r\n        /**\r\n         * Use .getValue() instead of this\r\n         */\r\n        this.value = value;\r\n        this.tags = tags;\r\n        this.tags[\"item\"] = true;\r\n        this.market_saturation_group = market_saturation_group;\r\n\r\n        if(!this.getName) {\r\n            this.getName = getName;\r\n        }\r\n    }\r\n\r\n    getMarketSaturationGroup() {\r\n        return this.market_saturation_group || {group_key: this.id, group_tier: 0};\r\n    }\r\n\r\n    getInventoryKey() {\r\n        if(!this.inventory_key) {\r\n            this.inventory_key = this.createInventoryKey();\r\n        }\r\n        return this.inventory_key;\r\n    }\r\n\r\n    createInventoryKey() {\r\n        const key = {};\r\n\r\n        if(!this.components) {\r\n            key.id = this.id;\r\n        } else {\r\n            key.components = {};\r\n            Object.keys(this.components).forEach(component => {\r\n                key.components[component] = this.components[component];\r\n            });\r\n        }\r\n        if(this.quality) {\r\n            key.quality = this.quality;\r\n        }\r\n        return JSON.stringify(key);\r\n    }\r\n\r\n    getBaseValue({quality, multiplier = 1}={}) {\r\n        quality = quality || this.quality || 100;\r\n        if(this.components) {\r\n            return getEquipmentValue({components: this.components, quality});\r\n        } else {\r\n            return round_item_price(multiplier * this.value * ((quality)/100) * rarity_multipliers[getItemRarity(quality)]);\r\n        }\r\n    }\r\n\r\n    getValue({quality, region, multiplier}) {\r\n        quality = quality || this.quality || 100;\r\n        if(!this.saturates_market || !region) {\r\n            return this.getBaseValue({quality, multiplier});\r\n        } else {\r\n            return this.getValueWithSaturation(region, multiplier);\r\n        }\r\n    }\r\n\r\n    getValueWithSaturation(region, multiplier = 1) {\r\n        const {group_key, group_tier} = this.getMarketSaturationGroup();\r\n\r\n        return get_item_value_with_market_saturation({item: this, value: round_item_price(this.getBaseValue() * multiplier), group_key, group_tier, region});\r\n    }\r\n\r\n    /**\r\n     * calculates total value for when trading multiple at once\r\n     * @param {Object} param0\r\n     * @param {Number} param0.additional_traded_count\r\n     * @param {Number} param0.price_multiplier from trader profit margin\r\n     * @returns\r\n     */\r\n    getValueOfMultiple({additional_traded_count = 0, count, region, price_multiplier = 1, is_selling = true, stop_multiplier_at = Infinity}) {\r\n        if(!this.saturates_market) {\r\n            //doesn't saturate market, so it's literally just price * count\r\n            return round_item_price(this.getBaseValue()*price_multiplier) * count;\r\n        } else {\r\n            const {group_key, group_tier} = this.getMarketSaturationGroup();\r\n\r\n            const val = this.getBaseValue();\r\n            //start_count: total existing saturation + however many is artificially added to sold (e.g. got 40 already added to selling, need to calc price of next 1)\r\n            const multi_value = get_loot_price_multiple({\r\n                value: round_item_price(val*price_multiplier),\r\n                start_count: get_total_tier_saturation({region, group_key, group_tier}) + additional_traded_count,\r\n                how_many_to_trade: count,\r\n                region,\r\n                is_group: group_key.startsWith(group_key_prefix),\r\n                is_selling,\r\n                stop_multiplier_at,\r\n            });\r\n\r\n            return Math.max(count, multi_value);\r\n        }\r\n    }\r\n\r\n    getDescription() {\r\n        return this.description;\r\n    }\r\n}\r\n\r\nclass OtherItem extends Item {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        this.item_type = \"OTHER\";\r\n    }\r\n}\r\n\r\nclass Material extends OtherItem {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        this.item_type = \"MATERIAL\";\r\n        this.tags[\"material\"] = true;\r\n    }\r\n}\r\n\r\nclass ItemComponent extends Item {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        this.item_type = \"COMPONENT\";\r\n        this.component_tier = item_data.component_tier || 1;\r\n        this.component_stats = item_data.component_stats || {};\r\n        this.component_bonus_skill_levels = item_data.component_bonus_skill_levels || {};\r\n        this.tags[\"component\"] = true;\r\n        this.quality = Math.round(item_data.quality) || 100;\r\n    }\r\n\r\n    getRarity(quality){\r\n        if(!quality) {\r\n            if(!this.rarity) {\r\n                this.rarity = getItemRarity(this.quality);\r\n            }\r\n            return this.rarity;\r\n        } else {\r\n            return getItemRarity(quality);\r\n        }\r\n    }\r\n\r\n    calculateRarity(quality) {\r\n        let rarity;\r\n        if(quality < 50) rarity =  \"trash\";\r\n        else if(quality < 100) rarity = \"common\";\r\n        else if(quality < 130) rarity = \"uncommon\";\r\n        else if(quality < 160) rarity = \"rare\";\r\n        else if(quality < 200) rarity = \"epic\";\r\n        else if(quality < 246) rarity = \"legendary\";\r\n        else rarity = \"mythical\";\r\n\r\n        return rarity;\r\n    }\r\n\r\n    getStats() {\r\n        return this.component_stats;\r\n    }\r\n\r\n    getBonusSkillLevels() {\r\n        return this.component_bonus_skill_levels;\r\n    }\r\n}\r\n\r\nclass WeaponComponent extends ItemComponent {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        if(item_data.component_type !== \"axe head\" && item_data.component_type !== \"hammer head\"\r\n        && item_data.component_type !== \"short blade\" && item_data.component_type !== \"long blade\"\r\n        && item_data.component_type !== \"short handle\" && item_data.component_type !== \"long handle\"\r\n        && item_data.component_type !== \"medium handle\") {\r\n            throw new Error(`No such weapon component type as ${item_data.component_type}`);\r\n        }\r\n        this.component_type = item_data.component_type;\r\n        //\"short blade\", \"long blade\", \"axe blade\", \"hammer blade\" for heads; \"short handle\", \"medium handle\", \"long handle\" for handles\r\n\r\n\r\n        this.attack_value = item_data.attack_value || 0; //can skip this for weapon handles\r\n        if(item_data.component_type === \"short handle\"){\r\n            this.attack_multiplier = 1;\r\n            this.market_saturation_group = {group_key: group_key_prefix+\"handle\", group_tier: this.component_tier-1};\r\n        } else if(item_data.component_type === \"medium handle\"){\r\n            this.attack_multiplier = 1;\r\n            this.market_saturation_group = {group_key: group_key_prefix+\"handle\", group_tier: this.component_tier-1};\r\n        } else if(item_data.component_type === \"long handle\"){\r\n            this.attack_multiplier = 1.5;\r\n            this.market_saturation_group = {group_key: group_key_prefix+\"handle\", group_tier: this.component_tier-1};\r\n        } else {\r\n            this.attack_multiplier = 1;\r\n            this.market_saturation_group = {group_key: group_key_prefix+\"weapon\", group_tier: this.component_tier-1};\r\n        }\r\n\r\n        this.name_prefix = item_data.name_prefix; //to create a name of an item, e.g. \"Sharp iron\" used to create spear results in \"Sharp iron spear\"\r\n\r\n        this.tags[\"weapon component\"] = true;\r\n        this.tags[\"component\"] = true;\r\n    }\r\n}\r\n\r\nclass ShieldComponent extends ItemComponent {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        if(item_data.component_type !== \"shield base\" && item_data.component_type !== \"shield handle\") {\r\n            throw new Error(`No such shield component type as ${item_data.component_type}`);\r\n        }\r\n        this.component_type = item_data.component_type;\r\n\r\n        if(item_data.component_type === \"shield base\") {\r\n            this.market_saturation_group = {group_key: group_key_prefix+\"shield\", group_tier: this.component_tier-1};\r\n        } else {\r\n            this.market_saturation_group = {group_key: group_key_prefix+\"handle\", group_tier: this.component_tier-1};\r\n        }\r\n        //properties below only matter for shield type component\r\n        this.shield_strength = item_data.shield_strength;\r\n        this.shield_name = item_data.shield_name || item_data.name;\r\n\r\n        this.tags[\"shield component\"] = true;\r\n        this.tags[\"component\"] = true;\r\n    }\r\n}\r\n\r\nclass ArmorComponent extends ItemComponent {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        if(item_data.component_type !== \"helmet interior\" && item_data.component_type !== \"helmet exterior\"\r\n        && item_data.component_type !== \"chestplate interior\" && item_data.component_type !== \"chestplate exterior\"\r\n        && item_data.component_type !== \"leg armor interior\" && item_data.component_type !== \"leg armor exterior\"\r\n        && item_data.component_type !== \"glove interior\" && item_data.component_type !== \"glove exterior\"\r\n        && item_data.component_type !== \"shoes interior\" && item_data.component_type !== \"shoes exterior\") {\r\n\r\n            throw new Error(`No such armor component type as ${item_data.component_type}`);\r\n        }\r\n        this.component_type = item_data.component_type;\r\n        this.defense_value = item_data.defense_value;\r\n\r\n        this.stats = item_data.stats || {};\r\n\r\n        this.equip_slot = item_data.equip_slot;\r\n\r\n        //only used with external elements\r\n        this.full_armor_name = item_data.full_armor_name;\r\n\r\n        //only used with internal elements\r\n        this.armor_name = item_data.armor_name;\r\n\r\n        //only used with external elements; name_prefix/name_suffix are used only if full_armor_name is not provided\r\n        this.name_prefix = item_data.name_prefix;\r\n        this.name_suffix = item_data.name_suffix;\r\n\r\n        this.tags[\"armor component\"] = true;\r\n        this.tags[\"component\"] = true;\r\n\r\n        this.market_saturation_group = {group_key: group_key_prefix+\"armor\", group_tier: this.component_tier-1};\r\n    }\r\n}\r\n\r\nclass UsableItem extends Item {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        this.item_type = \"USABLE\";\r\n        this.effects = item_data.effects || {};\r\n        this.recovery_chances = item_data.recovery_chances || {};\r\n        this.saturates_market = false;\r\n\r\n        this.tags[\"usable\"] = true;\r\n    }\r\n}\r\n\r\nclass Equippable extends Item {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        this.item_type = \"EQUIPPABLE\";\r\n        this.base_bonus_skill_levels = item_data.base_bonus_skill_levels;\r\n\r\n        this.quality = Math.round(Number(item_data.quality)) || 100;\r\n\r\n        this.tags[\"equippable\"] = true;\r\n    }\r\n\r\n    getItemTier() {\r\n        if(this.components) {\r\n            let tier = 1;\r\n            Object.values(this.components).forEach(component_key => {\r\n                if(item_templates[component_key].component_tier > tier) {\r\n                    tier = item_templates[component_key].component_tier;\r\n                }\r\n            });\r\n            return tier;\r\n        } else if(this.component_tier) {\r\n            return this.component_tier;\r\n        } else {\r\n            return 1;\r\n        }\r\n    }\r\n\r\n    getRarity(quality){\r\n        if(!quality) {\r\n            if(!this.rarity) {\r\n                this.rarity = getItemRarity(this.quality);\r\n            }\r\n            return this.rarity;\r\n        } else {\r\n            return getItemRarity(quality);\r\n        }\r\n\r\n    }\r\n\r\n    getStats(quality){\r\n        if(!quality) {\r\n            if(!this.stats) {\r\n                this.stats = this.calculateStats(this.quality);\r\n            }\r\n            return this.stats;\r\n        } else {\r\n            return this.calculateStats(quality);\r\n        }\r\n    }\r\n\r\n    calculateStats(quality){\r\n        const stats = {};\r\n        if(this.components) {\r\n            //iterate over components\r\n            const components = Object.values(this.components).map(comp => item_templates[comp]).filter(comp => comp);\r\n            for(let i = 0; i < components.length; i++) {\r\n                Object.keys(components[i].component_stats).forEach(stat => {\r\n                    if(!stats[stat]) {\r\n                        stats[stat] = {};\r\n                    }\r\n\r\n                    if(stat === \"defense\" || stat === \"attack_power\" || stat === \"block_strength\") { //skip it, it's to be added to the basic defense/attack instead\r\n                        return;\r\n                    }\r\n\r\n                    if(components[i].component_stats[stat].multiplier) {\r\n                        stats[stat].multiplier = (stats[stat].multiplier || 1) * components[i].component_stats[stat].multiplier;\r\n                    }\r\n                    if(components[i].component_stats[stat].flat) {\r\n                        stats[stat].flat = (stats[stat].flat || 0) + components[i].component_stats[stat].flat;\r\n                    }\r\n                });\r\n            }\r\n\r\n            //iterate over stats and apply rarity bonus if possible\r\n            Object.keys(stats).forEach(stat => {\r\n                if(stats[stat].multiplier){\r\n                    if(stats[stat].multiplier >= 1) {\r\n                        stats[stat].multiplier = Math.round(100 * (1 + (stats[stat].multiplier - 1) * rarity_multipliers[this.getRarity(quality)]))/100;\r\n                    } else {\r\n                        stats[stat].multiplier = Math.round(100 * stats[stat].multiplier)/100;\r\n                    }\r\n                }\r\n\r\n                if(stats[stat].flat){\r\n                    if(stats[stat].flat > 0) {\r\n                        stats[stat].flat = Math.round(100 * stats[stat].flat * rarity_multipliers[this.getRarity(quality)])/100;\r\n                    } else {\r\n                        stats[stat].flat = Math.round(100 * stats[stat].flat)/100;\r\n                    }\r\n                }\r\n            });\r\n        } else { //no components, only needs to apply quality to already present stats\r\n            let used_stats = this.component_stats || this.base_stats || {};\r\n            Object.keys(used_stats).forEach(stat => {\r\n                stats[stat] = {};\r\n                if(used_stats[stat].multiplier){\r\n                    stats[stat].multiplier = 1;\r\n                    if(used_stats[stat].multiplier >= 1) {\r\n                        stats[stat].multiplier = Math.round(100 * (1 + (used_stats[stat].multiplier - 1) * rarity_multipliers[this.getRarity(quality)]))/100;\r\n                    } else {\r\n                        stats[stat].multiplier = Math.round(100 * used_stats[stat].multiplier)/100;\r\n                    }\r\n                }\r\n\r\n                if(used_stats[stat].flat){\r\n                    stats[stat].flat = 0;\r\n                    if(used_stats[stat].flat > 0) {\r\n                        stats[stat].flat = Math.round(100 * used_stats[stat].flat * rarity_multipliers[this.getRarity(quality)])/100;\r\n                    } else {\r\n                        stats[stat].flat = Math.round(100 * used_stats[stat].flat)/100;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        return stats;\r\n    }\r\n\r\n    getBonusSkillLevels(quality) {\r\n        if(!quality) {\r\n            if(!this.bonus_skill_levels) {\r\n                this.bonus_skill_levels = this.calculateBonusSkillLevels(this.quality);\r\n            }\r\n            return this.bonus_skill_levels;\r\n        } else {\r\n            return this.calculateBonusSkillLevels(quality);\r\n        }\r\n    }\r\n\r\n    calculateBonusSkillLevels(quality) {\r\n        let skill_bonus = {};\r\n\r\n        if(this.components) {\r\n            //iterate over components\r\n            const components = Object.values(this.components).map(comp => item_templates[comp]).filter(comp => comp);\r\n            for(let i = 0; i < components.length; i++) {\r\n                Object.keys(components[i].component_bonus_skill_levels).forEach(skill => {\r\n                    skill_bonus[skill] = (skill_bonus[skill] || 0) + components[i].component_bonus_skill_levels[skill];\r\n                });\r\n            }\r\n\r\n            //iterate over stats and apply rarity bonus if possible\r\n            Object.keys(skill_bonus).forEach(skill => {\r\n                if(skill_bonus[skill]){\r\n                    if(skill_bonus[skill] > 0) {\r\n                        skill_bonus[skill] = Math.round(skill_bonus[skill] * rarity_multipliers[this.getRarity(quality)]);\r\n                    } else {\r\n                        skill_bonus[skill] = Math.round(skill_bonus[skill]);\r\n                    }\r\n                }\r\n            });\r\n        } else { //no components, only needs to apply quality to already present stats            \r\n            const used_bonus = this.component_bonus_skill_levels || this.base_bonus_skill_levels || {};\r\n            Object.keys(used_bonus).forEach(skill => {\r\n                if(used_bonus[skill] > 0) {\r\n                    skill_bonus[skill] = Math.round(used_bonus[skill] * rarity_multipliers[this.getRarity(quality)]);\r\n                } else {\r\n                    skill_bonus[skill] = Math.round(used_bonus[skill]);\r\n                }\r\n            });\r\n        }\r\n\r\n        return skill_bonus;\r\n    }\r\n}\r\n\r\nclass Artifact extends Equippable {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        this.equip_slot = \"artifact\";\r\n        this.stats = item_data.stats;\r\n        this.ignore_quality = true;\r\n\r\n        this.tags[\"artifact\"] = true;\r\n        if(!this.id) {\r\n            this.id = this.getName();\r\n        }\r\n    }\r\n\r\n    getStats(){\r\n        return this.stats;\r\n    }\r\n}\r\n\r\nclass Tool extends Equippable {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        this.equip_slot = item_data.equip_slot; //tool type is same as equip slot (axe/pickaxe/herb sickle)\r\n        this.ignore_quality = true;\r\n        this.tags[\"tool\"] = true;\r\n        this.tags[this.equip_slot] = true;\r\n        if(!this.id) {\r\n            this.id = this.getName();\r\n        }\r\n    }\r\n}\r\n\r\nclass Shield extends Equippable {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        this.equip_slot = \"off-hand\";\r\n        this.offhand_type = \"shield\"; //not like there's any other option\r\n\r\n        if(!item_templates[item_data.components.shield_base]) {\r\n            throw new Error(`No such shield base component as: ${item_data.components.shield_base}`);\r\n        }\r\n        this.components.shield_base = item_data.components.shield_base; //only the name\r\n\r\n        if(item_data.components.handle && !item_templates[item_data.components.handle]) {\r\n            throw new Error(`No such shield handle component as: ${item_data.components.handle}`);\r\n        }\r\n        this.components.handle = item_data.components.handle; //only the name\r\n        this.tags = {...this.tags, ...item_templates[this.components.handle].tags, ...item_templates[this.components.shield_base].tags};\r\n        this.tags[\"shield\"] = true;\r\n        if(!this.id) {\r\n            this.id = this.getName();\r\n        }\r\n\r\n        this.market_saturation_group = {group_key: group_key_prefix+\"shield\", group_tier: this.getItemTier()-1};\r\n    }\r\n\r\n    getShieldStrength(quality) {\r\n        if(!quality) {\r\n            if(!this.shield_strength) {\r\n                this.shield_strength = this.calculateShieldStrength(this.quality);\r\n            }\r\n            return this.shield_strength;\r\n        } else {\r\n            return this.calculateShieldStrength(quality);\r\n        }\r\n    }\r\n\r\n    calculateShieldStrength(quality) {\r\n        return Math.round(\r\n            10 * Math.ceil(10*item_templates[this.components.shield_base].shield_strength\r\n            * (item_templates[this.components.handle].component_stats?.block_strength?.multiplier || 1)\r\n            * (quality/100) * rarity_multipliers[this.getRarity(quality)]))/100;\r\n    }\r\n\r\n    getName() {\r\n        return item_templates[this.components.shield_base].shield_name;\r\n    }\r\n}\r\n\r\nclass Armor extends Equippable {\r\n    /*\r\n        can have no components, effectively being an equippable internal part;\r\n\r\n        naming convention:\r\n        if full_armor_name in external\r\n            then full_armor_name\r\n        else use prefix and suffix on internal element\r\n    */\r\n   /**\r\n    * Takes either {components} or {stats}, with {components} having higher priority. Lack of {components} assumes item is a wearable internal part (clothing)\r\n    * @param {*} item_data\r\n    */\r\n    constructor(item_data) {\r\n        super(item_data);\r\n\r\n        if(item_data.components) {\r\n            if(!item_templates[item_data.components.internal]) {\r\n                throw new Error(`No such internal armor element as: ${item_data.components.internal}`);\r\n            }\r\n\r\n            this.components.internal = item_data.components.internal; //only the name\r\n            this.components.external = item_data.components.external; //only the name\r\n\r\n            if(item_templates[this.components.internal].component_type === \"helmet interior\") {\r\n                this.equip_slot = \"head\";\r\n            } else if(item_templates[this.components.internal].component_type === \"chestplate interior\") {\r\n                this.equip_slot = \"torso\";\r\n            } else if(item_templates[this.components.internal].component_type === \"leg armor interior\") {\r\n                this.equip_slot = \"legs\";\r\n            } else if(item_templates[this.components.internal].component_type === \"glove interior\") {\r\n                this.equip_slot = \"arms\";\r\n            } else if(item_templates[this.components.internal].component_type === \"shoes interior\") {\r\n                this.equip_slot = \"feet\";\r\n            } else {\r\n                throw new Error(`Component type \"${item_templates[this.components.internal].component_type}\" doesn't correspond to any armor slot!`);\r\n            }\r\n            if(item_data.external && !item_templates[item_data.external]) {\r\n                throw new Error(`No such external armor element as: ${item_data.components.external}`);\r\n            }\r\n\r\n            this.market_saturation_group = {group_key: group_key_prefix+\"armor\", group_tier: this.getItemTier()-1};\r\n\r\n        } else {\r\n            //no components, assumed to be the internal part (clothing)\r\n            this.tags[\"component\"] = true;\r\n            this.tags[\"armor component\"] = true;\r\n            this.tags[\"clothing\"] = true;\r\n            this.component_stats = item_data.component_stats || {};\r\n            this.component_bonus_skill_levels = item_data.component_bonus_skill_levels || {};\r\n            delete this.components;\r\n\r\n            if(!item_data.name) {\r\n                throw new Error(`Component-less item needs to be provided a name!`);\r\n            }\r\n            this.name = item_data.name;\r\n            if(!item_data.value) {\r\n                throw new Error(`Component-less item \"${this.getName()}\" needs to be provided a monetary value!`);\r\n            }\r\n\r\n            this.component_type = item_data.component_type;\r\n            this.value = item_data.value;\r\n            this.component_tier = item_data.component_tier || 1;\r\n            this.base_defense = item_data.base_defense;\r\n\r\n            this.market_saturation_group = {group_key: group_key_prefix+\"clothing\", group_tier: this.getItemTier()-1};\r\n\r\n            if(item_data.component_type === \"helmet interior\") {\r\n                this.equip_slot = \"head\";\r\n            } else if(item_data.component_type === \"chestplate interior\") {\r\n                this.equip_slot = \"torso\";\r\n            } else if(item_data.component_type === \"leg armor interior\") {\r\n                this.equip_slot = \"legs\";\r\n            } else if(item_data.component_type === \"glove interior\") {\r\n                this.equip_slot = \"arms\";\r\n            } else if(item_data.component_type === \"shoes interior\") {\r\n                this.equip_slot = \"feet\";\r\n            } else {\r\n                throw new Error(`Component type \"${item_data.component_type}\" doesn't correspond to any armor slot!`);\r\n            }\r\n        }\r\n\r\n        this.tags[\"armor\"] = true;\r\n        if(!this.id) {\r\n            this.id = this.getName();\r\n        }\r\n    }\r\n\r\n    getDefense(quality) {\r\n        if(!quality) {\r\n            if(!this.defense_value) {\r\n                this.defense_value = this.calculateDefense(this.quality);\r\n            }\r\n            return this.defense_value;\r\n        } else {\r\n            return this.calculateDefense(quality);\r\n        }\r\n    }\r\n\r\n    calculateDefense(quality) {\r\n        if(this.components) {\r\n            return Math.ceil(((item_templates[this.components.internal].defense_value || item_templates[this.components.internal].base_defense ||0) +\r\n                                        (item_templates[this.components.external]?.defense_value || 0 ))\r\n                                        * (quality/100 || this.quality/100) * rarity_multipliers[this.getRarity(quality || this.quality)]\r\n            );\r\n        } else {\r\n            return Math.ceil((this.base_defense || 0)  * (quality/100 || this.quality/100) * rarity_multipliers[this.getRarity(quality || this.quality)]);\r\n        }\r\n    }\r\n\r\n    getName() {\r\n        /*\r\n        no external => name after internal.armor_name\r\n        external with full_armor_name => use full_armor_name\r\n        otherwise => prefix + internal + suffix\r\n        */\r\n\r\n        if(!this.name) {\r\n            if(!this.components.external) {\r\n                this.name = item_templates[this.components.internal].armor_name;\r\n            } else {\r\n                if(item_templates[this.components.external].full_armor_name) {\r\n                    this.name = item_templates[this.components.external].full_armor_name;\r\n                } else {\r\n                    this.name = (item_templates[this.components.external].name_prefix || '') + \" \" + item_templates[this.components.internal].armor_name.toLowerCase() + \" \" + (item_templates[this.components.external].name_suffix || '');\r\n                }\r\n            }\r\n        }\r\n\r\n        return this.name;\r\n    }\r\n}\r\n\r\nclass Weapon extends Equippable {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        this.equip_slot = \"weapon\";\r\n\r\n        if(!item_templates[item_data.components.head]) {\r\n            throw new Error(`No such weapon head as: ${item_data.components.head}`);\r\n        }\r\n        this.components.head = item_data.components.head; //only the name\r\n\r\n        if(!item_templates[item_data.components.handle]) {\r\n            throw new Error(`No such weapon handle as: ${item_data.components.handle}`);\r\n        }\r\n        this.components.handle = item_data.components.handle; //only the name\r\n\r\n        if(item_templates[this.components.handle].component_type === \"long handle\"\r\n        && (item_templates[this.components.head].component_type === \"short blade\" || item_templates[this.components.head].component_type === \"long blade\")) {\r\n            //long handle + short/long blade = spear\r\n            this.weapon_type = \"spear\";\r\n        } else if(item_templates[this.components.handle].component_type === \"medium handle\"\r\n        && item_templates[this.components.head].component_type === \"axe head\") {\r\n            //medium handle + axe head = axe\r\n            this.weapon_type = \"axe\";\r\n        } else if(item_templates[this.components.handle].component_type === \"medium handle\"\r\n        && item_templates[this.components.head].component_type === \"hammer head\") {\r\n            //medium handle + hammer head = hammer\r\n            this.weapon_type = \"hammer\";\r\n        } else if(item_templates[this.components.handle].component_type === \"short handle\"\r\n        && item_templates[this.components.head].component_type === \"short blade\") {\r\n            //short handle + short blade = dagger\r\n            this.weapon_type = \"dagger\";\r\n        } else if(item_templates[this.components.handle].component_type === \"short handle\"\r\n        && item_templates[this.components.head].component_type === \"long blade\") {\r\n            //short handle + long blade = sword\r\n            this.weapon_type = \"sword\";\r\n        } else {\r\n            throw new Error(`Combination of elements of types ${item_templates[this.components.handle].component_type} and ${item_templates[this.components.head].component_type} does not exist!`);\r\n        }\r\n\r\n        this.tags[\"weapon\"] = true;\r\n        this.tags[this.weapon_type] = true;\r\n        if(!this.id) {\r\n            this.id = this.getName();\r\n        }\r\n\r\n        this.market_saturation_group = {group_key: group_key_prefix+\"weapon\", group_tier: this.getItemTier()-1};\r\n    }\r\n\r\n    getAttack(quality){\r\n        if(!quality) {\r\n            if(!this.attack_power) {\r\n                this.attack_power = this.calculateAttackPower(this.quality);\r\n            }\r\n            return this.attack_power;\r\n        } else {\r\n            return this.calculateAttackPower(quality);\r\n        }\r\n    }\r\n\r\n    calculateAttackPower(quality) {\r\n        return Math.ceil(\r\n            (item_templates[this.components.head].attack_value + item_templates[this.components.handle].attack_value\r\n                + (item_templates[this.components.handle].component_stats?.attack_power?.flat || 0))\r\n            * item_templates[this.components.head].attack_multiplier * item_templates[this.components.handle].attack_multiplier\r\n            * (item_templates[this.components.handle].component_stats?.attack_power?.multiplier || 1)\r\n            * (quality/100) * rarity_multipliers[this.getRarity(quality)]\r\n        );\r\n    }\r\n\r\n    getName() {\r\n        return `${item_templates[this.components.head].name_prefix} ${this.weapon_type === \"hammer\" ? \"battle hammer\" : this.weapon_type}`;\r\n    }\r\n}\r\n\r\nclass Cape extends Equippable {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        this.components = undefined;\r\n        this.equip_slot = \"cape\";\r\n        this.base_stats = item_data.base_stats;\r\n        this.item_tier = item_data.item_tier;\r\n\r\n        this.tags[\"cape\"] = true;\r\n\r\n        if(!item_data.name) {\r\n            throw new Error(`Component-less item needs to be provided a name!`);\r\n        }\r\n        this.name = item_data.name;\r\n        if(!item_data.value) {\r\n            throw new Error(`Component-less item \"${this.getName()}\" needs to be provided a monetary value!`);\r\n        }\r\n\r\n        this.value = item_data.value;\r\n        this.base_defense = item_data.base_defense;\r\n\r\n        if(!this.id) {\r\n            this.id = this.getName();\r\n        }\r\n\r\n        this.market_saturation_group = {group_key: group_key_prefix+\"cape\", group_tier: this.getItemTier()-1};\r\n    }\r\n\r\n\r\n    getDefense(quality) {\r\n        if(!quality) {\r\n            if(!this.defense_value) {\r\n                this.defense_value = this.calculateDefense(this.quality);\r\n            }\r\n            return this.defense_value;\r\n        } else {\r\n            return this.calculateDefense(quality);\r\n        }\r\n    }\r\n    calculateDefense(quality) {\r\n        return Math.ceil((this.base_defense || 0)  * (quality/100 || this.quality/100) * rarity_multipliers[this.getRarity(quality || this.quality)]);\r\n    }\r\n}\r\n\r\nclass Amulet extends Equippable {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        this.equip_slot = \"amulet\";\r\n        this.stats = item_data.stats;\r\n\r\n        this.ignore_quality = true;\r\n\r\n        this.tags[\"amulet\"] = true;\r\n        if(!this.id) {\r\n            this.id = this.getName();\r\n        }\r\n    }\r\n\r\n    getStats(){\r\n        return this.stats;\r\n    }\r\n}\r\nclass Ring extends Equippable {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        this.equip_slot = \"ring\";\r\n        this.stats = item_data.stats;\r\n\r\n        this.ignore_quality = true;\r\n\r\n        this.tags[\"ring\"] = true;\r\n        if(!this.id) {\r\n            this.id = this.getName();\r\n        }\r\n    }\r\n\r\n    getStats(){\r\n        return this.stats;\r\n    }\r\n}\r\n\r\n//////////////////////////////\r\n//////////////////////////////\r\n//////////////////////////////\r\nclass BookData{\r\n    constructor({\r\n        required_time = 1,\r\n        required_skills = {literacy: 0},\r\n        literacy_xp_rate = 1,\r\n        finish_reward = {},\r\n        bonuses = {}, //xp/stat bonuses\r\n        rewards = {}, //unlocks, etc\r\n    }) {\r\n        this.required_time = required_time;\r\n        this.accumulated_time = 0;\r\n        this.required_skills = required_skills;\r\n        this.literacy_xp_rate = literacy_xp_rate;\r\n        this.finish_reward = finish_reward;\r\n        this.is_finished = false;\r\n        this.bonuses = bonuses;\r\n        this.rewards = rewards;\r\n    }\r\n}\r\n\r\nconst book_stats = {};\r\n\r\nclass Book extends Item {\r\n    constructor(item_data) {\r\n        super(item_data);\r\n        this.item_type = \"BOOK\";\r\n        this.name = item_data.name;\r\n\r\n        this.tags[\"book\"] = true;\r\n\r\n        this.saturates_market = false; //uncraftable and limited, no point\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {Number} total time needed to read the book\r\n     */\r\n    getReadingTime() {\r\n        //maybe make it go faster with literacy skill level?\r\n        let {required_time} = book_stats[this.name];\r\n        return required_time;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {Number} remaining time needed to read the book (total time minus accumulated time)\r\n     */\r\n    getRemainingTime() {\r\n        let remaining_time = Math.max(book_stats[this.name].required_time - book_stats[this.name].accumulated_time, 0);\r\n        return remaining_time;\r\n    }\r\n\r\n    addProgress(time = 1) {\r\n        book_stats[this.name].accumulated_time += time;\r\n        if(book_stats[this.name].accumulated_time >= book_stats[this.name].required_time) {\r\n            this.setAsFinished();\r\n        }\r\n    }\r\n\r\n    setAsFinished() {\r\n        book_stats[this.name].is_finished = true;\r\n        book_stats[this.name].accumulated_time = book_stats[this.name].required_time;\r\n    }\r\n}\r\n\r\n/**\r\n * @param {Object} item_data\r\n * @param {Object} item_data.item_type\r\n * @returns {Item} item of proper type, created with item_data\r\n */\r\nfunction getItem(item_data) {\r\n    switch(item_data.item_type) {\r\n        case \"EQUIPPABLE\":\r\n            switch(item_data.equip_slot) {\r\n                case \"weapon\":\r\n                    return new Weapon(item_data);\r\n                case \"off-hand\":\r\n                    return new Shield(item_data);\r\n                case \"artifact\":\r\n                    return new Artifact(item_data);\r\n                case \"axe\":\r\n                case \"pickaxe\":\r\n                case \"sickle\":\r\n                case \"shovel\":\r\n                case \"fishing_pole\":\r\n                    return new Tool(item_data);\r\n                case \"cape\":\r\n                    return new Cape(item_data);\r\n                case \"amulet\":\r\n                    return new Amulet(item_data);\r\n                case \"ring\":\r\n                    return new Ring(item_data);\r\n                default:\r\n                    return new Armor(item_data);\r\n            }\r\n        case \"USABLE\":\r\n            return new UsableItem(item_data);\r\n        case \"BOOK\":\r\n            return new Book(item_data);\r\n        case \"OTHER\":\r\n            return new OtherItem(item_data);\r\n        case \"COMPONENT\":\r\n            if(item_data.tags[\"weapon component\"])\r\n                return new WeaponComponent(item_data);\r\n            else if(item_data.tags[\"armor component\"])\r\n                return new ArmorComponent(item_data);\r\n            else if(item_data.tags[\"shield component\"])\r\n                return new ShieldComponent(item_data);\r\n            else throw new Error(`Item ${item_data.name} has a wrong component type`);\r\n        case \"MATERIAL\":\r\n            return new Material(item_data);\r\n        default:\r\n            throw new Error(`Wrong item type: ${item_data.item_type}`);\r\n    }\r\n}\r\n\r\n/**\r\n * @param {String} item_data\r\n * @returns {Item} item of proper type, created based on item_key\r\n */\r\nfunction getItemFromKey(key) {\r\n    let {id, components, quality} = JSON.parse(key);\r\n    if(id && !quality) {\r\n        if(item_templates[id]) {\r\n            return getItem(item_templates[id]);\r\n        } else {\r\n            throw new Error(`Inventory item \"${key}\" couldn't be found!`);\r\n        }\r\n    } else if(components) {\r\n        const {head, handle, shield_base, internal, external} = components;\r\n        if(head) { //weapon\r\n            if(!item_templates[head]){\r\n                throw new Error(`Weapon head component \"${head}\" couldn't be found!`);\r\n            } else if(!item_templates[handle]) {\r\n                throw new Error(`Weapon handle component \"${handle}\" couldn't be found!`);\r\n            } else {\r\n                return getItem({components, quality, equip_slot: \"weapon\", item_type: \"EQUIPPABLE\"});\r\n            }\r\n        } else if(shield_base){ //shield\r\n            if(!item_templates[shield_base]){\r\n                throw new Error(`Shield base component \"${shield_base}\" couldn't be found!`);\r\n            } else if(!item_templates[handle]) {\r\n                throw new Error(`Shield handle component \"${handle}\" couldn't be found!`);\r\n            } else {\r\n                return getItem({components, quality, equip_slot: \"off-hand\", item_type: \"EQUIPPABLE\"});\r\n            }\r\n        } else if(internal) { //armor\r\n            if(!item_templates[internal]){\r\n                throw new Error(`Internal armor component \"${internal}\" couldn't be found!`);\r\n            } else if(!item_templates[external]) {\r\n                throw new Error(`External armor component \"${external}\" couldn't be found!`);\r\n            } else {\r\n                let equip_slot = getArmorSlot(internal);\r\n                if(!equip_slot) {\r\n                    return;\r\n                }\r\n                return getItem({components, quality, equip_slot, item_type: \"EQUIPPABLE\"});\r\n            }\r\n        } else {\r\n            throw new Error(`Inventory key \"${key}\" seems to refer to non-existing item type!`);\r\n        }\r\n    } else if(quality) { //no comps but quality (clothing / artifact?)\r\n        return getItem({...item_templates[id], quality});\r\n    } else {\r\n        throw new Error(`Inventory key \"${key}\" is incorrect!`);\r\n    }\r\n}\r\n\r\n//book stats\r\nbook_stats[\"ABC for kids\"] = new BookData({\r\n    required_time: 120,\r\n    literacy_xp_rate: 1,\r\n    bonuses: {\r\n        xp_multipliers: {\r\n            all: 1.2,\r\n        }\r\n    },\r\n});\r\n\r\nbook_stats[\"Old combat manual\"] = new BookData({\r\n    required_time: 320,\r\n    literacy_xp_rate: 1,\r\n    bonuses: {\r\n        xp_multipliers: {\r\n            Combat: 1.5,\r\n        }\r\n    },\r\n});\r\n\r\nbook_stats[\"Twist liek a snek\"] = new BookData({\r\n    required_time: 320,\r\n    literacy_xp_rate: 1,\r\n    bonuses: {\r\n        xp_multipliers: {\r\n            Evasion: 1.5,\r\n        },\r\n        multipliers: {\r\n            agility: 1.1,\r\n        }\r\n    },\r\n});\r\n\r\nbook_stats[\"Medicine for dummies\"] = new BookData({\r\n    required_time: 420,\r\n    literacy_xp_rate: 2,\r\n    rewards: {\r\n        recipes: [\r\n            {category: \"alchemy\", subcategory: \"items\", recipe_id: \"Weak healing powder\"},\r\n            {category: \"alchemy\", subcategory: \"items\", recipe_id: \"Healing balm\"},\r\n            {category: \"alchemy\", subcategory: \"items\", recipe_id: \"Oneberry juice\"},\r\n            {category: \"alchemy\", subcategory: \"items\", recipe_id: \"Healing powder\"},\r\n            {category: \"alchemy\", subcategory: \"items\", recipe_id: \"Healing potion\"},\r\n        ],\r\n        skill_xp: {\r\n            \"Medicine\": 20,\r\n        }\r\n    },\r\n    bonuses: {\r\n        xp_multipliers: {\r\n            Medicine: 1.5,\r\n        },\r\n    }\r\n});\r\n\r\nbook_stats[\"Butchering and you\"] = new BookData({\r\n    required_time: 240,\r\n    literacy_xp_rate: 2,\r\n    rewards: {\r\n        skills: [\"Butchering\"],\r\n        recipes: [\r\n            {category: \"cooking\", subcategory: \"items\", recipe_id: \"Animal fat\"}\r\n        ],\r\n    },\r\n});\r\n\r\nbook_stats[\"Ode to Whimsy, and other poems\"] = new BookData({\r\n    required_time: 120,\r\n    literacy_xp_rate: 4,\r\n    bonuses: {\r\n        xp_multipliers: {\r\n            all: 1.2,\r\n        }\r\n    },\r\n});\r\n\r\nbook_stats[\"A Glint On The Sand\"] = new BookData({\r\n    required_time: 420,\r\n    literacy_xp_rate: 4,\r\n    rewards: {\r\n        recipes: [\r\n            {category: \"alchemy\", subcategory: \"items\", recipe_id: \"Potash\"},\r\n            {category: \"smelting\", subcategory: \"items\", recipe_id: \"Raw Glass\"},\r\n            {category: \"crafting\", subcategory: \"items\", recipe_id: \"Glass phial\"},\r\n            {category: \"crafting\", subcategory: \"items\", recipe_id: \"Glass bottle\"},\r\n        ],\r\n        activities: [\r\n            {location: \"Village\", activity: \"sand\"},\r\n            {location: \"Lake beach\", activity: \"sand\"}\r\n\t\t]\r\n    }\r\n\t\r\n});\r\n\r\nbook_stats[\"Shellfish desires\"] = new BookData({\r\n    required_time: 420,\r\n    literacy_xp_rate: 6,\r\n    rewards: {\r\n        recipes: [\r\n            {category: \"cooking\", subcategory: \"items\", recipe_id: \"Crab bisque\"},\r\n            {category: \"cooking\", subcategory: \"items\", recipe_id: \"Clam broth\"},\r\n            {category: \"cooking\", subcategory: \"items\", recipe_id: \"Turtle soup\"},\r\n            {category: \"cooking\", subcategory: \"items\", recipe_id: \"Basin gumbo\"},\r\n        ],\r\n    },\r\n    bonuses: {\r\n        xp_multipliers: {\r\n            Cooking: 1.5,\r\n        },\r\n    }\r\n});\r\n\r\n//books\r\n(()=>{\r\n    item_templates[\"ABC for kids\"] = new Book({\r\n        name: \"ABC for kids\",\r\n        description: \"The simplest book on the market\",\r\n        value: 100,\r\n    });\r\n    item_templates[\"Old combat manual\"] = new Book({\r\n        name: \"Old combat manual\",\r\n        description: \"Old book about combat, worn and outdated, but might still contain something useful\",\r\n        value: 200,\r\n    });\r\n    item_templates[\"Twist liek a snek\"] = new Book({\r\n        name: \"Twist liek a snek\",\r\n        description: \"This book has a terrible grammar, seemingly written by some uneducated bandit, but despite that it quite well details how to properly evade attacks\",\r\n        value: 200,\r\n    });\r\n    item_templates[\"Medicine for dummies\"] = new Book({\r\n        name: \"Medicine for dummies\",\r\n        description: \"A simple book about healing, describing how to create some basic medicines\",\r\n        value: 320,\r\n    });\r\n    item_templates[\"Butchering and you\"] = new Book({\r\n        name: \"Butchering and you\",\r\n        description: \"An introductory book to animal butchering, that goes into further detail on how to make a use of animal parts, especially hides and bones\",\r\n        value: 240,\r\n    });\r\n    item_templates[\"Ode to Whimsy, and other poems\"] = new Book({\r\n        name: \"Ode to Whimsy, and other poems\",\r\n        description: \"A short and wonderful book of poetry that fills one with appreciation for life\",\r\n        value: 200,\r\n    });\r\n    item_templates[\"A Glint On The Sand\"] = new Book({\r\n        name: \"A Glint On The Sand\",\r\n        description: \"This books recounts a tale of shipwrecked crew accidentally discovering glassmaking while cooking on a beach. More importantly, it details the processees and materials necessary to manufacture glass\",\r\n        value: 300\r\n    });\r\n    item_templates[\"Shellfish desires\"] = new Book({\r\n        name: \"Shellfish desires\",\r\n        description: \"A cookbook detailing various methods of cleaning and preparing crab, clam, snail, turtle, and other aquatic animals\",\r\n        value: 1620\r\n    });\r\n\t\r\n})();\r\n\r\n//miscellaneous, and useless loot:\r\n(function(){\r\n    item_templates[\"Rat fang\"] = new OtherItem({\r\n        name: \"Rat fang\",\r\n        description: \"Fang of a huge rat, not very sharp, but can still pierce a human skin if enough force is applied\",\r\n        value: 8,\r\n        material_type: \"animal tooth\",\r\n    });\r\n    item_templates[\"Wolf fang\"] = new OtherItem({\r\n        name: \"Wolf fang\",\r\n        description: \"Fang of a wild wolf. Somewhat sharp, still not very useful. Maybe if it had a bit better quality...\",\r\n        value: 12,\r\n        material_type: \"animal tooth\",\r\n    });\r\n    item_templates[\"Boar tusk\"] = new Material({\r\n        name: \"Boar tusk\",\r\n        description: \"Tusk of a wild boar. Visibly worn and not very sharp\",\r\n        value: 20,\r\n    });\r\n    item_templates[\"Rat meat chunks\"] = new OtherItem({\r\n        name: \"Rat meat chunks\",\r\n        description: \"Eww\",\r\n        value: 8,\r\n    });\r\n\r\n    item_templates[\"Fish fillet\"] = new OtherItem({\r\n        name: \"Fish fillet\", \r\n        description: \"Cuts of meat from a fish that was too big to eat whole\", \r\n        value: 30,\r\n    });\r\n\r\n    item_templates[\"Glass phial\"] = new OtherItem({\r\n        name: \"Glass phial\",\r\n        description: \"Small glass phial, a perfect container for a potion\",\r\n        value: 10,\r\n    });\r\n    item_templates[\"Glass bottle\"] = new OtherItem({\r\n        name: \"Glass bottle\",\r\n        description: \"A glass bottle, perfect for carrying a drink around\",\r\n        value: 20,\r\n    });\r\n    item_templates[\"Camping supplies\"] = new OtherItem({\r\n        name: \"Camping supplies\",\r\n        description: \"Bedroll, tent, small chest, and generally just anything that could be needed to establish a camp\",\r\n        value: 2000,\r\n    });\r\n    item_templates[\"Coil of rope\"] = new OtherItem({\r\n        name: \"Coil of rope\",\r\n        description: \"A nice, long coil of rope, for whatever use you might find (although you have a feeling it will only be very situational)\",\r\n        value: 400,\r\n    });\r\n    item_templates[\"Mountain goat horn\"] = new OtherItem({\r\n        name: \"Mountain goat horn\",\r\n        description: \"A curved and sturdy horn of a mountain goat. While not very useful in itself, it makes for a nice decoration\",\r\n        value: 30,\r\n    });\r\n\t\r\n})();\r\n\r\n//lootable materials\r\n(function(){\r\n    item_templates[\"Rat tail\"] = new Material({\r\n        name: \"Rat tail\",\r\n        description: \"Tail of a huge rat. Doesn't seem very useful, but maybe some meat could be recovered from it\",\r\n        value: 4,\r\n    });\r\n    item_templates[\"Rat pelt\"] = new Material({\r\n        name: \"Rat pelt\",\r\n        description: \"Pelt of a huge rat. Fur has terrible quality, but maybe leather could be used for something if you gather more?\",\r\n        value: 10,\r\n        material_type: \"pelt\",\r\n    });\r\n\t\r\n    item_templates[\"High quality wolf fang\"] = new Material({\r\n        name: \"High quality wolf fang\",\r\n        description: \"Fang of a wild wolf. Very sharp, undamaged and surprisingly clean\",\r\n        value: 15,\r\n        material_type: \"miscellaneous\",\r\n    });\r\n    item_templates[\"Wolf pelt\"] = new Material({\r\n        name: \"Wolf pelt\",\r\n        description: \"Pelt of a wild wolf. It's a bit damaged so it won't fetch a great price, but the leather itself could be useful\",\r\n        value: 20,\r\n        material_type: \"pelt\",\r\n    });\r\n\t\r\n    item_templates[\"Boar hide\"] = new Material({\r\n        name: \"Boar hide\",\r\n        description: \"Thick hide of a wild boar. Too stiff for clothing, but might be useful for an armor\",\r\n        value: 30,\r\n        material_type: \"pelt\",\r\n    });\r\n    item_templates[\"Boar meat\"] = new Material({\r\n        name: \"Boar meat\",\r\n        description: \"Fatty meat of a wild boar, all it needs is to be cooked\",\r\n        value: 20,\r\n    });\r\n    item_templates[\"High quality boar tusk\"] = new Material({\r\n        name: \"High quality boar tusk\",\r\n        description: \"Tusk of a wild boar. Sharp and long enough to easily kill an adult human\",\r\n        value: 25,\r\n        material_type: \"miscellaneous\",\r\n    });\r\n\t\r\n    item_templates[\"Bear hide\"] = new Material({\r\n        description: \"A strong hide of a wild bear, so strong that even steel struggles against it\",\r\n        value: 50,\r\n        material_type: \"pelt\",\r\n    });\r\n    item_templates[\"Bear claw\"] = new Material({\r\n        description: \"Large and dangerous claw of a wild bear, but it has seen better days\",\r\n        value: 50,\r\n    });\r\n    item_templates[\"Sharp bear claw\"] = new Material({\r\n        description: \"Large and dangerous claw of a wild bear, sharp enough to easily cut through meat\",\r\n        value: 80,\r\n        material_type: \"miscellaneous\",\r\n    });\r\n    item_templates[\"Weak monster bone\"] = new Material({\r\n        name: \"Weak monster bone\",\r\n        description: \"Mutated and dark bone of a monster. While on the weaker side, it's still very strong and should be useful for crafting after some processing\",\r\n        value: 30,\r\n        material_type: \"bone\",\r\n    });\r\n\t\r\n    item_templates[\"Goat meat\"] = new Material({\r\n        name: \"Goat meat\",\r\n        description: \"Lean meat of a goat, it's pretty tough and needs to be cooked for a long time\",\r\n        value: 25,\r\n    });\r\n    item_templates[\"Mountain goat hide\"] = new Material({\r\n        name: \"Mountain goat hide\",\r\n        description: \"Thick hide of a mountain goat hide. Not as strong as boar hide, but this one can actually be turned into clothes after some processing\",\r\n        value: 30,\r\n        material_type: \"pelt\",\r\n    });\r\n    item_templates[\"Pristine mountain goat horn\"] = new Material({\r\n        name: \"Pristine mountain goat horn\",\r\n        description: \"Curved and sturdy horn of a mountain goat. It's noticeably bigger than average and seems to be even sturdier\",\r\n        value: 70,\r\n        material_type: \"miscellaneous\",\r\n    });\r\n\t\r\n    item_templates[\"Crab meat\"] = new Material({\r\n        name: \"Crab meat\",\r\n        description: \"A sandy shell filled with crab meat. It needs to be cleaned before it can be cooked\",\r\n        value: 20,\r\n    });\r\n    item_templates[\"Crab claw\"] = new Material({\r\n        name: \"Crab claw\",\r\n        description: \"A large claw of a crab, covered in abrasions and barnicles, but it makes a nice souvenier\",\r\n        value: 40,\r\n    });\r\n    item_templates[\"Giant crab claw\"] = new Material({\r\n        description: \"A large claw of a crab in pristine condition, still sharp and strong enough to take a finger off\",\r\n        value: 100,\r\n        material_type: \"miscellaneous\",\r\n    });\r\n\t\r\n    item_templates[\"Alligator meat\"] = new Material({\r\n        name: \"Alligator meat\",\r\n        description: \"A lean chunk of alligator meat. It's tough, with a strange but not unappealing smell\",\r\n        value: 40,\r\n    });\r\n    item_templates[\"Alligator skin\"] = new Material({\r\n        name: \"Alligator skin\",\r\n        description: \"Rough, scaly hide of an alligator. Deceptively strong and flexible, but uncomfortable to touch and terrible at keeping the cold at bay\",\r\n        value: 50,\r\n        material_type: \"pelt\",\r\n    });\r\n\t\r\n    item_templates[\"Turtle meat\"] = new Material({\r\n        name: \"Turtle meat\",\r\n        description: \"A lean cut of turtle meat. It's tender and versatile, but difficult to prepare\",\r\n        value: 40,\r\n    });\r\n    item_templates[\"Turtle shell\"] = new Material({\r\n        name: \"Turtle shell\",\r\n        description: \"A dense, thick turtle shell. It's stronger than steel, but too bulky to work with\",\r\n        value: 30,\r\n        material_type: \"pelt\",\r\n    });\r\n\t\r\n    item_templates[\"Giant snake meat\"] = new Material({\r\n        name: \"Giant snake meat\",\r\n        description: \"A lean cut of snake meat. It's rubbery, and looks difficult to cook\",\r\n        value: 40,\r\n    });\r\n    item_templates[\"Giant snake skin\"] = new Material({\r\n        name: \"Giant snake skin\",\r\n        description: \"Smooth, scaly hide of a giant snake. Very durable, but very thin and a poor insulator\",\r\n        value: 50,\r\n        material_type: \"pelt\",\r\n    });\r\n\t\r\n\r\n    item_templates[\"Frog meat\"] = new Material({\r\n        name: \"Frog meat\",\r\n        description: \"Surprisingly tender meat from a frog\",\r\n        value: 50,\r\n    });\r\n    item_templates[\"Frog hide\"] = new Material({\r\n        name: \"Frog hide\", \r\n        description: \"Slippery hide of a giant frog. If you could remove the toxins from it, the leather could be put into good use\",\r\n        value: 50,\r\n        material_type: \"pelt\",\r\n    });\r\n\r\n})();\r\n\r\n//gatherable materials\r\n(function(){\r\n    item_templates[\"Low quality iron ore\"] = new Material({\r\n        name: \"Low quality iron ore\",\r\n        description: \"Iron content is rather low and there are a lot of problematic components that can't be fully removed, which will affect created materials\",\r\n        value: 3,\r\n        material_type: \"raw metal\",\r\n    });\r\n    item_templates[\"Iron ore\"] = new Material({\r\n        name: \"Iron ore\",\r\n        description: \"It has a decent iron content and can be smelt into market-quality iron\",\r\n        value: 5,\r\n        material_type: \"raw metal\",\r\n    });\r\n    item_templates[\"Atratan ore\"] = new Material({\r\n        name: \"Atratan ore\",\r\n        description: \"A dark-colored ore said to have minuscule magical effects, but used almost excluvisely for refining all types of iron\",\r\n        value: 6,\r\n        material_type: \"raw metal\",\r\n    });\r\n    item_templates[\"Silver ore\"] = new Material({\r\n        name: \"Silver ore\", \r\n        description: \"Peculiar for its ability to direct or disrupt magic\",\r\n        value: 10,\r\n        material_type: \"raw metal\",\r\n    });\r\n    item_templates[\"Coal\"] = new Material({\r\n        name: \"Coal\",\r\n        description: \"A flammable material with extremely high carbon content\",\r\n        value: 7,\r\n        material_type: \"coal\",\r\n    });\r\n    item_templates[\"Charcoal\"] = new Material({\r\n        name: \"Charcoal\",\r\n        description: \"A flammable material with extremely high carbon content, created by strongly heating wood\",\r\n        value: 5,\r\n        material_type: \"coal\",\r\n    });\r\n\t\r\n    item_templates[\"Piece of rough wood\"] = new Material({\r\n        description: \"Cheapest form of wood. There's a lot of bark and malformed pieces\",\r\n        value: 2,\r\n        material_type: \"raw wood\",\r\n        getName: ()=>{\r\n            if(is_rat()) return \"Piece of rat wood\";\r\n            else return \"Piece of rough wood\";\r\n        }\r\n    });\r\n    item_templates[\"Piece of wood\"] = new Material({\r\n        description: \"Average quality wood. There's a lot of bark and malformed pieces\",\r\n        value: 4,\r\n        material_type: \"raw wood\",\r\n    });\r\n    item_templates[\"Piece of ash wood\"] = new Material({\r\n        description: \"Strong yet elastic, it's best wood you can hope to find around. There's a lot of bark and malformed pieces\",\r\n        value: 7,\r\n        material_type: \"raw wood\",\r\n    });\r\n\t\r\n    item_templates[\"Belmart leaf\"] = new Material({\r\n        description: \"Small, round, dark-green leaves with with very good disinfectant properties\",\r\n        value: 8,\r\n        material_type: \"disinfectant herb\",\r\n    });\r\n    item_templates[\"Golmoon leaf\"] = new Material({\r\n        description: \"Big green-brown leaves that can be applied to wounds to speed up their healing\",\r\n        value: 8,\r\n        material_type: \"healing herb\",\r\n    });\r\n    item_templates[\"Oneberry\"] = new Material({\r\n        description: \"Small blue berries capable of stimulating body's natural healing\",\r\n        value: 8,\r\n        material_type: \"healing herb\",\r\n    });\r\n    item_templates[\"Silver thistle\"] = new Material({\r\n        description: \"Rare herb that usually grows high up in mountains, a potent healing ingredient\",\r\n        value: 20,\r\n        material_type: \"healing herb\",\r\n    });\r\n\t\r\n    item_templates[\"Cooking herbs\"] = new Material({\r\n        name: \"Parsley, sage, rosemary and thyme\",\r\n        description: \"A collection of various herbs commonly used to enhance the flavour and nutrition of dishes\",\r\n        value: 10,\r\n        material_type: \"culinary herb\",\r\n    });\r\n    item_templates[\"Wool\"] = new Material({\r\n        description: \"A handful of wool, raw and unprocessed\",\r\n        value: 8,\r\n        material_type: \"raw fabric\",\r\n    });\r\n    item_templates[\"Silica Sand\"] = new Material({\r\n        name: \"Silica sand\",\r\n        description: \"Sand made potent by the remains of countless generations of creatures that lived and died in the body of water it was taken from\",\r\n        value: 1\r\n    });\r\n\r\n    item_templates[\"Flax\"] = new Material({\r\n        name: \"Flax\",\r\n        description: \"A bundle of flax, raw and unprocessed\",\r\n        value: 14,\r\n        material_type: \"raw fabric\",\r\n    });\r\n    item_templates[\"Clam\"] = new Material({\r\n        name: \"Clam\",\r\n        description: \"Common shellfish found in the sand and mud around the lake shore. Can't be eaten raw\",\r\n        value: 6,\r\n    });\r\n    item_templates[\"Wild onion\"] = new Material({\r\n        name: \"Wild onion\",\r\n        description: \"A wild root vegetable sometimes used to add flavor to dishes. Can't be eaten raw\",\r\n        value: 20,\r\n    });\r\n    item_templates[\"Wild garlic\"] = new Material({\r\n        name: \"Wild garlic\",\r\n        description: \"A wild root vegetable known to possess anti-fungal properties, sometimes used to add flavor to dishes. Can't be eaten raw\",\r\n        value: 20,\r\n        material_type: \"culinary herb\",\r\n    });\r\n    item_templates[\"Wild potato\"] = new Material({\r\n        name: \"Wild potato\",\r\n        description: \"A wild nutrient-rich stem tuber that can be used in a variety of dishes. Can't be eaten raw\",\r\n        value: 20,\r\n    });\r\n\t\r\n    item_templates[\"Ratfish\"] = new Material({\r\n        name: \"Ratfish\",\r\n        description: \"A small sweetwater fish, named after its unremarkable coloration and propensity to travel in large groups\",\r\n        value: 5,\r\n        material_type: \"small fish\",\r\n    });\r\n\r\n    item_templates[\"Minnow\"] = new Material({\r\n        name: \"Minnow\",\r\n        description: \"One of the variety of small fish that inhabit rivers and streams\",\r\n        value: 10,\r\n        material_type: \"small fish\",\r\n    });\r\n\r\n    item_templates[\"Mackerel shark\"] = new Material({\r\n        name: \"Mackerel shark\",\r\n        description: \"A shark small enough to fit in a stream. Makes up for its size with its feistiness and big mouth\",\r\n        value: 50,\r\n        material_type: \"medium fish\",\r\n    });\r\n\r\n    item_templates[\"Trout\"] = new Material({\r\n        name: \"Trout\",\r\n        description: \"A fish large enough for a full meal and common in most rivers, making it a convenient source of food. So far, this has not effected their population\",\r\n        value: 50,\r\n        material_type: \"medium fish\",\r\n    });\r\n\r\n    item_templates[\"Carp\"] = new Material({\r\n        name: \"Carp\",\r\n        description: \"It hasn't grown into any of its more powerful forms yet, so its meat is still fatty and plump\",\r\n        value: 50,\r\n        material_type: \"medium fish\",\r\n    });\r\n\r\n    item_templates[\"Catfish\"] = new Material({\r\n        name: \"Catfish\",\r\n        description: \"A large fish with whiskers. Usually found near the bottom of lakes, where it feeds on ratfish and pretty much everything else it can hunt\",\r\n        value: 200,\r\n        material_type: \"large fish\",\r\n    });\r\n})();\r\n\r\n\r\n\r\n//processed materials\r\n(function(){\r\n    item_templates[\"Bonemeal\"] = new Material({\r\n        description: \"Powdered bones and teeth, that can be used as an organic fertilizer\",\r\n        value: 100,\r\n    }),\r\n\t\r\n    item_templates[\"Low quality iron ingot\"] = new Material({\r\n        description: \"It has a lot of impurities, resulting in it being noticeably below the market standard\",\r\n        value: 10,\r\n        material_type: \"metal\",\r\n    });\r\n    item_templates[\"Iron ingot\"] = new Material({\r\n        description: \"It doesn't suffer from any excessive impurities and can be used without worries\",\r\n        value: 20,\r\n        material_type: \"metal\",\r\n    });\r\n\r\n    item_templates[\"Steel ingot\"] = new Material({\r\n        description: \"Basic alloy of iron, harder and more resistant\",\r\n        value: 40,\r\n        material_type: \"metal\",\r\n    });\r\n    item_templates[\"Turtle shellplate\"] = new Material({        //treated as a metal material/chainmail instead of leather\r\n        description: \"Small, dense plates capable of reflecting mighty blows. Useless in their current form, but can be turned into something useful with enough effort and focus\",\r\n        value: 60,\r\n        material_type: \"metal\",\r\n    });\r\n\t\r\n    item_templates[\"Silver ingot\"] = new Material({\r\n        description: \"Too soft to use as weapon material, but has potential for use in magic tools\",\r\n        value: 30,\r\n        material_type: \"metal\",\r\n    });\r\n    item_templates[\"Piece of wolf rat leather\"] = new Material({\r\n        description: \"It's slightly damaged and seems useless for anything that requires precise work\",\r\n        value: 10,\r\n        material_type: \"piece of leather\",\r\n    });\r\n    item_templates[\"Processed rat pelt\"] = new Material({\r\n        description: \"Processed pelt of a huge rat. It's of a barely acceptable quality, but it's still a miracle with how terrible the basic material was\",\r\n        value: 15,\r\n        material_type: \"processed pelt\",\r\n    });\r\n\t\r\n    item_templates[\"Piece of wolf leather\"] = new Material({\r\n        description: \"Somewhat strong, should offer some protection when turned into armor\",\r\n        value: 20,\r\n        material_type: \"piece of leather\",\r\n    });\r\n    item_templates[\"Processed wolf pelt\"] = new Material({\r\n        description: \"Processed pelt of a wild wolf. It's a nice, stylish material, with fur that's feels good to touch\",\r\n        value: 30,\r\n        material_type: \"processed pelt\",\r\n    });\r\n\t\r\n    item_templates[\"Piece of boar leather\"] = new Material({\r\n        description: \"Thick and resistant leather, too stiff for clothes but perfect for armor\",\r\n        value: 30,\r\n        material_type: \"piece of leather\",\r\n    });\r\n    item_templates[\"Processed boar hide\"] = new Material({\r\n        description: \"Processed hide of a wild boar. It's a thick, heavy material, with short rough fur, but it's quite strong\",\r\n        value: 45,\r\n        material_type: \"processed pelt\",\r\n    });\r\n\t\r\n    item_templates[\"Piece of goat leather\"] = new Material({\r\n        description: \"Thick and resistant, just barely elastic enough to be used for clothing\",\r\n        value: 40,\r\n        material_type: \"piece of leather\"\r\n    }),\r\n    item_templates[\"Processed goat hide\"] = new Material({\r\n        description: \"Processed hide of a wild goat. It's a resistant material, with short and rough fur\",\r\n        value: 60,\r\n        material_type: \"processed pelt\",\r\n    });\r\n\t\r\n    item_templates[\"Piece of bear leather\"] = new Material({\r\n        description: \"Strong and resistant, but too thick for clothing\",\r\n        value: 60,\r\n        material_type: \"piece of leather\"\r\n    });\r\n    item_templates[\"Processed bear hide\"] = new Material({\r\n        description: \"Strong, resistant, and warm, with fluffy fur\",\r\n        value: 90,\r\n        material_type: \"piece of leather\"\r\n    }),\r\n\t\r\n\titem_templates[\"Piece of alligator leather\"] = new Material({\r\n        description: \"Strong and flexible, but too uncomfortable to use as clothing\",\r\n        value: 150,\r\n        material_type: \"piece of leather\"\r\n    }),\r\n    item_templates[\"Piece of snakeskin leather\"] = new Material({\r\n        description: \"Durable and thin, but a poor insulator\",\r\n        value: 150,\r\n        material_type: \"piece of leather\"\r\n    }),\r\n\r\n    item_templates[\"Piece of frog leather\"] = new Material({\r\n        description: \"The toxins have been removed and the slime coagulated into a waxy coating\",\r\n        value: 60,\r\n        material_type: \"piece of leather\"\r\n    });\r\n    item_templates[\"Animal fat\"] = new Material({\r\n        description: \"White, thick, oily substance, rendered from animal tissue\",\r\n        value: 40,\r\n        material_type: \"fat\",\r\n    });\r\n    item_templates[\"Wool cloth\"] = new Material({\r\n        description: \"Thick and warm, might possibly absorb some punches\",\r\n        value: 8,\r\n        material_type: \"fabric\",\r\n    });\r\n\titem_templates[\"Linen cloth\"] = new Material({\r\n        description: \"Bolt of durable and thin cloth that won't restrict mobility\",\r\n        value: 14,\r\n        material_type: \"fabric\",\r\n    });\r\n\r\n    item_templates[\"Iron chainmail\"] = new Material({\r\n        description: \"Dozens of tiny iron rings linked together. Nowhere near a wearable form, turning it into armor will still take a lot of effort and focus\",\r\n        value: 12,\r\n        material_type: \"chainmail\",\r\n    });\r\n    item_templates[\"Steel chainmail\"] = new Material({\r\n        description: \"Dozens of tiny steel rings linked together. Nowhere near a wearable form, turning it into armor will still take a lot of effort and focus\",\r\n        value: 18,\r\n        material_type: \"chainmail\",\r\n    });\r\n\t\r\n    item_templates[\"Scraps of wolf rat meat\"] = new Material({\r\n        description: \"Ignoring where they come from and all the attached diseases, they actually look edible. Just remember to cook it first\",\r\n        value: 8,\r\n        material_type: \"meat\",\r\n    });\r\n    item_templates[\"Processed rough wood\"] = new Material({\r\n        description: \"Cheapest form of wood, ready to be used. Despite being rather weak, it still has a lot of uses\",\r\n        value: 6,\r\n        material_type: \"wood\",\r\n    });\r\n    item_templates[\"Processed wood\"] = new Material({\r\n        description: \"Average quality wood, ready to be used\",\r\n        value: 11,\r\n        material_type: \"wood\",\r\n    });\r\n    item_templates[\"Processed ash wood\"] = new Material({\r\n        description: \"High quality wood, just waiting to be turned into a piece of equipment\",\r\n        value: 20,\r\n        material_type: \"wood\",\r\n    });\r\n    item_templates[\"Processed weak monster bone\"] = new Material({\r\n        description: \"Polished and cleaned bones of a weak monster, just waiting to be turned into a piece of equipment\",\r\n        value: 40,\r\n        material_type: \"bone\",\r\n    });\r\n\t\r\n    item_templates[\"Potash\"] = new Material({\r\n        description: \"An alchemical substance derived from plant ash, sought after for production of bleach, soap and glass\",\r\n        value: 25\r\n    });\r\n    item_templates[\"Raw Glass\"] = new Material({\r\n        name: \"Raw glass\",\r\n        description: \"Molten piece of glass, yet to be shaped into something useful\",\r\n        value: 100\r\n    });\r\n\r\n})();\r\n\r\n//spare parts\r\n(function(){\r\n    //currently not in use and not obtainable\r\n    item_templates[\"Basic spare parts\"] = new OtherItem({\r\n        name: \"Basic spare parts\",\r\n        description: \"Some cheap and simple spare parts, like bindings and screws, necessary for crafting equipment\",\r\n        value: 30,\r\n        component_tier: 1,\r\n    });\r\n}());\r\n\r\n//weapon components:\r\n(function(){\r\n    item_templates[\"Cheap short iron blade\"] = new WeaponComponent({\r\n        name: \"Cheap short iron blade\", description: \"Crude blade made of iron. Perfect length for a dagger, but could be also used for a spear\",\r\n        component_type: \"short blade\",\r\n        value: 70,\r\n        component_tier: 1,\r\n        name_prefix: \"Cheap iron\",\r\n        attack_value: 5,\r\n        component_stats: {\r\n            crit_rate: {\r\n                flat: 0.06,\r\n            },\r\n            attack_speed: {\r\n                multiplier: 1.20,\r\n            },\r\n            evasion_points: {\r\n                multiplier: 1.05,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Short iron blade\"] = new WeaponComponent({\r\n        name: \"Short iron blade\", description: \"A good iron blade. Perfect length for a dagger, but could be also used for a spear\",\r\n        component_type: \"short blade\",\r\n        value: 160,\r\n        component_tier: 2,\r\n        name_prefix: \"Iron\",\r\n        attack_value: 8,\r\n        component_stats: {\r\n            crit_rate: {\r\n                flat: 0.08,\r\n            },\r\n            attack_speed: {\r\n                multiplier: 1.30,\r\n            },\r\n            evasion_points: {\r\n                multiplier: 1.13,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Short steel blade\"] = new WeaponComponent({\r\n        name: \"Short steel blade\", description: \"A good steel blade. Perfect length for a dagger, but could be also used for a spear\",\r\n        component_type: \"short blade\",\r\n        value: 240,\r\n        component_tier: 3,\r\n        name_prefix: \"Steel\",\r\n        attack_value: 11,\r\n        component_stats: {\r\n            crit_rate: {\r\n                flat: 0.1,\r\n            },\r\n            attack_speed: {\r\n                multiplier: 1.35,\r\n            },\r\n            evasion_points: {\r\n                multiplier: 1.2,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Cheap long iron blade\"] = new WeaponComponent({\r\n        name: \"Cheap long iron blade\", description: \"Crude blade made of iron, with a perfect length for a sword\",\r\n        component_type: \"long blade\",\r\n        value: 100,\r\n        name_prefix: \"Cheap iron\",\r\n        component_tier: 1,\r\n        attack_value: 8,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.10,\r\n            },\r\n            crit_rate: {\r\n                flat: 0.02,\r\n            },\r\n            attack_points: {\r\n                multiplier: 1.05,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Long iron blade\"] = new WeaponComponent({\r\n        name: \"Long iron blade\", description: \"Good blade made of iron, with a perfect length for a sword\",\r\n        component_type: \"long blade\",\r\n        value: 210,\r\n        name_prefix: \"Iron\",\r\n        component_tier: 2,\r\n        attack_value: 13,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.15,\r\n            },\r\n            crit_rate: {\r\n                flat: 0.04,\r\n            },\r\n            attack_points: {\r\n                multiplier: 1.13,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Long steel blade\"] = new WeaponComponent({\r\n        name: \"Long steel blade\", description: \"Good blade made of steel, with a perfect length for a sword\",\r\n        component_type: \"long blade\",\r\n        value: 310,\r\n        name_prefix: \"Steel\",\r\n        component_tier: 3,\r\n        attack_value: 18,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.2,\r\n            },\r\n            crit_rate: {\r\n                flat: 0.05,\r\n            },\r\n            attack_points: {\r\n                multiplier: 1.2,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Cheap iron axe head\"] = new WeaponComponent({\r\n        name: \"Cheap iron axe head\", description: \"A heavy axe head made of low quality iron\",\r\n        component_type: \"axe head\",\r\n        value: 100,\r\n        name_prefix: \"Cheap iron\",\r\n        component_tier: 1,\r\n        attack_value: 10,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.9,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Iron axe head\"] = new WeaponComponent({\r\n        name: \"Iron axe head\", description: \"A heavy axe head made of steel\",\r\n        component_type: \"axe head\",\r\n        value: 210,\r\n        name_prefix: \"Iron\",\r\n        component_tier: 2,\r\n        attack_value: 16,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Steel axe head\"] = new WeaponComponent({\r\n        name: \"Steel axe head\", description: \"A heavy axe head made of steel\",\r\n        component_type: \"axe head\",\r\n        value: 310,\r\n        name_prefix: \"Steel\",\r\n        component_tier: 3,\r\n        attack_value: 22,\r\n    });\r\n\t\r\n    item_templates[\"Cheap iron hammer head\"] = new WeaponComponent({\r\n        name: \"Cheap iron hammer head\", description: \"A crude ball made of low quality iron, with a small hole for the handle\",\r\n        component_type: \"hammer head\",\r\n        value: 100,\r\n        name_prefix: \"Cheap iron\",\r\n        component_tier: 1,\r\n        attack_value: 12,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.8,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Iron hammer head\"] = new WeaponComponent({\r\n        name: \"Iron hammer head\", description: \"A crude ball made of iron, with a small hole for the handle\",\r\n        component_type: \"hammer head\",\r\n        value: 210,\r\n        name_prefix: \"Iron\",\r\n        component_tier: 2,\r\n        attack_value: 19,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.85,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Steel hammer head\"] = new WeaponComponent({\r\n        name: \"Steel hammer head\", description: \"A blocky piece of steel, with a small hole for the handle\",\r\n        component_type: \"hammer head\",\r\n        value: 300,\r\n        name_prefix: \"Steel\",\r\n        component_tier: 3,\r\n        attack_value: 26,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.9,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Simple short wooden hilt\"] = new WeaponComponent({\r\n        name: \"Simple short wooden hilt\", description: \"A short handle for a sword or maybe a dagger\",\r\n        component_type: \"short handle\",\r\n        value: 8,\r\n        component_tier: 1,\r\n    });\r\n    item_templates[\"Short wooden hilt\"] = new WeaponComponent({\r\n        name: \"Short wooden hilt\", description: \"A short handle for a sword or maybe a dagger\",\r\n        component_type: \"short handle\",\r\n        value: 32,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.05,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Short ash wood hilt\"] = new WeaponComponent({\r\n        name: \"Short ash wood hilt\", description: \"A short handle for a sword or maybe a dagger\",\r\n        component_type: \"short handle\",\r\n        value: 48,\r\n        component_tier: 3,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.1,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Simple medium wooden handle\"] = new WeaponComponent({\r\n        name: \"Simple medium wooden handle\", description: \"A medium handle for an axe or a hammer\",\r\n        component_type: \"medium handle\",\r\n        value: 16,\r\n        component_tier: 1,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Medium wooden handle\"] = new WeaponComponent({\r\n        name: \"Medium wooden handle\", description: \"A medium handle for an axe or a hammer\",\r\n        component_type: \"medium handle\",\r\n        value: 64,\r\n        component_tier: 2,\r\n    });\r\n    item_templates[\"Medium ash wood handle\"] = new WeaponComponent({\r\n        name: \"Medium ash wood handle\", description: \"A medium handle for an axe or a hammer\",\r\n        component_type: \"medium handle\",\r\n        value: 96,\r\n        component_tier: 3,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.05,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Simple long wooden shaft\"] = new WeaponComponent({\r\n        name: \"Simple long wooden shaft\", description: \"A long shaft for a spear, somewhat uneven\",\r\n        component_type: \"long handle\",\r\n        value: 24,\r\n        component_tier: 1,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.9,\r\n            },\r\n        }\r\n    });\r\n    item_templates[\"Long wooden shaft\"] = new WeaponComponent({\r\n        name: \"Long wooden shaft\",\r\n        description: \"A long shaft for a spear, somewhat uneven\",\r\n        component_type: \"long handle\",\r\n        value: 100,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.95,\r\n            },\r\n        }\r\n    });\r\n    item_templates[\"Long ash wood shaft\"] = new WeaponComponent({\r\n        name: \"Long ash wood shaft\",\r\n        description: \"A long shaft for a spear\",\r\n        component_type: \"long handle\",\r\n        value: 150,\r\n        component_tier: 3,\r\n    });\r\n\t\r\n    item_templates[\"Cheap short iron hilt\"] = new WeaponComponent({\r\n        name: \"Cheap short iron hilt\", description: \"A short handle for a sword or maybe a dagger, heavy\",\r\n        component_type: \"short handle\",\r\n        value: 56,\r\n        component_tier: 1,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.9,\r\n            },\r\n            attack_power: {\r\n                multiplier: 1.05,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Short iron hilt\"] = new WeaponComponent({\r\n        name: \"Short iron hilt\", description: \"A short handle for a sword or maybe a dagger, heavy\",\r\n        component_type: \"short handle\",\r\n        value: 80,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            attack_power: {\r\n                multiplier: 1.05,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Short steel hilt\"] = new WeaponComponent({\r\n        name: \"Short steel hilt\", description: \"A short handle for a sword or maybe a dagger, heavy\",\r\n        component_type: \"short handle\",\r\n        value: 120,\r\n        component_tier: 3,\r\n        component_stats: {\r\n            attack_power: {\r\n                multiplier: 1.1,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Cheap medium iron handle\"] = new WeaponComponent({\r\n        name: \"Cheap medium iron handle\", description: \"A medium handle for an axe or a hammer, very heavy\",\r\n        component_type: \"medium handle\",\r\n        value: 64,\r\n        component_tier: 1,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.7,\r\n            },\r\n            attack_power: {\r\n                multiplier: 1.2,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Medium iron handle\"] = new WeaponComponent({\r\n        name: \"Medium iron handle\", description: \"A medium handle for an axe or a hammer, very heavy\",\r\n        component_type: \"medium handle\",\r\n        value: 100,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.8,\r\n            },\r\n            attack_power: {\r\n                multiplier: 1.2,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Medium steel handle\"] = new WeaponComponent({\r\n        name: \"Medium steel handle\", description: \"A medium handle for an axe or a hammer, very heavy\",\r\n        component_type: \"medium handle\",\r\n        value: 150,\r\n        component_tier: 3,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.8,\r\n            },\r\n            attack_power: {\r\n                multiplier: 1.27,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Cheap long iron shaft\"] = new WeaponComponent({\r\n        name: \"Cheap long iron shaft\", description: \"A long shaft for a spear, extremely heavy\",\r\n        component_type: \"long handle\",\r\n        value: 92,\r\n        component_tier: 1,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.5,\r\n            },\r\n            attack_power: {\r\n                multiplier: 1.6,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Long iron shaft\"] = new WeaponComponent({\r\n        name: \"Long iron shaft\",\r\n        description: \"A long shaft for a spear, extremely heavy\",\r\n        component_type: \"long handle\",\r\n        value: 128,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.6,\r\n            },\r\n            attack_power: {\r\n                multiplier: 1.6,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Long steel shaft\"] = new WeaponComponent({\r\n        name: \"Long steel shaft\",\r\n        description: \"A long shaft for a spear, extremely heavy\",\r\n        component_type: \"long handle\",\r\n        value: 192,\r\n        component_tier: 3,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.6,\r\n            },\r\n            attack_power: {\r\n                multiplier: 1.75,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Short weak bone hilt\"] = new WeaponComponent({\r\n        name: \"Short weak bone hilt\", description: \"A short handle for a sword or maybe a dagger, made of a weak monster's bone\",\r\n        component_type: \"short handle\",\r\n        value: 120,\r\n        component_tier: 3,\r\n        component_stats: {\r\n            attack_power: {\r\n                multiplier: 1.05,\r\n            },\r\n            attack_speed: {\r\n                multiplier: 1.05,\r\n            }\r\n        },\r\n    });\r\n    item_templates[\"Medium weak bone handle\"] = new WeaponComponent({\r\n        name: \"Medium weak bone handle\", description: \"A medium handle for an axe or a hammer, made of a weak monster's bone\",\r\n        component_type: \"medium handle\",\r\n        value: 150,\r\n        component_tier: 3,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.95,\r\n            },\r\n            attack_power: {\r\n                multiplier: 1.1,\r\n            },\r\n        }\r\n    });\r\n    item_templates[\"Long weak bone shaft\"] = new WeaponComponent({\r\n        name: \"Long weak bone shaft\",\r\n        description: \"A long shaft for a spear, made of weak monster's bone\",\r\n        component_type: \"long handle\",\r\n        value: 192,\r\n        component_tier: 3,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.8,\r\n            },\r\n            attack_power: {\r\n                multiplier: 1.25,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Turtleshell hilt\"] = new WeaponComponent({\r\n        name: \"Turtleshell hilt\",\r\n        description: \"A short handle for a sword or maybe a dagger, made of turtle shellplate\",\r\n        component_type: \"short handle\",\r\n        value: 140,\r\n        component_tier: 4,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.05,\r\n            },\r\n            attack_points: {\r\n                multiplier: 1.1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Turtleshell handle\"] = new WeaponComponent({\r\n        name: \"Turtleshell handle\",\r\n        description: \"A medium handle for an axe or a hammer, made of turtle shellplate\",\r\n        component_type: \"medium handle\",\r\n        value: 190,\r\n        component_tier: 4,\r\n        component_stats: {\r\n            attack_points: {\r\n                multiplier: 1.1,\r\n            },\r\n            attack_power: {\r\n                multiplier: 1.1,\r\n            },\r\n        }\r\n    });\r\n    item_templates[\"Turtleshell shaft\"] = new WeaponComponent({\r\n        name: \"Turtleshell shaft\",\r\n        description: \"A long shaft for a spear, made of turtle shellplate\",\r\n        component_type: \"long handle\",\r\n        value: 250,\r\n        component_tier: 4,\r\n        component_stats: {\r\n            attack_power: {\r\n                multiplier: 1.2,\r\n            },\r\n            attack_speed: {\r\n                multiplier: 0.95,\r\n            },\r\n            attack_points: {\r\n                multiplier: 1.1,\r\n            }\r\n        }\r\n    });\r\n\t\r\n})();\r\n\r\n//weapons:\r\n(function(){\r\n    item_templates[\"Cheap iron spear\"] = new Weapon({\r\n        components: {\r\n            head: \"Cheap short iron blade\",\r\n            handle: \"Simple long wooden shaft\"\r\n        }\r\n    });\r\n    item_templates[\"Iron spear\"] = new Weapon({\r\n        components: {\r\n            head: \"Short iron blade\",\r\n            handle: \"Simple long wooden shaft\"\r\n        }\r\n    });\r\n    item_templates[\"Steel spear\"] = new Weapon({\r\n        components: {\r\n            head: \"Short steel blade\",\r\n            handle: \"Long wooden shaft\"\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Cheap iron dagger\"] = new Weapon({\r\n        components: {\r\n            head: \"Cheap short iron blade\",\r\n            handle: \"Simple short wooden hilt\",\r\n        }\r\n    });\r\n    item_templates[\"Iron dagger\"] = new Weapon({\r\n        components: {\r\n            head: \"Short iron blade\",\r\n            handle: \"Simple short wooden hilt\",\r\n        }\r\n    });\r\n    item_templates[\"Steel dagger\"] = new Weapon({\r\n        components: {\r\n            head: \"Short steel blade\",\r\n            handle: \"Short wooden hilt\",\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Cheap iron sword\"] = new Weapon({\r\n        components: {\r\n            head: \"Cheap long iron blade\",\r\n            handle: \"Simple short wooden hilt\",\r\n        }\r\n    });\r\n    item_templates[\"Iron sword\"] = new Weapon({\r\n        components: {\r\n            head: \"Long iron blade\",\r\n            handle: \"Simple short wooden hilt\",\r\n        }\r\n    });\r\n    item_templates[\"Steel sword\"] = new Weapon({\r\n        components: {\r\n            head: \"Long steel blade\",\r\n            handle: \"Short wooden hilt\",\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Cheap iron axe\"] = new Weapon({\r\n        components: {\r\n            head: \"Cheap iron axe head\",\r\n            handle: \"Simple medium wooden handle\",\r\n        }\r\n    });\r\n    item_templates[\"Iron axe\"] = new Weapon({\r\n        components: {\r\n            head: \"Iron axe head\",\r\n            handle: \"Simple medium wooden handle\",\r\n        }\r\n    });\r\n    item_templates[\"Steel axe\"] = new Weapon({\r\n        components: {\r\n            head: \"Steel axe head\",\r\n            handle: \"Medium wooden handle\",\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Cheap iron battle hammer\"] = new Weapon({\r\n        components: {\r\n            head: \"Cheap iron hammer head\",\r\n            handle: \"Simple medium wooden handle\",\r\n        }\r\n    });\r\n    item_templates[\"Iron battle hammer\"] = new Weapon({\r\n        components: {\r\n            head: \"Iron hammer head\",\r\n            handle: \"Simple medium wooden handle\",\r\n        }\r\n    });\r\n    item_templates[\"Steel battle hammer\"] = new Weapon({\r\n        components: {\r\n            head: \"Steel hammer head\",\r\n            handle: \"Medium wooden handle\",\r\n        }\r\n    });\r\n\t\r\n})();\r\n\r\n//armor components:\r\n(function(){\r\n    item_templates[\"Wolf leather helmet armor\"] = new ArmorComponent({\r\n        name: \"Wolf leather helmet armor\",\r\n        description: \"Strenghtened wolf leather, ready to be used as a part of a helmet\",\r\n        component_type: \"helmet exterior\",\r\n        value: 240,\r\n        component_tier: 2,\r\n        full_armor_name: \"Wolf leather helmet\",\r\n        defense_value: 2,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Boar leather helmet armor\"] = new ArmorComponent({\r\n        name: \"Boar leather helmet armor\",\r\n        description: \"Strong boar leather, ready to be used as a part of a helmet\",\r\n        component_type: \"helmet exterior\",\r\n        value: 400,\r\n        component_tier: 3,\r\n        full_armor_name: \"Boar leather helmet\",\r\n        defense_value: 3,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Bear leather helmet armor\"] = new ArmorComponent({\r\n        name: \"Bear leather helmet armor\",\r\n        description: \"Strong bear leather, ready to be used as a part of a helmet\",\r\n        component_type: \"helmet exterior\",\r\n        value: 600,\r\n        component_tier: 4,\r\n        full_armor_name: \"Bear leather helmet\",\r\n        defense_value: 4,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Alligator leather helmet armor\"] = new ArmorComponent({\r\n        name: \"Alligator leather helmet armor\",\r\n        description: \"Strong alligator leather, ready to be used as a part of a helmet\",\r\n        component_type: \"helmet exterior\",\r\n        value: 800,\r\n        component_tier: 5,\r\n        full_armor_name: \"Alligator helmet\",\r\n        defense_value: 8,\r\n        component_stats: {\r\n            cold_tolerance: {\r\n                flat: -.5,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Wolf leather chestplate armor\"] = new ArmorComponent({\r\n        id: \"Wolf leather chestplate armor\",\r\n        name: \"Wolf leather cuirass\",\r\n        description: \"Simple cuirass made of solid wolf leather, all it needs now is something softer to wear under it\",\r\n        component_type: \"chestplate exterior\",\r\n        value: 480,\r\n        component_tier: 2,\r\n        full_armor_name: \"Wolf leather armor\",\r\n        defense_value: 4,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Boar leather chestplate armor\"] = new ArmorComponent({\r\n        id: \"Boar leather chestplate armor\",\r\n        name: \"Boar leather cuirass\",\r\n        description: \"Strong cuirass made of boar leather\",\r\n        component_type: \"chestplate exterior\",\r\n        value: 800,\r\n        component_tier: 3,\r\n        full_armor_name: \"Boar leather armor\",\r\n        defense_value: 6,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Bear leather chestplate armor\"] = new ArmorComponent({\r\n        id: \"Bear leather chestplate armor\",\r\n        name: \"Bear leather cuirass\",\r\n        description: \"Strong cuirass made of bear leather\",\r\n        component_type: \"chestplate exterior\",\r\n        value: 1000,\r\n        component_tier: 4,\r\n        full_armor_name: \"Bear leather armor\",\r\n        defense_value: 8,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Alligator leather chestplate armor\"] = new ArmorComponent({\r\n        id: \"Alligator leather chestplate armor\",\r\n        name: \"Alligator leather cuirass\",\r\n        description: \"Strong cuirass made of alligator leather\",\r\n        component_type: \"chestplate exterior\",\r\n        value: 1600,\r\n        component_tier: 5,\r\n        full_armor_name: \"Alligator armor\",\r\n        defense_value: 16,\r\n        component_stats: {\r\n            cold_tolerance: {\r\n                flat: -.5,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Wolf leather greaves\"] = new ArmorComponent({\r\n        name: \"Wolf leather greaves\",\r\n        description: \"Greaves made of wolf leather. Just attach them onto some pants and you are ready to go\",\r\n        component_type: \"leg armor exterior\",\r\n        value: 240,\r\n        component_tier: 2,\r\n        full_armor_name: \"Wolf leather armored pants\",\r\n        defense_value: 2,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Boar leather greaves\"] = new ArmorComponent({\r\n        name: \"Boar leather greaves\",\r\n        description: \"Greaves made of thick boar leather. Just attach them onto some pants and you are ready to go\",\r\n        component_type: \"leg armor exterior\",\r\n        value: 400,\r\n        component_tier: 3,\r\n        full_armor_name: \"Boar leather armored pants\",\r\n        defense_value: 3,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Bear leather greaves\"] = new ArmorComponent({\r\n        name: \"Bear leather greaves\",\r\n        description: \"Greaves made of thick bear leather. Just attach them onto some pants and you are ready to go\",\r\n        component_type: \"leg armor exterior\",\r\n        value: 600,\r\n        component_tier: 4,\r\n        full_armor_name: \"Bear leather armored pants\",\r\n        defense_value: 4,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Alligator leather greaves\"] = new ArmorComponent({\r\n        name: \"Alligator leather greaves\",\r\n        description: \"Greaves made of alligator leather. Just attach them onto some pants and you are ready to go\",\r\n        component_type: \"leg armor exterior\",\r\n        value: 800,\r\n        component_tier: 5,\r\n        full_armor_name: \"Alligator armored pants\",\r\n        defense_value: 8,\r\n        component_stats: {\r\n            cold_tolerance: {\r\n                flat: -.5,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Wolf leather glove armor\"] = new ArmorComponent({\r\n        name: \"Wolf leather glove armor\",\r\n        description: \"Pieces of wolf leather shaped for gloves\",\r\n        component_type: \"glove exterior\",\r\n        value: 240,\r\n        component_tier: 2,\r\n        full_armor_name: \"Wolf leather gloves\",\r\n        defense_value: 2,\r\n    });\r\n    item_templates[\"Boar leather glove armor\"] = new ArmorComponent({\r\n        name: \"Boar leather glove armor\",\r\n        description: \"Pieces of boar leather shaped for gloves\",\r\n        component_type: \"glove exterior\",\r\n        value: 400,\r\n        component_tier: 3,\r\n        full_armor_name: \"Boar leather gloves\",\r\n        defense_value: 3,\r\n    });\r\n    item_templates[\"Bear leather glove armor\"] = new ArmorComponent({\r\n        name: \"Bear leather glove armor\",\r\n        description: \"Pieces of bear leather shaped for gloves\",\r\n        component_type: \"glove exterior\",\r\n        value: 600,\r\n        component_tier: 4,\r\n        full_armor_name: \"Bear leather gloves\",\r\n        defense_value: 4,\r\n    });\r\n    item_templates[\"Alligator leather glove armor\"] = new ArmorComponent({\r\n        name: \"Alligator leather glove armor\",\r\n        description: \"Pieces of alligator leather shaped for gloves\",\r\n        component_type: \"glove exterior\",\r\n        value: 800,\r\n        component_tier: 5,\r\n        full_armor_name: \"Alligator gloves\",\r\n        defense_value: 8,\r\n\t\tcomponent_stats: {\r\n            cold_tolerance: {\r\n                flat: -.5,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Wolf leather shoe armor\"] = new ArmorComponent({\r\n        name: \"Wolf leather shoe armor\",\r\n        description: \"Pieces of wolf leather shaped for shoes\",\r\n        component_type: \"shoes exterior\",\r\n        value: 240,\r\n        component_tier: 2,\r\n        full_armor_name: \"Wolf leather shoes\",\r\n        defense_value: 2,\r\n    });\r\n    item_templates[\"Boar leather shoe armor\"] = new ArmorComponent({\r\n        name: \"Boar leather shoe armor\",\r\n        description: \"Pieces of boar leather shaped for shoes\",\r\n        component_type: \"shoes exterior\",\r\n        value: 400,\r\n        component_tier: 3,\r\n        full_armor_name: \"Boar leather shoes\",\r\n        defense_value: 3,\r\n    });\r\n    item_templates[\"Bear leather shoe armor\"] = new ArmorComponent({\r\n        name: \"Bear leather shoe armor\",\r\n        description: \"Pieces of bear leather shaped for shoes\",\r\n        component_type: \"shoes exterior\",\r\n        value: 600,\r\n        component_tier: 4,\r\n        full_armor_name: \"Bear leather shoes\",\r\n        defense_value: 4,\r\n    });\r\n    item_templates[\"Alligator leather shoe armor\"] = new ArmorComponent({\r\n        name: \"Alligator leather shoe armor\",\r\n        description: \"Pieces of alligator leather shaped for shoes\",\r\n        component_type: \"shoes exterior\",\r\n        value: 800,\r\n        component_tier: 5,\r\n        full_armor_name: \"Alligator shoes\",\r\n        defense_value: 8,\r\n\t\tcomponent_stats: {\r\n            cold_tolerance: {\r\n                flat: -.5,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Iron chainmail helmet armor\"] = new ArmorComponent({\r\n        name: \"Iron chainmail helmet armor\",\r\n        description: \"Best way to keep your head in one piece\",\r\n        component_type: \"helmet exterior\",\r\n        value: 320,\r\n        component_tier: 2,\r\n        full_armor_name: \"Iron chainmail helmet\",\r\n        defense_value: 4,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.98,\r\n            },\r\n            agility: {\r\n                multiplier: 0.9,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Steel chainmail helmet armor\"] = new ArmorComponent({\r\n        name: \"Steel chainmail helmet armor\",\r\n        description: \"Best way to keep your head in one piece\",\r\n        component_type: \"helmet exterior\",\r\n        value: 480,\r\n        component_tier: 3,\r\n        full_armor_name: \"Steel chainmail helmet\",\r\n        defense_value: 6,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.98,\r\n            },\r\n            agility: {\r\n                multiplier: 0.9,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Turtleshell helmet armor\"] = new ArmorComponent({\r\n        name: \"Turtleshell helmet armor\",\r\n        description: \"Best way to keep your head in one piece\",\r\n        component_type: \"helmet exterior\",\r\n        value: 620,\r\n        component_tier: 5,\r\n        full_armor_name: \"Turtleshell platemail helmet\",\r\n        defense_value: 13,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.97,\r\n            },\r\n            agility: {\r\n                multiplier: 0.90,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Iron chainmail vest\"] = new ArmorComponent({\r\n        name: \"Iron chainmail vest\",\r\n        description: \"Basic iron chainmail. Nowhere near as strong as a plate armor\",\r\n        component_type: \"chestplate exterior\",\r\n        value: 640,\r\n        component_tier: 2,\r\n        full_armor_name: \"Iron chainmail armor\",\r\n        defense_value: 8,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.98,\r\n            },\r\n            agility: {\r\n                multiplier: 0.9,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Steel chainmail vest\"] = new ArmorComponent({\r\n        name: \"Steel chainmail vest\",\r\n        description: \"Basic steel chainmail. Nowhere near as strong as a plate armor\",\r\n        component_type: \"chestplate exterior\",\r\n        value: 960,\r\n        component_tier: 3,\r\n        full_armor_name: \"Steel chainmail armor\",\r\n        defense_value: 11,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.98,\r\n            },\r\n            agility: {\r\n                multiplier: 0.9,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Turtleshell chestplate\"] = new ArmorComponent({\r\n        name: \"Turtleshell chestplate\",\r\n        description: \"Basic turtle shellplate mail. Nowhere near as strong as a plate armor\",\r\n        component_type: \"chestplate exterior\",\r\n        value: 1220,\r\n        component_tier: 5,\r\n        full_armor_name: \"Turtleshell platemail armor\",\r\n        defense_value: 26,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.97,\r\n            },\r\n            agility: {\r\n                multiplier: 0.90,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Iron chainmail greaves\"] = new ArmorComponent({\r\n        name: \"Iron chainmail greaves\",\r\n        description: \"Greaves made of iron chainmail. Just attach them onto some pants and you are ready to go\",\r\n        component_type: \"leg armor exterior\",\r\n        value: 320,\r\n        component_tier: 2,\r\n        full_armor_name: \"Iron chainmail pants\",\r\n        defense_value: 4,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.98,\r\n            },\r\n            agility: {\r\n                multiplier: 0.9,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Steel chainmail greaves\"] = new ArmorComponent({\r\n        name: \"Steel chainmail greaves\",\r\n        description: \"Greaves made of steel chainmail. Just attach them onto some pants and you are ready to go\",\r\n        component_type: \"leg armor exterior\",\r\n        value: 480,\r\n        component_tier: 3,\r\n        full_armor_name: \"Steel chainmail pants\",\r\n        defense_value: 6,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.98,\r\n            },\r\n            agility: {\r\n                multiplier: 0.9,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Turtleshell greaves\"] = new ArmorComponent({\r\n        name: \"Turtleshell greaves\",\r\n        description: \"Greaves made of turtle shellplate. Just attach them onto some pants and you are ready to go\",\r\n        component_type: \"leg armor exterior\",\r\n        value: 620,\r\n        component_tier: 5,\r\n        full_armor_name: \"Turtleshell platemail pants\",\r\n        defense_value: 13,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.97,\r\n            },\r\n            agility: {\r\n                multiplier: 0.90,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Iron chainmail glove\"] = new ArmorComponent({\r\n        name: \"Iron chainmail glove\",\r\n        description: \"Iron chainmail in a form ready to be applied onto a glove\",\r\n        component_type: \"glove exterior\",\r\n        value: 320,\r\n        component_tier: 2,\r\n        full_armor_name: \"Iron chainmail gloves\",\r\n        defense_value: 4,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.98,\r\n            },\r\n            agility: {\r\n                multiplier: 0.9,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Steel chainmail glove\"] = new ArmorComponent({\r\n        name: \"Steel chainmail glove\",\r\n        description: \"Steel chainmail in a form ready to be applied onto a glove\",\r\n        component_type: \"glove exterior\",\r\n        value: 480,\r\n        component_tier: 3,\r\n        full_armor_name: \"Steel chainmail gloves\",\r\n        defense_value: 6,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.98,\r\n            },\r\n            agility: {\r\n                multiplier: 0.9,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Turtleshell glove\"] = new ArmorComponent({\r\n        name: \"Turtleshell glove\",\r\n        description: \"Turtle shellplate in a form ready to be applied onto a glove\",\r\n        component_type: \"glove exterior\",\r\n        value: 620,\r\n        component_tier: 5,\r\n        full_armor_name: \"Turtleshell platemail gloves\",\r\n        defense_value: 13,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.97,\r\n            },\r\n            agility: {\r\n                multiplier: 0.90,\r\n            }\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Iron chainmail shoes\"] = new ArmorComponent({\r\n        name: \"Iron chainmail shoes\",\r\n        description: \"Iron chainmail in a form ready to be applied onto a pair of shoes\",\r\n        component_type: \"shoes exterior\",\r\n        value: 320,\r\n        component_tier: 2,\r\n        full_armor_name: \"Iron chainmail boots\",\r\n        defense_value: 4,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 0.9,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Steel chainmail shoes\"] = new ArmorComponent({\r\n        name: \"Steel chainmail shoes\",\r\n        description: \"Steel chainmail in a form ready to be applied onto a pair of shoes\",\r\n        component_type: \"shoes exterior\",\r\n        value: 480,\r\n        component_tier: 3,\r\n        full_armor_name: \"Steel chainmail boots\",\r\n        defense_value: 6,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 0.9,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Turtleshell shoes\"] = new ArmorComponent({\r\n        name: \"Turtleshell shoes\",\r\n        description: \"Turtle shellplate in a form ready to be applied onto a pair of shoes\",\r\n        component_type: \"shoes exterior\",\r\n        value: 620,\r\n        component_tier: 5,\r\n        full_armor_name: \"Turtleshell platemail shoes\",\r\n        defense_value: 13,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.97,\r\n            },\r\n            agility: {\r\n                multiplier: 0.90,\r\n            }\r\n        }\r\n    });\r\n\t\r\n})();\r\n\r\n//clothing (functions both as weak armor and as an armor component) and capes:\r\n(function(){\r\n    item_templates[\"Cheap leather vest\"] = new Armor({\r\n        name: \"Cheap leather vest\",\r\n        description: \"Vest providing very low protection. Better not to know what's it made from\",\r\n        value: 100,\r\n        component_type: \"chestplate interior\",\r\n        base_defense: 2,\r\n        component_tier: 1,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.99,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Leather vest\"] = new Armor({\r\n        name: \"Leather vest\",\r\n        description: \"Comfortable leather vest, offering low protection\",\r\n        value: 300,\r\n        component_type: \"chestplate interior\",\r\n        base_defense: 2,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            cold_tolerance: {\r\n                flat: 1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Goat leather vest\"] = new Armor({\r\n        name: \"Goat leather vest\",\r\n        description: \"Comfortable leather vest, offering mediocre protection\",\r\n        value: 450,\r\n        component_type: \"chestplate interior\",\r\n        base_defense: 3,\r\n        component_tier: 3,\r\n        component_stats: {\r\n            cold_tolerance: {\r\n                flat: 1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Snakeskin vest\"] = new Armor({\r\n        name: \"Snakeskin vest\",\r\n        description: \"Comfortable snakeskin vest, offering decent protection\",\r\n        value: 900,\r\n        component_type: \"chestplate interior\",\r\n        base_defense: 7,\r\n        component_tier: 5,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.02,\r\n            },\r\n            agility: {\r\n                multiplier: 1.02,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -.5,\r\n            }\r\n        }\r\n    });\r\n\r\n    item_templates[\"Batrachian vest\"] = new Armor({\r\n        name: \"Batrachian vest\", \r\n        description: \"Comfortable leather vest, slippery enough to make enemy blows slide off\",\r\n        value: 700,\r\n        component_type: \"chestplate interior\",\r\n        base_defense: 3,\r\n        component_tier: 4,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 1.05,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 1,\r\n            }\r\n        },\r\n        component_bonus_skill_levels: {\r\n            \"Swimming\": 1,\r\n        }\r\n    });\r\n\r\n    item_templates[\"Cheap leather pants\"] = new Armor({\r\n        name: \"Cheap leather pants\",\r\n        description: \"Leather pants made from cheapest resources available\",\r\n        value: 100,\r\n        component_type: \"leg armor interior\",\r\n        base_defense: 1,\r\n        component_tier: 1,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.99,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Leather pants\"] = new Armor({\r\n        name: \"Leather pants\",\r\n        description: \"Solid leather pants\",\r\n        value: 300,\r\n        component_type: \"leg armor interior\",\r\n        base_defense: 2,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            cold_tolerance: {\r\n                flat: 2,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Goat leather pants\"] = new Armor({\r\n        name: \"Goat leather pants\",\r\n        description: \"Solid leather pants\",\r\n        value: 450,\r\n        component_type: \"leg armor interior\",\r\n        base_defense: 3,\r\n        component_tier: 3,\r\n        component_stats: {\r\n            cold_tolerance: {\r\n                flat: 2,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Snakeskin leggings\"] = new Armor({\r\n        name: \"Snakeskin leggings\",\r\n        description: \"Solid snakeskin leggings\",\r\n        value: 900,\r\n        component_type: \"leg armor interior\",\r\n        base_defense: 7,\r\n        component_tier: 5,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.01,\r\n            },\r\n            agility: {\r\n                multiplier: 1.01,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -.5,\r\n            }\r\n        }\r\n    });\r\n\r\n    item_templates[\"Batrachian pants\"] = new Armor({\r\n        name: \"Batrachian pants\", \r\n        description: \"Slippery leather pants\",\r\n        value: 700,\r\n        component_type: \"leg armor interior\",\r\n        base_defense: 3,\r\n        component_tier: 4,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 1.05,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 1,\r\n            }\r\n        },\r\n        component_bonus_skill_levels: {\r\n            \"Swimming\": 1,\r\n        }\r\n    });\r\n\r\n    item_templates[\"Cheap leather hat\"] = new Armor({\r\n        name: \"Cheap leather hat\",\r\n        description: \"A cheap leather hat to protect your head\",\r\n        value: 100,\r\n        component_type: \"helmet interior\",\r\n        base_defense: 1,\r\n        component_tier: 1,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.99,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Leather hat\"] = new Armor({\r\n        name: \"Leather hat\",\r\n        description: \"A nice leather hat to protect your head\",\r\n        value: 300,\r\n        component_type: \"helmet interior\",\r\n        base_defense: 2,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            cold_tolerance: {\r\n                flat: 1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Goat leather hat\"] = new Armor({\r\n        name: \"Goat leather hat\",\r\n        description: \"A solid leather hat to protect your head\",\r\n        value: 450,\r\n        component_type: \"helmet interior\",\r\n        base_defense: 3,\r\n        component_tier: 3,\r\n        component_stats: {\r\n            cold_tolerance: {\r\n                    flat: 1,\r\n            }\r\n        },\r\n    });\r\n    item_templates[\"Snakeskin hat\"] = new Armor({\r\n        name: \"Snakeskin hat\",\r\n        description: \"A solid snakeskin hat to protect your head\",\r\n        value: 900,\r\n        component_type: \"helmet interior\",\r\n        base_defense: 7,\r\n        component_tier: 5,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.02,\r\n            },\r\n            agility: {\r\n                multiplier: 1.02,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -.5,\r\n            }\r\n        }\r\n    });\r\n\r\n    item_templates[\"Batrachian hat\"] = new Armor({\r\n        name: \"Batrachian hat\", \r\n        description: \"A slippery leather hat to protect your head\",\r\n        value: 700,\r\n        component_type: \"helmet interior\",\r\n        base_defense: 3,\r\n        component_tier: 4,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 1.05,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 1,\r\n            }\r\n        },\r\n        component_bonus_skill_levels: {\r\n            \"Swimming\": 1,\r\n        }\r\n    });\r\n\r\n    item_templates[\"Leather gloves\"] = new Armor({\r\n        name: \"Leather gloves\",\r\n        description: \"Strong leather gloves, perfect for handling rough and sharp objects\",\r\n        value: 300,\r\n        component_type: \"glove interior\",\r\n        base_defense: 1,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            cold_tolerance: {\r\n                flat: 2,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Goat leather gloves\"] = new Armor({\r\n        name: \"Goat leather gloves\",\r\n        description: \"Strong leather gloves, perfect for handling rough and sharp objects\",\r\n        value: 450,\r\n        component_type: \"glove interior\",\r\n        base_defense: 2,\r\n        component_tier: 3,\r\n        component_stats: {\r\n            cold_tolerance: {\r\n                flat: 2,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Snakeskin gloves\"] = new Armor({\r\n        name: \"Snakeskin gloves\",\r\n        description: \"Strong snakeskin gloves, perfect for handling rough and sharp objects\",\r\n        value: 900,\r\n        component_type: \"glove interior\",\r\n        base_defense: 6,\r\n        component_tier: 5,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.01,\r\n            },\r\n            dexterity: {\r\n                multiplier: 1.01,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -.5,\r\n            }\r\n        }\r\n    });\r\n\r\n    item_templates[\"Batrachian gloves\"] = new Armor({\r\n        name: \"Batrachian gloves\", \r\n        description: \"Strong leather gloves, with membranes to help you swim\",\r\n        value: 700,\r\n        component_type: \"glove interior\",\r\n        base_defense: 2,\r\n        component_tier: 4,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 1.05,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 1,\r\n            }\r\n        },\r\n        component_bonus_skill_levels: {\r\n            \"Swimming\": 2,\r\n        }\r\n    });\r\n\r\n    item_templates[\"Cheap leather shoes\"] = new Armor({\r\n        name: \"Cheap leather shoes\",\r\n        description: \"Shoes made of thin and cheap leather. Even then, they are in every single aspect better than not having any\",\r\n        value: 100,\r\n        component_type: \"shoes interior\",\r\n        base_defense: 0,\r\n        component_tier: 1,\r\n        component_stats: {\r\n            agility: {\r\n                multiplier: 1.05,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 2,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Work shoes\"] = new Armor({\r\n        name: \"Work shoes\",\r\n        description: \"Work shoes made of a mix of leather and wool. While they provide no protection, they are very comfortable for moving around\",\r\n        value: 300,\r\n        component_type: \"shoes interior\",\r\n        base_defense: 0,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.02,\r\n            },\r\n            agility: {\r\n                multiplier: 1.15,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 2,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Leather shoes\"] = new Armor({\r\n        name: \"Leather shoes\",\r\n        description: \"Solid shoes made of leather, a must have for any traveler\",\r\n        value: 300,\r\n        component_type: \"shoes interior\",\r\n        base_defense: 1,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.02,\r\n            },\r\n            agility: {\r\n                multiplier: 1.1,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 2,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Goat leather shoes\"] = new Armor({\r\n        name: \"Goat leather shoes\",\r\n        description: \"Strong shoes made of leather, a must have for any traveler\",\r\n        value: 450,\r\n        component_type: \"shoes interior\",\r\n        base_defense: 2,\r\n        component_tier: 3,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.02,\r\n            },\r\n            agility: {\r\n                multiplier: 1.15,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 2,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Snakeskin boots\"] = new Armor({\r\n        name: \"Snakeskin boots\",\r\n        description: \"Strong boots made of snakeskin, a must have for any traveler\",\r\n        value: 900,\r\n        component_type: \"shoes interior\",\r\n        base_defense: 6,\r\n        component_tier: 5,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.05,\r\n            },\r\n            agility: {\r\n                multiplier: 1.25,\r\n            },\r\n            cold_tolerance: {\r\n                flat: -.5,\r\n            }\r\n        }\r\n    });\r\n\r\n    item_templates[\"Batrachian shoes\"] = new Armor({\r\n        name: \"Batrachian shoes\", \r\n        description: \"Strong shoes made of frog leather, that let you slide along the ground\",\r\n        value: 700,\r\n        component_type: \"shoes interior\",\r\n        base_defense: 2,\r\n        component_tier: 4,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.05,\r\n            },\r\n            agility: {\r\n                multiplier: 1.25,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 1,\r\n            }\r\n        },\r\n        component_bonus_skill_levels: {\r\n            \"Swimming\": 2,\r\n        }\r\n    });\r\n\r\n    item_templates[\"Wool shirt\"] = new Armor({\r\n        name: \"Wool shirt\",\r\n        description: \"It's not thick enough to provide any physical protection, but on the plus side it's light, it's warm, and it and doesn't block your moves\",\r\n        value: 300,\r\n        component_type: \"chestplate interior\",\r\n        base_defense: 0,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.01,\r\n            },\r\n            agility: {\r\n                multiplier: 1.02,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 3,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Linen vest\"] = new Armor({\r\n        name: \"Linen vest\",\r\n        description: \"A thin, breezy vest that won't get in your way, however it won't keep you warm and offers no protection from attacks\",\r\n        value: 650,\r\n        component_type: \"chestplate interior\",\r\n        base_defense: 0,\r\n        component_tier: 4,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.04,\r\n            },\r\n            agility: {\r\n                multiplier: 1.05,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 0.4,\r\n            }\r\n        }\r\n    });\r\n\r\n    item_templates[\"Wool pants\"] = new Armor({\r\n        name: \"Wool pants\",\r\n        description: \"Nice woollen pants. Slightly itchy\",\r\n        value: 100,\r\n        component_type: \"leg armor interior\",\r\n        base_defense: 0,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            cold_tolerance: {\r\n                flat: 3,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Linen leggings\"] = new Armor({\r\n        name: \"Linen leggings\",\r\n        description: \"Nice linen leggings\",\r\n        value: 450,\r\n        component_type: \"leg armor interior\",\r\n        base_defense: 0,\r\n        component_tier: 4,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.03,\r\n            },\r\n            agility: {\r\n                multiplier: 1.04,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 0.4,\r\n            }\r\n        }\r\n    });\r\n\r\n    item_templates[\"Wool hat\"] = new Armor({\r\n        name: \"Wool hat\",\r\n        description: \"Simple woollen hat to protect your head from cold\",\r\n        value: 300,\r\n        component_type: \"helmet interior\",\r\n        base_defense: 0,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.01,\r\n            },\r\n            agility: {\r\n                multiplier: 1.01,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 2,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Linen bandanna\"] = new Armor({\r\n        name: \"Linen bandanna\",\r\n        description: \"Simple linen bandanna to keep hair and sweat away from your eyes\",\r\n        value: 650,\r\n        component_type: \"helmet interior\",\r\n        base_defense: 0,\r\n        component_tier: 4,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.04,\r\n            },\r\n            agility: {\r\n                multiplier: 1.05,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 0.4,\r\n            }\r\n        }\r\n    });\r\n\r\n    item_templates[\"Wool gloves\"] = new Armor({\r\n        name: \"Wool gloves\",\r\n        description: \"Warm and comfy, but they don't provide any protection\",\r\n        value: 300,\r\n        component_type: \"glove interior\",\r\n        base_defense: 0,\r\n        component_tier: 2,\r\n        component_stats: {\r\n            cold_tolerance: {\r\n                flat: 3,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Linen gloves\"] = new Armor({\r\n        name: \"Linen gloves\",\r\n        description: \"Thin and tight, they help to maintain a grip on something, but they don't provide any protection\",\r\n        value: 650,\r\n        component_type: \"glove interior\",\r\n        base_defense: 0,\r\n        component_tier: 4,\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 1.03,\r\n            },\r\n            dexterity: {\r\n                multiplier: 1.03,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 0.4,\r\n            }\r\n        }\r\n    });\r\n\r\n    item_templates[\"Rat pelt cape\"] = new Cape({\r\n        name: \"Rat pelt cape\",\r\n        item_tier: 1,\r\n        description: \"It's a cape... made of wolf rat pelts. Only for poor or insane\",\r\n        value: 100,\r\n        base_stats: {\r\n            cold_tolerance: {\r\n                flat: 2,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Wolf pelt cape\"] = new Cape({\r\n        name: \"Wolf pelt cape\",\r\n        description: \"An elegant cape made from wolf pelts. Doesn't provide much protection, but is light enough to not hinder your movements\",\r\n        value: 400,\r\n        item_tier: 2,\r\n        base_defense: 2,\r\n        base_stats: {\r\n            cold_tolerance: {\r\n                flat: 4,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Boar hide cape\"] = new Cape({\r\n        name: \"Boar hide cape\",\r\n        description: \"A rough cape made from boar hides. Offers a nice protection, but is heavy and stiff\",\r\n        value: 700,\r\n        item_tier: 3,\r\n        base_defense: 5,\r\n        base_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.9,\r\n            },\r\n            agility: {\r\n                multiplier: 0.9,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 5,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Goat hide cape\"] = new Cape({\r\n        name: \"Goat hide cape\",\r\n        description: \"A rough cape made from goat hides\",\r\n        value: 700,\r\n        item_tier: 3,\r\n        base_defense: 3,\r\n        base_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.98,\r\n            },\r\n            agility: {\r\n                multiplier: 0.95,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 4,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Bear hide cape\"] = new Cape({\r\n        name: \"Bear hide cape\",\r\n        description: \"A thick, heavy, and warm furry cape, made from a bear hide\",\r\n        value: 1000,\r\n        item_tier: 4,\r\n        base_defense: 7,\r\n        base_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.95,\r\n            },\r\n            agility: {\r\n                multiplier: 0.95,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 7,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Batrachian cape\"] = new Cape({\r\n        name: \"Batrachian cape\", \r\n        description: \"A waterproof cape made from frogskin\",\r\n        value: 1000,\r\n        item_tier: 4,\r\n        base_defense: 4,\r\n        base_stats: {\r\n            agility: {\r\n                multiplier: 0.95,\r\n            },\r\n            cold_tolerance: {\r\n                flat: 4,\r\n            }\r\n        }\r\n    });\r\n})();\r\n\r\n//armors:\r\n(function(){\r\n    //predefined full (int+ext) armors go here\r\n    item_templates[\"Wolf leather armor\"] = new Armor({\r\n        components: {\r\n            internal: \"Leather vest\",\r\n            external: \"Wolf leather chestplate armor\",\r\n        }\r\n    });\r\n    item_templates[\"Wolf leather helmet\"] = new Armor({\r\n        components: {\r\n            internal: \"Leather hat\",\r\n            external: \"Wolf leather helmet armor\",\r\n        }\r\n    });\r\n    item_templates[\"Wolf leather armored pants\"] = new Armor({\r\n        components: {\r\n            internal: \"Leather pants\",\r\n            external: \"Wolf leather greaves\",\r\n        }\r\n    });\r\n\r\n    item_templates[\"Iron chainmail armor\"] = new Armor({\r\n        components: {\r\n            internal: \"Leather vest\",\r\n            external: \"Iron chainmail vest\",\r\n        }\r\n    });\r\n    item_templates[\"Iron chainmail helmet\"] = new Armor({\r\n        components: {\r\n            internal: \"Leather hat\",\r\n            external: \"Iron chainmail helmet armor\",\r\n        }\r\n    });\r\n    item_templates[\"Iron chainmail pants\"] = new Armor({\r\n        components: {\r\n            internal: \"Leather pants\",\r\n            external: \"Iron chainmail greaves\",\r\n        }\r\n    });\r\n\r\n    item_templates[\"Steel chainmail armor\"] = new Armor({\r\n        components: {\r\n            internal: \"Goat leather vest\",\r\n            external: \"Steel chainmail vest\",\r\n        }\r\n    });\r\n    item_templates[\"Steel chainmail helmet\"] = new Armor({\r\n        components: {\r\n            internal: \"Goat leather hat\",\r\n            external: \"Steel chainmail helmet armor\",\r\n        }\r\n    });\r\n    item_templates[\"Steel chainmail pants\"] = new Armor({\r\n        components: {\r\n            internal: \"Goat leather pants\",\r\n            external: \"Steel chainmail greaves\",\r\n        }\r\n    });\r\n\t\r\n\titem_templates[\"Alligator armor\"] = new Armor({\r\n        components: {\r\n            internal: \"Linen vest\",\r\n            external: \"Alligator leather chestplate armor\",\r\n        }\r\n    });\r\n    item_templates[\"Alligator helmet\"] = new Armor({\r\n        components: {\r\n            internal: \"Linen bandanna\",\r\n            external: \"Alligator leather helmet armor\",\r\n        }\r\n    });\r\n    item_templates[\"Alligator armored pants\"] = new Armor({\r\n        components: {\r\n            internal: \"Linen leggings\",\r\n            external: \"Alligator leather greaves\",\r\n        }\r\n    });\t\r\n\t\r\n\titem_templates[\"Turtleshell platemail armor\"] = new Armor({\r\n        components: {\r\n            internal: \"Linen vest\",\r\n            external: \"Turtleshell chestplate\",\r\n        }\r\n    });\r\n    item_templates[\"Turtleshell platemail helmet\"] = new Armor({\r\n        components: {\r\n            internal: \"Linen bandanna\",\r\n            external: \"Turtleshell helmet armor\",\r\n        }\r\n    });\r\n    item_templates[\"Turtleshell platemail pants\"] = new Armor({\r\n        components: {\r\n            internal: \"Linen leggings\",\r\n            external: \"Turtleshell greaves\",\r\n        }\r\n    });\r\n\t\r\n})();\r\n\r\n//shield components:\r\n(function(){\r\n\r\n    item_templates[\"Wooden training shield base\"] = new ShieldComponent({\r\n        name: \"Wooden training shield base\",\r\n        description: \"A primitive but cheap form of a shield\",\r\n        value: 16,\r\n        tags: {\"ignore_skill\": true},\r\n        shield_strength: 0.5,\r\n        shield_name: \"Wooden training shield\",\r\n        component_tier: 1,\r\n        component_type: \"shield base\",\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n\r\n    item_templates[\"Cheap wooden shield base\"] = new ShieldComponent({\r\n        name: \"Cheap wooden shield base\",\r\n        description: \"Cheap shield component made of wood, basically just a few planks barely holding together\",\r\n        value: 16,\r\n        shield_strength: 1,\r\n        shield_name: \"Cheap wooden shield\",\r\n        component_tier: 1,\r\n        component_type: \"shield base\",\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n\r\n    item_templates[\"Crude wooden shield base\"] = new ShieldComponent({\r\n        name: \"Crude wooden shield base\",\r\n        description: \"A shield base of rather bad quality, but at least it won't fall apart by itself\",\r\n        value: 32,\r\n        shield_strength: 3,\r\n        shield_name: \"Crude wooden shield\",\r\n        component_tier: 1,\r\n        component_type: \"shield base\",\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Wooden shield base\"] = new ShieldComponent({\r\n        name: \"Wooden shield base\",\r\n        description: \"Proper wooden shield base, although it could use some additional reinforcement\",\r\n        value: 80,\r\n        shield_strength: 5,\r\n        shield_name: \"Wooden shield\",\r\n        component_tier: 2,\r\n        component_type: \"shield base\",\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Ash wood shield base\"] = new ShieldComponent({\r\n        name: \"Ash wood shield base\",\r\n        description: \"Solid wooden shield base, although still nowhere near as resistant as metal\",\r\n        value: 120,\r\n        shield_strength: 8,\r\n        shield_name: \"Ash wood shield\",\r\n        component_tier: 3,\r\n        component_type: \"shield base\",\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.95,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Crude iron shield base\"] = new ShieldComponent({\r\n        name: \"Crude iron shield base\",\r\n        description: \"Heavy shield base made of low quality iron\",\r\n        value: 128,\r\n        shield_strength: 6,\r\n        shield_name: \"Crude iron shield\",\r\n        component_tier: 1,\r\n        component_type: \"shield base\",\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.75,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Iron shield base\"] = new ShieldComponent({\r\n        name: \"Iron shield base\",\r\n        description: \"Solid and strong shield base, although it's quite heavy\",\r\n        value: 210,\r\n        shield_strength: 10,\r\n        shield_name: \"Iron shield\",\r\n        component_tier: 2,\r\n        component_type: \"shield base\",\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.8,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Steel shield base\"] = new ShieldComponent({\r\n        name: \"Steel shield base\",\r\n        description: \"Mighty shield base, although it's quite heavy\",\r\n        value: 300,\r\n        shield_strength: 14,\r\n        shield_name: \"Steel shield\",\r\n        component_tier: 3,\r\n        component_type: \"shield base\",\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.85, //don't make speed penalty for heavy shields weaker than this\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Turtleshell shield base\"] = new ShieldComponent({\r\n        name: \"Turtleshell shield base\",\r\n        description: \"Dense turtle shellplate base, although it's quite heavy\",\r\n        value: 650,\r\n        shield_strength: 24,\r\n        shield_name: \"Turtleshell shield\",\r\n        component_tier: 5,\r\n        component_type: \"shield base\",\r\n        component_stats: {\r\n            attack_speed: {\r\n                multiplier: 0.75,\r\n            }\r\n        }\r\n    });\r\n\r\n    item_templates[\"Basic shield handle\"] = new ShieldComponent({\r\n        id: \"Basic shield handle\",\r\n        name: \"Crude wooden shield handle\",\r\n        description: \"A simple handle for holding the shield\",\r\n        value: 10,\r\n        component_tier: 1,\r\n        component_type: \"shield handle\",\r\n    });\r\n\r\n    item_templates[\"Wooden shield handle\"] = new ShieldComponent({\r\n        name: \"Wooden shield handle\",\r\n        description: \"A decent wooden handle for holding the shield\",\r\n        value: 32,\r\n        component_tier: 2,\r\n        component_type: \"shield handle\",\r\n        component_stats: {\r\n            block_strength: {\r\n                multiplier: 1.1,\r\n            }\r\n        }\r\n    });\r\n    item_templates[\"Ash wood shield handle\"] = new ShieldComponent({\r\n        name: \"Ash wood shield handle\",\r\n        description: \"A solid wooden handle for holding the shield\",\r\n        value: 48,\r\n        component_tier: 3,\r\n        component_type: \"shield handle\",\r\n        component_stats: {\r\n            block_strength: {\r\n                multiplier: 1.2,\r\n            }\r\n        }\r\n    });\r\n\r\n})();\r\n\r\n//shields:\r\n(function(){\r\n    item_templates[\"Wooden training shield\"] = new Shield({\r\n        components: {\r\n            shield_base: \"Wooden training shield base\",\r\n            handle: \"Basic shield handle\",\r\n        }\r\n    });\r\n\r\n    item_templates[\"Cheap wooden shield\"] = new Shield({\r\n        components: {\r\n            shield_base: \"Cheap wooden shield base\",\r\n            handle: \"Basic shield handle\",\r\n        }\r\n    });\r\n\r\n    item_templates[\"Crude wooden shield\"] = new Shield({\r\n        components: {\r\n            shield_base: \"Crude wooden shield base\",\r\n            handle: \"Basic shield handle\",\r\n        }\r\n    });\r\n\r\n    item_templates[\"Wooden shield\"] = new Shield({\r\n        components: {\r\n            shield_base: \"Wooden shield base\",\r\n            handle: \"Wooden shield handle\",\r\n        }\r\n    });\r\n    item_templates[\"Ash wood shield\"] = new Shield({\r\n        components: {\r\n            shield_base: \"Ash wood shield base\",\r\n            handle: \"Ash wood shield handle\",\r\n        }\r\n    });\r\n\r\n    item_templates[\"Crude iron shield\"] = new Shield({\r\n        components: {\r\n            shield_base: \"Crude iron shield base\",\r\n            handle: \"Basic shield handle\",\r\n        }\r\n    });\r\n\r\n    item_templates[\"Iron shield\"] = new Shield({\r\n        components: {\r\n            shield_base: \"Iron shield base\",\r\n            handle: \"Wooden shield handle\",\r\n        }\r\n    });\r\n\r\n    item_templates[\"Steel shield\"] = new Shield({\r\n        components: {\r\n            shield_base: \"Steel shield base\",\r\n            handle: \"Ash wood shield handle\",\r\n        }\r\n    });\r\n\t\r\n    item_templates[\"Turtleshell shield\"] = new Shield({\r\n        components: {\r\n            shield_base: \"Turtleshell shield base\",\r\n            handle: \"Ash wood shield handle\",\r\n        }\r\n    });\r\n\t\r\n})();\r\n\r\n//trinkets:\r\n(function(){\r\n    item_templates[\"Wolf trophy\"] = new Artifact({\r\n        name: \"Wolf trophy\",\r\n        value: 100,\r\n        stats: {\r\n            armor_penetration: {\r\n                flat: 50,\r\n            },\r\n            crit_rate: {\r\n                flat: 0.02,\r\n            },\r\n        }\r\n    });\r\n\r\n    item_templates[\"Boar trophy\"] = new Artifact({\r\n        name: \"Boar trophy\",\r\n        value: 160,\r\n        stats: {\r\n            attack_power: {\r\n                multiplier: 1.1,\r\n            },\r\n            crit_multiplier: {\r\n                flat: 0.2,\r\n            },\r\n        }\r\n    });\r\n\r\n    item_templates[\"Mountain goat trophy\"] = new Artifact({\r\n        name: \"Mountain goat trophy\",\r\n        value: 250,\r\n        stats: {\r\n            attack_power: {\r\n                multiplier: 1.05,\r\n            },\r\n            defense: {\r\n                flat: 5,\r\n                multiplier: 1.05,\r\n            },\r\n        }\r\n    });\r\n\r\n    item_templates[\"Bear trophy\"] = new Artifact({\r\n        name: \"Bear trophy\",\r\n        value: 400,\r\n        stats: {\r\n            attack_power: {\r\n                multiplier: 1.3,\r\n            },\r\n            attack_speed: {\r\n                multiplier: 0.9,\r\n            },\r\n        }\r\n    });\r\n\r\n    item_templates[\"Crab trophy\"] = new Artifact({\r\n        name: \"Crab trophy\",\r\n        value: 650,\r\n        stats: {\r\n            attack_points: {\r\n                multiplier: 1.15,\r\n            },\r\n            defense: {\r\n                multiplier: 1.15,\r\n            },\r\n        }\r\n    });\r\n\t\r\n})();\r\n\r\n//amulets:\r\n(function(){\r\n    item_templates[\"Warrior's necklace\"] = new Amulet({\r\n        value: 1000,\r\n        tags: {unique: true},\r\n        stats: {\r\n            attack_power: {\r\n                multiplier: 1.1,\r\n            },\r\n            attack_speed: {\r\n                multiplier: 1.1,\r\n            },\r\n        },\r\n    });\r\n})();\r\n\r\n\r\n//rings:\r\n(function(){\r\n    item_templates[\"Snake fang ring\"] = new Ring({\r\n        value: 2000,\r\n        tags: {unique: true},\r\n        stats: {\r\n            crit_multiplier: {\r\n                multiplier: 1.3,\r\n            },\r\n            crit_rate: {\r\n                multiplier: 1.2,\r\n            },\r\n            unarmed_power: {\r\n                flat: 1,\r\n            },\r\n        },\r\n    });\r\n})();\r\n\r\n//tools:\r\n(function(){\r\n    item_templates[\"Old pickaxe\"] = new Tool({\r\n        name: \"Old pickaxe\",\r\n        description: \"An old pickaxe that has seen better times, but is still usable\",\r\n        value: 10,\r\n        equip_slot: \"pickaxe\",\r\n    });\r\n\r\n    item_templates[\"Old axe\"] = new Tool({\r\n        name: \"Old axe\",\r\n        description: \"An old axe that has seen better times, but is still usable\",\r\n        value: 10,\r\n        equip_slot: \"axe\",\r\n    });\r\n\r\n    item_templates[\"Old sickle\"] = new Tool({\r\n        name: \"Old sickle\",\r\n        description: \"And old herb sickle that has seen better times, but is still usable\",\r\n        value: 10,\r\n        equip_slot: \"sickle\",\r\n    });\r\n\r\n    item_templates[\"Old shovel\"] = new Tool({\r\n        name: \"Old shovel\",\r\n        description: \"And old shovel that has seen better times, but can still be used to dig something up\",\r\n        value: 10,\r\n        equip_slot: \"shovel\",\r\n    });\r\n\r\n    item_templates[\"Iron pickaxe\"] = new Tool({\r\n        name: \"Iron pickaxe\",\r\n        description: \"A decent pickaxe made of iron, strong enough for most ores\",\r\n        value: 1000,\r\n        equip_slot: \"pickaxe\",\r\n        base_bonus_skill_levels: {\r\n            \"Mining\": 3,\r\n        }\r\n    });\r\n\r\n    item_templates[\"Iron chopping axe\"] = new Tool({\r\n        name: \"Iron chopping axe\",\r\n        description: \"A decent axe made of iron, hard and sharp enough for most of trees, even if they will still require an effort\",\r\n        value: 1000,\r\n        equip_slot: \"axe\",\r\n        base_bonus_skill_levels: {\r\n            \"Woodcutting\": 3,\r\n        }\r\n    });\r\n\r\n    item_templates[\"Iron sickle\"] = new Tool({\r\n        name: \"Iron sickle\",\r\n        description: \"A decent sickle made of iron, sharp enough for most of plants\",\r\n        value: 1000,\r\n        equip_slot: \"sickle\",\r\n        base_bonus_skill_levels: {\r\n            \"Herbalism\": 3,\r\n        }\r\n    });\r\n\r\n    item_templates[\"Iron shovel\"] = new Tool({\r\n        name: \"Iron shovel\",\r\n        description: \"A decent shovel made of iron, solid enough for most of your digging needs\",\r\n        value: 1000,\r\n        equip_slot: \"shovel\",\r\n        base_bonus_skill_levels: {\r\n            \"Digging\": 3,\r\n        }\r\n    });\r\n\r\n    item_templates[\"Makeshift fishing pole\"] = new Tool({\r\n        name: \"Makeshift fishing pole\",\r\n        description: \"Little more than a piece of string tied to a stick, but sufficient to get a catch\",\r\n        value: 10,\r\n        equip_slot: \"fishing_pole\",\r\n    });\r\n})();\r\n\r\n//usables:\r\n(function(){\r\n    item_templates[\"Stale bread\"] = new UsableItem({\r\n        name: \"Stale bread\", description: \"Big piece of an old bread, still edible\",\r\n        value: 20,\r\n        effects: [{effect: \"Basic meal\", duration: 60}],\r\n        tags: {\"food\": true},\r\n        material_type: \"bread\",\r\n    });\r\n\r\n    item_templates[\"Fresh bread\"] = new UsableItem({\r\n        name: \"Fresh bread\",\r\n        description: \"Freshly baked bread, delicious\",\r\n        value: 40,\r\n        effects: [{effect: \"Basic meal\", duration: 150}],\r\n        tags: {\"food\": true},\r\n        material_type: \"bread\",\r\n    });\r\n\r\n    item_templates[\"Bread kwas\"] = new UsableItem({\r\n        name: \"Bread kwas\",\r\n        description: \"Tastes like bread\",\r\n        value: 40,\r\n        effects: [{effect: \"Well hydrated\", duration: 60}],\r\n        recovery_chances: {\"Glass bottle\": 0.6},\r\n        tags: {\"drink\": true},\r\n    });\r\n\r\n    item_templates[\"Carrot\"] = new UsableItem({\r\n        name: \"Carrot\", description: \"A delicious root that can be eaten raw\",\r\n        value: 20,\r\n        effects: [{effect: \"Basic meal\", duration: 10}],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    item_templates[\"Cooked carrot\"] = new UsableItem({\r\n        name: \"Cooked carrot\", description: \"A delicious root, cooked\",\r\n        value: 30,\r\n        effects: [{effect: \"Basic meal\", duration: 150}],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    item_templates[\"Potato\"] = new UsableItem({\r\n        name: \"Potato\", description: \"A common tuber with versatile culinary usage. Just remember to cook it first!\",\r\n        value: 15,\r\n        effects: [{effect: \"Slight food poisoning\", duration: 20}],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    item_templates[\"Cooked potato\"] = new UsableItem({\r\n        name: \"Potato\", description: \"A common tuber with versatile culinary usage, though this one was simply cooked\",\r\n        value: 40,\r\n        effects: [{effect: \"Basic meal\", duration: 150}],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    //supposed to be obtained by making clam broth, but multiple results from a recipe are not yet supported\r\n    item_templates[\"Cooked clam\"] = new UsableItem({\r\n        name: \"Boiled clam\",\r\n        description: \"Common shellfish found around the lake shore that has been boiled, not steamed\",\r\n        value: 6,\r\n        effects: [{effect: \"Basic meal\", duration: 90}],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    item_templates[\"Weak healing powder\"] = new UsableItem({\r\n        name: \"Weak healing powder\",\r\n        description: \"Not very potent, but can still make body heal noticeably faster for quite a while\",\r\n        value: 40,\r\n        effects: [{effect: \"Weak healing powder\", duration: 240}],\r\n        tags: {\"medicine\": true},\r\n    });\r\n\r\n    item_templates[\"Healing powder\"] = new UsableItem({\r\n        name: \"Healing powder\",\r\n        description: \"Not exactly powerful in its effects, but still makes the body heal noticeably faster and for a long time\",\r\n        value: 100,\r\n        effects: [{effect: \"Healing powder\", duration: 300}],\r\n        tags: {\"medicine\": true},\r\n    });\r\n\r\n    item_templates[\"Oneberry juice\"] = new UsableItem({\r\n        name: \"Oneberry juice\",\r\n        description: \"Tastes kinda nice and provides a quick burst of healing\",\r\n        value: 80,\r\n        effects: [{effect: \"Weak healing potion\", duration: 10}],\r\n        recovery_chances: {\"Glass phial\": 0.75},\r\n        tags: {\"medicine\": true},\r\n    });\r\n    item_templates[\"Healing potion\"] = new UsableItem({\r\n        name: \"Healing potion\",\r\n        description: \"Tastes nice at first but has a bitter aftertaste. Provides a quick burst of healing\",\r\n        value: 200,\r\n        effects: [{effect: \"Healing potion\", duration: 10}],\r\n        recovery_chances: {\"Glass phial\": 0.75},\r\n        tags: {\"medicine\": true},\r\n    });\r\n    item_templates[\"Healing balm\"] = new UsableItem({\r\n        name: \"Healing balm\",\r\n        description: \"Simply apply it to your wound and watch it heal\",\r\n        value: 120,\r\n        effects: [{effect: \"Weak healing balm\", duration: 90}],\r\n        tags: {\"medicine\": true},\r\n    });\r\n\r\n    item_templates[\"Roasted rat meat\"] = new UsableItem({\r\n        name: \"Roasted rat meat\",\r\n        description: \"Smell might be fine now, but it still seems like a bad idea to eat it\",\r\n        value: 10,\r\n        effects: [{effect: \"Cheap meat meal\", duration: 45}, {effect: \"Slight food poisoning\", duration: 45}],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    item_templates[\"Roasted purified rat meat\"] = new UsableItem({\r\n        name: \"Roasted purified rat meat\",\r\n        description: \"Smells alright and should be safe to eat, yet you still have some doubts\",\r\n        value: 20,\r\n        effects: [{effect: \"Cheap meat meal\", duration: 45}],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    item_templates[\"Fried pork\"] = new UsableItem({\r\n        name: \"Fried pork\",\r\n        description: \"It's dripping with fat and smells fantastic, all it lacks is some spices and a good side dish\",\r\n        value: 40,\r\n        effects: [{effect: \"Simple meat meal\", duration: 90}],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    item_templates[\"Fried goat meat\"] = new UsableItem({\r\n        name: \"Fried goat meat\",\r\n        description: \"It has a nice aroma, but is a bit too tough. Perhaps a stew would have been a better choice?\",\r\n        value: 40,\r\n        effects: [{effect: \"Simple meat meal\", duration: 90}],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    item_templates[\"Pork roast\"] = new UsableItem({\r\n        name: \"Pork roast\",\r\n        description: \"A generous amount of herbs has been rubbed into the meat, resulting in a hearty meal with a mouthwatering aroma\",\r\n        value: 100,\r\n        effects: [{effect: \"Decent meat meal\", duration: 120}],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    item_templates[\"Goat stew\"] = new UsableItem({\r\n        name: \"Goat stew\",\r\n        description: \"Goat meat boiled to tenderness in a herbal broth. Perfect to warm yourself up for the road\",\r\n        value: 100,\r\n        effects: [{ effect: \"Decent meat meal\", duration: 120 },\r\n                  { effect: \"Hot meal\", duration: 60 }],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    item_templates[\"Crab bisque\"] = new UsableItem({\r\n        name: \"Crab bisque\",\r\n        description: \"A smooth, creamy crab soup, lightly seasoned with fragrant herbs and vegetables\",\r\n        value: 100,\r\n        effects: [{ effect: \"Simple seafood soup\", duration: 120 },\r\n                  { effect: \"Hot meal\", duration: 30 }],\r\n        tags: {\"food\": true},\r\n    });\r\n    item_templates[\"Clam broth\"] = new UsableItem({\r\n        name: \"Clam broth\",\r\n        description: \"Briny, flavorful, and tastes of the ocean. In a good way\",\r\n        value: 100,\r\n        effects: [{ effect: \"Simple seafood soup\", duration: 90 },\r\n                  { effect: \"Hot meal\", duration: 30 }],\r\n        tags: {\"food\": true},\r\n    });\r\n    item_templates[\"Alligator jerky\"] = new UsableItem({\r\n        name: \"Alligator jerky\",\r\n        description: \"It's tough meat, but it'll keep you from going hungry for a long time\",\r\n        value: 100,\r\n        effects: [{ effect: \"Tough meat meal\", duration: 300 }],\r\n        tags: {\"food\": true},\r\n    });\r\n    item_templates[\"Snake jerky\"] = new UsableItem({\r\n        name: \"Snake jerky\",\r\n        description: \"It's rubbery meat, but it'll keep you from going hungry for a long time\",\r\n        value: 100,\r\n        effects: [{ effect: \"Tough meat meal\", duration: 300 }],\r\n        tags: {\"food\": true},\r\n    });\r\n    item_templates[\"Turtle jerky\"] = new UsableItem({\r\n        name: \"Turtle jerky\",\r\n        description: \"It's stringy meat, but it'll still keep you from going hungry for a long time\",\r\n        value: 100,\r\n        effects: [{ effect: \"Tough meat meal\", duration: 300 }],\r\n        tags: {\"food\": true},\r\n    });\r\n    item_templates[\"Turtle soup\"] = new UsableItem({\r\n        name: \"Turtle soup\",\r\n        description: \"Tonight you dine on turtle soup\",     //reference to a line said by Shredder in the old Teenaged Mutant Ninja Turtles cartoon\r\n        value: 100,\r\n        effects: [{ effect: \"Simple seafood soup\", duration: 120 },\r\n                  { effect: \"Hot meal\", duration: 45 }],\r\n        tags: {\"food\": true},\r\n    });\r\n    item_templates[\"Swampland skewer\"] = new UsableItem({\r\n        name: \"Swampland skewer\",\r\n        description: \"There's no better way to feed on the creatures of the swampland\",\r\n        value: 100,\r\n        effects: [{ effect: \"Varied meat meal\", duration: 150 },\r\n                  { effect: \"Hot meal\", duration: 60 }],\r\n        tags: {\"food\": true},\r\n    });\r\n    item_templates[\"Basin gumbo\"] = new UsableItem({\r\n        name: \"Basin gumbo\",\r\n        description: \"An incredibly complex meal that's difficult to make, but it's got an indescribable taste\",\r\n        value: 100,\r\n        effects: [{ effect: \"Varied seafood meal\", duration: 90 }],\r\n        tags: {\"food\": true},\r\n    });\r\n\t\r\n    //TODO made them tier 2 and 3 for now, but are hard enough to get that they could be bumped to tier 4?\r\n    item_templates[\"Fried frog meat\"] = new UsableItem({\r\n        name: \"Fried frog meat\",\r\n        description: \"Tastes a bit like bird, and a bit like fish\",\r\n        value: 50,\r\n        effects: [{effect: \"Simple meat meal\", duration: 120}],\r\n        tags: {\"food\": true},\r\n    });\r\n    item_templates[\"Kingsized frog legs\"] = new UsableItem({\r\n        name: \"Kingsized frog legs\",\r\n        description: \"The legs are agreed to be the best part, and when cooked with proper seasoning, considered a delicacy by some\",\r\n        value: 100,\r\n        effects: [{effect: \"Decent meat meal\", duration: 120}],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    item_templates[\"Fish skewer\"] = new UsableItem({\r\n        name: \"Fish skewer\", \r\n        description: \"Several small fish cooked together on a stick. While none of them have much meat on them individually, together they make for a servicable meal\",\r\n        value: 20,\r\n        effects: [{effect: \"Cheap meat meal\", duration: 45}],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    item_templates[\"Fried fish\"] = new UsableItem({\r\n        name: \"Fried fish\",\r\n        description: \"A fish fried whole. A simple but fulfilling meal\",\r\n        value: 40,\r\n        effects: [{effect: \"Simple meat meal\", duration: 60}],\r\n        tags: {\"food\": true},\r\n    });\r\n\r\n    item_templates[\"Fish steak\"] = new UsableItem({\r\n        name: \"Fish steak\",\r\n        description: \"Properly filleted and cooked. A much better experience than eating them whole\",\r\n        value: 60,\r\n        effects: [{effect: \"Decent meat meal\", duration: 60}],\r\n        tags: {\"food\": true},\r\n    });\r\n})();\r\n\r\n//setup ids\r\nObject.keys(item_templates).forEach(id => {\r\n    item_templates[id].id = id;\r\n    if(!item_templates[id].getName()) {\r\n        item_templates[id].name = id;\r\n    }\r\n});\r\n\r\nexport {\r\n    item_templates,\r\n    Item, OtherItem, UsableItem,\r\n    Armor, Shield, Weapon, Cape, Artifact, Book,\r\n    Material, WeaponComponent, ArmorComponent, ShieldComponent,\r\n    getItem, getItemFromKey,\r\n    round_item_price, getArmorSlot, getEquipmentValue,\r\n    book_stats, BookData,\r\n    rarity_multipliers,\r\n    getItemRarity\r\n};", "\"use strict\";\r\nimport { get_total_skill_level } from \"./character.js\";\r\nimport { skills } from \"./skills.js\";\r\nconst stances = {};\r\n\r\nclass Stance {\r\n    constructor(\r\n            {\r\n                name,\r\n                id,\r\n                related_skill,\r\n                target_count = 1,\r\n                randomize_target_count = false,\r\n                is_unlocked = false,\r\n                stat_multipliers = {},\r\n                stamina_cost = 1,\r\n                description = \"\"\r\n            }\r\n        ) {\r\n            \r\n        if(related_skill && !skills[related_skill]) {\r\n            throw(`Tried to attach skill \"${related_skill}\" to stance \"${name}\", but such a skill doesnt exist!`);\r\n        }\r\n\r\n        this.name = name;\r\n        this.id = id;\r\n        this.related_skill = related_skill;\r\n        this.description = description;\r\n        if(this.target_count < 1) {\r\n            throw(\"Combat stance cannot target less than 1 enemy!\");\r\n        }  \r\n        this.target_count = target_count;\r\n        this.randomize_target_count = randomize_target_count; //if true, the actual target count is a random number in range [1, target_count]\r\n        this.is_unlocked = is_unlocked;\r\n        this.stat_multipliers = stat_multipliers;\r\n        this.stamina_cost = stamina_cost;\r\n    }\r\n\r\n    getDescription = function(){\r\n        if(this.description) {\r\n            return this.description;\r\n        } else if(this.related_skill) {\r\n            return skills[this.related_skill].description;\r\n        }\r\n    }\r\n\r\n    getStats = function() {\r\n        if(!this.related_skill) {\r\n            //no skill, nothing to scale stats with\r\n            return this.stat_multipliers;\r\n        } else {\r\n            const multipliers = {};\r\n            Object.keys(this.stat_multipliers).forEach(stat => {\r\n                if(this.stat_multipliers[stat] < 1) {\r\n                    multipliers[stat] = this.stat_multipliers[stat] + (1 - this.stat_multipliers[stat]) * get_total_skill_level(this.related_skill)/(2*skills[this.related_skill].max_level);\r\n                    //div by 2 because penalties don't get fully nullified, only cut in half (e.g. x0.2->x0.6)\r\n                }\r\n                else {\r\n                    multipliers[stat] =  this.stat_multipliers[stat] + (this.stat_multipliers[stat]-1) * get_total_skill_level(this.related_skill)/skills[this.related_skill].max_level;\r\n                }\r\n            });\r\n            return multipliers;\r\n        }\r\n    }\r\n}\r\n\r\nstances[\"normal\"] = new Stance({\r\n    name: \"Normal Stance\",\r\n    id: \"normal\",\r\n    is_unlocked: true,\r\n    description: \"A normal and basic stance. It doesn't excell in anything, but also doesn't suffer any major flaws and is energy efficient.\",\r\n    stat_multipliers: {}\r\n})\r\n\r\nstances[\"quick\"] = new Stance({\r\n    name: \"Quick Steps\",\r\n    id: \"quick\",\r\n    related_skill: \"Quick steps\",\r\n    description: \"A swift and precise technique that abandons strength in favor of greater speed\",\r\n    stat_multipliers: {\r\n        attack_power: 0.8,\r\n        attack_speed: 1.2\r\n    },\r\n    stamina_cost: 2,\r\n});\r\n\r\nstances[\"heavy\"] = new Stance({\r\n    name: \"Crushing Force\",\r\n    id: \"heavy\",\r\n    related_skill: \"Heavy strike\",\r\n    stat_multipliers: {\r\n        //attack multis are stronger than they appear since enemies have defense stat\r\n        attack_power: 1.2,\r\n        attack_speed: 0.8\r\n    },\r\n    stamina_cost: 2,\r\n});\r\n\r\nstances[\"defensive\"] = new Stance({\r\n    name: \"Defensive Measures\",\r\n    id: \"defensive\",\r\n    related_skill: \"Defensive measures\",\r\n    stat_multipliers: {\r\n        attack_power: 0.8,\r\n        attack_speed: 0.8,\r\n        evasion_points: 1.2,\r\n        block_strength: 1.1,\r\n    },\r\n    target_count: 1,\r\n    stamina_cost: 2,\r\n});\r\n\r\nstances[\"wide\"] = new Stance({\r\n    name: \"Broad Arc\",\r\n    id: \"wide\",\r\n    related_skill: \"Wide swing\",\r\n    stat_multipliers: {\r\n        attack_power: 0.4,\r\n        attack_speed: 0.8,\r\n    },\r\n    target_count: 4,\r\n    stamina_cost: 4,\r\n});\r\n\r\nstances[\"berserk\"] = new Stance({\r\n    name: \"Berserker's Stride\",\r\n    id: \"berserk\",\r\n    related_skill: \"Berserker's stride\",\r\n    stat_multipliers: {\r\n        attack_power: 1.2,\r\n        hit_chance: 1.2,\r\n        agility: 0.4,\r\n        block_strength: 0.4,\r\n    },\r\n    target_count: 3,\r\n    randomize_target_count: true,\r\n    stamina_cost: 4,\r\n});\r\n\r\nstances[\"flowing water\"] = new Stance({\r\n    name: \"Flowing Water\",\r\n    id: \"flowing water\",\r\n    related_skill: \"Flowing water\",\r\n    stat_multipliers: {\r\n        attack_power: 1.2,\r\n        agility: 1.2,\r\n        attack_speed: 1.2,\r\n    },\r\n    target_count: 2,\r\n    stamina_cost: 4,\r\n});\r\nexport {stances};", "import { effect_templates } from \"./active_effects.js\";\r\nimport { activities } from \"./activities.js\";\r\nimport { character } from \"./character.js\";\r\nimport { dialogues } from \"./dialogues.js\";\r\nimport { enemy_templates } from \"./enemies.js\";\r\nimport { item_templates } from \"./items.js\";\r\nimport { locations } from \"./locations.js\";\r\nimport { skills, skill_categories } from \"./skills.js\";\r\nimport { traders } from \"./traders.js\";\r\nimport { quests } from \"./quests.js\";\r\nimport { market_region_mapping } from \"./market_saturation.js\";\r\nimport { translations } from \"./translation.js\";\r\nimport { recipes } from \"./crafting_recipes.js\";\r\n\r\nconst trc = 1000000; //time rounding precision\r\n\r\nfunction Verify_Game_Objects() {\r\n    let results = [0,0];\r\n    let overall_start_time = performance.now();\r\n    let start_time = performance.now();\r\n    let item_results = [0,0];\r\n    console.log(\"Began verifying game objects.\");\r\n    console.log(\"Began verifying items.\");\r\n    for(const [key,item] of Object.entries(item_templates)){\r\n        let has_issue = false;\r\n        if(key !== item.id) {\r\n            console.error(`Id mismatch: \"${key}\" - \"${item.id}\"`);\r\n            has_issue = true;\r\n        }\r\n        if(item.tags.usable) {\r\n            for(let i = 0; i < item.effects.length; i++) {\r\n                if(!effect_templates[item.effects[i].effect]) {\r\n                    console.error(`Effect \"${item.effects[i].effect}\" of item \"${key}\" is not defined in effect templates`);\r\n                    has_issue = true;\r\n                }\r\n            }\r\n        }\r\n        /*\r\n        UNNEEDED, check is already done in item creation\r\n        if(item.components) {\r\n            Object.values(item.components).forEach(component => {\r\n                if(!item_templates[component]) {\r\n                    console.error(`Component \"${component}\" of item \"${key}\" is not defined in item templates`);\r\n                    has_issue = true;\r\n                }\r\n            })\r\n        }*/\r\n\r\n        if(item.stats) {\r\n            Object.keys(item.stats).forEach(stat_key => {\r\n                if(character.base_stats[stat_key] === undefined) {\r\n                    console.error(`Item \"${key}\" has a non-existent stat \"${stat_key}\"`);\r\n                    has_issue = true;\r\n                } else {\r\n                    Object.keys(item.stats[stat_key]).forEach(stat_type_key => {\r\n                        if(stat_type_key !== \"multiplier\" && stat_type_key !== \"flat\") {\r\n                            console.error(`Item \"${key}\" has a non-existent stat type \"${stat_type_key}\" (should be 'multiplier' or 'flat')`);\r\n                            has_issue = true;\r\n                        }\r\n                    });\r\n                }\r\n            })\r\n        }\r\n\r\n        if(item.effects) {\r\n            for(let i = 0; i < item.effects.length; i++) {\r\n                if(!effect_templates[item.effects[i].effect]) {\r\n                    console.error(`Item \"${key}\" refers to a non-existent effect \"${item.effects[i].effect}\"`);\r\n                    has_issue = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        item_results[0]++;\r\n        item_results[1]+=has_issue;\r\n        results[0]++;\r\n        results[1]+=has_issue;\r\n    }\r\n    let end_time = performance.now();\r\n    if(item_results[1] > 0) {\r\n        console.log(`Finished verifying items in: ${Math.round(trc*(end_time-start_time))/trc}s\\nFound issue in ${item_results[1]} out of ${item_results[0]}`);\r\n    } else {\r\n        console.log(`Finished verifying ${item_results[0]} items in: ${Math.round(trc*(end_time-start_time))/trc}s\\nNo issues were found.`);\r\n    }\r\n\r\n    start_time = performance.now();\r\n    let skill_results = [0,0];\r\n    console.log(\"Began verifying skills.\");\r\n    for(const [key,skill] of Object.entries(skills)){\r\n        let has_issue = false;\r\n        if(key !== skill.skill_id) {\r\n            console.error(`Id mismatch: \"${key}\" - \"${skill.skill_id}\"`);\r\n            has_issue = true;\r\n        }\r\n\r\n        if(skill.milestones) {\r\n            Object.values(skill.milestones).forEach(milestone => {\r\n                Object.keys(milestone).forEach(milestone_reward_type_key => {\r\n                    if(milestone_reward_type_key !== \"unlocks\" && milestone_reward_type_key !== \"stats\" && milestone_reward_type_key !== \"xp_multipliers\") {\r\n                        console.error(`Skill \"${key}\" has a milestone reward to a non-existent category of \"${milestone_reward_type_key}\"`);\r\n                        has_issue = true;\r\n                    } else {\r\n                        if(milestone_reward_type_key === \"unlocks\"){\r\n                            Object.keys(milestone[milestone_reward_type_key]).forEach(unlock_key => {\r\n                                if(unlock_key !== \"skills\" && unlock_key !== \"recipes\" && unlock_key !== \"quests\") {\r\n                                    console.error(`Skill \"${key}\" has a milestone reward in form of unlocking \"${unlock_key}\" which is not supported`);\r\n                                    has_issue = true;\r\n                                }\r\n                            });\r\n                        } else if(milestone_reward_type_key === \"stats\"){\r\n                            Object.keys(milestone[milestone_reward_type_key]).forEach(stat_key => {\r\n                                if(character.base_stats[stat_key] === undefined) {\r\n                                    console.error(`Skill \"${key}\" has a milestone reward for a non-existent stat \"${stat_key}\"`);\r\n                                    has_issue = true;\r\n                                }\r\n                                Object.keys(milestone[milestone_reward_type_key][stat_key]).forEach(stat_type=>{\r\n                                    if(stat_type !== \"flat\" && stat_type !== \"multiplier\") {\r\n                                        console.error(`Skill \"${key}\" has a milestone reward to stats of wrong type \"${stat_type}\". Should be \"flat\" or \"multiplier\"`);\r\n                                        has_issue = true;\r\n                                    }\r\n                                });\r\n                            });\r\n                        } else { //xp_multipliers\r\n                            Object.keys(milestone[milestone_reward_type_key]).forEach(skill_key => {\r\n                                if(skill_key !== \"all\" && skill_key !== \"all_skill\" && skill_key !== \"hero\" && !skills[skill_key]) {\r\n                                    if(skill_key.includes(\"category_\")) {\r\n                                        if(!skill_categories[skill_key.replace(\"category_\",\"\")]) {\r\n                                            has_issue = true;\r\n                                            console.error(`Skill \"${key}\" has a milestone reward for a non-existent skill \"${skill_key}\"`);\r\n                                        }\r\n                                    } else {\r\n                                        has_issue = true;\r\n                                        console.error(`Skill \"${key}\" has a milestone reward for a non-existent skill \"${skill_key}\"`);\r\n                                    }\r\n                                }\r\n                            });\r\n                        }\r\n                    }\r\n                });\r\n                /*\r\n                if(character.base_stats[stat_key] === undefined) {\r\n                    console.error(`Item \"${key}\" has a non-existent stat \"${stat_key}\"`);\r\n                    has_issue = true;\r\n                } else {\r\n                    Object.keys(skill.stats[stat_key]).forEach(stat_type_key => {\r\n                        if(stat_type_key !== \"multiplier\" && stat_type_key !== \"flat\") {\r\n                            console.error(`Item \"${key}\" has a non-existent stat type \"${stat_type_key}\" (should be 'multiplier' or 'flat')`);\r\n                            has_issue = true;\r\n                        }\r\n                    });\r\n                }*/\r\n            });\r\n        }\r\n\r\n        skill_results[0]++;\r\n        skill_results[1]+=has_issue;\r\n        results[0]++;\r\n        results[1]+=has_issue;\r\n    }\r\n    end_time = performance.now();\r\n    if(skill_results[1] > 0) {\r\n        console.log(`Finished verifying skills in: ${Math.round(trc*(end_time-start_time))/trc}s\\nFound issue in ${skill_results[1]} out of ${skill_results[0]}`);\r\n    } else {\r\n        console.log(`Finished verifying ${skill_results[0]} skills in: ${Math.round(trc*(end_time-start_time))/trc}s\\nNo issues were found.`);\r\n    }\r\n\r\n\r\n    start_time = performance.now();\r\n    let location_results = [0,0];\r\n    console.log(\"Began verifying locations.\");\r\n    for(const [key,location] of Object.entries(locations)){\r\n        let has_issue = false;\r\n        if(key !== location.id) {\r\n            console.error(`Id mismatch: \"${key}\" - \"${location.id}\"`);\r\n            has_issue = true;\r\n        }\r\n        if(location.tags[\"safe_zone\"]) {\r\n            for(let i = 0; i < location.dialogues.length; i++) {\r\n                if(!dialogues[location.dialogues[i]]) {\r\n                    console.error(`Location \"${key}\" refers to a non-existent dialogue \"${dialogues[location.dialogues[i]]}\"`);\r\n                    has_issue = true;\r\n                }\r\n            }\r\n            if(location.traders?.length > 0) {\r\n                if(!location.market_region) {\r\n                    console.error(`Location \"${key}\" has at least one trader but no trade region assigned!`);\r\n                    has_issue = true;\r\n                } else {\r\n                    if(!market_region_mapping[location.market_region]) {\r\n                        console.error(`Location \"${key}\" has market region \"${location.market_region}\" assigned, but no such region is present in region mapping!`);\r\n                        has_issue = true;\r\n                    }\r\n                }\r\n                for(let i = 0; i < location.traders.length; i++) {\r\n                    if(!traders[location.traders[i]]) {\r\n                        console.error(`Location \"${key}\" refers to a non-existent trader \"${location.traders[i]}\"`);\r\n                        has_issue = true;\r\n                    }\r\n                }\r\n            }\r\n            \r\n            for(let i = 0; i < location.connected_locations.length; i++) {\r\n                if(!location.connected_locations[i].location) {\r\n                    console.error(`Location \"${key}\" is connected to a non-existent location.`);\r\n                    has_issue = true;\r\n                }\r\n            }\r\n            Object.keys(location.activities).forEach(activity_key => {\r\n                if(!activities[location.activities[activity_key].activity_name]) {\r\n                    console.error(`Location \"${key}\" refers to a non-existent activity \"${location.activities[activity_key].activity_name}\"`);\r\n                    has_issue = true;\r\n                }\r\n                for(let i = 0; i < location.activities[activity_key].gained_resources?.length; i++) {\r\n                    if(!item_templates[location.activities[activity_key].gained_resources.resources[i].name]) {\r\n                        console.error(`Activity \"${activity_key}\" in location \"${key}\" refers to a non-existent item \"${location.activities[activity_key].gained_resources.resources[i].name}\"`);\r\n                        has_issue = true;\r\n                    }\r\n                }   \r\n            });\r\n        } else if(location.tags[\"Combat zone\"]) {\r\n\r\n            if(location.parent_location == undefined) {\r\n                console.error(`Combat location \"${key}\" refers to a non-existent parent\"`);\r\n                has_issue = true;\r\n            }\r\n\r\n            for(let i = 0; i < location.enemies_list?.length; i++) {\r\n                if(!enemy_templates[location.enemies_list[i]]) {\r\n                    console.error(`Location \"${key}\" refers to a non-existent enemy \"${location.enemies_list[i]}\"`);\r\n                    has_issue = true;\r\n                }\r\n            }\r\n\r\n            for(let i = 0; i < location.enemy_groups_list?.length; i++) {\r\n                for(let j = 0; j < location.enemy_groups_list[i].enemies.length; j++) {\r\n                    if(!enemy_templates[location.enemy_groups_list[i].enemies[j]]) {\r\n                        console.error(`Location \"${key}\" refers to a non-existent enemy \"${location.enemy_groups_list[i].enemies[j]}\"`);\r\n                        has_issue = true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if(location.first_reward) {\r\n                if(!verify_rewards(location.first_reward, \"location\", key)){\r\n                    //has_issue = true;\r\n                }\r\n            }\r\n            if(location.repeatable_reward) {\r\n                if(!verify_rewards(location.repeatable_reward, \"location\", key)){\r\n                    has_issue = true;\r\n                }\r\n            }\r\n            if(location.rewards_with_clear_requirement) {\r\n                for(let i = 0; i < location.rewards_with_clear_requirement.length; i++) {\r\n                    if(!verify_rewards(location.rewards_with_clear_requirement[i], \"location\", key)){\r\n                        has_issue = true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        location_results[0]++;\r\n        location_results[1]+=has_issue;\r\n        results[0]++;\r\n        results[1]+=has_issue;\r\n    }\r\n    end_time = performance.now();\r\n    if(location_results[1] > 0) {\r\n        console.log(`Finished verifying locations in: ${Math.round(trc*(end_time-start_time))/trc}s\\nFound issue in ${location_results[1]} out of ${location_results[0]}`);\r\n    } else {\r\n        console.log(`Finished verifying ${location_results[0]} locations in: ${Math.round(trc*(end_time-start_time))/trc}s\\nNo issues were found.`);\r\n    }\r\n\r\n    start_time = performance.now();\r\n    let enemy_results = [0,0];\r\n    console.log(\"Began verifying enemies.\");\r\n    for(const [key,enemy] of Object.entries(enemy_templates)){\r\n        let has_issue = false;\r\n        if(key !== enemy.id) {\r\n            console.error(`Id mismatch: \"${key}\" - \"${enemy.id}\"`);\r\n            has_issue = true;\r\n        }\r\n\r\n        for(let i = 0; i < enemy.loot_list.length; i++) {\r\n            if(!item_templates[enemy.loot_list[i].item_name]) {\r\n                console.error(`Enemy \"${key}\" refers to a non-existent item \"${enemy.loot_list[i].item_name}\"`);\r\n                has_issue = true;\r\n            }\r\n        }\r\n\r\n        enemy_results[0]++;\r\n        enemy_results[1]+=has_issue;\r\n        results[0]++;\r\n        results[1]+=has_issue;\r\n    }\r\n    end_time = performance.now();\r\n    if(enemy_results[1] > 0) {\r\n        console.log(`Finished verifying enemies in: ${Math.round(trc*(end_time-start_time))/trc}s\\nFound issue in ${enemy_results[1]} out of ${enemy_results[0]}`);\r\n    } else {\r\n        console.log(`Finished verifying ${enemy_results[0]} in: ${Math.round(trc*(end_time-start_time))/trc}s\\nNo issues were found.`);\r\n    }\r\n\r\n    start_time = performance.now();\r\n    let market_region_results = [0,0];\r\n    console.log(\"Began verifying market regions.\");\r\n    for(const [key, ] of Object.entries(market_region_mapping)) {\r\n        let has_issue = false;\r\n\r\n        let is_present = false;\r\n        Object.values(locations).forEach(location => {\r\n            if(location.market_region === key) {\r\n                is_present = true;\r\n            }\r\n        });\r\n\r\n        if(!is_present) {\r\n            has_issue = true;\r\n            console.error(`Market region \"${key}\" is not used for any location despite being defined in region connections!`);\r\n        }\r\n        market_region_results[0]++;\r\n        market_region_results[1]+=has_issue;\r\n        results[0]++;\r\n        results[1]+=has_issue;\r\n    }\r\n    end_time = performance.now();\r\n    if(market_region_results[1] > 0) {\r\n        console.log(`Finished verifying market regions in: ${Math.round(trc*(end_time-start_time))/trc}s\\nFound issue in ${market_region_results[1]} out of ${market_region_results[0]}`);\r\n    } else {\r\n        console.log(`Finished verifying ${market_region_results[0]} market regions in: ${Math.round(trc*(end_time-start_time))/trc}s\\nNo issues were found.`);\r\n    }\r\n\r\n    start_time = performance.now();\r\n    let dialogue_results = [0,0];\r\n    console.log(\"Began verifying dialogues.\");\r\n    for(const [key, value] of Object.entries(dialogues)) {\r\n        let has_issue = false;\r\n\r\n        for(const [textline_key, textline] of Object.entries(value.textlines)) {\r\n            if(!translations[\"english\"][textline.name]) {\r\n                has_issue = true;\r\n                console.error(`Textline \"${textline_key}\" in \"${key}\" has no translation provided for starting text`);\r\n            }\r\n            if(!translations[\"english\"][textline.getText()]) {\r\n                //might miss something if there are multiple options provided\r\n                has_issue = true;\r\n                console.error(`Textline \"${textline_key}\" in \"${key}\" has no translation provided for answer text`);\r\n            }\r\n            if(textline.rewards) {\r\n                if(!verify_rewards(textline.rewards, \"textline\", key, textline_key)) {\r\n                    has_issue = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        for(const [action_key, action] of Object.entries(value.actions)) {\r\n            if(!translations[\"english\"][action.starting_text]) {\r\n                has_issue = true;\r\n                console.error(`Action \"${action_key}\" in \"${key}\" has no translation provided for starting text`);\r\n            }\r\n            if(!translations[\"english\"][action.success_text]) {\r\n                //might miss something if there are multiple options provided\r\n                has_issue = true;\r\n                console.error(`Textline \"${action_key}\" in \"${key}\" has no translation provided for success text`);\r\n            }\r\n        }\r\n\r\n        dialogue_results[0]++;\r\n        dialogue_results[1]+=has_issue;\r\n        results[0]++;\r\n        results[1]+=has_issue;\r\n    }\r\n    end_time = performance.now();\r\n    if(dialogue_results[1] > 0) {\r\n        console.log(`Finished verifying dialogues in: ${Math.round(trc*(end_time-start_time))/trc}s\\nFound issue in ${dialogue_results[1]} out of ${dialogue_results[0]}`);\r\n    } else {\r\n        console.log(`Finished verifying ${dialogue_results[0]} dialogues in: ${Math.round(trc*(end_time-start_time))/trc}s\\nNo issues were found.`);\r\n    }\r\n\r\n    start_time = performance.now();\r\n    let recipes_results = [0,0];\r\n    console.log(\"Began verifying recipes.\");\r\n    Object.keys(recipes).forEach(recipe_category => {\r\n        Object.keys(recipes[recipe_category]).forEach(recipe_subcategory => {\r\n            for(const [key, value] of Object.entries(recipes[recipe_category][recipe_subcategory])) {\r\n            let has_issue = false;\r\n            if(!skills[value.recipe_skill]) {\r\n                has_issue = true;\r\n                console.error(`Recipe \"${recipe_category}\" -> \"${recipe_subcategory}\" -> \"${key}\" refers to nonexistent skill \"${value.recipe_skill}\"`);\r\n            }\r\n\r\n            if(recipe_subcategory === \"items\"){\r\n                if(!item_templates[value.result.result_id]) {\r\n                    has_issue = true;\r\n                    console.error(`Recipe \"${recipe_category}\" -> \"${recipe_subcategory}\" -> \"${key}\" creates nonexistent item \"${value.result.result_id}\"`);\r\n                }\r\n\r\n                for(let i = 0; i < value.materials.length; i++) {\r\n                    if(value.materials[i].material_id && !item_templates[value.materials[i].material_id]) {\r\n                        has_issue = true;\r\n                        console.error(`Recipe \"${recipe_category}\" -> \"${recipe_subcategory}\" -> \"${key}\" uses nonexistent material \"${value.materials[i].material_id}\"`);\r\n                    }\r\n                }\r\n                \r\n            } else if(value.recipe_type === \"componentless\" || value.recipe_type === \"component\") {\r\n                for(let i = 0; i < value.materials.length; i++) {\r\n                    if(value.materials[i].material_id && !item_templates[value.materials[i].material_id]) {\r\n                        has_issue = true;\r\n                        console.error(`Recipe \"${recipe_category}\" -> \"${recipe_subcategory}\" -> \"${key}\" uses nonexistent material \"${value.materials[i].material_id}\"`);\r\n                    }\r\n                    if(!item_templates[value.materials[i].result_id]) {\r\n                        has_issue = true;\r\n                        console.error(`Recipe \"${recipe_category}\" -> \"${recipe_subcategory}\" -> \"${key}\" creates nonexistent item \"${value.materials[i].result_id}\"`);\r\n                    }\r\n                }\r\n            }\r\n\r\n            recipes_results[0]++;\r\n            recipes_results[1]+=has_issue;\r\n            results[0]++;\r\n            results[1]+=has_issue;\r\n        }\r\n        });\r\n    });\r\n\r\n    end_time = performance.now();\r\n    if(recipes_results[1] > 0) {\r\n        console.log(`Finished verifying recipes in: ${Math.round(trc*(end_time-start_time))/trc}s\\nFound issue in ${recipes_results[1]} out of ${recipes_results[0]}`);\r\n    } else {\r\n        console.log(`Finished verifying ${recipes_results[0]} recipes in: ${Math.round(trc*(end_time-start_time))/trc}s\\nNo issues were found.`);\r\n    }\r\n\r\n    let overall_end_time = performance.now();\r\n    let result_message;\r\n    if(results[1] > 0) {\r\n        result_message = `Finished verifying game objects in: ${Math.round(trc*(overall_end_time-overall_start_time))/trc}s\\nFound issue in ${results[1]} out of ${results[0]}`;\r\n    } else {\r\n        result_message = `Finished verifying ${results[0]} game objects in: ${Math.round(trc*(overall_end_time-overall_start_time))/trc}s\\nNo issues were found.`;\r\n    }\r\n\r\n    console.log(result_message);\r\n    return results[1] == 0;\r\n}\r\n\r\nfunction verify_rewards(rewards, source_type, source_key, subsource_key) {\r\n    //todo\r\n    //doesn't yet cover: actions, activities, global activities, locking, quest unlocks, traders, money, reputation, items, flags\r\n    let is_correct = true;\r\n\r\n    Object.keys(rewards).forEach(reward_type => {\r\n        if(reward_type === \"xp\" && typeof rewards[reward_type] !== 'number') {\r\n            console.error(create_reward_error_message(source_type, source_key, subsource_key) + \"wrong kind of reward of 'xp' type, should be Number but found '\"+typeof rewards[reward_type]+\"'\");\r\n            is_correct = false;\r\n        } else if(reward_type === \"skill_xp\") {\r\n            Object.keys(rewards[reward_type]).forEach(skill_id =>{\r\n                if(!skills[skill_id]) {\r\n                    console.error(create_reward_error_message(source_type, source_key, subsource_key) + \"wrong skill id for 'skill_xp', no such skill as '\"+skill_id+\"'\");\r\n                    is_correct = false;\r\n                }\r\n                if(typeof rewards[reward_type][skill_id] !== 'number') {\r\n                    console.error(create_reward_error_message(source_type, source_key, subsource_key) + \"wrong kind of reward of 'skill xp' type for '\" +skill_id+\"', should be Number but found '\"+typeof rewards[reward_type][skill_id]+\"'\");\r\n                    is_correct = false;\r\n                }\r\n            });\r\n        } else if(reward_type === \"locations\") {\r\n            for(let i = 0; i < rewards[reward_type].length; i++) {\r\n                if(!locations[rewards[reward_type][i].location]) {\r\n                    console.error(create_reward_error_message(source_type, source_key, subsource_key) + `non-existent location '${rewards[reward_type][i].location}' listed for unlocks`);\r\n                    is_correct = false;\r\n                }\r\n            }\r\n        } else if(reward_type === \"textlines\") {\r\n            for(let i = 0; i < rewards[reward_type].length; i++) {\r\n                if(!dialogues[rewards[reward_type][i].dialogue]) {\r\n                    console.error(create_reward_error_message(source_type, source_key, subsource_key) + `non-existent dialogue '${rewards[reward_type][i].dialogue}' listed for textline unlocks`);\r\n                    is_correct = false;\r\n                }\r\n                for(let j = 0; j < rewards[reward_type][i].lines.length; j++) {\r\n                    if(!dialogues[rewards[reward_type][i].dialogue].textlines[rewards[reward_type][i].lines[j]]) {\r\n                        console.error(create_reward_error_message(source_type, source_key, subsource_key) + `non-existent textline '${rewards[reward_type][i].lines[j]}' listed for unlocks in dialogue '${rewards[reward_type][i].dialogue}'`);\r\n                        is_correct = false;\r\n                    }\r\n                }\r\n            }\r\n        } else if(reward_type === \"move_to\") {\r\n            if(!locations[rewards[reward_type].location]) {\r\n                console.error(create_reward_error_message(source_type, source_key, subsource_key) + `non-existent location '${rewards[reward_type].location}' listed for moving to`);\r\n                is_correct = false;\r\n            }\r\n        } else if(reward_type === \"quest_progress\") {\r\n            for(let i = 0; i < rewards[reward_type].length; i++) {\r\n                if(!quests[rewards[reward_type][i].quest_id]) {\r\n                    console.error(create_reward_error_message(source_type, source_key, subsource_key) + `non-existent quest '${rewards[reward_type][i].quest_id}' listed for progressing`);\r\n                    is_correct = false;\r\n                }\r\n                if(quests[rewards[reward_type][i].quest_id].quest_tasks.length < rewards[reward_type][i].task_index) {\r\n                    console.error(create_reward_error_message(source_type, source_key, subsource_key) + `too high task index for progressing quest '${rewards[reward_type][i].quest_id}'`);\r\n                    is_correct = false;\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    return is_correct;\r\n}\r\n\r\nfunction create_reward_error_message(source_type, source_key, subsource_key) {\r\n    if(source_type === \"location\") {\r\n        return `Location \"${source_key}\" has a `;\r\n    } else if(source_type === \"textline\") {\r\n        return `Textline \"${subsource_key}\" in dialogue \"${source_key}\" has a `;\r\n    }\r\n}\r\n\r\nexport {\r\n    Verify_Game_Objects\r\n}", "import { character } from \"./character.js\";\r\n\r\nconst ReputationManager = {\r\n\r\n    add_reputation: ({reputation, region}) => {\r\n        if(Number.isInteger(reputation)) {\r\n            if(region in character.reputation) {\r\n                character.reputation[region] += reputation;\r\n            } else {\r\n                throw new Error(`Tried to add reputation to \"${region}\", which is not a valid reputation region!`);\r\n            }\r\n        } else {\r\n            throw new Error(`Tried to add \"${reputation}\", which is not a valid integer!`);\r\n        }\r\n    },\r\n\r\n\r\n    //for future: some unlocks for reaching certain values?\r\n    //they could be handled via unmarked quests, but doing that here should be cleaner\r\n}\r\n\r\n\r\nexport {ReputationManager}", "\"use strict\";\r\n\r\nimport { skills } from \"./skills.js\";\r\n\r\n\r\nconst speed_modifiers_from_skills = {};\r\nconst default_travel_skill = \"Running\";\r\nconst default_travel_time = 60; //realistically shouldn't be relied upon, try to define travel times for every connection\r\nconst max_modifier_from_skill = 4;\r\n\r\nclass PriorityQueue {\r\n    constructor() {\r\n        this.queue = [];\r\n    }\r\n\r\n    add_to_queue(location_element) {\r\n        this.queue.push(location_element);\r\n        this.queue.sort((a,b) => a[0] - b[0]);\r\n    }\r\n    \r\n    shift_from_queue() {\r\n        if(this.is_queue_empty()) {\r\n            return \"Queue is empty\";\r\n        } \r\n\r\n        return this.queue.shift();\r\n    }\r\n\r\n    is_queue_empty() {\r\n        return this.queue.length == 0;\r\n    }\r\n}\r\n\r\nclass Pathfinder {\r\n    constructor() {\r\n        this.adjacent = {};\r\n        this.vertice_count = 0;\r\n    }\r\n\r\n    /**\r\n     * Creates connection from 1 to 2 with provided travel time. Does it one way only, as travel times can be assymetrical\r\n     * @param {*} loc1 \r\n     * @param {*} loc2 \r\n     * @param {*} distance \r\n     */\r\n    add_connection(loc1, loc2, travel_time) {\r\n\r\n        if(!this.adjacent[loc1]) {\r\n            this.adjacent[loc1] = [];\r\n        }\r\n\r\n        this.adjacent[loc1].push([loc2,travel_time]);\r\n    }\r\n\r\n    update_time_skill_modifiers() { //probably useless\r\n        Object.keys(speed_modifiers_from_skills).forEach(skill_id => {\r\n            speed_modifiers_from_skills[skill_id] = 1/(max_modifier_from_skill**(skills[skill_id].current_level/skills[skill_id].max_level));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Updates travel time modifier from given skill, as to not calculate it repeatedly for every possible connection\r\n     * @param {*} skill_id \r\n     */\r\n    update_time_skill_modifier(skill_id) {\r\n        speed_modifiers_from_skills[skill_id] = 1/(max_modifier_from_skill**(skills[skill_id].current_level/skills[skill_id].max_level));\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {Array} used_skills \r\n     * @returns total speed modifier from provided skills, calculated via geometric average \r\n     */\r\n    get_total_skills_modifier(used_skills) {\r\n        let skill_modifier = 1;\r\n        for(let j = 0; j < used_skills.length; j++) {\r\n            if(!(used_skills[j] in speed_modifiers_from_skills)) {\r\n                this.update_time_skill_modifier(used_skills[j]);\r\n            }\r\n            skill_modifier *= speed_modifiers_from_skills[used_skills[j]];\r\n        }\r\n\r\n        return skill_modifier ** used_skills.length;\r\n    }\r\n\r\n    /**\r\n     * fills in connections for all locations and calculates direct travel times depending on relevant skills\r\n     * @param {*} locations \r\n     */\r\n    fill_connections(locations) {\r\n        Object.values(locations).forEach(location => {\r\n            if(location.is_unlocked && !location.is_finished) { //don't bother if it's unavailable\r\n                if(location.parent_location) {\r\n                    \r\n                    const travel_time_to_here = location.parent_location.connected_locations.find(x => x.location === location).travel_time ?? default_travel_time;\r\n\r\n                    const used_skills = location.parent_location.connected_locations.find(x => x.location === location).travel_time_skills || [default_travel_skill];\r\n\r\n                    const skill_modifier = this.get_total_skills_modifier(used_skills);\r\n\r\n                    this.add_connection(location.id, location.parent_location.id, travel_time_to_here*skill_modifier);\r\n                } else {\r\n                    for(let i = 0; i < location.connected_locations.length; i++) {\r\n                        if(location.connected_locations[i].location.is_unlocked && !location.connected_locations[i].location.is_finished) { //check if the connected one is available\r\n\r\n                            const used_skills = location.connected_locations[i].travel_time_skills || [default_travel_skill];\r\n                            \r\n                            const skill_modifier = this.get_total_skills_modifier(used_skills);\r\n\r\n                            this.add_connection(location.id, location.connected_locations[i].location.id, (location.connected_locations[i].travel_time ?? default_travel_time)*skill_modifier);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Finds shortest paths from starting location to all using Dijkstra with priority queue; \r\n     * as of v0.5 it's a bit too much as there's only a single connection between any given A and B, but routes are likely to become more complicated in future\r\n     * @param {String} starting_location location id\r\n     */\r\n    find_shortest_paths(starting_location) {\r\n        const priority_queue = new PriorityQueue();\r\n        const distance = {};\r\n\r\n        priority_queue.add_to_queue([0,starting_location]);\r\n        distance[starting_location] = 0;\r\n\r\n        while(!priority_queue.is_queue_empty()) {\r\n            const [, loc1] = priority_queue.shift_from_queue();\r\n            if(this.adjacent[loc1]) { //a minor check for that singular case of having only 1 location, therefore no adjacents, which would throw an error in next line\r\n                for(const [loc2, weight] of this.adjacent[loc1]) {\r\n\r\n                    if(distance[loc1] == undefined) distance[loc1] = Infinity;\r\n                    if(distance[loc2] == undefined) distance[loc2] = Infinity;\r\n\r\n                    if(distance[loc2] > distance[loc1] + weight) {\r\n                        distance[loc2] = distance[loc1] + weight;\r\n                        priority_queue.add_to_queue([distance[loc2], loc2]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        Object.keys(distance).forEach(target => {\r\n            distance[target] = Math.round(distance[target]);\r\n        });\r\n        return distance;\r\n    } \r\n}\r\n\r\nexport {Pathfinder, speed_modifiers_from_skills};\r\n", "\"use strict\";\r\n\r\nimport { current_game_time, is_night } from \"./game_time.js\";\r\nimport { item_templates, getItem, book_stats, rarity_multipliers, getArmorSlot, getItemFromKey, getItemRarity} from \"./items.js\";\r\nimport { loot_sold_count, market_region_mapping, recover_item_prices, trickle_market_saturations, set_loot_sold_count, capped_at } from \"./market_saturation.js\";\r\nimport { locations, favourite_locations, location_types } from \"./locations.js\";\r\nimport { crafting_skill_xp_gains_cap, skill_categories, skill_xp_gains_cap, skills, weapon_type_to_skill, which_skills_affect_skill } from \"./skills.js\";\r\nimport { dialogues } from \"./dialogues.js\";\r\nimport { enemy_killcount, enemy_tag_to_skill_mapping, enemy_templates, tags_for_droprate_modifier_skills } from \"./enemies.js\";\r\nimport { traders } from \"./traders.js\";\r\nimport { is_in_trade, start_trade, cancel_trade, accept_trade, exit_trade, add_to_trader_inventory,\r\n         add_to_buying_list, remove_from_buying_list, add_to_selling_list, remove_from_selling_list} from \"./trade.js\";\r\nimport { character, \r\n         add_to_character_inventory, remove_from_character_inventory,\r\n         equip_item_from_inventory, unequip_item, equip_item,\r\n         update_character_stats,\r\n         get_skill_xp_gain, \r\n         get_total_skill_level,\r\n         time_until_wet,\r\n         cold_status_temperatures,\r\n         time_until_cold,\r\n         time_until_cold_when_wet,\r\n         cold_status_effects,\r\n         get_character_cold_tolerance,\r\n         is_rat} from \"./character.js\";\r\nimport { activities } from \"./activities.js\";\r\nimport { end_activity_animation, \r\n         update_displayed_character_inventory, update_displayed_trader_inventory, sort_displayed_inventory, sort_displayed_skills,\r\n         update_displayed_money, log_message,\r\n         update_displayed_enemies, update_displayed_health_of_enemies,\r\n         update_displayed_combat_location, update_displayed_normal_location,\r\n         log_loot, update_displayed_equipment,\r\n         update_displayed_health, update_displayed_stamina,\r\n         format_money, update_displayed_stats,\r\n         update_displayed_effects, update_displayed_effect_durations,\r\n         update_displayed_time, update_displayed_character_xp, \r\n         start_sleeping_display,\r\n         create_new_skill_bar, update_displayed_skill_bar, update_displayed_skill_description,\r\n         update_displayed_ongoing_activity, \r\n         update_enemy_attack_bar, update_character_attack_bar,\r\n         remove_fast_travel_choice,\r\n         create_new_bestiary_entry,\r\n         start_reading_display,\r\n         update_displayed_xp_bonuses, \r\n         update_displayed_skill_xp_gain, update_all_displayed_skills_xp_gain, update_displayed_stance_list, \r\n         update_displayed_stamina_efficiency, update_displayed_stance, update_displayed_faved_stances, update_stance_tooltip,\r\n         update_gathering_tooltip,\r\n         open_crafting_window,\r\n         update_displayed_location_types,\r\n         close_crafting_window,\r\n         switch_crafting_recipes_page,\r\n         switch_crafting_recipes_subpage,\r\n         create_displayed_crafting_recipes,\r\n         update_displayed_component_choice,\r\n         update_displayed_material_choice,\r\n         update_recipe_tooltip,\r\n         update_displayed_crafting_recipes,\r\n         update_item_recipe_visibility,\r\n         update_item_recipe_tooltips,\r\n         update_displayed_book,\r\n         update_backup_load_button,\r\n         update_other_save_load_button,\r\n         set_game_action_finish_text,\r\n         update_game_action_progress_bar,\r\n         update_game_action_finish_button,\r\n         update_displayed_storage_inventory,\r\n         update_location_icon,\r\n         skill_list,\r\n         update_booklist_entry,\r\n         update_displayed_temperature,\r\n         update_displayed_quest,\r\n         start_rain_animation,\r\n         start_snow_animation,\r\n         stop_background_animation,\r\n         skill_category_order,\r\n         update_displayed_total_price,\r\n         start_stars_animation,\r\n         update_export_button_tooltip,\r\n         update_displayed_reputation,\r\n         hide_loading_screen,\r\n         set_loading_screen_versions,\r\n         set_loading_screen_errors_warning,\r\n         set_loading_screen_progress,\r\n         hide_loading_text,\r\n         show_play_button,\r\n         set_loading_screen_warnings_warning,\r\n         fill_action_box,\r\n         update_bestiary_entry_killcount,\r\n         update_bestiary_entry_tooltip,\r\n         set_play_button_text,\r\n         do_enemy_onhit_animation,\r\n         remove_enemy_onhit_animation,\r\n         create_floating_effect,\r\n         booklist_entry_divs,\r\n         do_enemy_onstart_animation,\r\n         update_location_kill_count,\r\n         change_completed_quest_visibility,\r\n         update_fav_display\r\n        } from \"./display.js\";\r\nimport { compare_game_version, crafting_tags_to_skills, get_hit_chance, is_a_older_than_b, skill_consumable_tags } from \"./misc.js\";\r\nimport { stances } from \"./combat_stances.js\";\r\nimport { get_recipe_xp_value, recipes } from \"./crafting_recipes.js\";\r\nimport { game_version, get_game_version } from \"./game_version.js\";\r\nimport { ActiveEffect, effect_templates } from \"./active_effects.js\";\r\nimport { open_storage, close_storage, move_item_to_storage, remove_item_from_storage, player_storage, is_storage_open } from \"./storage.js\";\r\nimport { Verify_Game_Objects } from \"./verifier.js\";\r\nimport { ReputationManager } from \"./reputation.js\";\r\nimport { quests, questManager, active_quests } from \"./quests.js\";\r\nimport { get_current_temperature_smoothed, is_raining } from \"./weather.js\";\r\nimport { Pathfinder, speed_modifiers_from_skills } from \"./pathfinding.js\";\r\n\r\nconst save_key = \"save data\";\r\nconst dev_save_key = \"dev save data\";\r\nconst backup_key = \"backup save\";\r\nconst dev_backup_key = \"dev backup save\";\r\n\r\nconst global_flags = {\r\n    is_gathering_unlocked: false,\r\n    is_crafting_unlocked: false,\r\n    is_strength_proved: false, //this role could be fulfilled by a quest, but it was originally added before that mechanic; besides, flags are cool and elegant\r\n    is_mofu_mofu_enabled: true,\r\n    is_guard_met: false,\r\n};\r\nconst flag_unlock_texts = {\r\n    is_gathering_unlocked: \"You have gained the ability to gather new materials! Remember to equip your tools first <br>[Note: equipped tools do not appear in inventory as you will be swapping them very rarely]\",\r\n    is_crafting_unlocked: \"You have gained the ability to craft items and equipment!\",\r\n}\r\n\r\nconst play_button = document.getElementById(\"loading_screen_play_button\");\r\n\r\nconst languages = {\r\n    english: \"english\",\r\n    mofu_english: \"mofu_english\",\r\n};\r\nlet language = languages.mofu_english;\r\n\r\nlet is_loading_error = false;\r\n\r\n//in seconds\r\nlet total_playtime = 0;\r\n\r\n//some random stats to keep count of in case they ever become relevant\r\nlet total_deaths = 0;\r\nlet total_crafting_attempts = 0;\r\nlet total_crafting_successes = 0;\r\nlet total_kills = 0; \r\nlet total_crits_done = 0;\r\nlet total_crits_taken = 0;\r\nlet total_hits_done = 0;\r\nlet total_hits_taken = 0;\r\nlet strongest_hit = 0;\r\nlet gathered_materials = {};\r\n\r\n//\r\nconst trade_price_recovery_flat = 5;//\r\nconst trade_price_recovery_ratio = 1/360; //\r\n//larger of two (sold count * ratio or flat value)\r\nconst market_saturation_trickle_rate = 0.2;\r\n\r\n//keeping the time to use it for export bonus\r\nlet last_rewarded_export = 0;\r\nconst time_between_export_rewards = 1000*60*60*20; //1000 miliseconds -> 1s, x60 -> 1m, x60 -> 1h, x20 -> 20h\r\n\r\n//temperature\r\nlet current_temperature = 20;\r\n\r\nlet rain_counter = 0;\r\nconst cold_status_counters = [0,0,0,0];\r\n\r\nlet was_raining = false;\r\nlet was_starry = false;\r\n\r\n//current enemy\r\nlet current_enemies = null;\r\n\r\nconst enemy_attack_loops = {};\r\nlet enemy_attack_cooldowns;\r\nlet enemy_timer_variance_accumulator = [];\r\nlet enemy_timer_adjustment = [];\r\nlet enemy_timers = [];\r\nlet character_attack_loop;\r\n\r\nlet character_timer_variance_accumulator = 0;\r\nlet character_timer_adjustment = 0;\r\nlet character_timers = [];\r\n\r\nconst maximum_time_correction = 10;\r\n//maximum time correction for combat, in miliseconds\r\n\r\n//current location\r\nlet current_location;\r\n\r\nlet current_activity;\r\n\r\nlet game_action_interval;\r\nlet current_game_action;\r\n\r\n//time needed to travel from A to B\r\nlet travel_times = {};\r\nlet pathfinder;\r\n\r\n//locations for fast travel\r\nlet unlocked_beds = {};\r\n\r\n//resting, true -> health regenerates\r\nlet is_resting = true;\r\n\r\n//sleeping, true -> health regenerates, timer goes up faster\r\nlet is_sleeping = false;\r\n\r\nlet last_location_with_bed = null; //actually last location where player slept!\r\nlet last_combat_location = null;\r\n\r\n//reading, either null or book name\r\nlet is_reading = null;\r\n\r\n//ticks between saves, 60 = ~1 minute\r\nlet save_period = 60;\r\nlet save_counter = 0;\r\n\r\n//ticks between saves, 60 = ~1 minute\r\nlet backup_period = 3600;\r\nlet backup_counter = 0;\r\n\r\n//accumulates deviations\r\nlet time_variance_accumulator = 0;\r\n//all 3 used for calculating and adjusting tick durations\r\nlet time_adjustment = 0;\r\nlet start_date;\r\nlet end_date;\r\n\r\nlet current_dialogue;\r\nconst active_effects = {};\r\n//e.g. health regen from food\r\n\r\nlet selected_stance = stances[\"normal\"];\r\nlet current_stance = stances[\"normal\"];\r\nconst faved_stances = {};\r\n\r\nconst favourite_consumables = {};\r\n//consumables that are to be used automatically if their effect runs out\r\n\r\nconst favourite_items = {};\r\n//items to be displayed with \"show faves\" option in inventory\r\n\r\nconst tickrate = 1;\r\n//how many ticks per second\r\n//1 is the default value; going too high might make the game unstable\r\n\r\nconst global_xp_multiplier = 1;\r\n\r\n//stuff from options panel\r\nconst options = {\r\n    uniform_text_size_in_action: false,\r\n    auto_return_to_bed: true,\r\n    remember_message_log_filters: false,\r\n    remember_sorting_options: false,\r\n    combat_disable_autoswitch: false,\r\n    log_every_gathering_period: true,\r\n    log_total_gathering_gain: true,\r\n    auto_use_when_longest_runs_out: true,\r\n    use_uncivilised_temperature_scale: false, //true -> swap Celsius for Fahrenheit\r\n    do_background_animations: false,\r\n    skip_play_button: false, //not really skips, just automatically clicks it right after loading\r\n    mofu_mofu_mode: true,\r\n    do_enemy_onhit_animations: true,\r\n    expo_threshold: 1e9,\r\n    hide_max_level_skills: false,\r\n};\r\n\r\nlet message_log_filters = {\r\n    unlocks: true,\r\n    events: true,\r\n    combat: true,\r\n    loot: true,\r\n    crafting: true,\r\n    background: true,\r\n};\r\n\r\n//enemy crit stats\r\nconst enemy_crit_chance = 0.1;\r\nconst enemy_crit_damage = 2; //multiplier, not a flat bonus\r\n\r\n//holds the stack of dialogues/textlines and actions/activities\r\nconst content_stack = [];\r\nconst content_stack_removal_options = {TOP: \"top\", ALL: \"all\"};\r\n\r\n//character name\r\nconst name_field = document.getElementById(\"character_name_field\");\r\nname_field.value = character.name;\r\nname_field.addEventListener(\"change\", () => character.name = name_field.value.toString().trim().length>0?name_field.value:\"Hero\");\r\n\r\nconst time_field = document.getElementById(\"time_div\");\r\ntime_field.innerHTML = current_game_time.toString();\r\n\r\n(function setup(){\r\n    Object.keys(skills).forEach(skill => {\r\n        character.xp_bonuses.total_multiplier[skill] = 1;\r\n        character.bonus_skill_levels.full[skill] = 0;\r\n    });\r\n    \r\n    Object.keys(skill_categories).forEach(category => {\r\n        character.xp_bonuses.total_multiplier[\"category_\"+category] = 1;\r\n    });\r\n})();\r\n\r\nfunction option_uniform_textsize(option) {\r\n    //doesn't really force same textsize, just changes some variables so they match\r\n    const checkbox = document.getElementById(\"options_textsize\");\r\n    if(checkbox.checked || option) {\r\n        options.uniform_text_size_in_action = true;    \r\n        document.documentElement.style.setProperty('--options_action_textsize', '20px');\r\n    } else {\r\n        options.uniform_text_size_in_action = false;\r\n        document.documentElement.style.setProperty('--options_action_textsize', '16px');\r\n    }\r\n\r\n    if(option !== undefined) {\r\n        checkbox.checked = option;\r\n    }\r\n}\r\n\r\nfunction option_bed_return(option) {\r\n    const checkbox = document.getElementById(\"options_bed_return\");\r\n\r\n    if(option !== undefined) {\r\n        options.auto_return_to_bed = option;\r\n        checkbox.checked = option;\r\n    } else {\r\n        options.auto_return_to_bed = checkbox.checked;\r\n    }\r\n}\r\n\r\nfunction option_remember_filters(option) {\r\n    const checkbox = document.getElementById(\"options_save_messagelog_settings\");\r\n    if(checkbox.checked || option) {\r\n        options.remember_message_log_filters = true;\r\n    } else {\r\n        options.remember_message_log_filters = false;\r\n    }\r\n\r\n    if(option !== undefined) {\r\n        checkbox.checked = option;\r\n\r\n        if(message_log_filters.unlocks){\r\n            document.documentElement.style.setProperty('--message_unlocks_display', 'inline-block');\r\n        } else {\r\n            document.documentElement.style.setProperty('--message_unlocks_display', 'none');\r\n            document.getElementById(\"message_show_unlocks\").classList.remove(\"active_selection_button\");\r\n        }\r\n\r\n        if(message_log_filters.combat) {\r\n            document.documentElement.style.setProperty('--message_combat_display', 'inline-block');\r\n        } else {\r\n            document.documentElement.style.setProperty('--message_combat_display', 'none');\r\n            document.getElementById(\"message_show_combat\").classList.remove(\"active_selection_button\");\r\n        }\r\n\r\n        if(message_log_filters.events) {\r\n            document.documentElement.style.setProperty('--message_events_display', 'inline-block');\r\n        } else {\r\n            document.documentElement.style.setProperty('--message_events_display', 'none');\r\n            document.getElementById(\"message_show_events\").classList.remove(\"active_selection_button\");\r\n        }\r\n\r\n        if(message_log_filters.loot) {\r\n            document.documentElement.style.setProperty('--message_loot_display', 'inline-block');\r\n        } else {\r\n            document.documentElement.style.setProperty('--message_loot_display', 'none');\r\n            document.getElementById(\"message_show_loot\").classList.remove(\"active_selection_button\");\r\n        }\r\n\r\n        if(message_log_filters.crafting) {\r\n            document.documentElement.style.setProperty('--message_crafting_display', 'inline-block');\r\n        } else {\r\n            document.documentElement.style.setProperty('--message_crafting_display', 'none');\r\n            document.getElementById(\"message_show_crafting\").classList.remove(\"active_selection_button\");\r\n        }\r\n\r\n        if(message_log_filters.background) {\r\n            document.documentElement.style.setProperty('--message_background_display', 'inline-block');\r\n        } else {\r\n            document.documentElement.style.setProperty('--message_background_display', 'none');\r\n            document.getElementById(\"message_show_background\").classList.remove(\"active_selection_button\");\r\n        }\r\n    }\r\n}\r\n\r\nfunction option_combat_autoswitch(option) {\r\n    const checkbox = document.getElementById(\"options_dont_autoswitch_to_combat\");\r\n\r\n    if(checkbox.checked || option) {\r\n        options.disable_combat_autoswitch = true;\r\n    } else {\r\n        options.disable_combat_autoswitch = false;\r\n    }\r\n\r\n    if(option !== undefined) {\r\n        checkbox.checked = option;\r\n    }\r\n}\r\n\r\nfunction option_log_all_gathering(option) {\r\n    const checkbox = document.getElementById(\"options_log_all_gathering\");\r\n\r\n    if(checkbox.checked || option) {\r\n        options.log_every_gathering_period = true;\r\n    } else {\r\n        options.log_every_gathering_period = false;\r\n    }\r\n\r\n    if(option !== undefined) {\r\n        checkbox.checked = option;\r\n    }\r\n}\r\n\r\nfunction option_log_gathering_result(option) {\r\n    const checkbox = document.getElementById(\"options_log_gathering_result\");\r\n\r\n    if(checkbox.checked || option) {\r\n        options.log_total_gathering_gain = true;\r\n    } else {\r\n        options.log_total_gathering_gain = false;\r\n    }\r\n\r\n    if(option !== undefined) {\r\n        checkbox.checked = option;\r\n    }\r\n}\r\n\r\nfunction option_expo_threshold(option) {\r\n    const input = document.getElementById(\"options_expo_threshold\");\r\n\r\n    options.expo_threshold = option || input.value || 0;\r\n\r\n    if(option !== undefined) {\r\n        input.value = option;\r\n    }\r\n    input.nextElementSibling.value = '1e'+options.expo_threshold;\r\n}\r\n\r\nfunction option_use_uncivilised_temperature_scale(option) {\r\n    const checkbox = document.getElementById(\"options_use_uncivilised_temperature_scale\");\r\n    if(checkbox.checked || option) {\r\n        options.use_uncivilised_temperature_scale = true;\r\n    } else {\r\n        options.use_uncivilised_temperature_scale = false;\r\n    }\r\n\r\n    if(option !== undefined) {\r\n        checkbox.checked = option;\r\n    }\r\n\r\n    update_displayed_temperature();\r\n}\r\n\r\nfunction option_do_background_animations(option) {\r\n    const checkbox = document.getElementById(\"options_do_background_animations\");\r\n    if(checkbox.checked || option) {\r\n        options.do_background_animations = true;\r\n    } else {\r\n        options.do_background_animations = false;\r\n        stop_background_animation();\r\n        \r\n        window.removeEventListener(\"resize\", start_snow_animation);\r\n        window.removeEventListener(\"resize\", start_rain_animation);\r\n        window.removeEventListener(\"resize\", start_stars_animation);\r\n    }\r\n\r\n    if(option !== undefined) {\r\n        checkbox.checked = option;\r\n    }\r\n}\r\n\r\nfunction option_skip_play_button(option) {\r\n    const checkbox = document.getElementById(\"options_skip_play_button\");\r\n    if(checkbox.checked || option) {\r\n        options.skip_play_button = true;\r\n    } else {\r\n        options.skip_play_button = false;\r\n    }\r\n    \r\n    if(option !== undefined) {\r\n        checkbox.checked = option;\r\n    }\r\n}\r\n\r\nfunction option_mofu_mofu_mode(option) {\r\n    const checkbox = document.getElementById(\"options_mofu_mofu_mode\");\r\n\r\n    if(option !== undefined) {\r\n        checkbox.checked = option;\r\n    }\r\n\r\n    if(checkbox.checked) {\r\n        options.mofu_mofu_mode = true;\r\n        global_flags.is_mofu_mofu_enabled = true;\r\n        language = languages.mofu_english;\r\n    } else {\r\n        options.mofu_mofu_mode = false;\r\n        global_flags.is_mofu_mofu_enabled = false;\r\n        language = languages.english;\r\n    }\r\n}\r\n\r\nfunction option_do_enemy_onhit_animations(option) {\r\n    const checkbox = document.getElementById(\"options_do_enemy_onhit_animations\");\r\n    if(checkbox.checked || option) {\r\n        options.do_enemy_onhit_animations = true;\r\n    } else {\r\n        options.do_enemy_onhit_animations = false;\r\n    }\r\n    \r\n    if(option !== undefined) {\r\n        checkbox.checked = option;\r\n    }\r\n}\r\n\r\nfunction option_hide_max_level_skills(option) {\r\n    const checkbox = document.getElementById(\"options_hide_max_level_skills\");\r\n    if(checkbox.checked || option) {\r\n        options.hide_max_level_skills = true;\r\n        document.documentElement.style.setProperty('--maxxed_skill_display', 'none');\r\n    } else {\r\n        options.hide_max_level_skills = false;\r\n        document.documentElement.style.setProperty('--maxxed_skill_display', 'block');\r\n    }\r\n    \r\n    if(option !== undefined) {\r\n        checkbox.checked = option;\r\n    }\r\n}\r\n\r\n/**\r\n * \r\n * @param {Object} params\r\n * @param {Event} params.event\r\n * @param {Boolean} params.skip_combat used to not call start_combat function, used in loading as it's only called after 'PLAY' button is clicked\r\n */\r\nfunction change_location({location_id, event, skip_travel_time = false, do_quest_events = true, skip_combat = false}) {\r\n    if(event?.target.classList.contains(\"fast_travel_removal_button\")) {\r\n        return;\r\n    }\r\n\r\n    const previous_location = current_location;\r\n    let location = locations[location_id] || current_location;\r\n\r\n    if(location_id !== current_location?.name && location.is_finished) {\r\n        //refuse to change location if it's finished and it's not the current one\r\n        return;\r\n    }\r\n\r\n    clear_all_enemy_attack_loops();\r\n    clear_character_attack_loop();\r\n    clear_enemies();\r\n\r\n    if(!location) {\r\n        throw `No such location as \"${location_id}\"`;\r\n    }\r\n\r\n    if(do_quest_events) {\r\n        do_quest_event({\r\n            quest_event_type: \"enter_location\",\r\n            quest_event_target: location.id,\r\n            quest_event_count: 1,\r\n        });\r\n    } \r\n\r\n    if(typeof current_location !== \"undefined\" && current_location.id !== location.id){\r\n        //so it's not called when initializing the location on page load or on reloading current location due to new unlocks\r\n        log_message(`[ Entering ${location.name} ]`, \"message_travel\");\r\n    }\r\n\r\n    if(location.crafting) {\r\n        update_displayed_crafting_recipes();\r\n    }\r\n    \r\n    current_location = location;\r\n\r\n    if(!pathfinder) {\r\n        pathfinder = new Pathfinder();\r\n        pathfinder.fill_connections(locations);\r\n    }\r\n\r\n    if(!travel_times[current_location.id]) {\r\n        travel_times[current_location.id] = pathfinder.find_shortest_paths(current_location.id);\r\n    }\r\n\r\n    if(previous_location && !skip_travel_time) {\r\n        progress_time({value: travel_times[previous_location.id][current_location.id], source: \"travel\"});\r\n    }\r\n\r\n    update_displayed_temperature();\r\n    update_character_stats();\r\n\r\n    if(\"connected_locations\" in current_location) { \r\n        // basically means it's a normal location and not a combat zone (as combat zone has only \"parent\")\r\n        update_displayed_normal_location(current_location);\r\n    } else { //so if entering combat zone\r\n        update_displayed_combat_location(current_location);\r\n        if(!skip_combat) {\r\n            start_combat();\r\n        }\r\n\r\n        if(!current_location.is_challenge) {\r\n            last_combat_location = current_location.id;\r\n        }\r\n    }\r\n\r\n    process_rewards({rewards: current_location.entrance_rewards});\r\n}\r\n\r\nfunction handle_location_icon_click() {\r\n    if(current_location.housing && current_location.housing.is_unlocked) {\r\n        return;\r\n        //nothing\r\n    } else if(favourite_locations[current_location.id]) {\r\n        remove_location_from_favourites({location_id: current_location.id, update_choices: false});\r\n    } else {\r\n        add_location_to_favourites({location_id: current_location.id});\r\n    }\r\n}\r\n\r\n/**\r\n * \r\n * @param {Object} selected_activity - {id} of activity in Location's activities list??\r\n */\r\nfunction start_activity(selected_activity) {\r\n    current_activity = Object.assign({},current_location.activities[selected_activity]);\r\n    current_activity.id = selected_activity;\r\n\r\n    if(!activities[current_activity.activity_name]) {\r\n        throw `No such activity as ${current_activity.activity_name} could be found`;\r\n    }\r\n\r\n    if(activities[current_activity.activity_name].type === \"JOB\") {\r\n        if(!can_work(current_activity)) {\r\n            current_activity = null;\r\n            return;\r\n        }\r\n\r\n        current_activity.earnings = 0;\r\n        current_activity.working_time = 0;\r\n\r\n    } else if(activities[current_activity.activity_name].type === \"TRAINING\") {\r\n        if(!can_work(current_activity)) {\r\n            current_activity = null;\r\n            return;\r\n        }\r\n        //\r\n    } else if(activities[current_activity.activity_name].type === \"GATHERING\") { \r\n        \r\n        let has_proper_tool = !activities[current_activity.activity_name].required_tool_type || character.equipment[activities[current_activity.activity_name].required_tool_type];\r\n        //just check if slot is not empty\r\n\r\n        if(!has_proper_tool) {\r\n            log_message(\"You need to equip a proper tool to do that!\");\r\n            current_activity = null;\r\n            return;\r\n        }\r\n        current_activity.gathered_materials = {};\r\n    } else throw `\"${activities[current_activity.activity_name].type}\" is not a valid activity type!`;\r\n\r\n    current_activity.gathering_time = 0;\r\n    if(current_activity.gained_resources) {\r\n        current_activity.gathering_time_needed = current_activity.getActivityEfficiency().gathering_time_needed;\r\n    }\r\n\r\n    add_to_content_stack({content_type: \"activity\", data: {activity: current_activity}});\r\n\r\n    //start_activity_display(current_activity);\r\n}\r\n\r\nfunction end_activity() {\r\n    \r\n    log_message(`${character.name} finished ${current_activity.activity_name}`, \"activity_finished\");\r\n    \r\n    if(current_activity.earnings) {\r\n        log_message(`${character.name} earned ${format_money(current_activity.earnings)}`, \"activity_money\");\r\n        add_money_to_character(current_activity.earnings);\r\n    }\r\n\r\n    if(current_activity.gathered_materials && options.log_total_gathering_gain) {\r\n        const loot = []; \r\n        Object.keys(current_activity.gathered_materials).forEach(mat_key => {\r\n            loot.push({item_key: mat_key, count: current_activity.gathered_materials[mat_key]});\r\n        });\r\n\r\n        log_loot({loot_list: loot, is_a_summary: true});\r\n    }\r\n    end_activity_animation(); //clears the \"animation\"\r\n    current_activity = null;\r\n    remove_from_content_stack(content_stack_removal_options.TOP);\r\n}\r\n\r\n/**\r\n * Starts selected action, checks conditions if applicable, launches action animations\r\n * @param {String} action_key\r\n * @param {String} source either \"location\" or \"dialogue\"\r\n * @returns \r\n */\r\nfunction start_game_action(action_key, event) {\r\n    current_game_action = action_key;\r\n    let game_action;\r\n    if(current_dialogue) {\r\n        game_action = dialogues[current_dialogue].actions[action_key];\r\n    } else{\r\n        game_action = current_location.actions[action_key];\r\n    }\r\n    let conditions_status; //[0,...,1]\r\n\r\n    add_to_content_stack({content_type:\"action\", data: {dialogue_key: current_dialogue, action_key: action_key}});\r\n    //start_game_action_display(selected_action);\r\n\r\n    if(!game_action.can_be_started(character)) {\r\n        finish_game_action({action_key, conditions_status: -1, dialogue_key: current_dialogue});\r\n        return;\r\n    }\r\n    \r\n    if(!game_action.check_conditions_on_finish) {\r\n        conditions_status = game_action.get_conditions_status(character);\r\n\r\n        if(conditions_status == 0) {\r\n            finish_game_action({action_key, conditions_status: 0, dialogue_key: current_dialogue});\r\n            return;\r\n        }\r\n    }\r\n\r\n    if(event && game_action.floating_click_effects) {\r\n        const random_effect = game_action.floating_click_effects[Math.floor(Math.random()*game_action.floating_click_effects.length)];\r\n        create_floating_effect(random_effect, {x: event.pageX, y: event.pageY});\r\n    }\r\n\r\n    if(game_action.attempt_duration > 0) {\r\n        let current_iterations = game_action.keep_progress?game_action.accumulated_progress:0;\r\n        const total_iterations = game_action.attempt_duration/0.1;\r\n\r\n        game_action_interval = setInterval(()=>{\r\n            if(current_iterations >= total_iterations - 1) {\r\n                clearInterval(game_action_interval);\r\n                finish_game_action({action_key, conditions_status, dialogue_key: current_dialogue});\r\n            }\r\n\r\n            current_iterations++;\r\n            if(game_action.keep_progress) {\r\n                game_action.accumulated_progress = current_iterations;\r\n            }\r\n            update_game_action_progress_bar(current_iterations/total_iterations);\r\n        }, 1000*0.1/tickrate);\r\n    } else {\r\n        update_game_action_progress_bar(1);\r\n        finish_game_action({action_key, conditions_status,dialogue_key: current_dialogue});\r\n    }\r\n}\r\n\r\n/**\r\n * Handles the finish, successful or not, of a game action. Not to be mistaken for end_game_action\r\n * @param {String} action_key \r\n * @param {Number} conditions_status\r\n * @param {String} dialogue_key optional, only passed if action is from dialogue instead of from location\r\n */\r\nfunction finish_game_action({action_key, conditions_status, dialogue_key}){\r\n    end_activity_animation(true);\r\n\r\n    let action;\r\n    if(dialogue_key) {\r\n        action = dialogues[dialogue_key].actions[action_key];\r\n    } else {\r\n        action = current_location.actions[action_key];\r\n    }\r\n\r\n    if(typeof conditions_status === 'undefined') {\r\n        if(dialogue_key) {\r\n            conditions_status = dialogues[dialogue_key].actions[action_key].get_conditions_status(character);\r\n        } else {\r\n            conditions_status = current_location.actions[action_key].get_conditions_status(character);\r\n        }\r\n    }\r\n    \r\n    let result_message = 'If you see this, Miktaew screwed something up. Whoops!';\r\n\r\n    if(conditions_status == -1) {\r\n        //not meeting requirements to begin\r\n        result_message = action.failure_texts.unable_to_begin[Math.floor(action.failure_texts.unable_to_begin.length * Math.random())];\r\n    } else if(conditions_status == 0) {\r\n        //lost by failing to meet conditions, nothing to check, deal with it\r\n        result_message = action.failure_texts.conditional_loss[Math.floor(action.failure_texts.conditional_loss.length * Math.random())];\r\n    } else {\r\n        const action_result = get_game_action_result({action_key, conditions_status, dialogue_key});\r\n        let is_won = false;\r\n        if(action_result > Math.random()) {\r\n            //win\r\n\r\n            result_message = action.success_text;\r\n            if(!action.repeatable) {\r\n                lock_action({dialogue_key, location_key: current_location.id, action_key});\r\n            } else {\r\n                action.completion_count++;\r\n            }\r\n            process_rewards({rewards: action.rewards, source_type: \"action\", source_name: dialogue_key || current_location.id});\r\n            is_won = true;\r\n        } else {\r\n            //random loss\r\n\r\n            result_message = action.failure_texts.random_loss[Math.floor(action.failure_texts.random_loss.length * Math.random())];\r\n        }\r\n\r\n        Object.keys(action.conditions[0]?.items_by_id || {}).forEach(item_id => {\r\n            //no need to check if they are in inventory, as without them action would have been conditionally failed before reaching here\r\n            if(action.conditions[0].items_by_id[item_id].remove) {\r\n                remove_from_character_inventory([{item_key: item_templates[item_id].getInventoryKey(), item_count: action.conditions[0].items_by_id[item_id].count}]);\r\n            }\r\n        });\r\n        Object.keys(action.required.items_by_id || {}).forEach(item_id => {\r\n            //again no need to check\r\n            if(action.required.items_by_id[item_id].remove_on_success && is_won || action.required.items_by_id[item_id].remove_on_fail && !is_won) {\r\n                remove_from_character_inventory([{item_key: item_templates[item_id].getInventoryKey(), item_count: action.required.items_by_id[item_id].count}]);\r\n            }\r\n        });\r\n    }\r\n\r\n    update_game_action_finish_button();\r\n\r\n    if(!dialogue_key) {\r\n        set_game_action_finish_text(result_message);\r\n    } else {\r\n        pass_data_down_the_content_stack({data: {upstack_result_message: result_message}});\r\n\r\n        if(action.attempt_duration == 0) { //if action is instant, just jump back to dialogue without bothering with display of results, leave that stuff to dialogue answer\r\n            remove_from_content_stack(content_stack_removal_options.TOP);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Handles quitting a game action, no matter the results. Not to be mistaken for finish_game_action which deals with what happens on timer finish (and with the results)\r\n */\r\nfunction end_game_action() {\r\n    end_activity_animation();\r\n    clearInterval(game_action_interval);\r\n    current_game_action = null;\r\n    remove_from_content_stack(content_stack_removal_options.TOP);\r\n}\r\n\r\n/**\r\n * \r\n * @param {String} action_key \r\n * @param {Number} conditions_status assumed to be more than 0\r\n * @param {String} dialogue_key\r\n * @returns {Boolean} did_succeed\r\n */\r\nfunction get_game_action_result({action_key, conditions_status, dialogue_key}) {\r\n    let action;\r\n    if(dialogue_key) {\r\n        action = dialogues[dialogue_key].actions[action_key];\r\n    } else {\r\n        action = current_location.actions[action_key];\r\n    }\r\n    if(action.success_chances.length == 1) {\r\n        return action.success_chances[0];\r\n    } else if(conditions_status == 1 && action.success_chances[1]) {\r\n        return action.success_chances[1];\r\n    } else {\r\n        return action.success_chances[0] + (action.success_chances[1]-action.success_chances[0]) * conditions_status;\r\n    }\r\n}\r\n\r\n/**\r\n * @description Globally unlocks an activity and adds a proper message to the message log, local children might still need to be unlocked separately. NOT called on loading a save.\r\n * @param {String} activity_id\r\n */\r\nfunction unlock_global_activity({activity_id}) {\r\n    if(!activities[activity_id].is_unlocked){\r\n        activities[activity_id].is_unlocked = true;\r\n        \r\n        let message = \"\";\r\n        if(activities[activity_id].unlock_text) {\r\n           message = activities[activity_id].unlock_text+\":<br>\";\r\n        }\r\n        log_message(message + `Gained the ability of \"${activities[activity_id].name}\"`, \"activity_unlocked\");\r\n    }\r\n}\r\n\r\n/**\r\n * @description Unlocks an activity and adds a proper message to the message log. NOT called on loading a save.\r\n * @param {Object} activity_data {activity, location_name}\r\n */\r\nfunction unlock_activity(activity_data) {\r\n    if(!activity_data.activity.is_unlocked){\r\n        activity_data.activity.is_unlocked = true;\r\n        \r\n        if(!activity_data.skip_message) {\r\n            let message = \"\";\r\n            if(locations[activity_data.location].activities[activity_data.activity.activity_id].unlock_text) {\r\n                message = locations[activity_data.location].activities[activity_data.activity.activity_id].unlock_text+\":<br>\";\r\n            }\r\n            if(activities[activity_data.activity.activity_name].type !== \"GATHERING\" || global_flags.is_gathering_unlocked) {\r\n                log_message(message + `Unlocked activity \"${activity_data.activity.activity_name}\" in location \"${activity_data.location}\"`, \"activity_unlocked\");\r\n            }\r\n        }\r\n        \r\n    }\r\n}\r\n\r\nfunction unlock_action(action_data) {\r\n    if(!action_data.action.is_unlocked) {\r\n        action_data.action.is_unlocked = true;\r\n        \r\n        if(!action_data.skip_message) {\r\n            let message = \"\";\r\n            if(action_data.location) {\r\n                if(locations[action_data.location].actions[action_data.action.action_id].unlock_text) {\r\n                    message = locations[action_data.location].actions[action_data.action.action_id].unlock_text+\":<br>\";\r\n                    log_message(message + `Unlocked action \"${action_data.action.action_name}\" in location \"${action_data.location}\"`, \"activity_unlocked\");\r\n                }\r\n            } else if(action_data.dialogue) {\r\n                if(dialogues[action_data.dialogue].actions[action_data.action.action_id].unlock_text) {\r\n                    message = dialogues[action_data.dialogue].actions[action_data.action.action_id].unlock_text+\":<br>\";\r\n                    log_message(message + `Unlocked action \"${action_data.action.action_name}\" wit \"${action_data.dialogue}\"`, \"activity_unlocked\");\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction lock_action({location_key, dialogue_key, action_key}) {\r\n    if(dialogue_key) {\r\n        dialogues[dialogue_key].actions[action_key].is_finished = true;\r\n    } else  {\r\n        locations[location_key].actions[action_key].is_finished = true;\r\n    }\r\n}\r\n\r\nfunction add_money_to_character(money_num) {\r\n    character.money += money_num;\r\n    update_displayed_money();\r\n}\r\n\r\n/**\r\n * @description Handles health change from beneficial and harmful sources\r\n * @param {Object} params\r\n * @param {Number} params.ammount \r\n * @param {Boolean} params.add_xp \r\n * @param {Number} params.xp_to_add skippable\r\n * @returns \r\n */\r\nfunction update_health({ammount_to_restore = 0, ammount_to_loose = 0, add_xp = true} = {}) {\r\n    if(!ammount_to_restore && !ammount_to_loose) {\r\n        //no change, nothing to do\r\n        return;\r\n    }\r\n\r\n    //actual change: smaller between missing and balance of lose/restoration\r\n    const actual_health_change = Math.min(character.stats.full.max_health - character.stats.full.health, ammount_to_restore-ammount_to_loose);\r\n    //actual healing: smaller between missing+lose and restoration\r\n    const actual_healing_done = Math.min(character.stats.full.max_health - character.stats.full.health + ammount_to_loose, ammount_to_restore);\r\n\r\n    //anything changed - update health and display\r\n    if(actual_health_change) {\r\n        character.stats.full.health += actual_health_change;\r\n\r\n        update_displayed_health();\r\n    }\r\n\r\n    //anything actually healed - add xp\r\n    if(actual_healing_done && add_xp && actual_healing_done > 0) {\r\n        add_xp_to_skill({skill: skills[\"Regeneration\"], xp_to_add: actual_healing_done});\r\n    }\r\n\r\n    //out of hp - set hp to 0, kill\r\n    if(character.stats.full.health <= 0) {\r\n        character.stats.full.health = 0;\r\n        kill_player({is_combat: \"parent_location\" in current_location});\r\n    }\r\n}\r\n\r\n//single tick of resting\r\nfunction do_resting() {\r\n    if(character.stats.full.health < character.stats.full.max_health) {\r\n        const resting_heal_ammount =  Math.round(Math.max(character.stats.full.max_health * 0.01, 2) * (1 + 3*get_total_skill_level(\"Regeneration\")/skills[\"Regeneration\"].max_level));\r\n\r\n        update_health({ammount_to_restore: resting_heal_ammount});\r\n    }\r\n\r\n    if(character.stats.full.stamina < character.stats.full.max_stamina) {\r\n        const resting_stamina_ammount = Math.round(Math.max(character.stats.full.max_stamina/120, 2)); \r\n        //todo: scale it with skill as well\r\n\r\n        character.stats.full.stamina += (resting_stamina_ammount);\r\n        if(character.stats.full.stamina > character.stats.full.max_stamina) {\r\n            character.stats.full.stamina = character.stats.full.max_stamina;\r\n        } \r\n        \r\n        update_displayed_stamina();\r\n    }\r\n}\r\n\r\nfunction do_sleeping() {\r\n    if(character.stats.full.health < character.stats.full.max_health) {\r\n        const sleeping_heal_ammount = Math.round(Math.max(character.stats.full.max_health * 0.04, 5) * (1 + get_total_skill_level(\"Sleeping\")/skills[\"Sleeping\"].max_level) * (1 + 3*get_total_skill_level(\"Regeneration\")/skills[\"Regeneration\"].max_level));\r\n        \r\n        update_health({ammount_to_restore: sleeping_heal_ammount});\r\n    }\r\n\r\n    if(character.stats.full.stamina < character.stats.full.max_stamina) {\r\n        const sleeping_stamina_ammount = Math.round(Math.max(character.stats.full.max_stamina/30, 5) * (1 + get_total_skill_level(\"Sleeping\")/skills[\"Sleeping\"].max_level)); \r\n\r\n        character.stats.full.stamina += (sleeping_stamina_ammount);\r\n        if(character.stats.full.stamina > character.stats.full.max_stamina) {\r\n            character.stats.full.stamina = character.stats.full.max_stamina;\r\n        } \r\n        update_displayed_stamina();\r\n    }\r\n}\r\n\r\nfunction start_sleeping() {\r\n    start_sleeping_display();\r\n    is_sleeping = true;\r\n\r\n    last_location_with_bed = current_location.id;\r\n}\r\n\r\nfunction end_sleeping() {\r\n    is_sleeping = false;\r\n    change_location({location_id: current_location.id, skip_travel_time: true});\r\n    end_activity_animation();\r\n}\r\n\r\nfunction start_reading(book_key) {\r\n    \r\n    const book_id = is_JSON(book_key)?JSON.parse(book_key).id:book_key;\r\n    if(current_location?.parent_location) {\r\n        return; //no reading in combat areas\r\n    }\r\n\r\n    if(is_reading === book_id) {\r\n        end_reading();\r\n        return; \r\n        //reading the same one, cancel\r\n    } else if(is_reading) {\r\n        end_reading();\r\n    }\r\n\r\n    if(book_stats[book_id].is_finished) {\r\n        return; //already read\r\n    }\r\n\r\n    if(is_sleeping) {\r\n        end_sleeping();\r\n    }\r\n    if(current_activity) {\r\n        end_activity();\r\n    }\r\n\r\n\r\n    is_reading = book_id;\r\n    start_reading_display(book_id);\r\n\r\n    update_displayed_book(is_reading);\r\n}\r\n\r\nfunction end_reading() {\r\n    change_location({location_id: current_location.id, skip_travel_time: true});\r\n    end_activity_animation();\r\n    \r\n    const book_id = is_reading;\r\n    is_reading = null;\r\n\r\n    update_displayed_book(book_id);\r\n}\r\n\r\nfunction do_reading() {\r\n    item_templates[is_reading].addProgress();\r\n\r\n    update_displayed_book(is_reading);\r\n    const book = book_stats[is_reading];\r\n    add_xp_to_skill({skill: skills[\"Literacy\"], xp_to_add: book.literacy_xp_rate});\r\n\r\n    if(book.is_finished) {\r\n        log_message(`Finished the book \"${is_reading}\"`);\r\n        update_booklist_entry(is_reading, true);\r\n        end_reading();\r\n\r\n        character.stats.add_book_bonus(book.bonuses);\r\n        update_character_stats();\r\n        process_rewards({rewards: book.rewards});\r\n    }\r\n}\r\n\r\nfunction get_current_book() {\r\n    return is_reading;\r\n}\r\n\r\n/**\r\n * \r\n * @param {*} selected_activity location activity property (job or training)\r\n * @returns if current time is within working hours\r\n */\r\nfunction can_work(selected_activity) {\r\n    //if can start at all\r\n    if(!selected_activity.infinite) {\r\n        if(selected_activity.availability_time){\r\n            if(selected_activity.availability_time.end > selected_activity.availability_time.start) {\r\n                //ends on the same day\r\n                if(current_game_time.hour * 60 + current_game_time.minute > selected_activity.availability_time.end*60\r\n                    ||  //too late\r\n                    current_game_time.hour * 60 + current_game_time.minute < selected_activity.availability_time.start*60\r\n                    ) {  //too early\r\n                    \r\n                    return false;\r\n                }\r\n                if(!selected_activity.availability_seasons?.includes(current_game_time.getSeason())) {\r\n                    //can't be done in current season\r\n                    return false;\r\n                }  \r\n            } else { //ends on the next day (i.e. working through the night)\r\n                if(!selected_activity.availability_seasons?.includes(current_game_time.getSeason(1))) {\r\n                    //ends on new season during which it's not available\r\n                    return false;\r\n                }  \r\n\r\n                if(current_game_time.hour * 60 + current_game_time.minute > selected_activity.availability_time.start*60\r\n                    //too late\r\n                    ||\r\n                    current_game_time.hour * 60 + current_game_time.minute < selected_activity.availability_time.end*60\r\n                    //too early\r\n\r\n                ) {  \r\n                    return false;\r\n                }\r\n            }\r\n        } else {\r\n            if(!selected_activity.availability_seasons?.includes(current_game_time.getSeason())) {\r\n                //can't be done in current season\r\n                return false;\r\n            }  \r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * \r\n * @param {} selected_job location job property\r\n * @returns if there's enough time to earn anything\r\n */\r\nfunction enough_time_for_earnings(selected_job) {\r\n\r\n    if(!selected_job.infinite) {\r\n        //if enough time for at least 1 working period\r\n        if(selected_job.availability_time.end > selected_job.availability_time.start) {\r\n            //ends on the same day\r\n            if(current_game_time.hour * 60 + current_game_time.minute + selected_job.working_period - selected_job.working_time%selected_job.working_period > selected_job.availability_time.end*60\r\n                ||  //not enough time left for another work period\r\n                current_game_time.hour * 60 + current_game_time.minute < selected_job.availability_time.start*60\r\n                ) {  //too early to start (shouldn't be allowed to start and get here at all)\r\n                return false;\r\n            }\r\n        } else {\r\n            //ends on the next day (i.e. working through the night)\r\n  \r\n            if(!selected_job.availability_time.includes(current_game_time.getSeason(1))) {\r\n                //ends on new season during which it's not available\r\n                return false;\r\n            } \r\n\r\n            if(current_game_time.hour * 60 + current_game_time.minute > selected_job.availability_time.start*60\r\n                //timer is past the starting hour, so it's the same day as job starts\r\n                && \r\n                current_game_time.hour * 60 + current_game_time.minute + selected_job.working_period  - selected_job.working_time%selected_job.working_period > selected_job.availability_time.end*60 + 24*60\r\n                //time available on this day + time available on next day are less than time needed\r\n                ||\r\n                current_game_time.hour * 60 + current_game_time.minute < selected_job.availability_time.start*60\r\n                //timer is less than the starting hour, so it's the next day\r\n                &&\r\n                current_game_time.hour * 60 + current_game_time.minute + selected_job.working_period  - selected_job.working_time%selected_job.working_period > selected_job.availability_time.end*60\r\n                //time left on this day is not enough to finish\r\n                ) {  \r\n                return false;\r\n            }\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * \r\n * @param {String} dialogue_key \r\n */\r\nfunction start_dialogue(dialogue_key) {\r\n    add_to_content_stack({content_type: \"dialogue\", data: {dialogue_key: dialogue_key}});\r\n}\r\n\r\nfunction end_dialogue() {\r\n    current_dialogue = null;\r\n    remove_from_content_stack(content_stack_removal_options.TOP);\r\n}\r\n\r\nfunction reload_normal_location() {\r\n    update_displayed_normal_location(current_location);\r\n}\r\n\r\n/**\r\n * \r\n * @param {String} textline_key \r\n */\r\nfunction start_textline(textline_key){\r\n    const dialogue = dialogues[current_dialogue];\r\n    const textline = dialogue.textlines[textline_key];\r\n\r\n    process_rewards({rewards: textline.rewards, source_type: \"textline\", inform_textline: false, source_name: current_dialogue})\r\n\r\n    if(textline.otherUnlocks) {\r\n        textline.otherUnlocks();\r\n    }\r\n\r\n    \r\n    //start_dialogue(current_dialogue);\r\n    let text = get_textline_answer(textline);\r\n\r\n    //a very stupid easter egg that totally won't be annoying - 1% chance to have a random word in dialogue replaced with \"rat\" if your hero's name contains that word\r\n    if(is_rat()) {\r\n        if(Math.random() <= 0.01) {\r\n            const words = text.split(\" \");\r\n            const index = Math.floor(words.length * Math.random());\r\n            words[index] = \"rat\";\r\n            text = words.join(\" \");\r\n        }\r\n    }\r\n\r\n    if(textline.branches_into?.length) {\r\n        fill_action_box({content_type: \"dialogue_branch\", data: {text: text, dialogue_key: current_dialogue, textlines: textline.branches_into}});\r\n    } else {\r\n        fill_action_box({content_type: \"dialogue_answer\", data: {text: text, dialogue_key: current_dialogue}});\r\n    }\r\n}\r\n\r\n/**\r\n * Attaches some context to textline's .getText()\r\n * @param {Textline} textline \r\n * @returns textline answer\r\n */\r\nfunction get_textline_answer(textline) {\r\n    return textline.getText({\r\n            season: current_game_time.getSeason(),\r\n            //to be expanded with more stuff when needed\r\n        });\r\n}\r\n\r\nfunction unlock_combat_stance(stance_id) {\r\n    if(!stances[stance_id]) {\r\n        console.warn(`Tried to unlock stance \"${stance_id}\", but no such stance exists!`);\r\n        return;\r\n    }\r\n\r\n    if(!stances[stance_id].is_unlocked) {\r\n        log_message(`You have learned a new stance: \"${stances[stance_id].name}\"`, \"location_unlocked\");\r\n    }\r\n    stances[stance_id].is_unlocked = true;\r\n    update_displayed_stance_list(stances, current_stance, faved_stances);\r\n}\r\n\r\nfunction change_stance({stance_id, is_temporary = false}) {\r\n    if(is_temporary) {\r\n        if(!stances[stance_id]) {\r\n            throw new Error(`No such stance as \"${stance_id}\"`);\r\n        }\r\n        if(!stances[stance_id].is_unlocked) {\r\n            throw new Error(`Stance \"${stance_id}\" is not yet unlocked!`);\r\n        }\r\n\r\n    } else {\r\n        selected_stance = stances[stance_id];\r\n        update_displayed_stance(selected_stance);\r\n    }\r\n    \r\n    current_stance = stances[stance_id];\r\n\r\n    update_character_stats();\r\n    reset_combat_loops(true); //param will be used to award 'Persistence' xp only when change was due to low stamina and not to a player click\r\n}\r\n\r\n/**\r\n * @description handle faving/unfaving of stances\r\n * @param {String} stance_id \r\n */\r\nfunction fav_stance(stance_id) {\r\n    if(faved_stances[stance_id]) {\r\n        delete faved_stances[stance_id];\r\n    } else if(stances[stance_id].is_unlocked){\r\n        faved_stances[stance_id] = true;\r\n    } else {\r\n        console.warn(`Tried to fav a stance '${stance_id}' despite it not being unlocked!`);\r\n    }\r\n    update_displayed_faved_stances(stances);\r\n}\r\n\r\n/**\r\n * @description sets attack cooldowns and new enemies, either from provided list or from current location, called whenever a new enemy group starts\r\n * @param {List<Enemy>} enemies \r\n */\r\nfunction set_new_combat({enemies} = {}) {\r\n    if(!current_location.get_next_enemies){\r\n        clear_all_enemy_attack_loops();\r\n        clear_character_attack_loop();\r\n        return;\r\n    }\r\n\r\n    //remove animations\r\n    for(let i = 0; i < current_enemies?.length; i++) {\r\n        remove_enemy_onhit_animation(i);\r\n    }\r\n\r\n    current_enemies = enemies || current_location.get_next_enemies();\r\n    clear_all_enemy_attack_loops();\r\n\r\n    let character_attack_cooldown = 1/(character.stats.full.attack_speed);\r\n    enemy_attack_cooldowns = [...current_enemies.map(x => 1/x.stats.attack_speed)];\r\n\r\n    let fastest_cooldown = [character_attack_cooldown, ...enemy_attack_cooldowns].sort((a,b) => a - b)[0];\r\n\r\n    //scale all attacks to be not faster than 1 per second\r\n    if(fastest_cooldown < 1) {\r\n        const cooldown_multiplier = 1/fastest_cooldown;\r\n        \r\n        character_attack_cooldown *= cooldown_multiplier;\r\n        for(let i = 0; i < current_enemies.length; i++) {\r\n            enemy_attack_cooldowns[i] *= cooldown_multiplier;\r\n            enemy_timer_variance_accumulator[i] = 0;\r\n            enemy_timer_adjustment[i] = 0;\r\n            enemy_timers[i] = [Date.now(), Date.now()];\r\n        }\r\n    } else {\r\n        for(let i = 0; i < current_enemies.length; i++) {\r\n            enemy_timer_variance_accumulator[i] = 0;\r\n            enemy_timer_adjustment[i] = 0;\r\n            enemy_timers[i] = [Date.now(), Date.now()];\r\n        }\r\n    }\r\n    character_timer_variance_accumulator = 0;\r\n    character_timer_adjustment = 0;\r\n    character_timers = [Date.now(), Date.now()];\r\n\r\n    //attach loops and animations\r\n    for(let i = 0; i < current_enemies.length; i++) {\r\n        if(options.do_enemy_onhit_animations) {\r\n            do_enemy_onstart_animation(i);\r\n        }\r\n        \r\n        do_enemy_attack_loop(i, 0, true);\r\n    }\r\n\r\n    set_character_attack_loop({base_cooldown: character_attack_cooldown});\r\n    \r\n    update_displayed_enemies();\r\n    update_displayed_health_of_enemies();\r\n}\r\n\r\n/**\r\n * @description Recalculates attack speeds;\r\n * \r\n * For enemies, modifies their existing cooldowns, for hero it restarts the attack bar with a new cooldown \r\n */\r\nfunction reset_combat_loops(skip_persistence_xp_for_stance_change) {\r\n    if(!current_enemies) { \r\n        return;\r\n    }\r\n\r\n    let character_attack_cooldown = 1/(character.stats.full.attack_speed);\r\n    enemy_attack_cooldowns = [...current_enemies.map(x => 1/x.stats.attack_speed)];\r\n\r\n    let fastest_cooldown = [character_attack_cooldown, ...enemy_attack_cooldowns].sort((a,b) => a - b)[0];\r\n\r\n    //scale all attacks to be not faster than 1 per second\r\n    if(fastest_cooldown < 1) {\r\n        const cooldown_multiplier = 1/fastest_cooldown;\r\n        character_attack_cooldown *= cooldown_multiplier;\r\n        for(let i = 0; i < current_enemies.length; i++) {\r\n            enemy_attack_cooldowns[i] *= cooldown_multiplier;\r\n        }\r\n    }\r\n\r\n    set_character_attack_loop({base_cooldown: character_attack_cooldown, skip_persistence_xp_for_stance_change});\r\n}\r\n\r\n/**\r\n * @description Creates an Interval responsible for performing the attack loop of enemy and updating their attack_bar progress\r\n * @param {*} enemy_id \r\n * @param {*} cooldown \r\n */\r\nfunction do_enemy_attack_loop(enemy_id, count, is_new = false) {\r\n    count = count || 0;\r\n    update_enemy_attack_bar(enemy_id, count/60);\r\n\r\n    if(is_new) {\r\n        enemy_timer_variance_accumulator[enemy_id] = 0;\r\n        enemy_timer_adjustment[enemy_id] = 0;\r\n    }\r\n\r\n    clearTimeout(enemy_attack_loops[enemy_id]);\r\n    enemy_attack_loops[enemy_id] = setTimeout(() => {\r\n        enemy_timers[enemy_id][0] = Date.now(); \r\n        enemy_timer_variance_accumulator[enemy_id] += ((enemy_timers[enemy_id][0] - enemy_timers[enemy_id][1]) - enemy_attack_cooldowns[enemy_id]*1000/(60*tickrate));\r\n\r\n        enemy_timers[enemy_id][1] = Date.now();\r\n        update_enemy_attack_bar(enemy_id, count/60);\r\n        count++;\r\n        if(count >= 60) {\r\n            count = 0;\r\n            do_enemy_combat_action(enemy_id);\r\n        }\r\n        do_enemy_attack_loop(enemy_id, count);\r\n\r\n        if(enemy_timer_variance_accumulator[enemy_id] <= maximum_time_correction/tickrate && enemy_timer_variance_accumulator[enemy_id] >= -maximum_time_correction/tickrate) {\r\n            enemy_timer_adjustment[enemy_id] = enemy_timer_variance_accumulator[enemy_id];\r\n        } else {\r\n            if(enemy_timer_variance_accumulator[enemy_id] > maximum_time_correction/tickrate) {\r\n                enemy_timer_adjustment[enemy_id] = maximum_time_correction/tickrate;\r\n            }\r\n            else {\r\n                if(enemy_timer_variance_accumulator[enemy_id] < -maximum_time_correction/tickrate) {\r\n                    enemy_timer_adjustment[enemy_id] = -maximum_time_correction/tickrate;\r\n                }\r\n            }\r\n        } //limits the maximum correction, just to be safe\r\n\r\n    }, enemy_attack_cooldowns[enemy_id]*1000/(60*tickrate) - enemy_timer_adjustment[enemy_id]);\r\n}\r\n\r\nfunction clear_enemy_attack_loop(enemy_id) {\r\n    clearTimeout(enemy_attack_loops[enemy_id]);\r\n}\r\n\r\n/**\r\n * \r\n * @param {Number} base_cooldown basic cooldown based on attack speeds of enemies and character (ignoring stamina penalty) \r\n * @param {String} attack_type type of attack, not yet implemented\r\n */\r\nfunction set_character_attack_loop({base_cooldown, skip_persistence_xp_for_stance_change}) {\r\n    clear_character_attack_loop();\r\n\r\n    //little safety, as this function would occasionally throw an error due to not having any enemies left \r\n    //(can happen on forced leave after first win)\r\n    if(!current_enemies) {\r\n        return;\r\n    }\r\n\r\n    //tries to switch stance back to the one that was actually selected if there's enough stamina, otherwise tries to switch stance to \"normal\" if not enough stamina\r\n    if(character.stats.full.stamina >= (selected_stance.stamina_cost / character.stats.full.stamina_efficiency)){ \r\n        if(selected_stance.id !== current_stance.id) {\r\n            change_stance({stance_id: selected_stance.id});\r\n            return;\r\n        }\r\n    } else if(current_stance.id !== \"normal\") {\r\n        change_stance({stance_id: \"normal\", is_temporary: true});\r\n        return;\r\n    }\r\n\r\n    let target_count = current_stance.target_count;\r\n    if(target_count > 1 && current_stance.related_skill) {\r\n        target_count = target_count + Math.round(target_count * get_total_skill_level(current_stance.related_skill)/skills[current_stance.related_skill].max_level);\r\n    }\r\n\r\n    if(current_stance.randomize_target_count) {\r\n        target_count = Math.floor(Math.random()*target_count) || 1;\r\n    }\r\n\r\n    let targets = [];\r\n    const alive_targets = current_enemies.filter(enemy => enemy.is_alive).slice(-target_count);\r\n\r\n    while(alive_targets.length>0) {\r\n        targets.push(alive_targets.pop());\r\n    }\r\n\r\n    use_stamina({stamina_to_use: current_stance.stamina_cost, skip_persistence_xp_for_stance_change});\r\n    let actual_cooldown = base_cooldown / character.get_stamina_multiplier();\r\n\r\n    let attack_power = character.get_attack_power();\r\n    do_character_attack_loop({base_cooldown, actual_cooldown, attack_power, targets, target_count});\r\n}\r\n\r\n/**\r\n * @description updates character's attack bar, performs combat action when it reaches full\r\n * @param {Number} base_cooldown \r\n * @param {Number} actual_cooldown \r\n * @param {String} attack_power \r\n * @param {String} attack_type \r\n */\r\nfunction do_character_attack_loop({base_cooldown, actual_cooldown, attack_power, targets, count = 0, is_new = true, target_count = 1, do_quest_events = true}) {\r\n    update_character_attack_bar(count/60);\r\n\r\n    if(is_new) {\r\n        character_timer_variance_accumulator = 0;\r\n        character_timer_adjustment = 0;\r\n    }\r\n\r\n    clear_character_attack_loop();\r\n    character_attack_loop = setTimeout(() => {\r\n        character_timers[0] = Date.now(); \r\n        character_timer_variance_accumulator += ((character_timers[0] - character_timers[1]) - actual_cooldown*1000/(60*tickrate));\r\n\r\n        character_timers[1] = Date.now();\r\n        update_character_attack_bar(count/60);\r\n        count++;\r\n        if(count >= 60) {\r\n            count = 0;\r\n            let leveled = false;\r\n\r\n            for(let i = 0; i < targets.length; i++) {\r\n                do_character_combat_action({target: targets[i], attack_power, target_count: targets.length});\r\n            }\r\n\r\n            if(current_stance.related_skill) {\r\n                leveled = add_xp_to_skill({skill: skills[current_stance.related_skill], xp_to_add: targets.reduce((sum,enemy)=>sum+enemy.xp_value,0)/targets.length});\r\n                \r\n                if(leveled) {\r\n                    update_stance_tooltip(current_stance);\r\n                    update_character_stats();\r\n                }\r\n            }\r\n\r\n            if(current_enemies.filter(enemy => enemy.is_alive).length != 0) { //set next loop if there's still an enemy left;\r\n                set_character_attack_loop({base_cooldown});\r\n            } else { //all enemies defeated, do relevant things and set new combat\r\n                current_location.enemy_groups_killed += 1;\r\n                if(current_location.enemy_groups_killed > 0 && current_location.enemy_groups_killed % current_location.enemy_count == 0) {\r\n                    get_location_rewards(current_location);\r\n\r\n                    if(do_quest_events) {\r\n                        do_quest_event({\r\n                            quest_event_type: \"clear\",\r\n                            quest_event_target: current_location.id,\r\n                            quest_event_count: 1,\r\n                        });\r\n                    }\r\n                }\r\n                update_location_kill_count(current_location);\r\n                set_new_combat();\r\n            }\r\n        } else {\r\n            do_character_attack_loop({base_cooldown, actual_cooldown, attack_power, targets, target_count, count, is_new: false});\r\n        }\r\n\r\n        if(character_timer_variance_accumulator <= maximum_time_correction/tickrate && character_timer_variance_accumulator >= -maximum_time_correction/tickrate) {\r\n            character_timer_adjustment = character_timer_variance_accumulator;\r\n        } else {\r\n            if(character_timer_variance_accumulator > maximum_time_correction/tickrate) {\r\n                character_timer_adjustment = maximum_time_correction/tickrate;\r\n            }\r\n            else {\r\n                if(character_timer_variance_accumulator < -maximum_time_correction/tickrate) {\r\n                    character_timer_adjustment = -maximum_time_correction/tickrate;\r\n                }\r\n            }\r\n        } //limits the maximum correction, just to be safe\r\n    }, actual_cooldown*1000/(60*tickrate) - character_timer_adjustment);\r\n}\r\n\r\nfunction clear_character_attack_loop() {\r\n    clearTimeout(character_attack_loop);\r\n}\r\n\r\nfunction clear_all_enemy_attack_loops() {\r\n    Object.keys(enemy_attack_loops).forEach((key) => {\r\n        clearTimeout(enemy_attack_loops[key]);\r\n    });\r\n}\r\n\r\nfunction start_combat() {\r\n    if(current_enemies == null) {\r\n        set_new_combat();\r\n    }\r\n}\r\n\r\n/**\r\n * performs a single combat action (that is attack, as there isn't really any other kind for now),\r\n * called when attack cooldown finishes\r\n * \r\n * @param {String} attacker id of enemy\r\n*/ \r\nfunction do_enemy_combat_action(enemy_id) {\r\n    \r\n    /*\r\n    tiny workaround, as character being defeated while facing multiple enemies,\r\n    sometimes results in enemy attack animation still finishing before character retreats,\r\n    launching this function and causing an error\r\n    */\r\n    if(!current_enemies) { \r\n        return;\r\n    }\r\n\r\n    const enemy_count_xp_mod = current_enemies.filter(enemy => enemy.is_alive).length**(2/3);\r\n    \r\n    const attacker = current_enemies[enemy_id];\r\n\r\n    let evasion_chance_modifier = current_enemies.filter(enemy => enemy.is_alive).length**(-1/3); //down to .5 if there's full 8 enemies (multiple attackers make it harder to evade attacks)\r\n    let defense_modifier = 0;\r\n    \r\n    Object.keys(attacker.tags).forEach(enemy_tag => {\r\n        if(enemy_tag_to_skill_mapping[enemy_tag]) {\r\n            for(let i = 0; i < enemy_tag_to_skill_mapping[enemy_tag].length; i++) {\r\n                const skill = skills[enemy_tag_to_skill_mapping[enemy_tag][i]];\r\n                add_xp_to_skill({skill, xp_to_add: attacker.xp_value/enemy_count_xp_mod});\r\n                const {modifier_to_evasion, modifier_to_defense} = skill.get_stat_modifiers();\r\n                evasion_chance_modifier *= modifier_to_evasion || 1;\r\n                defense_modifier += modifier_to_defense || 1;\r\n            }\r\n        }\r\n    });\r\n\r\n    const enemy_base_damage = attacker.stats.attack;\r\n\r\n    let damages_dealt = [];\r\n\r\n    let critted = false;\r\n\r\n    let partially_blocked = false; //only used for combat info in message log\r\n\r\n    for(let i = 0; i < attacker.stats.attack_count; i++) {\r\n        damages_dealt.push(enemy_base_damage * (1.2 - Math.random() * 0.4)); //basic 20% deviation for damage\r\n    }\r\n\r\n    damages_dealt = damages_dealt.sort((a,b)=>b-a);\r\n    \r\n    if(character.equipment[\"off-hand\"]?.offhand_type === \"shield\") { //HAS SHIELD\r\n        if(character.stats.full.block_chance > Math.random()) {//BLOCKED THE ATTACK\r\n\r\n            damages_dealt = damages_dealt.map(x => x*(1-get_total_skill_level(\"Shield blocking\")/100));\r\n\r\n            add_xp_to_skill({skill: skills[\"Shield blocking\"], xp_to_add: attacker.xp_value/enemy_count_xp_mod});\r\n            const blocked = character.equipment[\"off-hand\"].getShieldStrength() * (character.equipment[\"off-hand\"].tags.ignore_skill?1:character.stats.total_multiplier.block_strength);\r\n\r\n            if(blocked > damages_dealt[0]) {\r\n                log_message(character.name + \" blocked an attack\", \"hero_blocked\");\r\n                return; //damage fully blocked, nothing more can happen \r\n            } else {\r\n                damages_dealt = damages_dealt.map(val => Math.max(0,val-blocked));\r\n                partially_blocked = true;\r\n            }\r\n         } else {\r\n            add_xp_to_skill({skill: skills[\"Shield blocking\"], xp_to_add: attacker.xp_value/(2*enemy_count_xp_mod)});\r\n         }\r\n    } else { // HAS NO SHIELD\r\n        const hit_chance = get_hit_chance(attacker.stats.dexterity * Math.sqrt(attacker.stats.intuition ?? 1), character.stats.full.evasion_points*evasion_chance_modifier);\r\n\r\n        if(hit_chance < Math.random()) { //EVADED ATTACK\r\n            const xp_to_add = character.wears_armor() ? attacker.xp_value : attacker.xp_value * 1.5; \r\n            //50% more evasion xp if going without armor\r\n            add_xp_to_skill({skill: skills[\"Evasion\"], xp_to_add: xp_to_add/enemy_count_xp_mod});\r\n            log_message(character.name + \" evaded an attack\", \"enemy_missed\");\r\n            return; //damage fully evaded, nothing more can happen\r\n        } else {\r\n            add_xp_to_skill({skill: skills[\"Evasion\"], xp_to_add: attacker.xp_value/(2*enemy_count_xp_mod)});\r\n        }\r\n    }\r\n\r\n    total_hits_taken++;\r\n    if(enemy_crit_chance > Math.random()){\r\n        damages_dealt = damages_dealt.map(val => val*enemy_crit_damage);\r\n        critted = true;\r\n        total_crits_taken++;\r\n    }\r\n\r\n    if(!character.wears_armor()) //no armor so either completely naked or in things with 0 def\r\n    {\r\n        add_xp_to_skill({skill: skills[\"Iron skin\"], xp_to_add: attacker.xp_value/enemy_count_xp_mod});\r\n    } \r\n    \r\n    let {damage_taken, fainted} = character.take_damage({damage_values: damages_dealt, defense_modifier});\r\n\r\n    add_xp_to_skill({skill: skills[\"Fortitude\"], xp_to_add: (damage_taken**0.6)/enemy_count_xp_mod});\r\n\r\n    const hit_count_msg = damages_dealt.length > 1?` x${damages_dealt.length}`:\"\";\r\n\r\n    if(critted) {\r\n        if(partially_blocked) {\r\n            log_message(character.name + \" partially blocked, was critically hit\" + hit_count_msg + \" for \" + Math.ceil(10*damage_taken)/10 + \" dmg\", \"hero_attacked_critically\");\r\n        } \r\n        else {\r\n            log_message(character.name + \" was critically hit\" + hit_count_msg + \" for \" + Math.ceil(10*damage_taken)/10 + \" dmg\", \"hero_attacked_critically\");\r\n        }\r\n    } else {\r\n        if(partially_blocked) {\r\n            log_message(character.name + \" partially blocked, was hit\" + hit_count_msg + \" for \" + Math.ceil(10*damage_taken)/10 + \" dmg\", \"hero_attacked\");\r\n        }\r\n        else {\r\n            log_message(character.name + \" was hit\" + hit_count_msg + \" for \" + Math.ceil(10*damage_taken)/10 + \" dmg\", \"hero_attacked\");\r\n        }\r\n    }\r\n\r\n    attacker.on_hit(character);\r\n\r\n    if(fainted) {\r\n        kill_player();\r\n        return;\r\n    }\r\n\r\n    update_displayed_health();\r\n}\r\n\r\nfunction do_character_combat_action({target, attack_power, target_count}) {\r\n    const hero_base_damage = attack_power;\r\n\r\n    const groupsize_xp_multiplier = current_enemies.length**0.3334;\r\n\r\n    let damage_dealt;\r\n    \r\n    let critted = false;\r\n    \r\n    let hit_chance_modifier = current_enemies.filter(enemy => enemy.is_alive).length**(-1/4); // down to ~ 60% if there's full 8 enemies\r\n    let damage_modifier = 1;\r\n    \r\n    add_xp_to_skill({skill: skills[\"Combat\"], xp_to_add: target.xp_value*groupsize_xp_multiplier/target_count});\r\n\r\n    Object.keys(target.tags).forEach(enemy_tag => {\r\n        if(enemy_tag_to_skill_mapping[enemy_tag]) {\r\n            for(let i = 0; i < enemy_tag_to_skill_mapping[enemy_tag].length; i++) {\r\n                const skill = skills[enemy_tag_to_skill_mapping[enemy_tag][i]];\r\n                add_xp_to_skill({skill, xp_to_add: target.xp_value*groupsize_xp_multiplier/target_count});\r\n                const {modifier_to_damage, modifier_to_hit_chance} = skill.get_stat_modifiers();\r\n                hit_chance_modifier *= modifier_to_hit_chance || 1;\r\n                damage_modifier *= modifier_to_damage || 1;\r\n            }\r\n        }\r\n    });\r\n\r\n    const hit_chance = get_hit_chance(character.stats.full.attack_points * hit_chance_modifier, target.stats.agility * Math.sqrt(target.stats.intuition ?? 1));\r\n\r\n    if(hit_chance > Math.random()) {//hero's attack hits\r\n\r\n        total_hits_done++;\r\n        if(character.equipment.weapon != null) {\r\n            //if has weapon\r\n            damage_dealt = Math.round(10 * damage_modifier * hero_base_damage * (1.2 - Math.random() * 0.4))/10;\r\n\r\n            add_xp_to_skill({skill: skills[weapon_type_to_skill[character.equipment.weapon.weapon_type]], xp_to_add: target.xp_value*groupsize_xp_multiplier/target_count}); \r\n\r\n        } else {\r\n            //if has no weapon\r\n            damage_dealt = Math.round(10 * hero_base_damage * (1.2 - Math.random() * 0.4) )/10;\r\n            add_xp_to_skill({skill: skills['Unarmed'], xp_to_add: target.xp_value*groupsize_xp_multiplier/target_count});\r\n        }\r\n        //small randomization by up to 20%, then bonus from skill\r\n\r\n        if(options.do_enemy_onhit_animations) {\r\n            const enemy_id = current_enemies.findIndex(enemy => enemy===target);\r\n            do_enemy_onhit_animation(enemy_id);\r\n        }\r\n        if(character.stats.full.crit_rate > Math.random()) {\r\n            damage_dealt = Math.round(10*damage_dealt * character.stats.full.crit_multiplier)/10;\r\n            critted = true;\r\n            total_crits_done++;\r\n            add_xp_to_skill({skill: skills['Perception'], xp_to_add: 1/target_count}); //gains unaffected by damage nor by enemy xp value\r\n        }\r\n        else {\r\n            critted = false;\r\n        }\r\n        \r\n        damage_dealt = Math.ceil(10*Math.max(damage_dealt - Math.max(0,target.stats.defense-character.stats.full.armor_penetration), damage_dealt*0.1, 1))/10;\r\n\r\n        target.stats.health -= damage_dealt;\r\n        if(damage_dealt > strongest_hit) {\r\n            strongest_hit = damage_dealt;\r\n        }\r\n        if(critted) {\r\n            log_message(target.name + \" was critically hit for \" + damage_dealt + \" dmg\", \"enemy_attacked_critically\");\r\n        }\r\n        else {\r\n            log_message(target.name + \" was hit for \" + damage_dealt + \" dmg\", \"enemy_attacked\");\r\n        }\r\n\r\n        target.on_damaged(character);\r\n\r\n        if(target.stats.health <= 0) {\r\n            total_kills++;\r\n            target.stats.health = 0; //to not go negative on displayed value\r\n            target.on_death(character);\r\n\r\n            log_message(target.name + \" was defeated\", \"enemy_defeated\");\r\n\r\n            //gained xp multiplied by TOTAL size of enemy group raised to 1/3\r\n            let xp_reward = target.xp_value * groupsize_xp_multiplier;\r\n            add_xp_to_character(xp_reward/target_count, true);\r\n\r\n            let loot = target.get_loot({drop_chance_modifier: 1/target_count**0.6667});\r\n            if(loot.length > 0) {\r\n                log_loot({loot_list: loot, is_combat: true});\r\n                loot = loot.map(x => {return {item_key: item_templates[x.item_id].getInventoryKey(), count: x.count}});\r\n                add_to_character_inventory(loot);\r\n            }\r\n            \r\n            kill_enemy(target);\r\n        }\r\n\r\n        update_displayed_health_of_enemies();\r\n    } else {\r\n        log_message(character.name + \" has missed\", \"hero_missed\");\r\n    }\r\n}\r\n\r\n/**\r\n * sets enemy to dead, disabled their attack, checks if that was the last enemy in group\r\n * @param {Enemy} enemy \r\n * @return {Boolean} if that was the last of an enemy group\r\n */\r\nfunction kill_enemy(target, do_quest_events = true) {\r\n    target.is_alive = false;\r\n    if(target.add_to_bestiary) {\r\n        if(enemy_killcount[target.name]) {\r\n            enemy_killcount[target.name] += 1;\r\n            update_bestiary_entry_killcount(target.name);\r\n        } else {\r\n            enemy_killcount[target.name] = 1;\r\n            create_new_bestiary_entry(target.name);\r\n        }\r\n    }\r\n    const enemy_id = current_enemies.findIndex(enemy => enemy===target);\r\n    clear_enemy_attack_loop(enemy_id);\r\n\r\n    if(do_quest_events) {\r\n        do_quest_event({\r\n            quest_event_type: \"kill\",\r\n            quest_event_target: target.id,\r\n            quest_event_count: 1,\r\n        });\r\n\r\n        Object.keys(target.tags || {}).forEach(tag => {\r\n            do_quest_event({\r\n                quest_event_type: \"kill_any\",\r\n                quest_event_target: tag,\r\n                quest_event_count: 1,\r\n            });\r\n        })\r\n    }\r\n}\r\n\r\nfunction kill_player({is_combat = true} = {}) {\r\n    if(is_combat) {\r\n        total_deaths++;\r\n        log_message(character.name + \" has lost consciousness\", \"hero_defeat\");\r\n\r\n        update_displayed_health();\r\n        if(options.auto_return_to_bed && last_location_with_bed) {\r\n            change_location({location_id: last_location_with_bed});\r\n            start_sleeping();\r\n        } else {\r\n            change_location({location_id: current_location.parent_location.id});\r\n        }\r\n    }\r\n\r\n    add_active_effect(\"Recovering\", 5);\r\n}\r\n\r\nfunction use_stamina({stamina_to_use = 1, skip_persistence_xp_for_stance_change = false}) {\r\n    \r\n    character.stats.full.stamina -= stamina_to_use/(character.stats.full.stamina_efficiency || 1);\r\n\r\n    if(character.stats.full.stamina < 0)  {\r\n        character.stats.full.stamina = 0;\r\n    }\r\n\r\n    if(character.stats.full.stamina < 1) {\r\n\r\n        //double the gain if hp under 20%\r\n        if(character.stats.full.health/character.stats.full.max_health < 0.2) {\r\n            stamina_to_use *= 2;\r\n        }\r\n        for(let i = 0; i < cold_status_effects.length; i++) {\r\n            if(active_effects[cold_status_effects[i]]) {\r\n                stamina_to_use *= (1.19**i); //~x2 at i==4\r\n            }\r\n        }\r\n\r\n        if(!skip_persistence_xp_for_stance_change) {\r\n            add_xp_to_skill({skill: skills[\"Persistence\"], xp_to_add: stamina_to_use});\r\n        }\r\n        update_displayed_stats();\r\n    }\r\n\r\n    update_displayed_stamina();\r\n}\r\n\r\n/**\r\n * adds xp to skills, handles their levelups and tooltips\r\n * @param skill - skill object \r\n * @param {Number} xp_to_add \r\n * @param {Boolean} should_info \r\n * @returns {Boolean}\r\n */\r\nfunction add_xp_to_skill({skill, xp_to_add = 1, should_info = true, use_bonus = true, add_to_parent = true, cap_gained_xp = true, is_from_loading = false, do_quest_events = true})\r\n{\r\n    let leveled = false;\r\n    if(xp_to_add == 0) {\r\n        return leveled;\r\n    } else if(xp_to_add < 0) {\r\n        console.error(`Tried to add negative xp to skill ${skill.skill_id}`);\r\n        return leveled;\r\n    } else if(isNaN(xp_to_add)) {\r\n        console.error(`Tried to add NaN xp to skill ${skill.skill_id}`);\r\n        return leveled;\r\n    }\r\n\r\n    if(use_bonus) {\r\n        xp_to_add = xp_to_add * global_xp_multiplier * get_skill_xp_gain(skill.skill_id);\r\n\r\n        if(skill.parent_skill) {\r\n            xp_to_add *= skill.get_parent_xp_multiplier();\r\n        }\r\n    }\r\n\r\n    if(cap_gained_xp && typeof skill.xp_to_next_lvl === Number) {\r\n        //cap on singular gains for non-crafting skills; cap for crafting skills handled in crafting code as it's dependent on how many items are made at once\r\n        xp_to_add = Math.min(xp_to_add, skill.xp_to_next_lvl*skill_xp_gains_cap);\r\n    }\r\n    \r\n    const prev_name = skill.name();\r\n    const was_hidden = skill.visibility_treshold > skill.total_xp;\r\n\r\n    let {message, gains, unlocks} = skill.add_xp({xp_to_add: xp_to_add});\r\n    const new_name = skill.name();\r\n    if(skill.parent_skill && add_to_parent) {\r\n        if(skill.total_xp > skills[skill.parent_skill].total_xp) {\r\n            /*\r\n                add xp to parent if skill would now have more than the parent\r\n                calc xp ammount so that it's no more than the difference between child and parent\r\n            */\r\n            let xp_for_parent = Math.min(skill.total_xp - skills[skill.parent_skill].total_xp, xp_to_add);\r\n            add_xp_to_skill({skill: skills[skill.parent_skill], xp_to_add: xp_for_parent, should_info, use_bonus: false, add_to_parent, cap_gained_xp: false, is_from_loading});\r\n        }\r\n    }\r\n\r\n    const is_visible = skill.visibility_treshold <= skill.total_xp;\r\n\r\n\r\n    if(was_hidden && is_visible) {\r\n        //skill only now became visible, so it needs to be added to display\r\n        create_new_skill_bar(skill);\r\n        update_displayed_skill_bar(skill, false);\r\n        \r\n        if(typeof should_info === \"undefined\" || should_info) {\r\n            log_message(`Unlocked new skill: ${skill.name()}`, \"skill_raised\");\r\n        }\r\n    } \r\n\r\n    if(gains) { \r\n        character.stats.add_skill_milestone_bonus(gains);\r\n        if(skill.skill_id === \"Unarmed\") {\r\n            character.stats.add_all_equipment_bonus();\r\n        }\r\n    }\r\n    \r\n    if(is_visible) {\r\n        if(prev_name !== new_name) { //skill name has changed; this may trigger on levelup OR on becoming visible\r\n            if(which_skills_affect_skill[skill.skill_id]) {\r\n                for(let i = 0; i < which_skills_affect_skill[skill.skill_id].length; i++) {\r\n                    update_displayed_skill_bar(skills[which_skills_affect_skill[skill.skill_id][i]], false);\r\n                }\r\n            }\r\n\r\n            Object.keys(booklist_entry_divs).forEach(book_id => {\r\n                //update anthology entry\r\n                const bonuses = book_stats[book_id]?.bonuses?.xp_multipliers || {};\r\n                if(bonuses[skill.skill_id]) {\r\n                    update_booklist_entry(book_id, true);\r\n                }\r\n            });\r\n            Object.keys(character.inventory).forEach(inv_key => {\r\n                //update equippable/useable/book item\r\n                const item = getItemFromKey(inv_key);\r\n                if(item.tags.usable) {\r\n                    const effects = item.effects;\r\n                    for(let i = 0; i < effects.length; i++) {\r\n                        if(effect_templates[effects[i].effect].effects?.bonus_skill_levels?.[skill.skill_id]) {\r\n                            update_displayed_character_inventory({item_key: inv_key});\r\n                            return;\r\n                        }\r\n                    }\r\n                } else if(item.tags.book) {\r\n                    const bonuses = book_stats[item.id]?.bonuses?.xp_multipliers || {};\r\n                    if(bonuses[skill.skill_id]) {\r\n                        update_displayed_character_inventory({item_key: inv_key});\r\n                    }\r\n                } else if(item.tags.equippable) {\r\n                    const bonuses = item.getBonusSkillLevels();\r\n                    if(bonuses[skill.skill_id]) {\r\n                        update_displayed_character_inventory({item_key: inv_key});\r\n                    }\r\n                }\r\n            });\r\n            Object.keys(character.equipment).forEach(eq_slot => {\r\n                //update equipped item\r\n                if(!character.equipment[eq_slot]) {\r\n                    return;\r\n                }\r\n                const bonuses = character.equipment[eq_slot].getBonusSkillLevels(); {\r\n                    if(bonuses[skill.skill_id]) {\r\n                        update_displayed_equipment();\r\n                        update_displayed_character_inventory({equip_slot: eq_slot});\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        if(typeof message !== \"undefined\"){ \r\n        //not undefined => levelup happened and levelup message was returned\r\n            leveled = true;\r\n\r\n            message = message.replace(\"%HeroName%\", character.name);\r\n\r\n            update_displayed_skill_bar(skill, true);\r\n\r\n            if(typeof should_info === \"undefined\" || should_info)\r\n            {\r\n                update_character_stats();\r\n            }\r\n\r\n            if(typeof skill.get_effect_description !== \"undefined\")\r\n            {\r\n                update_displayed_skill_description(skill);\r\n            }\r\n\r\n            if(skill.is_parent) {\r\n                update_all_displayed_skills_xp_gain();\r\n            } else {\r\n                update_displayed_skill_xp_gain(skill);\r\n            }\r\n\r\n            //no point doing any checks for optimization\r\n            update_displayed_stamina_efficiency();\r\n            \r\n            process_rewards({source_name: skill.skill_id, source_type: \"skill\", rewards: unlocks, inform_overall: should_info});\r\n            \r\n            if(typeof should_info === \"undefined\" || should_info){\r\n                log_message(message, \"skill_raised\");\r\n            }\r\n\r\n            if(prev_name !== new_name) { //skill name has changed\r\n                //display of skill name in other places (like tooltips of other skills) is handled slightly earlier\r\n                if(!was_hidden && (typeof should_info === \"undefined\" || should_info)) {\r\n                    log_message(`Skill ${prev_name} upgraded to ${new_name}`, \"skill_raised\");\r\n                }\r\n\r\n                if(current_location?.connected_locations && !current_activity) {\r\n                    Object.keys(current_location.activities).forEach(activity_key => {\r\n                        if(activities[current_location.activities[activity_key].activity_name].base_skills_names.includes(skill.skill_id)) {\r\n                            update_gathering_tooltip(activities[activity_key]);\r\n                        }\r\n                    });\r\n                }\r\n                /*\r\n                Object.keys(character.inventory).forEach(inv_key => {\r\n                    //update equippable/useable item\r\n                    const item = getItemFromKey(inv_key);\r\n                    if(item.tags.usable) {\r\n                        const effects = item.effects;\r\n                        for(let i = 0; i < effects.length; i++) {\r\n                            if(effect_templates[effects[i].effect].effects?.bonus_skill_levels?.[skill.skill_id]) {\r\n                                update_displayed_character_inventory({item_key: inv_key});\r\n                                return;\r\n                            }\r\n                        }\r\n                    } else if(item.tags.equippable) {\r\n                        const bonuses = item.getBonusSkillLevels();\r\n                        if(bonuses[skill.skill_id]) {\r\n                            update_displayed_character_inventory({item_key: inv_key});\r\n                        }\r\n                    }\r\n                });\r\n                Object.keys(character.equipment).forEach(eq_slot => {\r\n                    //update equipped item\r\n                    if(!character.equipment[eq_slot]) {\r\n                        return;\r\n                    }\r\n                    const bonuses = character.equipment[eq_slot].getBonusSkillLevels(); {\r\n                        if(bonuses[skill.skill_id]) {\r\n                            update_displayed_equipment();\r\n                            update_displayed_character_inventory({equip_slot: eq_slot});\r\n                        }\r\n                    }\r\n                });\r\n                */\r\n\r\n                /*\r\n                Object.keys(booklist_entry_divs).forEach(book_id => {\r\n                    //update anthology entry\r\n                    const bonuses = book_stats[book_id]?.bonuses?.xp_multipliers || {};\r\n                    if(bonuses[skill.skill_id]) {\r\n                        update_booklist_entry(book_id, true);\r\n                    }\r\n                });\r\n                */\r\n\r\n                update_displayed_effects();\r\n                //a bit lazy, but there shouldn't ever be enough to have any performance impact\r\n            }\r\n\r\n            if(speed_modifiers_from_skills[skill.skill_id] && !is_from_loading) {\r\n                //check if skill affects any travel times, update pathing if so\r\n                pathfinder = new Pathfinder();\r\n                pathfinder.fill_connections(locations);\r\n                travel_times = {};\r\n                travel_times[current_location.id] = pathfinder.find_shortest_paths(current_location.id);\r\n                //shouldn't need any display updates\r\n            }\r\n\r\n            if(tags_for_droprate_modifier_skills[skill.skill_id]) { \r\n                //this skill affects some droprates, so bestiary update is required\r\n                \r\n                //go through enemy types that were killed, check if relevant tag is present, update related display if so\r\n                Object.keys(enemy_killcount).forEach(enemy_id => {\r\n                    if(enemy_templates[enemy_id].tags[tags_for_droprate_modifier_skills[skill.skill_id]]) {\r\n                        //update_bestiary_entry(enemy_id);\r\n                        update_bestiary_entry_tooltip(enemy_id);\r\n                    }\r\n                });\r\n            }\r\n\r\n            if(do_quest_events) {\r\n                do_quest_event({\r\n                    quest_event_type: \"reach_skill\",\r\n                    quest_event_target: skill.skill_id,\r\n                    quest_event_count: skill.current_level,\r\n                });\r\n            }\r\n        } else {\r\n            update_displayed_skill_bar(skill, false);\r\n        }\r\n    } else {\r\n        //\r\n    }\r\n\r\n    return leveled;\r\n}\r\n\r\n/**\r\n * adds xp to character, handles levelups\r\n * @param {Number} xp_to_add \r\n * @param {Boolean} should_info \r\n */\r\nfunction add_xp_to_character(xp_to_add, should_info = true, use_bonus) {\r\n    const level_up = character.add_xp({xp_to_add, use_bonus});\r\n    \r\n    if(level_up) {\r\n        if(should_info) {\r\n            log_message(level_up, \"level_up\");\r\n        }\r\n        \r\n        character.stats.full.health = character.stats.full.max_health; //free healing on level up, because it's a nice thing to have\r\n        update_character_stats();\r\n    }\r\n\r\n    update_displayed_character_xp(level_up);\r\n}\r\n\r\n/**\r\n * @param {Location} location game Location object\r\n * @description handles all the rewards for clearing location (both first and subsequent clears), adding xp and unlocking stuff\r\n */\r\nfunction get_location_rewards(location) {\r\n\r\n    let should_return = false;\r\n\r\n    if(location.enemy_groups_killed == location.enemy_count || location.is_challenge) { //first clear\r\n\r\n        if(location.is_challenge) {\r\n            lock_location({location, challenge_self_lock: true});\r\n        }\r\n        should_return = true;\r\n        \r\n        if(location.first_reward) {\r\n            process_rewards({rewards: location.first_reward, source_type: \"location\", source_name: location.name, is_first_clear: true, source_id: location.id});\r\n        }\r\n    } else if(location.repeatable_reward.xp && typeof location.repeatable_reward.xp === \"number\") {\r\n        process_rewards({rewards: {xp: location.repeatable_reward.xp}, source_type: \"location\", source_name: location.name, is_first_clear: false, source_id: location.id});\r\n    }\r\n\r\n    if(location.rewards_with_clear_requirement) {\r\n        for(let i = 0; i < location.rewards_with_clear_requirement.length; i++) {\r\n            if(location.enemy_groups_killed == location.enemy_count * location.rewards_with_clear_requirement[i].required_clear_count)\r\n            {\r\n                //only once, on N-th clear\r\n                process_rewards({rewards: location.rewards_with_clear_requirement[i], source_type: \"location\", source_name: location.name, is_first_clear: false, source_id: location.id});\r\n            }\r\n        }\r\n    }\r\n\r\n    //calls in first clear give xp, this call omits xp to avoid repeating it\r\n    //repeatable rewards are indeed intended to be called on first clear as well (with the exception of xp, duh)\r\n    process_rewards({rewards: {...location.repeatable_reward, xp: null}, source_type: \"location\", source_name: location.name, is_first_clear: false, source_id: location.id});\r\n\r\n    location.otherUnlocks();\r\n\r\n    //return if need be; additional check in case it was already performed by rewards\r\n    if(should_return && current_location?.parent_location) {\r\n        change_location({location_id: current_location.parent_location.id}); //go back to parent location, only on first clear\r\n    }\r\n}\r\n\r\n/**\r\n * processes rewards and logs all necessary messages\r\n * @param {Object} rewards_data\r\n * @param {Object} rewards_data.rewards //the standard object with rewards\r\n * @param {String} rewards_data.source_type //location, gameAction, textline\r\n * @param {Boolean} rewards_data.is_first_clear //exclusively for location rewards (and only for a single message to be logged)\r\n * @param {Boolean} rewards_data.inform_overall //if unlocks are to be logged\r\n * @param {Boolean} rewards_data.inform_textline //if textline unlock is to be logged (requires inform_overall to also be true)\r\n * @param {String} rewards_data.source_name //in case it's needed for logging a message\r\n */\r\nfunction process_rewards({rewards = {}, source_type, source_name, is_first_clear, inform_overall = true, inform_textline = true, only_unlocks = false, is_from_loading = false}) {\r\n    let was_any_location_availability_changed = false;\r\n\r\n    if(rewards.messages && !is_from_loading) {\r\n        for(let i = 0; i < rewards.messages.length; i++) {\r\n            log_message(rewards.messages[i]);\r\n        }\r\n    }\r\n\r\n    if(rewards.money && typeof rewards.money === \"number\" && !only_unlocks) {\r\n        if(inform_overall) {\r\n            log_message(`${character.name} earned ${format_money(rewards.money)}`);\r\n        }\r\n        add_money_to_character(rewards.money);\r\n    }\r\n\r\n    if(rewards.xp && typeof rewards.xp === \"number\" && !only_unlocks) {\r\n        if(source_type === \"location\") {\r\n            if(inform_overall) {\r\n                if(is_first_clear) {\r\n                    log_message(`Obtained ${rewards.xp}xp for clearing ${source_name} for the first time`, \"location_reward\");\r\n                } else {\r\n                    log_message(`Obtained additional ${rewards.xp}xp for clearing ${source_name}`, \"location_reward\");\r\n                }\r\n            }\r\n        } else {\r\n            //other sources\r\n            log_message(`Gained ${rewards.xp}xp`, \"location_reward\");\r\n        }\r\n        add_xp_to_character(rewards.xp);\r\n    }\r\n\r\n    if(rewards.skill_xp && !only_unlocks) {\r\n        Object.keys(rewards.skill_xp).forEach(skill_key => {\r\n            if(typeof rewards.skill_xp[skill_key] === \"number\") {\r\n                if(inform_overall) {\r\n                    log_message(`${character.name} gained ${rewards.skill_xp[skill_key]}xp to ${skills[skill_key].name()}`);\r\n                }\r\n                add_xp_to_skill({skill: skills[skill_key], xp_to_add: rewards.skill_xp[skill_key], cap_gained_xp: false});\r\n            }\r\n        });\r\n    }\r\n    \r\n    if(rewards.locations) {\r\n        //if(source_type === \"location\") {\r\n            for(let i = 0; i < rewards.locations.length; i++) {\r\n               was_any_location_availability_changed = \r\n                    unlock_location({location: locations[rewards.locations[i].location], skip_message: (inform_overall && rewards.locations[i].skip_message || is_from_loading)}) \r\n                    || was_any_location_availability_changed;\r\n                    \r\n            }\r\n    }\r\n\r\n    if(rewards.flags) {\r\n        for(let i = 0; i < rewards.flags.length; i++) {\r\n            const flag = global_flags[rewards.flags[i]];\r\n            global_flags[rewards.flags[i]] = true;\r\n            if(!flag && flag_unlock_texts[rewards.flags[i]] && inform_overall) {\r\n                log_message(`${flag_unlock_texts[rewards.flags[i]]}`, \"activity_unlocked\");\r\n            }\r\n        }\r\n    }\r\n\r\n    if(rewards.textlines) {\r\n        for(let i = 0; i < rewards.textlines.length; i++) {\r\n            let any_unlocked = false;\r\n            for(let j = 0; j < rewards.textlines[i].lines.length; j++) {\r\n                if(dialogues[rewards.textlines[i].dialogue].textlines[rewards.textlines[i].lines[j]].is_unlocked == false) {\r\n                    any_unlocked = true;\r\n                    dialogues[rewards.textlines[i].dialogue].textlines[rewards.textlines[i].lines[j]].is_unlocked = true;\r\n                }\r\n            }\r\n            if(any_unlocked && inform_textline && inform_overall && !rewards.textlines[i].skip_message && source_name !== rewards.textlines[i].dialogue) {\r\n\r\n                log_message(`You should talk to ${dialogues[rewards.textlines[i].dialogue].getName({is_mofu_mofu_enabled: global_flags.is_mofu_mofu_enabled})}`, \"dialogue_unlocked\");\r\n                //maybe do this only when there's just 1 dialogue with changes?\r\n            }\r\n        }\r\n    }\r\n\r\n    if(rewards.dialogues) {\r\n        for(let i = 0; i < rewards.dialogues?.length; i++) {\r\n            const dialogue = dialogues[rewards.dialogues[i]]\r\n            if(!dialogue.is_unlocked) {\r\n                dialogue.is_unlocked = true;\r\n                log_message(`You can now talk with ${dialogue.name}`, \"activity_unlocked\");\r\n            }\r\n        }\r\n    }\r\n\r\n    if(rewards.traders) { \r\n        for(let i = 0; i < rewards.traders.length; i++) {\r\n            const trader = traders[rewards.traders[i].trader];\r\n            if(!trader.is_unlocked) {\r\n                trader.is_unlocked = true;\r\n                if(!rewards.traders[i].skip_message) {\r\n                    if(trader.unlock_message) {\r\n                        log_message(trader.unlock_message, \"activity_unlocked\");\r\n                    } else {\r\n                        log_message(`You can now trade with ${trader.name}`, \"activity_unlocked\");\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    if(rewards.housing) {\r\n        Object.keys(rewards.housing).forEach(location_key => {\r\n            locations[location_key].housing.is_unlocked = true;\r\n        });\r\n    }\r\n\r\n    if(rewards.crafting) {\r\n        for(let i = 0; i < rewards.crafting.length; i++) {\r\n            locations[rewards.crafting[i]].crafting.is_unlocked = true;\r\n            log_message(`You can now use a crafting station in ${locations[rewards.crafting[i]].name}`, \"activity_unlocked\");\r\n        }\r\n    }\r\n\r\n    if(rewards.global_activities) {\r\n        for(let i = 0; i < rewards.global_activities?.length; i++) {\r\n                unlock_global_activity({activity_id: rewards.global_activities[i]});\r\n        }\r\n    }\r\n\r\n\r\n    if(rewards.activities) {\r\n        for(let i = 0; i < rewards.activities?.length; i++) {\r\n            if(!locations[rewards.activities[i].location].activities[rewards.activities[i].activity].tags?.gathering || global_flags.is_gathering_unlocked) {\r\n\r\n                unlock_activity({location: locations[rewards.activities[i].location].name, \r\n                                activity: locations[rewards.activities[i].location].activities[rewards.activities[i].activity],\r\n                                skip_message: is_from_loading,\r\n                            });\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    if(rewards.actions) {\r\n        for(let i = 0; i < rewards.actions?.length; i++) {\r\n            if(rewards.actions[i].dialogue) {\r\n                unlock_action({\r\n                                dialogue: dialogues[rewards.actions[i].dialogue]?.name,\r\n                                action: dialogues[rewards.actions[i].dialogue].actions[rewards.actions[i].action],\r\n                                skip_message: is_from_loading,\r\n                            });\r\n            } else if(rewards.actions[i].location){\r\n                unlock_action({\r\n                                location: locations[rewards.actions[i].location]?.name,\r\n                                action: locations[rewards.actions[i].location].actions[rewards.actions[i].action],\r\n                                skip_message: is_from_loading,\r\n                            });\r\n            }\r\n        }\r\n    }\r\n\r\n    if(rewards.stances) {  \r\n        for(let i = 0; i < rewards.stances.length; i++) {\r\n            unlock_combat_stance(rewards.stances[i]);\r\n        }\r\n    }\r\n\r\n    if(rewards.skills) {\r\n        for(let i = 0; i < rewards.skills.length; i++) {\r\n            if(!skills[rewards.skills[i]].is_unlocked) {\r\n                skills[rewards.skills[i]].is_unlocked = true;\r\n                create_new_skill_bar(skills[rewards.skills[i]]);\r\n                update_displayed_skill_bar(skills[rewards.skills[i]], false);\r\n                if(inform_overall) {\r\n                    log_message(`Unlocked new skill: ${skills[rewards.skills[i]].name()}`);\r\n                }\r\n\r\n                if(source_type === \"skill\") {\r\n                    if(!which_skills_affect_skill[rewards.skills[i]]) {\r\n                        which_skills_affect_skill[rewards.skills[i]] = [];\r\n                    }\r\n\r\n                    if(skills[source_name]) {\r\n                        which_skills_affect_skill[rewards.skills[i]].push(source_name);\r\n                        //shouldn't cause issues, as it will only trigger on skill unlocks by other skills\r\n                    } else {\r\n                        console.error(`Tried to register skill \"${source_name}\" as related to \"${rewards.skills[i]}\", but the former does not exist!`);\r\n                    }\r\n                }\r\n\r\n                //update all related skills; may be none if unlock was not from another skill, so need to check with '?'\r\n                for(let j = 0; j < which_skills_affect_skill[rewards.skills[i]]?.length; j++) {\r\n                    update_displayed_skill_bar(skills[which_skills_affect_skill[rewards.skills[i]][j]], false);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    if(rewards.recipes) {\r\n        for(let i = 0; i < rewards.recipes.length; i++) {\r\n            if(!recipes[rewards.recipes[i].category][rewards.recipes[i].subcategory][rewards.recipes[i].recipe_id].is_unlocked) {\r\n                recipes[rewards.recipes[i].category][rewards.recipes[i].subcategory][rewards.recipes[i].recipe_id].is_unlocked = true;\r\n                if(inform_overall) {\r\n                    log_message(`Unlocked new recipe: ${recipes[rewards.recipes[i].category][rewards.recipes[i].subcategory][rewards.recipes[i].recipe_id].name}`);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    if(rewards.quests) {\r\n        for(let i = 0; i < rewards.quests.length; i++) {\r\n            if(!questManager.isQuestActive(rewards.quests[i]) && !questManager.isQuestFinished(rewards.quests[i])) {\r\n                questManager.startQuest({quest_id: rewards.quests[i]});\r\n                if(inform_overall) {\r\n                    //log_message(`Received a new quest: ${quests[rewards.quests[i]].getQuestName()}`);\r\n                    //already done in quests\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    if(rewards.quest_progress) {\r\n        for(let i = 0; i < rewards.quest_progress.length; i++) {\r\n            const quest_id = rewards.quest_progress[i].quest_id;\r\n            const task_index = rewards.quest_progress[i].task_index;\r\n            if(task_index == quests[quest_id].getCompletedTaskCount()) {\r\n                if(quests[quest_id]?.quest_tasks[task_index]) {\r\n                    questManager.finishQuestTask({quest_id: quest_id, task_index: task_index, skip_warning: true});\r\n                } else {\r\n                    console.warn(`Tried to complete ${task_index}'th task for quest '${quest_id}', but either quest or index does not exist!`);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    if(rewards.locks) {\r\n        if(rewards.locks.textlines) {\r\n            Object.keys(rewards.locks.textlines).forEach(dialogue_key => {\r\n                for(let i = 0; i < rewards.locks.textlines[dialogue_key].length; i++) {\r\n                    dialogues[dialogue_key].textlines[rewards.locks.textlines[dialogue_key][i]].is_finished = true;\r\n                }\r\n            });\r\n        }\r\n        if(rewards.locks.locations) {\r\n            for(let i = 0; i < rewards.locks.locations.length; i++) {\r\n                was_any_location_availability_changed = lock_location({location: locations[rewards.locks.locations[i]]}) || was_any_location_availability_changed;\r\n            }\r\n        }\r\n        if(rewards.locks.traders) {\r\n            for(let i = 0; i < rewards.locks.traders.length; i++) {\r\n                traders[rewards.locks.traders[i]].is_finished = true;\r\n            }\r\n        }\r\n        if(rewards.locks.quests) {\r\n            for(let i = 0; i < rewards.locks.quests.length; i++) {\r\n                questManager.finishQuest({quest_id: rewards.locks.quests[i], skip_rewards: true})\r\n            }\r\n        }\r\n        if(rewards.locks.actions) {\r\n            for(let i = 0; i < rewards.locks.actions.length; i++) {\r\n                lock_action({\r\n                            dialogue_key: rewards.locks.actions[i].dialogue,\r\n                            location_key: rewards.locks.actions[i].location,\r\n                            action_key: rewards.locks.actions[i].action\r\n                        });\r\n            }\r\n        }\r\n    }\r\n\r\n    if(rewards.items && !only_unlocks) {\r\n        for(let i = 0; i < rewards.items.length; i++) {\r\n            let item;\r\n            let count;\r\n            if(typeof rewards.items[i] === \"string\") {\r\n                item = item_templates[rewards.items[i]];\r\n                count = 1;\r\n            } else {\r\n                item = item_templates[rewards.items[i].item];\r\n                count = rewards.items[i].count || 1;\r\n            }\r\n            \r\n            log_message(`${character.name} obtained \"${item.getName()} x${count}\"`);\r\n            add_to_character_inventory([{item_key: item.getInventoryKey(), count}]);\r\n        }\r\n    }\r\n\r\n    if(rewards.reputation) {\r\n        Object.keys(rewards.reputation).forEach(region => {\r\n            ReputationManager.add_reputation({region, reputation: rewards.reputation[region]});\r\n        });\r\n        update_displayed_reputation();\r\n    }\r\n\r\n    if(was_any_location_availability_changed && !is_from_loading) {\r\n        //pathing update\r\n        pathfinder = new Pathfinder();\r\n        pathfinder.fill_connections(locations);\r\n        travel_times = {};\r\n        travel_times[current_location.id] = pathfinder.find_shortest_paths(current_location.id);\r\n\r\n        //shouldn't need any display updates\r\n    }\r\n\r\n    if(rewards.move_to && !only_unlocks) {\r\n        if(source_type !== \"action\") {\r\n            change_location({location_id: rewards.move_to.location});\r\n        } else {\r\n            current_location = locations[rewards.move_to.location];\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * \r\n * @param location game location object \r\n * @returns whether it was actually unlocked (false meaning it was already available before)\r\n */\r\nfunction unlock_location({location, skip_message}) {\r\n    let was_unlocked = false;\r\n    if(!location.is_unlocked){\r\n        location.is_unlocked = true;\r\n        was_unlocked = true;\r\n        if(!skip_message) {\r\n            const message = location.unlock_text || `Unlocked location ${location.name}`;\r\n            log_message(message, \"location_unlocked\");\r\n        }\r\n\r\n        //reloads the current location just in case it needs the new unlock to be added to current display\r\n        //current action check most probably unnecessary\r\n        if(current_location && !current_dialogue && !current_game_action) {\r\n            change_location({location_id: current_location.id, skip_travel_time: true});\r\n        }\r\n    }\r\n\r\n    if(location.housing?.is_unlocked) {\r\n        unlocked_beds[location.id] = true;\r\n    }\r\n\r\n    return was_unlocked;\r\n}\r\n\r\n/**\r\n * \r\n * @param {*} param0 \r\n * @returns whether it was actually locked (false meaning it was already locked before)\r\n */\r\nfunction lock_location({location, challenge_self_lock = false}) {\r\n    let was_locked = false;\r\n    if(favourite_locations[location.id]) {\r\n        delete favourite_locations[location.id];\r\n        if(!challenge_self_lock) {\r\n            remove_fast_travel_choice({location_id: location.id});\r\n        }\r\n    }\r\n\r\n    if(!location.is_finished) {\r\n        was_locked = true;\r\n        location.is_finished = true;\r\n    }\r\n    if(last_combat_location === location.id) {\r\n        last_combat_location = null;\r\n    }\r\n\r\n    return was_locked;\r\n}\r\n\r\nfunction add_location_to_favourites({location_id}) {\r\n    if(favourite_locations[location_id]) {\r\n        console.warn(`Tried to favourite location \"${locations[location_id].name}\" despite it already being in favourites`);\r\n        return;\r\n    }\r\n\r\n    favourite_locations[location_id] = true;\r\n    update_location_icon();\r\n}\r\n\r\nfunction remove_location_from_favourites({location_id, update_choices = true}) {\r\n    if(!favourite_locations[location_id]) {\r\n        console.warn(`Tried to unfavourite location \"${locations[location_id].name}\" despite it not being in favourites`);\r\n        return;\r\n    }\r\n\r\n    delete favourite_locations[location_id];\r\n    update_location_icon();\r\n    if(update_choices) {\r\n        remove_fast_travel_choice({location_id});\r\n    }\r\n}\r\n\r\nfunction clear_enemies() {\r\n    current_enemies = null;\r\n    for(let i = 0; i < 7; i++) {\r\n        remove_enemy_onhit_animation(i);\r\n    }\r\n}\r\n\r\nfunction use_recipe(target, ammount_wanted_to_craft = 1) {\r\n\r\n    const category = target.parentNode.parentNode.dataset.crafting_category;\r\n    const subcategory = target.parentNode.parentNode.dataset.crafting_subcategory;\r\n    const recipe_id = target.parentNode.dataset.recipe_id;\r\n    const station_tier = current_location.crafting.tiers[category];\r\n\r\n    if(!category || !subcategory || !recipe_id) {\r\n        //shouldn't be possible to reach this\r\n        throw new Error(`Tried to use a recipe but either category, subcategory, or recipe id was not passed: ${category} - ${subcategory} - ${recipe_id}`);\r\n    } else if(!recipes[category][subcategory][recipe_id]) {\r\n        //shouldn't be possible to reach this\r\n        throw new Error(`Tried to use a recipe that doesn't exist: ${category} -> ${subcategory} -> ${recipe_id}`);\r\n    } else {\r\n        const selected_recipe = recipes[category][subcategory][recipe_id];\r\n        const recipe_div = document.querySelector(`[data-crafting_category=\"${category}\"][data-crafting_subcategory=\"${subcategory}\"] [data-recipe_id=\"${recipe_id}\"]`);\r\n        let leveled = false;\r\n        let result;\r\n        let xp_to_add;\r\n        if(subcategory === \"items\") {\r\n            const {available_ammount, materials} = selected_recipe.get_availability()\r\n            let ammount_that_can_be_crafted = Math.min(ammount_wanted_to_craft, available_ammount);\r\n            let attempted_crafting_ammount = ammount_that_can_be_crafted; //ammount that will be attempted (e.g. 100)\r\n            let successful_crafting_ammount; //ammount that will succeed (e.g. 100 * 75.6% success = 75.6 -> 75 + 60% for another 1)\r\n            if(ammount_that_can_be_crafted > 0) { \r\n                const success_chance = selected_recipe.get_success_chance(station_tier);\r\n                result = selected_recipe.getResult();\r\n                let {result_id, count} = result;\r\n\r\n                const recipe_skill = skills[selected_recipe.recipe_skill];\r\n                const needed_xp = recipe_skill.total_xp_to_next_lvl - recipe_skill.total_xp;\r\n                //const xp_per_craft = get_recipe_xp_value({category, subcategory, recipe_id});\r\n                const xp_per_craft = Math.min(recipe_skill.xp_to_next_lvl*crafting_skill_xp_gains_cap, get_recipe_xp_value({category, subcategory, recipe_id})*get_skill_xp_gain(recipe_skill.skill_id));\r\n                const estimated_xp_per_craft = xp_per_craft * success_chance;\r\n                const needed_crafts = Math.ceil(needed_xp/(estimated_xp_per_craft));\r\n                \r\n                attempted_crafting_ammount = Math.min(needed_crafts, ammount_that_can_be_crafted);\r\n                successful_crafting_ammount = Math.floor(attempted_crafting_ammount*success_chance);\r\n                \r\n                //chance to get 1 more if it was not an integer\r\n                const variable_craft = Math.random()<(attempted_crafting_ammount*success_chance - successful_crafting_ammount)?1:0;\r\n                successful_crafting_ammount += variable_craft;\r\n                \r\n                //const current_gained_xp = (attempted_crafting_ammount-1)*estimated_xp_per_craft + (variable_craft?xp_per_craft:(xp_per_craft/4));\r\n                const current_gained_xp = (successful_crafting_ammount + (attempted_crafting_ammount-successful_crafting_ammount)/4)*xp_per_craft;\r\n                let success = 0;\r\n                let fail = 0;\r\n                \r\n                if(attempted_crafting_ammount < ammount_that_can_be_crafted && current_gained_xp < needed_xp) {\r\n                    //if more can be crafted and failed to get enough for a levelup, try to make up to 3 more (since it's 1/4th per fail and there's already 1 fail)\r\n                    for(let i = 0; i < 2 && attempted_crafting_ammount+success+fail < ammount_that_can_be_crafted; i++) {\r\n                        \r\n                        if(Math.random()<success_chance) {\r\n                            success++;\r\n                        } else {\r\n                            fail++;\r\n                        }\r\n                        \r\n                        if((current_gained_xp + xp_per_craft*(success+fail/4)) >= needed_xp) {\r\n                            break;\r\n                        }\r\n                    }\r\n                    attempted_crafting_ammount += success + fail;\r\n                    successful_crafting_ammount += success;\r\n                }\r\n\r\n                xp_to_add = current_gained_xp + xp_per_craft*(success+fail/4);\r\n\r\n                total_crafting_attempts += attempted_crafting_ammount;\r\n                total_crafting_successes += successful_crafting_ammount;\r\n\r\n                //remove used materials by id\r\n                for(let i = 0; i < selected_recipe.materials.length; i++) {\r\n                    if(selected_recipe.materials[i].material_id) {\r\n                        const key = item_templates[selected_recipe.materials[i].material_id].getInventoryKey();\r\n                        remove_from_character_inventory([{item_key: key, item_count: selected_recipe.materials[i].count*attempted_crafting_ammount}]);\r\n                    }\r\n                } \r\n\r\n                //remove used materials by material_type\r\n                for(let i = 0; i < materials.length; i++) {\r\n                    const mat_type = item_templates[materials[i]].material_type;\r\n                    const mat = selected_recipe.materials.find(x => x.material_type === mat_type);\r\n                    remove_from_character_inventory([{item_key: item_templates[materials[i]].getInventoryKey(), item_count: mat.count*attempted_crafting_ammount}]);\r\n                } \r\n\r\n                if(successful_crafting_ammount > 0) {\r\n                    add_to_character_inventory([{item_key: item_templates[result_id].getInventoryKey(), count: count*successful_crafting_ammount}]);\r\n                    let msg = `Created ${item_templates[result_id].getName()}`;\r\n                    if(attempted_crafting_ammount > 1) {\r\n                        msg+=` [${count*successful_crafting_ammount} out of ${count*attempted_crafting_ammount}]`;\r\n                    } else {\r\n                        msg+= ` x${count*successful_crafting_ammount}`;\r\n                    }\r\n                    log_message(msg, \"crafting\");\r\n\r\n                } else {\r\n                    let msg = `Failed to create ${item_templates[result_id].getName()}`;\r\n                    if(attempted_crafting_ammount > 1) {\r\n                        msg+=` [0 out of ${count*attempted_crafting_ammount}]`;\r\n                    } else {\r\n                        msg+= ` x${count*attempted_crafting_ammount}`;\r\n                    }\r\n                    log_message(msg, \"crafting\");\r\n                }\r\n\r\n                leveled = add_xp_to_skill({skill: recipe_skill, xp_to_add: xp_to_add, cap_gained_xp: false, use_bonus: false}); \r\n                //no cap, as it was already capped; skip bonus as it was already added\r\n                Object.keys(item_templates[result_id].tags).forEach(tag => {\r\n                    const skill_id = crafting_tags_to_skills[tag];\r\n                    if(skill_id) {\r\n                        let leveled = add_xp_to_skill({skill: skills[skill_id], xp_to_add: xp_to_add/2, cap_gained_xp: true, use_bonus: false});\r\n                        //cap, as it's assumed to not be a crafting skill; skip bonus as it was already added\r\n                        if(leveled) {\r\n                            character.stats.add_active_effect_bonus();\r\n                            update_character_stats();\r\n                            Object.keys(character.inventory).forEach(item_key => {\r\n                                if(character.inventory[item_key].item.tags.medicine) {\r\n                                    update_displayed_character_inventory({item_key});\r\n                                }\r\n                            });\r\n                        }\r\n                    }\r\n                });\r\n                \r\n                if(attempted_crafting_ammount < ammount_that_can_be_crafted) {\r\n                    use_recipe(target, ammount_that_can_be_crafted - attempted_crafting_ammount);\r\n                } else {\r\n                    update_item_recipe_visibility();\r\n                    update_item_recipe_tooltips();\r\n                }\r\n                \r\n                //do those two whether success or fail since materials get used either way\r\n\r\n                if(leveled) {\r\n                    //reload all recipe tooltips of matching category, except it's kinda pointless if reload happens anyway?\r\n                }\r\n            } else {\r\n                console.warn(`Tried to use a recipe without having enough materials!`);\r\n            }\r\n            \r\n        } else if(subcategory === \"components\" || selected_recipe.recipe_type === \"component\" || selected_recipe.recipe_type === \"componentless\" ) {\r\n            //either component, clothing, or componentless\r\n            //read the selected material, pass it as param\r\n\r\n            const material_div = recipe_div.children[1].querySelector(\".selected_material\");\r\n            if(!material_div) {\r\n                return;\r\n            } else {\r\n                const material_1_key = material_div.dataset.item_key;\r\n                const {id} = JSON.parse(material_1_key);\r\n                const recipe_material = selected_recipe.materials.filter(x=> x.material_id===id)[0];\r\n\r\n                if(recipe_material.count <= character.inventory[material_1_key]?.count) {\r\n\r\n                    const recipe_skill = skills[selected_recipe.recipe_skill];\r\n                    let ammount_that_can_be_crafted = Math.min(ammount_wanted_to_craft, Math.floor(character.inventory[material_1_key].count/recipe_material.count));\r\n                    let needed_xp = recipe_skill.total_xp_to_next_lvl - recipe_skill.total_xp;\r\n                    let accumulated_xp = 0;\r\n                    let crafted_items = {};\r\n                    let crafted_count = 0;\r\n                    const all_crafted = {};\r\n                    const result = selected_recipe.getResult(character.inventory[material_1_key].item, station_tier);\r\n\r\n                    let quality;\r\n\r\n                    for(let i = 0; i < ammount_that_can_be_crafted; i++) {\r\n                        //loop for every item to be crafted, as they differ in quality and resultingly in xp too\r\n                        const result_tier = result.component_tier ?? result.item_tier;\r\n                        quality = selected_recipe.get_quality(station_tier - result_tier);\r\n\r\n                        crafted_items[quality] = (crafted_items[quality]+1 || 1);\r\n                        all_crafted[quality] = (all_crafted[quality]+1 || 1);\r\n                        crafted_count++;\r\n\r\n                        accumulated_xp += Math.min(\r\n                            recipe_skill.xp_to_next_lvl*crafting_skill_xp_gains_cap, \r\n                            get_recipe_xp_value({category, subcategory, recipe_id, material_count:recipe_material.count, result_tier: result_tier, rarity_multiplier: rarity_multipliers[getItemRarity(quality)]})* get_skill_xp_gain(recipe_skill.skill_id)\r\n                        );\r\n                        if(accumulated_xp  >= needed_xp) {\r\n                            const qualities = Object.keys(crafted_items).map(x => Number(x)).sort((a,b)=>b-a);\r\n                            const highest_qual = qualities[0];\r\n\r\n                            if(crafted_count > 1) {\r\n                                log_message(`Created ${result.getName()} x${crafted_count} [highest quality: ${highest_qual}% x${crafted_items[highest_qual]}] (+${Math.floor(accumulated_xp)} xp)`, \"crafting\");\r\n                            } else {\r\n                                log_message(`Created ${result.getName()} [${highest_qual}% quality] x1 (+${Math.floor(accumulated_xp)} xp)`, \"crafting\");\r\n                            }\r\n\r\n                            add_xp_to_skill({skill: recipe_skill, xp_to_add: accumulated_xp, cap_gained_xp: false, use_bonus: false});\r\n\r\n                            crafted_items = {};\r\n                            crafted_count = 0;\r\n                            accumulated_xp = 0;\r\n                            needed_xp = recipe_skill.total_xp_to_next_lvl - recipe_skill.total_xp;\r\n                        }\r\n                    }\r\n                    total_crafting_attempts+=ammount_that_can_be_crafted;\r\n                    total_crafting_successes+=ammount_that_can_be_crafted;\r\n\r\n                    if(crafted_count > 0) {\r\n                        const qualities = Object.keys(crafted_items).map(x => Number(x)).sort((a,b)=>b-a);\r\n                        const highest_qual = qualities[0];\r\n\r\n                        if(crafted_count > 1) {\r\n                            log_message(`Created ${result.getName()} x${crafted_count} [highest quality: ${highest_qual}% x${crafted_items[highest_qual]}] (+${Math.floor(accumulated_xp)} xp)`, \"crafting\");\r\n\r\n                        } else {\r\n                            log_message(`Created ${result.getName()} [${highest_qual}% quality] x1 (+${Math.floor(accumulated_xp)} xp)`, \"crafting\");\r\n                        }\r\n                        add_xp_to_skill({skill: recipe_skill, xp_to_add: accumulated_xp, cap_gained_xp: false, use_bonus: false});\r\n                    }\r\n\r\n                    //grab key, modify it with proper quality value, add (together with count) to list for adding to inv\r\n                    const result_key = result.getInventoryKey();\r\n                    const parsed_key = JSON.parse(result_key);\r\n                    const crafted_qualities = Object.keys(all_crafted).map(x => Number(x));\r\n                    const to_add = [];\r\n                    for(let i = 0; i < crafted_qualities.length; i++ ) {\r\n                        const new_key = JSON.stringify({...parsed_key, quality: crafted_qualities[i]});\r\n                        to_add.push({item_key: new_key, count: all_crafted[crafted_qualities[i]]}); \r\n                    }\r\n                    add_to_character_inventory(to_add);\r\n\r\n                    //remove used mats\r\n                    remove_from_character_inventory([{item_key: material_1_key, item_count: recipe_material.count*ammount_that_can_be_crafted}]);\r\n\r\n                    //update display\r\n                    material_div.classList.remove(\"selected_material\");\r\n                    if(character.inventory[material_1_key]) { \r\n                        //if item is still present in inventory + if there's not enough of it = change recipe color\r\n                        if(recipe_material.count > character.inventory[material_1_key].count) { \r\n                            material_div.classList.add(\"recipe_unavailable\");\r\n                        }\r\n                    } else {\r\n                        material_div.remove();\r\n                    }\r\n                    \r\n                    update_displayed_material_choice({category, subcategory, recipe_id, refreshing: true});\r\n                    //update_displayed_crafting_recipes();\r\n                } else {\r\n                    console.log(\"Tried to create an item without having necessary materials\");\r\n                }\r\n            }\r\n            \r\n        } else if(subcategory === \"equipment\") {\r\n            //read the selected components, pass them as params\r\n            \r\n            const component_1_key = recipe_div.children[1].children[0].children[1].querySelector(\".selected_component\")?.dataset.item_key;\r\n            \r\n            const component_2_key = recipe_div.children[1].children[1].children[1].querySelector(\".selected_component\")?.dataset.item_key;\r\n\r\n            if(!component_1_key || !component_2_key) {\r\n                return;\r\n            } else {\r\n                if(!character.inventory[component_1_key] || !character.inventory[component_2_key]) {\r\n                    throw new Error(`Tried to create item with components that are not present in the inventory!`);\r\n                } else {\r\n                    //a probably unnecessary check to see if they are actually in inventory\r\n                    //no need to check how many there is as crafting always takes only 1\r\n                    if(character.inventory[component_1_key].count && character.inventory[component_2_key].count) {\r\n                        \r\n                        const recipe_skill = skills[selected_recipe.recipe_skill]; //should always be \"Crafting\" but who knows what changes in the future?\r\n                        let ammount_that_can_be_crafted = Math.min(ammount_wanted_to_craft, character.inventory[component_1_key].count, character.inventory[component_2_key].count);\r\n                        let needed_xp = recipe_skill.total_xp_to_next_lvl - recipe_skill.total_xp;\r\n                        let accumulated_xp = 0;\r\n                        let crafted_items = {};\r\n                        let crafted_count = 0;\r\n                        const comp_1 = character.inventory[component_1_key].item;\r\n                        const comp_2 = character.inventory[component_2_key].item;\r\n                        const all_crafted = {};\r\n                        const result = selected_recipe.getResult(comp_1, comp_2, station_tier);\r\n\r\n                        let quality;\r\n                        const comp_quality_weighted = selected_recipe.get_component_quality_weighted(comp_1, comp_2);\r\n                        const comp_tier_max = Math.max(comp_1.component_tier, comp_2.component_tier)\r\n\r\n                        for(let i = 0; i < ammount_that_can_be_crafted; i++) {\r\n                            quality = selected_recipe.get_quality(comp_quality_weighted, (station_tier-Math.max(comp_tier_max)) || 0);\r\n\r\n                            crafted_items[quality] = (crafted_items[quality]+1 || 1);\r\n                            all_crafted[quality] = (all_crafted[quality]+1 || 1);\r\n                            crafted_count++;\r\n\r\n                            accumulated_xp += Math.min(\r\n                                    recipe_skill.xp_to_next_lvl, \r\n                                    get_recipe_xp_value({category, subcategory, recipe_id, selected_components: [comp_1, comp_2], rarity_multiplier: rarity_multipliers[getItemRarity(quality)]})*get_skill_xp_gain(recipe_skill.skill_id)\r\n                            );\r\n                            \r\n                            if(accumulated_xp >= needed_xp) {\r\n                                const qualities = Object.keys(crafted_items).map(x => Number(x)).sort((a,b)=>b-a);\r\n                                const highest_qual = qualities[0];\r\n\r\n                                if(crafted_count > 1) {\r\n                                    log_message(`Created ${result.getName()} x${crafted_count} [highest quality: ${highest_qual}% x${crafted_items[highest_qual]}] (+${Math.floor(accumulated_xp)} xp)`, \"crafting\");\r\n                                } else {\r\n                                    log_message(`Created ${result.getName()} [${highest_qual}% quality] x1 (+${Math.floor(accumulated_xp)} xp)`, \"crafting\");\r\n                                }\r\n\r\n                                add_xp_to_skill({skill: recipe_skill, xp_to_add: accumulated_xp, use_bonus: false, cap_gained_xp: false});\r\n\r\n                                crafted_items = {};\r\n                                crafted_count = 0;\r\n                                accumulated_xp = 0;\r\n                                needed_xp = recipe_skill.total_xp_to_next_lvl - recipe_skill.total_xp;\r\n                            }\r\n                        }\r\n\r\n                        total_crafting_attempts+=ammount_that_can_be_crafted;\r\n                        total_crafting_successes+=ammount_that_can_be_crafted;\r\n\r\n                        if(crafted_count > 0) {\r\n                            const qualities = Object.keys(crafted_items).map(x => Number(x)).sort((a,b)=>b-a);\r\n                            const highest_qual = qualities[0];\r\n\r\n                            if(crafted_count > 1) {\r\n                                log_message(`Created ${result.getName()} x${crafted_count} [highest quality: ${highest_qual}% x${crafted_items[highest_qual]}] (+${Math.floor(accumulated_xp)} xp)`, \"crafting\");\r\n\r\n                            } else {\r\n                                log_message(`Created ${result.getName()} [${highest_qual}% quality] x1 (+${Math.floor(accumulated_xp)} xp)`, \"crafting\");\r\n                            }\r\n                            add_xp_to_skill({skill: recipe_skill, xp_to_add: accumulated_xp, use_bonus: false, cap_gained_xp: false});\r\n                        }\r\n\r\n                        //grab key, modify it with proper quality value, add (together with count) to list for adding to inv\r\n                        const result_key = result.getInventoryKey();\r\n                        const parsed_key = JSON.parse(result_key);\r\n                        const crafted_qualities = Object.keys(all_crafted).map(x => Number(x));\r\n                        const to_add = [];\r\n                        for(let i = 0; i < crafted_qualities.length; i++ ) {\r\n                            const new_key = JSON.stringify({...parsed_key, quality: crafted_qualities[i]});\r\n                            to_add.push({item_key: new_key, count: all_crafted[crafted_qualities[i]]}); \r\n                        }\r\n                        add_to_character_inventory(to_add);\r\n\r\n                        //remove used mats\r\n                        remove_from_character_inventory([{item_key: component_1_key, item_count: ammount_that_can_be_crafted}, {item_key: component_2_key, item_count: ammount_that_can_be_crafted}]);\r\n                        const component_keys = {};\r\n                        component_keys[component_1_key] = true;\r\n                        component_keys[component_2_key] = true;\r\n                        update_displayed_component_choice({category, recipe_id, component_keys});\r\n                    }\r\n                }\r\n            }\r\n            //update_displayed_crafting_recipes();\r\n        }  \r\n    }\r\n}\r\n\r\nfunction add_to_content_stack({content_type, data, what_to_remove = content_stack_removal_options.TOP}) {\r\n    content_stack.push({content_type, data, what_to_remove});\r\n\r\n    switch_action_box_content();\r\n}\r\n\r\nfunction remove_from_content_stack() {\r\n    const content = content_stack.pop();\r\n    const what_to_remove = content.what_to_remove || content_stack_removal_options.TOP;\r\n\r\n    if(what_to_remove === content_stack_removal_options.TOP) {\r\n        //nothing - already done\r\n    } else if(what_to_remove === content_stack_removal_options.ALL) {\r\n        //clear it completely, which will default to location display\r\n        while(content_stack[0]) {\r\n            content_stack.pop();\r\n        }\r\n    } else {\r\n        throw new Error(`No such content stack removal option as \"${what_to_remove}\"`);\r\n    }\r\n\r\n    switch_action_box_content();\r\n}\r\n\r\nfunction pass_data_down_the_content_stack({data}) {\r\n    if(content_stack.length > 1) {\r\n        content_stack[content_stack.length - 2].data.special = data;\r\n    }\r\n}\r\n\r\nfunction switch_action_box_content() {\r\n    //cancel everything when switching\r\n    if(current_dialogue) {\r\n        current_dialogue = null;\r\n    } else if(current_activity) {\r\n        current_activity = null;\r\n        end_activity_animation();\r\n    } else if(current_game_action) {\r\n        current_game_action = null;\r\n        end_activity_animation();\r\n        clearInterval(game_action_interval);\r\n    }\r\n\r\n    if(content_stack.length) {\r\n        let {content_type, data} = content_stack[content_stack.length - 1];\r\n\r\n        if(content_type.startsWith(\"dialogue\")) {\r\n            current_dialogue = data.dialogue_key;\r\n        }\r\n        if(content_type === \"dialogue\") {\r\n\r\n            //nothing?\r\n        } else if(content_type === \"dialogue_answer\") {\r\n            //no need to handle this one? (and it's expected to not appear here), as there's no need to put the answer to the stack\r\n        } else if(content_type === \"dialogue_branch\") {\r\n            //need to handle this one, to allow infinite depth branching?\r\n        } else if(content_type === \"action\") {\r\n            //everything else is handled in action code\r\n            current_dialogue = data.dialogue_key;\r\n            current_game_action = data.action_key;\r\n        } else if(content_type === \"activity\") {\r\n            current_activity = data.activity;\r\n            //no need to do much as nothing should be stackable on top of it\r\n        } else {\r\n            throw new Error(`Error on switching action box content: no such content type as \"${content_type}\"`);\r\n        }\r\n\r\n        if(content_type) {\r\n            //something -> pass it forward\r\n            fill_action_box({content_type, data});\r\n        } else {\r\n            //nothing -> shouldn't be possible\r\n        }\r\n        \r\n    } else {\r\n        //stack is empty, just display the current location\r\n\r\n        change_location({location_id: current_location.id, skip_travel_time: true});\r\n    }\r\n}\r\n\r\nfunction character_equip_item(item_key) {\r\n    equip_item_from_inventory(item_key);\r\n    if(current_enemies) {\r\n        reset_combat_loops(true);\r\n    } else if(current_location.tags.safe_zone) {\r\n        //update resource gathering tooltips in case there's a skill lvl bonus change\r\n        //done on any change as of now, but could be slightly optimized\r\n        Object.keys(current_location.activities).forEach(activity_key => {\r\n            if(current_location.activities[activity_key].gained_resources) {\r\n                update_gathering_tooltip(current_location.activities[activity_key]);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction character_unequip_item(item_slot) {\r\n    unequip_item(item_slot);\r\n    if(current_enemies) {\r\n        reset_combat_loops(true);\r\n        //set_new_combat({enemies: current_enemies});\r\n    }\r\n}\r\n\r\nfunction use_item(item_key) { \r\n    const {id} = JSON.parse(item_key);\r\n    const item_effects = item_templates[id].effects;\r\n    let used = false;\r\n    for(let i = 0; i < item_effects.length; i++) {\r\n        const duration = item_templates[id].effects[i].duration;\r\n        if(!active_effects[item_effects[i].effect] || active_effects[item_effects[i].effect].duration < duration) {\r\n\r\n            active_effects[item_effects[i].effect] = new ActiveEffect({...effect_templates[item_effects[i].effect], duration});\r\n            used = true;\r\n        }\r\n        //goes through item effects, checking if it has any that is either not currently active or with longer duration than any active\r\n    }\r\n    \r\n    if(used) {\r\n        update_displayed_effects();\r\n        character.stats.add_active_effect_bonus();\r\n        update_character_stats();\r\n\r\n        const recovered = [];\r\n        Object.keys(item_templates[id].recovery_chances).forEach(recoverable => {\r\n            const chance = item_templates[id].recovery_chances[recoverable];\r\n            if(chance > Math.random()) {\r\n                recovered.push({item_id: recoverable});\r\n            }\r\n        });\r\n        add_to_character_inventory(recovered);\r\n\r\n        //update consuming-related skills if relevant tags are present\r\n        Object.keys(skill_consumable_tags).forEach(skill_id => {\r\n            if(item_templates[id].tags[skill_consumable_tags[skill_id]]) {\r\n                let leveled = add_xp_to_skill({skill: skills[skill_id], xp_to_add: (item_templates[id].value/10)**.6667});\r\n                //if levelup, update all related tooltips\r\n                if(leveled) {\r\n                    character.stats.add_active_effect_bonus();\r\n                    update_character_stats();\r\n                    Object.keys(character.inventory).forEach(item_key => {\r\n                        if(character.inventory[item_key].item.tags[skill_consumable_tags[skill_id]]) {\r\n                            update_displayed_character_inventory({item_key});\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n        remove_from_character_inventory([{item_key}]);\r\n    }\r\n}\r\n\r\nfunction add_consumable_to_favourites(item_id) {\r\n    if(!item_templates[item_id]) {\r\n        throw new Error(`Tried to add \"${item_id}\" to auto consume, but no such item exists.`);\r\n    } else if(!item_templates[item_id].tags.usable) {\r\n        throw new Error(`Tried to add \"${item_id}\" to auto consume, but it's not a consumable.`);\r\n    }\r\n    favourite_consumables[item_id] = true;\r\n    //update autouse button display? currently done in .html\r\n}\r\n\r\nfunction remove_consumable_from_favourites(item_id) {\r\n    if(!favourite_consumables[item_id]) {\r\n        throw new Error(`Tried to remove \"${item_id}\" from auto consume, but it's not there.`);\r\n    }\r\n    delete favourite_consumables[item_id];\r\n    if(character.inventory[item_templates[item_id].getInventoryKey()]) {\r\n        //update autouse button display? currently done in .html\r\n    }\r\n}\r\n\r\nfunction change_consumable_favourite_status(item_id) {\r\n    if(!item_templates[item_id]) {\r\n        throw new Error(`Tried to change \"${item_id}\" auto consum status, but no such item exists.`);\r\n    } else if(!item_templates[item_id].tags.usable) {\r\n        throw new Error(`Tried to change \"${item_id}\" auto consume status, but it's not a consumable.`);\r\n    }\r\n\r\n    if(favourite_consumables[item_id]) {\r\n        remove_consumable_from_favourites(item_id);\r\n    } else {\r\n        add_consumable_to_favourites(item_id);\r\n    }\r\n\r\n    if(character.inventory[item_templates[item_id].getInventoryKey()]) {\r\n        //update autouse button display? currently done in .html\r\n    }\r\n}\r\n\r\nfunction add_item_to_favourites(item_key) {\r\n    favourite_items[item_key] = true;\r\n}\r\n\r\nfunction remove_item_from_favourites(item_key) {\r\n    delete favourite_items[item_key];\r\n}\r\n\r\nfunction change_item_favourite_status(target, item_key) {\r\n    if(favourite_items[item_key]) {\r\n        remove_item_from_favourites(item_key);\r\n        update_fav_display(target, false);\r\n    } else {\r\n        add_item_to_favourites(item_key);\r\n        update_fav_display(target, true);\r\n    }\r\n\r\n    update_displayed_character_inventory({item_key});\r\n}\r\n\r\nfunction add_active_effect(effect_key, duration){\r\n    let do_not_apply_because_stronger_is_active = false; //readable names are good, right?\r\n    Object.keys(active_effects).forEach(effect => {\r\n        if(do_not_apply_because_stronger_is_active) {\r\n            return;\r\n        }\r\n        Object.keys(effect_templates[effect].group_tags).forEach(group_tag => {\r\n            if(do_not_apply_because_stronger_is_active) {\r\n                return;\r\n            }\r\n            if(group_tag in effect_templates[effect_key].group_tags) {\r\n                if(effect_templates[effect].group_tags[group_tag] > effect_templates[effect_key].group_tags[group_tag]) {\r\n                    //stronger effect is active, skip\r\n                    do_not_apply_because_stronger_is_active = true; \r\n                } else {\r\n                    //aply the effect normally, remove the weaker\r\n                    delete active_effects[effect];\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    if(do_not_apply_because_stronger_is_active) {\r\n        //shouldn't need any recalculations or display updates as nothing was changed\r\n        return;\r\n    }\r\n    active_effects[effect_key] = new ActiveEffect({...effect_templates[effect_key], duration});\r\n    character.stats.add_active_effect_bonus();\r\n    update_displayed_effects();\r\n    update_character_stats();\r\n}\r\n\r\n/**\r\n * Handles preliminary management of quest events, simplifying work by automatically providing all the additional data\r\n * @param {Object} quest_event_data \r\n */\r\nfunction do_quest_event({quest_event_type, quest_event_target, quest_event_count}) {\r\n\r\n    questManager.catchQuestEvent({\r\n        quest_event_type,\r\n        quest_event_target,\r\n        quest_event_count,\r\n        additional_quest_tags: {\r\n            location: current_location?.id || \"\",\r\n            season: current_game_time.getSeason() || \"\",\r\n            //just whatever might be possibly needed, to be updated as things expand\r\n        }\r\n    })\r\n}\r\n\r\n/**\r\n * \r\n */\r\nfunction give_export_reward() {\r\n    add_active_effect(\"Spark of Inspiration\", 1800);\r\n    log_message(\"Gained a Spark of Inspiration!\", \"export_reward\");\r\n}\r\n\r\nfunction get_date() {\r\n    const date = new Date();\r\n    const year = date.getFullYear();\r\n    const month_num = date.getMonth()+1;\r\n    const month = month_num > 9 ? month_num.toString() : \"0\" + month_num.toString();\r\n    const day = date.getDate() > 9 ? date.getDate().toString() : \"0\" + date.getDate().toString();\r\n    const hour = date.getHours() > 9 ? date.getHours().toString() : \"0\" + date.getHours().toString();\r\n    const minute = date.getMinutes() > 9 ? date.getMinutes().toString() : \"0\" + date.getMinutes().toString();\r\n    const second = date.getSeconds() > 9 ? date.getSeconds().toString() : \"0\" + date.getSeconds().toString();\r\n    return `${year}-${month}-${day} ${hour}_${minute}_${second}`;\r\n}\r\n\r\nfunction is_on_dev() {\r\n    return window.location.href.endsWith(\"-dev/\");\r\n}\r\n\r\nfunction is_JSON(str) {\r\n    try {\r\n        return (JSON.parse(str) && !!str);\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * puts all important stuff into a string\r\n * @returns string with save data\r\n */\r\nfunction create_save() {\r\n    try{\r\n        const save_data = {};\r\n        save_data[\"game version\"] = game_version;\r\n        save_data[\"current time\"] = current_game_time;\r\n        save_data[\"language\"] = language;\r\n        save_data.saved_at = get_date();\r\n        save_data.total_playtime = total_playtime;\r\n        save_data.total_deaths = total_deaths;\r\n        save_data.total_crafting_attempts = total_crafting_attempts;\r\n        save_data.total_crafting_successes = total_crafting_successes;\r\n        save_data.total_kills = total_kills;\r\n        save_data.total_crits_done = total_crits_done;\r\n        save_data.total_crits_taken = total_crits_taken;\r\n        save_data.total_hits_done = total_hits_done;\r\n        save_data.total_hits_taken = total_hits_taken;\r\n        save_data.strongest_hit = strongest_hit;\r\n        save_data.gathered_materials = gathered_materials;\r\n        save_data.global_flags = global_flags;\r\n        save_data.last_rewarded_export = last_rewarded_export || 0;\r\n        save_data[\"character\"] = {\r\n                                name: character.name, titles: character.titles, \r\n                                inventory: {}, equipment: character.equipment,\r\n                                money: character.money, \r\n                                xp: {\r\n                                    total_xp: character.xp.total_xp,\r\n                                },\r\n                                hp_to_full: character.stats.full.max_health - character.stats.full.health,\r\n                                stamina_to_full: character.stats.full.max_stamina - character.stats.full.stamina,\r\n                                reputation: character.reputation,\r\n                            };\r\n        //stats don't get saved, they will be recalculated upon loading\r\n        save_data[\"player_storage\"] = {inventory: {}};\r\n\r\n        save_data.rain_counter = rain_counter;\r\n        save_data.cold_status_counters = cold_status_counters;\r\n\r\n        save_data.are_finished_quests_hidden = document.getElementById(\"quest_hiding_button\").checked;\r\n\r\n        Object.keys(character.inventory).forEach(key =>{\r\n            save_data[\"character\"].inventory[key] = {count: character.inventory[key].count};\r\n        });\r\n        \r\n        Object.keys(player_storage.inventory).forEach(key =>{\r\n            save_data[\"player_storage\"].inventory[key] = {count: player_storage.inventory[key].count};\r\n        });\r\n       \r\n        //Object.keys(character.equipment).forEach(key =>{\r\n            //save_data[\"character\"].equipment[key] = true;\r\n            //need to rewrite equipment loading first\r\n        //});\r\n\r\n        save_data[\"favourite_consumables\"] = favourite_consumables;\r\n        save_data[\"favourite_items\"] = favourite_items;\r\n\r\n        save_data[\"recipes\"] = {};\r\n        Object.keys(recipes).forEach(category => {\r\n            save_data[\"recipes\"][category] = {};\r\n            Object.keys(recipes[category]).forEach(subcategory => {\r\n                save_data[\"recipes\"][category][subcategory] = {};\r\n                Object.keys(recipes[category][subcategory]).forEach(recipe_id => {\r\n                    save_data[\"recipes\"][category][subcategory][recipe_id] = {};\r\n                    save_data[\"recipes\"][category][subcategory][recipe_id].is_unlocked = recipes[category][subcategory][recipe_id].is_unlocked;\r\n                    save_data[\"recipes\"][category][subcategory][recipe_id].is_finished = recipes[category][subcategory][recipe_id].is_finished;\r\n                });\r\n            });\r\n        });\r\n\r\n        save_data[\"skill_category_order\"] = skill_category_order;\r\n        save_data[\"skills\"] = {};\r\n        Object.keys(skills).forEach(function(key) {\r\n            if(!skills[key].is_parent){\r\n                save_data[\"skills\"][skills[key].skill_id] = {total_xp: skills[key].total_xp}; \r\n                //a bit redundant, but keep it in case key in skills is different than skill_id\r\n            }\r\n        }); //only save total xp of each skill, again in case of any changes\r\n        \r\n        save_data[\"current location\"] = current_location.id;\r\n\r\n        save_data[\"locations\"] = {};\r\n        Object.keys(locations).forEach(function(key) { \r\n            save_data[\"locations\"][key] = {};\r\n            if(locations[key].is_unlocked) {      \r\n                save_data[\"locations\"][key].is_unlocked = true;\r\n            }\r\n            if(locations[key].is_finished) {      \r\n                save_data[\"locations\"][key].is_finished = true;\r\n            }\r\n\r\n            if(\"parent_location\" in locations[key]) { //combat zone //check for is_unlocked too?\r\n                save_data[\"locations\"][key][\"enemy_groups_killed\"] = locations[key].enemy_groups_killed;\r\n            }\r\n\r\n            if(locations[key].activities) {\r\n                save_data[\"locations\"][key][\"unlocked_activities\"] = []\r\n                Object.keys(locations[key].activities).forEach(activity_key => {\r\n                    if(locations[key].activities[activity_key].is_unlocked) {\r\n                        save_data[\"locations\"][key][\"unlocked_activities\"].push(activity_key);\r\n                    }\r\n                });\r\n            }\r\n            if(locations[key].actions) {\r\n                save_data[\"locations\"][key][\"actions\"] = {};\r\n                Object.keys(locations[key].actions).forEach(action_key => {\r\n                    if(locations[key].actions[action_key].is_unlocked || locations[key].actions[action_key].is_finished) {\r\n                        save_data[\"locations\"][key][\"actions\"][action_key] = {};\r\n\r\n                        if(locations[key].actions[action_key].is_unlocked) {\r\n                            save_data[\"locations\"][key][\"actions\"][action_key].is_unlocked = true;\r\n                            if(locations[key].actions[action_key].keep_progress) {\r\n                                save_data[\"locations\"][key][\"actions\"][action_key].accumulated_progress = locations[key].actions[action_key].accumulated_progress;\r\n                            }\r\n                            if(locations[key].actions[action_key].repeatable) {\r\n                                save_data[\"locations\"][key][\"actions\"][action_key].completion_count = locations[key].actions[action_key].completion_count;\r\n                            }\r\n                        }\r\n                        if(locations[key].actions[action_key].is_finished) {\r\n                            save_data[\"locations\"][key][\"actions\"][action_key].is_finished = true;\r\n                        }\r\n                    }\r\n                    \r\n                });\r\n            }\r\n            if(locations[key].housing?.is_unlocked) {\r\n                save_data[\"locations\"][key].housing_unlocked = true;\r\n            }\r\n            if(locations[key].crafting?.is_unlocked) {\r\n                save_data[\"locations\"][key].crafting_unlocked = true;\r\n            }\r\n        }); //save locations' (and their activities'/actions') unlocked status and their killcounts\r\n\r\n        save_data.favourite_locations = favourite_locations;\r\n\r\n        save_data[\"activities\"] = {};\r\n        Object.keys(activities).forEach(function(activity) {\r\n            if(activities[activity].is_unlocked) {\r\n                save_data[\"activities\"][activity] = {is_unlocked: true};\r\n            }\r\n        }); //save activities' unlocked status (this is separate from unlock status in location)\r\n\r\n        if(current_activity) {\r\n            save_data[\"current_activity\"] = {activity_id: current_activity.id, \r\n                                             working_time: current_activity.working_time, \r\n                                             earnings: current_activity.earnings,\r\n                                             gathering_time: current_activity.gathering_time,\r\n                                             gathered_materials: current_activity.gathered_materials,\r\n                                            };\r\n        }\r\n        \r\n        save_data[\"dialogues\"] = {};\r\n        Object.keys(dialogues).forEach(function(dialogue) {\r\n            save_data[\"dialogues\"][dialogue] = {is_unlocked: dialogues[dialogue].is_unlocked, is_finished: dialogues[dialogue].is_finished, textlines: {}, actions: {}};\r\n            if(dialogues[dialogue].textlines) {\r\n                Object.keys(dialogues[dialogue].textlines).forEach(textline_key => {\r\n                    save_data[\"dialogues\"][dialogue].textlines[textline_key] = {is_unlocked: dialogues[dialogue].textlines[textline_key].is_unlocked,\r\n                                                                is_finished: dialogues[dialogue].textlines[textline_key].is_finished};\r\n                });\r\n            }\r\n            if(dialogues[dialogue].actions) {\r\n                Object.keys(dialogues[dialogue].actions).forEach(action_key => {\r\n                    save_data[\"dialogues\"][dialogue].actions[action_key] = {is_unlocked: dialogues[dialogue].actions[action_key].is_unlocked,\r\n                                                                is_finished: dialogues[dialogue].actions[action_key].is_finished};\r\n\r\n                    if(dialogues[dialogue].actions[action_key].keep_progress) {\r\n                        save_data[\"dialogues\"][dialogue].actions[action_key].accumulated_progress = dialogues[dialogue].actions[action_key].accumulated_progress;\r\n                    }\r\n                    if(dialogues[dialogue].actions[action_key].repeatable) {\r\n                        save_data[\"dialogues\"][dialogue].actions[action_key].completion_count = dialogues[dialogue].actions[action_key].completion_count;\r\n                    }\r\n                });\r\n            }\r\n        }); //save dialogues' and their textlines' unlocked/finished statuses\r\n\r\n        save_data[\"traders\"] = {};\r\n        Object.keys(traders).forEach(function(trader) {\r\n            if(traders[trader].is_finished) {\r\n                //trader is no longer accessible\r\n                save_data[\"traders\"][trader] = {is_unlocked: traders[trader].is_unlocked,\r\n                                                is_finished: traders[trader].is_finished};\r\n\r\n            } else if(traders[trader].is_unlocked) {\r\n                if(traders[trader].last_refresh == -1 || traders[trader].can_refresh()) {\r\n                    //no need to save inventory, as trader would be anyway refreshed on any visit\r\n                    save_data[\"traders\"][trader] = {last_refresh: -1,\r\n                                                    is_unlocked: traders[trader].is_unlocked};\r\n                } else {\r\n                    const temp_inventory = {};\r\n                    Object.keys(traders[trader].inventory).forEach(key =>{\r\n                        temp_inventory[key] = {count: traders[trader].inventory[key].count};\r\n                    });\r\n                    save_data[\"traders\"][trader] = {inventory: temp_inventory,\r\n                                                    last_refresh: traders[trader].last_refresh,\r\n                                                    is_unlocked: traders[trader].is_unlocked,\r\n                                                    is_finished: traders[trader].is_finished,\r\n                                                };\r\n                }\r\n            }\r\n        });\r\n\r\n        save_data[\"books\"] = {};\r\n        Object.keys(book_stats).forEach(book => {\r\n            if(book_stats[book].accumulated_time > 0 || book_stats[book].is_finished) {\r\n                //check both conditions, on loading set as finished if either 'is_finished' or has enough time accumulated\r\n                save_data[\"books\"][book] = {\r\n                    accumulated_time: book_stats[book].accumulated_time,\r\n                    is_finished: book_stats[book].is_finished,\r\n                };\r\n            }\r\n        });\r\n\r\n        save_data[\"quests\"] = {};\r\n        Object.keys(quests).forEach(quest_id => {\r\n            //save quest status and their tasks' statuses\r\n\r\n            save_data[\"quests\"][quest_id] = {\r\n                is_active: quest_id in active_quests,\r\n                is_finished: quests[quest_id].is_finished,\r\n                task_status: [],\r\n            };\r\n\r\n            for(let i = 0; i < quests[quest_id].quest_tasks.length; i++) {\r\n                if(quests[quest_id].quest_tasks[i].is_finished) {\r\n                    save_data[\"quests\"][quest_id].task_status[i] = {is_finished: true};\r\n                } else {\r\n                    if(quest_id in active_quests){\r\n                        //save the progress and return, as only up to the first not-completed needs to be saved, anything after that cannot have  progress\r\n                        save_data[\"quests\"][quest_id].task_status[i] = {progress: active_quests[quest_id].quest_tasks[i].task_condition};\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        save_data[\"is_reading\"] = is_reading;\r\n\r\n        save_data[\"is_sleeping\"] = is_sleeping;\r\n\r\n        save_data[\"active_effects\"] = active_effects;\r\n\r\n        save_data[\"enemy_killcount\"] = enemy_killcount;\r\n\r\n        save_data[\"loot_sold_count\"] = loot_sold_count;\r\n\r\n        save_data[\"last_combat_location\"] = last_combat_location;\r\n        save_data[\"last_location_with_bed\"] = last_location_with_bed;\r\n\r\n        save_data[\"options\"] = options;\r\n\r\n        save_data[\"stances\"] = {};\r\n        Object.keys(stances).forEach(stance => {\r\n            if(stances[stance].is_unlocked) {\r\n                save_data[\"stances\"][stance] = true;\r\n            }\r\n        }) \r\n        save_data[\"current_stance\"] = current_stance;\r\n        save_data[\"selected_stance\"] = selected_stance;\r\n        save_data[\"faved_stances\"] = faved_stances;\r\n\r\n        save_data[\"message_filters\"] = {\r\n            unlocks: document.documentElement.style.getPropertyValue('--message_unlocks_display') !== \"none\",\r\n            events: document.documentElement.style.getPropertyValue('--message_events_display') !== \"none\",\r\n            combat: document.documentElement.style.getPropertyValue('--message_combat_display') !== \"none\",\r\n            loot: document.documentElement.style.getPropertyValue('--message_loot_display') !== \"none\",\r\n            background: document.documentElement.style.getPropertyValue('--message_background_display') !== \"none\",\r\n            crafting: document.documentElement.style.getPropertyValue('--message_crafting_display') !== \"none\",\r\n        };\r\n\r\n        save_data[\"skill_list_state\"] = {};\r\n        for (let i = 0; i < skill_list.childElementCount; i++) {\r\n            save_data[\"skill_list_state\"][i] = skill_list.children[i].classList.contains(\"skill_category_expanded\");\r\n        }\r\n\r\n        return JSON.stringify(save_data);\r\n    } catch(error) {\r\n        console.error(\"Something went wrong on saving the game!\");\r\n        console.error(error);\r\n        log_message(\"FAILED TO CREATE A SAVE FILE, PLEASE CHECK CONSOLE FOR ERRORS AND REPORT IT\", \"message_critical\");\r\n    }\r\n} \r\n\r\n/**\r\n * called from index.html\r\n * @returns save string encoded to base64\r\n */\r\nfunction save_to_file() {\r\n    if(Date.now() - last_rewarded_export > time_between_export_rewards) {\r\n        last_rewarded_export = Date.now();\r\n        give_export_reward();\r\n    }\r\n\r\n    //will create save twice...\r\n    save_progress();\r\n    return btoa(create_save());\r\n}\r\n\r\n/**\r\n * saves game state to localStorage, on manual saves also logs message about it being done\r\n * @param {Boolean} is_manual \r\n */\r\nfunction save_to_localStorage({key, is_manual}) {\r\n    const save = create_save();\r\n    if(save) {\r\n        localStorage.setItem(key, save);\r\n        if(is_manual) {\r\n            log_message(\"Saved the game manually\");\r\n            save_counter = 0;\r\n        }\r\n    }\r\n    return JSON.parse(save).saved_at;\r\n}\r\n\r\nfunction save_progress() {\r\n    if(is_on_dev()) {\r\n        save_to_localStorage({key: dev_save_key, is_manual: true});\r\n    } else {\r\n        save_to_localStorage({key: save_key, is_manual: true});\r\n    }\r\n}\r\n\r\n//core function for loading\r\nfunction load(save_data) {\r\n    try{\r\n        //single loading method\r\n        \r\n        //current enemies are not saved\r\n\r\n        let any_warnings = false;\r\n\r\n        current_game_time.loadTime(save_data[\"current time\"]);\r\n        time_field.innerHTML = current_game_time.toString();\r\n        //set game time\r\n\r\n        Object.keys(save_data.global_flags||{}).forEach(flag => {\r\n            \r\n            if(flag === \"is_deep_forest_beaten\") { //compatibility for pre-0.5\r\n                global_flags[\"is_strength_proved\"] = save_data.global_flags[flag];\r\n            } else {\r\n                global_flags[flag] = save_data.global_flags[flag];\r\n            }\r\n        });\r\n\r\n        if(save_data.language) {\r\n            if(languages[save_data.language]) {\r\n                language = save_data.language;\r\n            } else {\r\n                console.warn(`Language ${save_data.language} could not be found.`);\r\n                if(options.mofu_mofu_mode) {\r\n                    language = languages.mofu_english;\r\n                } else {\r\n                    language = languages.english;\r\n                }\r\n            }\r\n            \r\n        }\r\n\r\n        last_rewarded_export = save_data.last_rewarded_export || last_rewarded_export;\r\n\r\n        total_playtime = save_data.total_playtime || 0;\r\n        total_deaths = save_data.total_deaths || 0;\r\n        total_crafting_attempts = save_data.total_crafting_attempts || 0;\r\n        total_crafting_successes = save_data.total_crafting_successes || 0;\r\n        total_kills = save_data.total_kills || 0;\r\n        total_crits_done = save_data.total_crits_done || 0;\r\n        total_crits_taken = save_data.total_crits_taken || 0;\r\n        total_hits_done = save_data.total_hits_done || 0;\r\n        total_hits_taken = save_data.total_hits_taken || 0;\r\n        strongest_hit = save_data.strongest_hit || 0;\r\n        gathered_materials = save_data.gathered_materials || {};\r\n\r\n        name_field.value = save_data.character.name;\r\n        character.name = save_data.character.name;\r\n\r\n        last_location_with_bed = save_data.last_location_with_bed;\r\n        last_combat_location = save_data.last_combat_location;\r\n\r\n        options.uniform_text_size_in_action = save_data.options?.uniform_text_size_in_action;\r\n        option_uniform_textsize(options.uniform_text_size_in_action);\r\n\r\n        options.auto_return_to_bed = save_data.options?.auto_return_to_bed;\r\n        option_bed_return(options.auto_return_to_bed);\r\n\r\n        options.disable_combat_autoswitch = save_data.options?.disable_combat_autoswitch;\r\n        option_combat_autoswitch(options.disable_combat_autoswitch);\r\n\r\n        options.remember_message_log_filters = save_data.options?.remember_message_log_filters;\r\n        if(save_data.message_filters) {\r\n            Object.keys(message_log_filters).forEach(filter => {\r\n                message_log_filters[filter] = save_data.message_filters[filter] ?? true;\r\n            })\r\n        }\r\n\r\n        option_remember_filters(options.remember_message_log_filters);\r\n\r\n        options.log_every_gathering_period = save_data.options?.log_every_gathering_period;\r\n        option_log_all_gathering(options.log_every_gathering_period);\r\n\r\n        options.log_total_gathering_gain = save_data.options?.log_total_gathering_gain;\r\n        option_log_gathering_result(options.log_total_gathering_gain);\r\n\r\n        options.do_background_animations = save_data.options?.do_background_animations;\r\n        option_do_background_animations(options.do_background_animations);\r\n\r\n        options.skip_play_button = save_data.options?.skip_play_button;\r\n        option_skip_play_button(options.skip_play_button);\r\n\r\n        options.mofu_mofu_mode = save_data.options?.mofu_mofu_mode;\r\n        option_mofu_mofu_mode(options.mofu_mofu_mode);\r\n\r\n        options.do_enemy_onhit_animations = save_data.options?.do_enemy_onhit_animations;\r\n        option_do_enemy_onhit_animations(options.do_enemy_onhit_animations);\r\n\r\n        options.expo_threshold = save_data.options?.expo_threshold;\r\n        option_expo_threshold(options.expo_threshold);\r\n\r\n        options.hide_max_level_skills = save_data.options?.hide_max_level_skills;\r\n        option_hide_max_level_skills(options.hide_max_level_skills);\r\n\r\n        document.getElementById(\"quest_hiding_button\").checked = save_data.are_finished_quests_hidden;\r\n        change_completed_quest_visibility();\r\n\r\n        //compatibility for old saves, can be removed at some point\r\n        const is_from_before_eco_rework = compare_game_version(\"v0.3.5\", save_data[\"game version\"]) == 1;\r\n\r\n        character.money = (save_data.character.money || 0) * ((is_from_before_eco_rework == 1)*10 || 1);\r\n        update_displayed_money();\r\n\r\n        add_xp_to_character(save_data.character.xp.total_xp, false);\r\n\r\n        rain_counter = save_data.rain_counter || 0;\r\n        for(let i = 0; i < save_data.cold_status_counters?.length; i++) {\r\n            cold_status_counters[i] = save_data.cold_status_counters[i] || 0;\r\n        }\r\n\r\n        Object.keys(save_data.favourite_consumables || {}).forEach(key => {\r\n            favourite_consumables[key] = true;\r\n        });\r\n        Object.keys(save_data.favourite_items || {}).forEach(key =>{\r\n            favourite_items[key] = true;\r\n        })\r\n\r\n        /*\r\n        Object.keys(save_data.character.reputation || {}).forEach(rep_region => {\r\n            if(rep_region in character.reputation) {\r\n                character.reputation[rep_region] = save_data.character.reputation[rep_region];\r\n            } else {\r\n                console.warn(`Skipped reputation, no such region as \"${rep_region}\"`);\r\n                any_warnings = true;\r\n            }\r\n        });\r\n        */\r\n        update_displayed_reputation();\r\n\r\n\r\n        set_loading_screen_progress(\"Checking out your books\");\r\n        \r\n        if(save_data.skill_category_order) {\r\n            save_data.skill_category_order.forEach((elem, idx) => {\r\n                skill_category_order[idx] = elem;\r\n            });\r\n        }\r\n\r\n        if(save_data.books) {\r\n            let total_book_xp = 0;\r\n            const literacy_xp = save_data.skills[\"Literacy\"].total_xp;\r\n            Object.keys(save_data.books).forEach(book=>{\r\n                if(!item_templates[book]) {\r\n                    console.warn(`Book ${book} couldn't be found and was skipped!`);\r\n                    any_warnings = true;\r\n                }\r\n\r\n                if(save_data.books[book].accumulated_time > 0) {\r\n                    if(save_data.books[book].is_finished) {\r\n                        item_templates[book].setAsFinished();\r\n                        character.stats.add_book_bonus(book_stats[book].bonuses);\r\n                        process_rewards({rewards: book_stats[book].rewards, only_unlocks: true, inform_overall: false, is_from_loading: true});\r\n\r\n                        total_book_xp += book_stats[book].required_time * book_stats[book].literacy_xp_rate;\r\n                    } else {\r\n                        item_templates[book].addProgress(save_data.books[book].accumulated_time);\r\n                        total_book_xp += book_stats[book].accumulated_time * book_stats[book].literacy_xp_rate;\r\n                    }\r\n                }\r\n\r\n                update_booklist_entry(book, save_data.books[book].is_finished);\r\n            });\r\n            if(total_book_xp > literacy_xp) {\r\n                add_xp_to_skill({skill: skills[\"Literacy\"], should_info: false, xp_to_add: total_book_xp, use_bonus: false, cap_gained_xp: false, is_from_loading: true});\r\n                console.warn(`Saved XP for \"Literacy skill\" was less than it should be based on progress with books (${literacy_xp} vs ${total_book_xp}), so it was adjusted to match it!`);\r\n                any_warnings = true;\r\n            } else {\r\n                add_xp_to_skill({skill: skills[\"Literacy\"], should_info: false, xp_to_add: literacy_xp, use_bonus: false, cap_gained_xp: false, is_from_loading: true});\r\n            }\r\n        }\r\n        \r\n        Object.keys(save_data.skills).forEach(key => { \r\n            if(key === \"Literacy\") {\r\n                return; //done separately, for compatibility with older saves (can be eventually removed)\r\n            }\r\n            if(skills[key] && !skills[key].is_parent){\r\n                if(save_data.skills[key].total_xp > 0) {\r\n                    add_xp_to_skill({\r\n                                        skill: skills[key], xp_to_add: save_data.skills[key].total_xp, \r\n                                        should_info: false, add_to_parent: true, use_bonus: false, cap_gained_xp: false,\r\n                                        is_from_loading: true\r\n                                    });\r\n                }\r\n            } else if(save_data.skills[key].total_xp > 0) {\r\n                    console.warn(`Skill \"${key}\" couldn't be found!`);\r\n                    any_warnings = true;\r\n            }\r\n        }); //add xp to skills\r\n\r\n        if(save_data[\"stances\"]) {\r\n            Object.keys(save_data[\"stances\"]).forEach(stance => {\r\n                if(save_data[\"stances\"]) {\r\n                    stances[stance].is_unlocked = true;\r\n                } \r\n            });\r\n        }\r\n\r\n        update_displayed_stance_list(stances, current_stance, faved_stances);\r\n\r\n        if(save_data.faved_stances) {\r\n            Object.keys(save_data.faved_stances).forEach(stance_id=> {\r\n                if(stances[stance_id] && stances[stance_id].is_unlocked) {\r\n                    fav_stance(stance_id);\r\n                }\r\n            });\r\n        }\r\n\r\n        if(save_data.current_stance) {\r\n            current_stance = stances[save_data.current_stance.id] || stances[save_data.current_stance];\r\n            selected_stance = stances[save_data.selected_stance.id] || stances[save_data.selected_stance];\r\n\r\n            change_stance({stance_id: selected_stance.id});\r\n        }\r\n\r\n        Object.keys(save_data.character.equipment).forEach(function(key){\r\n            if(save_data.character.equipment[key] != null) {\r\n                const quality_mult = compare_game_version(\"v0.4.4\", save_data[\"game version\"]) == 1?100:1; //x100 if its from before quality rework\r\n                if(key === \"weapon\") {\r\n                    const {quality, equip_slot} = save_data.character.equipment[key];\r\n                    let components;\r\n                    if(save_data.character.equipment[key].components) {\r\n                        components = save_data.character.equipment[key].components\r\n                    } else {\r\n                        const {head, handle} = save_data.character.equipment[key];\r\n                        components = {head, handle};\r\n                    }\r\n\r\n                    if(!item_templates[components.head]){\r\n                        console.warn(`Skipped item: weapon head component \"${components.head}\" couldn't be found!`);\r\n                        any_warnings = true;\r\n                    } else if(!item_templates[components.handle]) {\r\n                        console.warn(`Skipped item: weapon handle component \"${components.handle}\" couldn't be found!`);\r\n                        any_warnings = true;\r\n                    } else {\r\n                        const item = getItem({components, quality:quality*quality_mult, equip_slot, item_type: \"EQUIPPABLE\"});\r\n                        equip_item(item, true);\r\n                    }\r\n                } else if(key === \"off-hand\") {\r\n                    const {quality, equip_slot} = save_data.character.equipment[key];\r\n                    let components;\r\n                    if(save_data.character.equipment[key].components) {\r\n                        components = save_data.character.equipment[key].components\r\n                    } else {\r\n                        const {shield_base, handle} = save_data.character.equipment[key];\r\n                        components = {shield_base, handle};\r\n                    }\r\n\r\n                    if(!item_templates[components.shield_base]){\r\n                        console.warn(`Skipped item: shield base component \"${components.shield_base}\" couldn't be found!`);\r\n                        any_warnings = true;\r\n                    } else if(!item_templates[components.handle]) {\r\n                        console.warn(`Skipped item: shield handle \"${components.handle}\" couldn't be found!`);\r\n                        any_warnings = true;\r\n                    } else {\r\n                        const item = getItem({components, quality:quality*quality_mult, equip_slot, item_type: \"EQUIPPABLE\"});\r\n                        equip_item(item, true);\r\n                    }\r\n                } else if(save_data.character.equipment[key].equip_slot === \"artifact\" || save_data.character.equipment[key].tags?.tool) {\r\n                    equip_item(getItem({...item_templates[save_data.character.equipment[key].id]}), true);\r\n                } else { //armor\r\n                    \r\n                    const {quality, equip_slot} = save_data.character.equipment[key];\r\n                    \r\n                    if(save_data.character.equipment[key].components && save_data.character.equipment[key].components.internal.includes(\" [component]\")) {\r\n                        //compatibility for armors from before v0.4.3\r\n                        const item = getItem({...item_templates[save_data.character.equipment[key].components.internal.replace(\" [component]\",\"\")], quality:quality*quality_mult});\r\n                        equip_item(item, true);\r\n                    } else if(save_data.character.equipment[key].components) {\r\n                        let components = save_data.character.equipment[key].components;\r\n                        if(!item_templates[components.internal]){\r\n                            console.warn(`Skipped item: internal armor component \"${components.internal}\" couldn't be found!`);\r\n                            any_warnings = true;\r\n                        } else if(components.external && !item_templates[components.external]) {\r\n                            console.warn(`Skipped item: external armor component \"${components.external}\" couldn't be found!`);\r\n                            any_warnings = true;\r\n                        } else {\r\n                            const item = getItem({components, quality:quality*quality_mult, equip_slot, item_type: \"EQUIPPABLE\"});\r\n                            equip_item(item, true);\r\n                        }\r\n                    } else {\r\n                        const item = getItem({...item_templates[save_data.character.equipment[key].name], quality:quality*quality_mult});\r\n                        equip_item(item, true);\r\n                    }\r\n\r\n                }\r\n            }\r\n        }); //equip proper items\r\n\r\n        if(character.equipment.weapon === null) {\r\n            equip_item(null, true);\r\n        }\r\n\r\n        const item_list = [];\r\n\r\n        Object.keys(save_data.character.inventory).forEach(key => {\r\n            if(is_JSON(key)) {\r\n                //case where this is False is left as compatibility for saves before v0.4.4\r\n                let {id, components, quality} = JSON.parse(key);\r\n                if(id && !quality) { \r\n                    //id is just a key of item_templates\r\n                    //if it's present, item is \"simple\" (no components)\r\n                    //and if it has no quality, it's something non-equippable\r\n                    if(item_templates[id]) {\r\n                        if(id === \"Coal\" && is_a_older_than_b(save_data[\"game version\"], \"v0.4.6.12\")) {\r\n                            item_list.push({item_key: item_templates[\"Charcoal\"].getInventoryKey(), count: save_data.character.inventory[key].count, quality: quality});\r\n                        } else {\r\n                            item_list.push({item_key: key, count: save_data.character.inventory[key].count, quality: quality});\r\n                        }\r\n                    } else {\r\n                        console.warn(`Inventory item \"${key}\" from save on version \"${save_data[\"game version\"]} couldn't be found!`);\r\n                        any_warnings = true;\r\n                        return;\r\n                    }\r\n                } else if(components) {\r\n                    const {head, handle, shield_base, internal, external} = components;\r\n                    if(head) { //weapon\r\n                        if(!item_templates[head]){\r\n                            console.warn(`Skipped item: weapon head component \"${head}\" couldn't be found!`);\r\n                            any_warnings = true;\r\n                            return;\r\n                        } else if(!item_templates[handle]) {\r\n                            console.warn(`Skipped item: weapon handle component \"${handle}\" couldn't be found!`);\r\n                            any_warnings = true;\r\n                            return;\r\n                        } else {\r\n                            item_list.push({item_key: key, count: save_data.character.inventory[key].count, quality: quality});\r\n                        }\r\n                    } else if(shield_base){ //shield\r\n                        if(!item_templates[shield_base]){\r\n                            console.warn(`Skipped item: shield base component \"${shield_base}\" couldn't be found!`);\r\n                            any_warnings = true;\r\n                            return;\r\n                        } else if(!item_templates[handle]) {\r\n                            console.warn(`Skipped item: shield handle component \"${handle}\" couldn't be found!`);\r\n                            any_warnings = true;\r\n                            return;\r\n                        } else {\r\n                            item_list.push({item_key: key, count: save_data.character.inventory[key].count, quality: quality});\r\n                        }\r\n                    } else if(internal) { //armor\r\n                        if(!item_templates[internal]){\r\n                            console.warn(`Skipped item: internal armor component \"${internal}\" couldn't be found!`);\r\n                            any_warnings = true;\r\n                            return;\r\n                        } else if(!item_templates[external]) {\r\n                            console.warn(`Skipped item: external armor component \"${external}\" couldn't be found!`);\r\n                            any_warnings = true;\r\n                            return;\r\n                        } else {\r\n                            let equip_slot = getArmorSlot(internal);\r\n                            if(!equip_slot) {\r\n                                return;\r\n                            }\r\n                            item_list.push({item_key: key, count: save_data.character.inventory[key].count, quality: quality});\r\n                        }\r\n                    } else {\r\n                        console.error(`Intentory key \"${key}\" from save on version \"${save_data[\"game version\"]} seems to refer to non-existing item type!`);\r\n                    }\r\n                } else if(quality) { //no comps but quality (clothing / artifact?)\r\n                    item_list.push({item_key: key, count: save_data.character.inventory[key].count, quality: quality});\r\n                } else {\r\n                    console.error(`Intentory key \"${key}\" from save on version \"${save_data[\"game version\"]} is incorrect!`);\r\n                }\r\n            } else { //older savefile\r\n                if(Array.isArray(save_data.character.inventory[key])) { //is a list of unstackable items (equippables or books), needs to be added 1 by 1\r\n                    for(let i = 0; i < save_data.character.inventory[key].length; i++) {\r\n                        if(save_data.character.inventory[key][i].item_type === \"EQUIPPABLE\" ) {\r\n                            if(save_data.character.inventory[key][i].equip_slot === \"weapon\") {\r\n                                \r\n                                const {quality} = save_data.character.inventory[key][i];\r\n                                let components;\r\n                                if(save_data.character.inventory[key][i].components) {\r\n                                    components = save_data.character.inventory[key][i].components\r\n                                } else {\r\n                                    const {head, handle} = save_data.character.inventory[key][i];\r\n                                    components = {head, handle};\r\n                                }\r\n\r\n                                if(!item_templates[components.head]){\r\n                                    console.warn(`Skipped item: weapon head component \"${components.head}\" couldn't be found!`);\r\n                                    any_warnings = true;\r\n                                } else if(!item_templates[components.handle]) {\r\n                                    console.warn(`Skipped item: weapon handle component \"${components.handle}\" couldn't be found!`);\r\n                                    any_warnings = true;\r\n                                } else {\r\n                                    const item = getItem({item_type: \"EQUIPPABLE\", equip_slot: \"weapon\", components});\r\n                                    item_list.push({item_key: item.getInventoryKey(), count: 1, quality: quality*100});\r\n                                }\r\n                            } else if(save_data.character.inventory[key][i].equip_slot === \"off-hand\") {\r\n                                const {quality} = save_data.character.inventory[key][i];\r\n                                let components;\r\n                                if(save_data.character.inventory[key][i].components) {\r\n                                    components = save_data.character.inventory[key][i].components\r\n                                } else {\r\n                                    const {shield_base, handle} = save_data.character.inventory[key][i];\r\n                                    components = {shield_base, handle};\r\n                                }\r\n\r\n                                if(!item_templates[components.shield_base]){\r\n                                    console.warn(`Skipped item: shield base component \"${components.shield_base}\" couldn't be found!`);\r\n                                    any_warnings = true;\r\n                                } else if(!item_templates[components.handle]) {\r\n                                    console.warn(`Skipped item: shield handle \"${components.handle}\" couldn't be found!`);\r\n                                    any_warnings = true;\r\n                                } else {\r\n                                    const item = getItem({item_type: \"EQUIPPABLE\", equip_slot: \"off-hand\", components});\r\n                                    item_list.push({item_key: item.getInventoryKey(), count: 1, quality: quality*100});\r\n                                }\r\n                            } else if(save_data.character.inventory[key][i].equip_slot === \"artifact\" || save_data.character.inventory[key][i].equip_slot === \"amulet\") {\r\n                                item_list.push({item_key: key, count: 1});\r\n                            } else { //armor    \r\n                                if(save_data.character.inventory[key][i].components && save_data.character.inventory[key][i].components.internal.includes(\" [component]\")) {\r\n                                    //compatibility for armors from before v0.4.3\r\n                                    //const item = getItem({item_type: \"EQUIPPABLE\", equip_slot: \"weapon\", components});\r\n                                    item_list.push({item_key: key, count: 1});\r\n                                }\r\n                                else if(save_data.character.inventory[key][i].components) {\r\n                                    let components = save_data.character.inventory[key][i].components;\r\n                                    if(!item_templates[components.internal]){\r\n                                        console.warn(`Skipped item: internal armor component \"${components.internal}\" couldn't be found!`);\r\n                                        any_warnings = true;\r\n                                    } else if(components.external && !item_templates[components.external]) {\r\n                                        console.warn(`Skipped item: external armor component \"${components.external}\" couldn't be found!`);\r\n                                        any_warnings = true;\r\n                                    } else {\r\n                                        const item = getItem({item_type: \"EQUIPPABLE\", components});\r\n                                        item_list.push({item_key: item.getInventoryKey(), count: 1, quality: save_data.character.inventory[key][i].quality*100});\r\n                                    }\r\n                                } else {\r\n                                    item_list.push({item_id: key, count: 1});\r\n                                }\r\n                            }\r\n                        } else {\r\n                            item_list.push({item_id: key, count: 1, quality: save_data.character.inventory[key][i].quality*100});\r\n                        }\r\n                        \r\n                    }\r\n                } else { //is stackable \r\n                    if(item_templates[key]) {\r\n                        item_list.push({item_id: key, count: save_data.character.inventory[key].count});\r\n                    } else {\r\n                        console.warn(`Inventory item \"${key}\" from save on version \"${save_data[\"game version\"]}\" couldn't be found!`);\r\n                        any_warnings = true;\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        }); //add all loaded items to list\r\n        add_to_character_inventory(item_list); // and then to inventory\r\n\r\n        const storage_item_list = [];\r\n        if(save_data.player_storage) {\r\n            Object.keys(save_data.player_storage.inventory).forEach(function(key){\r\n                if(is_JSON(key)) {\r\n                    let {id, components, quality} = JSON.parse(key);\r\n                    if(id && !quality) { \r\n                        //id is just a key of item_templates\r\n                        //if it's present, item is \"simple\" (no components)\r\n                        //and if it has no quality, it's something non-equippable\r\n                        if(item_templates[id]) {\r\n                            storage_item_list.push({item_key: key, count: save_data.player_storage.inventory[key].count, quality: quality});\r\n                        } else {\r\n                            console.warn(`Inventory item \"${key}\" from save on version \"${save_data[\"game version\"]} couldn't be found!`);\r\n                            any_warnings = true;\r\n                            return;\r\n                        }\r\n                    } else if(components) {\r\n                        const {head, handle, shield_base, internal, external} = components;\r\n                        if(head) { //weapon\r\n                            if(!item_templates[head]){\r\n                                console.warn(`Skipped item: weapon head component \"${head}\" couldn't be found!`);\r\n                                any_warnings = true;\r\n                                return;\r\n                            } else if(!item_templates[handle]) {\r\n                                console.warn(`Skipped item: weapon handle component \"${handle}\" couldn't be found!`);\r\n                                any_warnings = true;\r\n                                return;\r\n                            } else {\r\n                                storage_item_list.push({item_key: key, count: save_data.player_storage.inventory[key].count, quality: quality});\r\n                            }\r\n                        } else if(shield_base){ //shield\r\n                            if(!item_templates[shield_base]){\r\n                                console.warn(`Skipped item: shield base component \"${shield_base}\" couldn't be found!`);\r\n                                any_warnings = true;\r\n                                return;\r\n                            } else if(!item_templates[handle]) {\r\n                                console.warn(`Skipped item: shield handle component \"${handle}\" couldn't be found!`);\r\n                                any_warnings = true;\r\n                                return;\r\n                            } else {\r\n                                storage_item_list.push({item_key: key, count: save_data.player_storage.inventory[key].count, quality: quality});\r\n                            }\r\n                        } else if(internal) { //armor\r\n                            if(!item_templates[internal]){\r\n                                console.warn(`Skipped item: internal armor component \"${internal}\" couldn't be found!`);\r\n                                any_warnings = true;\r\n                                return;\r\n                            } else if(!item_templates[external]) {\r\n                                console.warn(`Skipped item: external armor component \"${external}\" couldn't be found!`);\r\n                                any_warnings = true;\r\n                                return;\r\n                            } else {\r\n                                let equip_slot = getArmorSlot(internal);\r\n                                if(!equip_slot) {\r\n                                    return;\r\n                                }\r\n                                storage_item_list.push({item_key: key, count: save_data.player_storage.inventory[key].count, quality: quality});\r\n                            }\r\n                        } else {\r\n                            console.error(`Intentory key \"${key}\" from save on version \"${save_data[\"game version\"]} seems to refer to non-existing item type!`);\r\n                        }\r\n                    } else if(quality) { //no comps but quality (clothing / artifact?)\r\n                        storage_item_list.push({item_key: key, count: save_data.player_storage.inventory[key].count, quality: quality});\r\n                    } else {\r\n                        console.error(`Intentory key \"${key}\" from save on version \"${save_data[\"game version\"]} is incorrect!`);\r\n                    }\r\n                } //storage didn't exist before everything became stackable, so no need to check the other case\r\n            }); //add all loaded items to list\r\n            player_storage.add_to_inventory(storage_item_list); // and then to storage inventory\r\n        }\r\n\r\n        set_loading_screen_progress(\"Meowing at your cat\");\r\n\r\n        Object.keys(save_data.dialogues).forEach(function(dialogue) {\r\n            if(dialogues[dialogue]) {\r\n                dialogues[dialogue].is_unlocked = save_data.dialogues[dialogue].is_unlocked;\r\n                dialogues[dialogue].is_finished = save_data.dialogues[dialogue].is_finished;\r\n            } else {\r\n                if(dialogue === \"cute little rat\" && is_a_older_than_b(save_data[\"game version\"], \"v0.5.0\")) {\r\n                    return;\r\n                }\r\n                console.warn(`Dialogue \"${dialogue}\" couldn't be found!`);\r\n                any_warnings = true;\r\n                return;\r\n            }\r\n            if(save_data.dialogues[dialogue].textlines) {  \r\n                Object.keys(save_data.dialogues[dialogue].textlines).forEach(textline_key => {\r\n                    if(dialogues[dialogue].textlines[textline_key]) {\r\n                        dialogues[dialogue].textlines[textline_key].is_unlocked = save_data.dialogues[dialogue].textlines[textline_key].is_unlocked;\r\n                        dialogues[dialogue].textlines[textline_key].is_finished = save_data.dialogues[dialogue].textlines[textline_key].is_finished;\r\n                    } else {\r\n                        console.warn(`Textline \"${textline_key}\" in dialogue \"${dialogue}\" couldn't be found!`);\r\n                        any_warnings = true;\r\n                        return;\r\n                    }\r\n                }); \r\n            }\r\n            if(save_data.dialogues[dialogue].actions) {  \r\n                Object.keys(save_data.dialogues[dialogue].actions).forEach(action_key => {\r\n                    if(dialogues[dialogue].actions[action_key]) {\r\n                        dialogues[dialogue].actions[action_key].is_unlocked = save_data.dialogues[dialogue].actions[action_key].is_unlocked;\r\n                        dialogues[dialogue].actions[action_key].is_finished = save_data.dialogues[dialogue].actions[action_key].is_finished;\r\n\r\n                        if(dialogues[dialogue].actions[action_key].keep_progress && save_data.dialogues[dialogue].actions[action_key].accumulated_progress) {\r\n                            dialogues[dialogue].actions[action_key].accumulated_progress = save_data.dialogues[dialogue].actions[action_key].accumulated_progress;\r\n                        }\r\n                        if(dialogues[dialogue].actions[action_key].repeatable) {\r\n                            dialogues[dialogue].actions[action_key].completion_count = save_data.dialogues[dialogue].actions[action_key].completion_count || 0;\r\n                        }\r\n                    } else {\r\n                        console.warn(`Textline \"${action_key}\" in dialogue \"${dialogue}\" couldn't be found!`);\r\n                        any_warnings = true;\r\n                        return;\r\n                    }\r\n                }); \r\n            }\r\n        }); //load for dialogues and their textlines and actions their unlocked/finished status\r\n\r\n        if(is_a_older_than_b(save_data[\"game version\"], \"v0.5.1\")) {\r\n            //compatibility for some dialogues\r\n            process_rewards({\r\n                rewards: {\r\n                    textlines: [{dialogue: \"village elder\", lines: [\"crab rumors\"]}]\r\n                },\r\n                inform_overall: false,\r\n            });\r\n\r\n            if(dialogues[\"village guard\"].textlines[\"hello\"].is_finished) {\r\n                process_rewards({\r\n                    rewards: {\r\n                        flags: [\"is_guard_met\"],\r\n                        textlines: [\r\n                            {dialogue: \"village elder\", lines: [\"about guard\"]},\r\n                            {dialogue: \"old craftsman\", lines: [\"about guard\"]},\r\n                            {dialogue: \"village millers\", lines: [\"about guard\"]},\r\n                        ],\r\n                    },\r\n                    inform_overall: false,\r\n                });\r\n            }\r\n\r\n            if(dialogues[\"village guard\"].textlines[\"wide\"].is_finished) {\r\n                process_rewards({\r\n                    rewards: {\r\n                        textlines: [{dialogue: \"village guard\", lines: [\"hi\", \"tips 2\", \"serious\", \"teach more\"]}]\r\n                    },\r\n                    inform_overall: false,\r\n                });\r\n            }\r\n        }\r\n\r\n        Object.keys(save_data.traders).forEach(function(trader) { \r\n            let trader_item_list = [];\r\n            if(traders[trader]){\r\n                traders[trader].is_unlocked = save_data.traders[trader].is_unlocked;\r\n\r\n                if(save_data.traders[trader].is_finished) {\r\n                    traders[trader].is_finished = true;\r\n                    return;\r\n                }\r\n\r\n                if(save_data.traders[trader].inventory) {\r\n                    Object.keys(save_data.traders[trader].inventory).forEach(function(key){\r\n                        if(is_JSON(key)) {\r\n                            let {id, components, quality} = JSON.parse(key);\r\n                            if(id && !quality) { \r\n                                //id is just a key of item_templates\r\n                                //if it's present, item is \"simple\" (no components)\r\n                                //and if it has no quality, it's something non-equippable\r\n                                if(item_templates[id]) {\r\n                                    trader_item_list.push({item_key: key, count: save_data.traders[trader].inventory[key].count});\r\n                                } else {\r\n                                    console.warn(`Inventory item \"${key}\" from save on version \"${save_data[\"game version\"]} couldn't be found!`);\r\n                                    any_warnings = true;\r\n                                    return;\r\n                                }\r\n                            } else if(components) {\r\n                                const {head, handle, shield_base, internal, external} = components;\r\n                                if(head) { //weapon\r\n                                    if(!item_templates[head]){\r\n                                        console.warn(`Skipped item: weapon head component \"${head}\" couldn't be found!`);\r\n                                        any_warnings = true;\r\n                                        return;\r\n                                    } else if(!item_templates[handle]) {\r\n                                        console.warn(`Skipped item: weapon handle component \"${handle}\" couldn't be found!`);\r\n                                        any_warnings = true;\r\n                                        return;\r\n                                    } else {\r\n                                        trader_item_list.push({item_key: key, count: save_data.traders[trader].inventory[key].count, quality});\r\n                                    }\r\n                                } else if(shield_base){ //shield\r\n                                    if(!item_templates[shield_base]){\r\n                                        console.warn(`Skipped item: shield base component \"${shield_base}\" couldn't be found!`);\r\n                                        any_warnings = true;\r\n                                        return;\r\n                                    } else if(!item_templates[handle]) {\r\n                                        console.warn(`Skipped item: shield handle component \"${handle}\" couldn't be found!`);\r\n                                        any_warnings = true;\r\n                                        return;\r\n                                    } else {\r\n                                        //const item = getItem({components, quality, equip_slot: \"off-hand\", item_type: \"EQUIPPABLE\"});\r\n                                        trader_item_list.push({item_key: key, count: save_data.traders[trader].inventory[key].count, quality});\r\n                                    }\r\n                                } else if(internal) { //armor\r\n                                    if(!item_templates[internal]){\r\n                                        console.warn(`Skipped item: internal armor component \"${internal}\" couldn't be found!`);\r\n                                        any_warnings = true;\r\n                                        return;\r\n                                    } else if(!item_templates[external]) {\r\n                                        console.warn(`Skipped item: external armor component \"${external}\" couldn't be found!`);\r\n                                        any_warnings = true;\r\n                                        return;\r\n                                    } else {\r\n                                        if(!getArmorSlot(internal)) {\r\n                                            return;\r\n                                        }\r\n                                        trader_item_list.push({item_key: key, count: save_data.traders[trader].inventory[key].count, quality});\r\n                                    }\r\n                                } else {\r\n                                    console.error(`Intentory key \"${key}\" from save on version \"${save_data[\"game version\"]} seems to refer to non-existing item type!`);\r\n                                }\r\n                            } else if(quality) { //no comps but quality (clothing / artifact?)\r\n                                trader_item_list.push({item_key: key, count: save_data.traders[trader].inventory[key].count, quality});\r\n                            } else {\r\n                                console.error(`Intentory key \"${key}\" from save on version \"${save_data[\"game version\"]} is incorrect!`);\r\n                            }\r\n                            \r\n                        } else { //compatibility for saves before v0.4.4\r\n                            if(Array.isArray(save_data.traders[trader].inventory[key])) { //is a list of unstackable (equippable or book) item, needs to be added 1 by 1\r\n                                for(let i = 0; i < save_data.traders[trader].inventory[key].length; i++) {\r\n                                    if(save_data.traders[trader].inventory[key][i].item_type === \"EQUIPPABLE\"){\r\n                                        if(save_data.traders[trader].inventory[key][i].equip_slot === \"weapon\") {\r\n                                            const {quality} = save_data.traders[trader].inventory[key][i];\r\n                                            let components;\r\n                                            if(save_data.traders[trader].inventory[key][i].components) {\r\n                                                components = save_data.traders[trader].inventory[key][i].components\r\n                                            } else {\r\n                                                const {head, handle} = save_data.traders[trader].inventory[key][i];\r\n                                                components = {head, handle};\r\n                                            }\r\n\r\n                                            if(!item_templates[components.head]){\r\n                                                console.warn(`Skipped item: weapon head component \"${components.head}\" couldn't be found!`);\r\n                                                any_warnings = true;\r\n                                            } else if(!item_templates[components.handle]) {\r\n                                                console.warn(`Skipped item: weapon handle component \"${components.handle}\" couldn't be found!`);\r\n                                                any_warnings = true;\r\n                                            } else {\r\n                                                const item = getItem({components, item_type: \"EQUIPPABLE\", equip_slot: \"weapon\"});\r\n                                                trader_item_list.push({item_key: item.getInventoryKey(), count: 1, quality: quality*100});\r\n                                            }\r\n                                        } else if(save_data.traders[trader].inventory[key][i].equip_slot === \"off-hand\") {\r\n                                            \r\n                                            const {quality} = save_data.traders[trader].inventory[key][i];\r\n                                            let components;\r\n                                            if(save_data.traders[trader].inventory[key][i].components) {\r\n                                                components = save_data.traders[trader].inventory[key][i].components\r\n                                            } else {\r\n                                                const {shield_base, handle} = save_data.traders[trader].inventory[key][i];\r\n                                                components = {shield_base, handle};\r\n                                            }\r\n\r\n                                            if(!item_templates[components.shield_base]){\r\n                                                console.warn(`Skipped item: shield base component \"${components.shield_base}\" couldn't be found!`);\r\n                                                any_warnings = true;\r\n                                            } else if(!item_templates[components.handle]) {\r\n                                                console.warn(`Skipped item: shield handle \"${components.handle}\" couldn't be found!`);\r\n                                                any_warnings = true;\r\n                                            } else {\r\n                                                //trader_item_list.push({item_key: key, count: 1, quality: quality*100});\r\n                                                const item = getItem({components, item_type: \"EQUIPPABLE\", equip_slot: \"off-hand\"});\r\n                                                trader_item_list.push({item_key: item.getInventoryKey(), count: 1, quality: quality*100});\r\n                                            }\r\n                                        } else { //armor\r\n                                            const {quality} = save_data.traders[trader].inventory[key][i];\r\n                                            if(save_data.traders[trader].inventory[key][i].components && save_data.traders[trader].inventory[key][i].components.internal.includes(\" [component]\")) {\r\n                                                //compatibility for armors from before v0.4.3\r\n                                                const item = getItem({...item_templates[key]});\r\n                                                trader_item_list.push({item_key: item.getInventoryKey(), count: 1, quality: quality*100});\r\n                                            } else if(save_data.traders[trader].inventory[key][i].components) {\r\n                                                let components = save_data.traders[trader].inventory[key][i].components;\r\n                                                if(!item_templates[components.internal]){\r\n                                                    console.warn(`Skipped item: internal armor component \"${components.internal}\" couldn't be found!`);\r\n                                                    any_warnings = true;\r\n                                                } else if(components.external && !item_templates[components.external]) {\r\n                                                    console.warn(`Skipped item: external armor component \"${components.external}\" couldn't be found!`);\r\n                                                    any_warnings = true;\r\n                                                } else {\r\n                                                    //trader_item_list.push({item_key: key, count: 1, quality: quality*100});\r\n                                                    const item = getItem({components, item_type: \"EQUIPPABLE\", equip_slot: \"armor\"});\r\n                                                    trader_item_list.push({item_key: item.getInventoryKey(), count: 1, quality: quality*100});\r\n                                                }\r\n                                            } else { //no components, so clothing? not sure, it's old stuff\r\n                                                trader_item_list.push({item_id: key, count: 1, quality: quality*100});\r\n                                            }\r\n                                        }\r\n                                    } else {\r\n                                        console.warn(`Skipped item, no such item type as \"${0}\" could be found`)\r\n                                        any_warnings = true;\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                save_data.traders[trader].inventory[key].item.value = item_templates[key].value;\r\n                                if(item_templates[key].item_type === \"EQUIPPABLE\") {\r\n                                    save_data.traders[trader].inventory[key].item.equip_effect = item_templates[key].equip_effect;\r\n                                } else if(item_templates[key].item_type === \"USABLE\") {\r\n                                    save_data.traders[trader].inventory[key].item.use_effect = item_templates[key].use_effect;\r\n                                }\r\n                                trader_item_list.push({item_id: key, count: save_data.traders[trader].inventory[key].count});\r\n                            }\r\n                        }\r\n                    });\r\n                    \r\n                }\r\n                traders[trader].refresh(); \r\n                traders[trader].inventory = {};\r\n                add_to_trader_inventory(trader, trader_item_list);\r\n\r\n                traders[trader].last_refresh = save_data.traders[trader].last_refresh; \r\n            }\r\n            else {\r\n                console.warn(`Trader \"${trader} couldn't be found!`);\r\n                any_warnings = true;\r\n                return;\r\n            }\r\n        }); //load trader inventories\r\n\r\n        set_loading_screen_progress(\"Hiding rats in your walls\");\r\n\r\n        Object.keys(save_data.locations).forEach(function(key) {\r\n            if(locations[key]) {\r\n                if(save_data.locations[key].is_unlocked) {\r\n                    locations[key].is_unlocked = true;\r\n                }\r\n                if(save_data.locations[key].is_finished) {\r\n                    locations[key].is_finished = true;\r\n                }\r\n                if(\"parent_location\" in locations[key]) { // if combat zone\r\n                    locations[key].enemy_groups_killed = save_data.locations[key].enemy_groups_killed || 0;   \r\n\r\n                    if(is_a_older_than_b(save_data[\"game version\"], \"v0.4.6\")) { //compatibility patch for pre-rep and/or pre-rewrite of rewards with required clear count\r\n                        if(locations[key].rewards_with_clear_requirement) {\r\n                            //process rewards with clear req, as these won't be checked on further clears\r\n                            for(let i = 0; i < locations[key].rewards_with_clear_requirement.length; i++) {\r\n                                if(locations[key].enemy_groups_killed == locations[key].enemy_count * locations[key].rewards_with_clear_requirement[i].required_clear_count)\r\n                                {\r\n                                    //always do it if there was enough or more than enough clears\r\n                                    process_rewards({\r\n                                                        rewards: locations[key].rewards_with_clear_requirement[i], source_type: \"location\", \r\n                                                        source_name: locations[key].name, is_first_clear: false, source_id: locations[key].id,\r\n                                                        is_from_loading: true\r\n                                                    });\r\n                                }\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if(locations[key].rewards_with_clear_requirement) {\r\n                            //process rewards with clear req, as these won't be checked on further clears\r\n                            for(let i = 0; i < locations[key].rewards_with_clear_requirement.length; i++) {\r\n                                if(locations[key].enemy_groups_killed >= locations[key].enemy_count * locations[key].rewards_with_clear_requirement[i].required_clear_count)\r\n                                {\r\n                                    //always do it if there was enough or more than enough clears\r\n                                    process_rewards({\r\n                                                        rewards: locations[key].rewards_with_clear_requirement[i], source_type: \"location\", \r\n                                                        source_name: locations[key].name, is_first_clear: false, source_id: locations[key].id, \r\n                                                        only_unlocks: true, is_from_loading: true\r\n                                                    });\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if(locations[key].first_reward) {\r\n                        //process first clear reward, as it won't be checked on further clears\r\n                        process_rewards({\r\n                            rewards: locations[key].first_reward, \r\n                            source_type: \"location\", \r\n                            is_first_clear: true, \r\n                            source_id: location.id,\r\n                            is_from_loading: true,\r\n                            only_unlocks: true,\r\n                        });\r\n                    }\r\n                }\r\n\r\n                //unlock activities\r\n                if(save_data.locations[key].unlocked_activities) {\r\n                    for(let i = 0; i < save_data.locations[key].unlocked_activities.length; i++) {\r\n                        if(!locations[key].activities[save_data.locations[key].unlocked_activities[i]]) {\r\n                            continue;\r\n                        }\r\n                        if(save_data.locations[key].unlocked_activities[i] === \"plowing the fields\") { //old compatibility patch\r\n                            locations[key].activities[\"fieldwork\"].is_unlocked = true;\r\n                        } else {\r\n                            locations[key].activities[save_data.locations[key].unlocked_activities[i]].is_unlocked = true;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if(save_data.locations[key].actions) {\r\n                    Object.keys(save_data.locations[key].actions).forEach(action_key => {\r\n                        if(save_data.locations[key].actions[action_key].is_unlocked) {\r\n                            locations[key].actions[action_key].is_unlocked = true;\r\n                            if(locations[key].actions[action_key].keep_progress && save_data.locations[key].actions[action_key].accumulated_progress) {\r\n                                locations[key].actions[action_key].accumulated_progress = save_data.locations[key].actions[action_key].accumulated_progress;\r\n                            }\r\n                            if(locations[key].actions[action_key].repeatable) {\r\n                                locations[key].actions[action_key].completion_count = save_data.locations[key].actions[action_key].completion_count || 0;\r\n                            }\r\n                        }\r\n\r\n                        if(save_data.locations[key].actions[action_key].is_finished) {\r\n                            locations[key].actions[action_key].is_finished = true;\r\n                        }\r\n\r\n                    });\r\n                }\r\n\r\n                if(save_data.locations[key].housing_unlocked) {\r\n                    if(!Object.keys(locations[key].housing).length) {\r\n                        console.warn(`Location \"${locations[key].name}\" was saved as having a bed unlocked, but it no longer has this mechanic and was skipped!`);\r\n                        any_warnings = true;\r\n                    } else {\r\n                        locations[key].housing.is_unlocked = true;\r\n                        if(save_data.locations[key].is_unlocked) {\r\n                            unlocked_beds[key] = true;\r\n                        }\r\n                    }\r\n                } else if(locations[key].housing?.is_unlocked){ \r\n                    unlocked_beds[key] = true;\r\n                }\r\n\r\n                if(save_data.locations[key].crafting_unlocked) {\r\n                    if(!Object.keys(locations[key].crafting).length) {\r\n                        console.warn(`Location \"${locations[key].name}\" was saved as having a crafting unlocked, but it no longer has this mechanic and was skipped!`);\r\n                        any_warnings = true;\r\n                    } else {\r\n                        locations[key].crafting.is_unlocked = true;\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                console.warn(`Location \"${key}\" couldn't be found!`);\r\n                any_warnings = true;\r\n                return;\r\n            }\r\n        }); //load for locations their unlocked status and their killcounts\r\n\r\n        if(is_a_older_than_b(save_data[\"game version\"], \"v0.5\")) {\r\n            //unlock status was swapped from local activity to global activity, so a need for this\r\n            if(locations[\"Nearby cave\"].activities[\"climbing\"].is_unlocked) {\r\n                activities[\"climbing\"].is_unlocked = true;\r\n            }\r\n        }\r\n\r\n        if(is_a_older_than_b(save_data[\"game version\"], \"v0.4.6.7\")) {\r\n            locations[\"Town square\"].is_unlocked = false;\r\n            if(save_data[\"current location\"] === \"Town square\") {\r\n                save_data[\"current location\"] = \"Village\";\r\n            }\r\n            //tiny lock and location swap as it was accidentally unlocked in 4.6.0 - 4.6.6\r\n        }\r\n        \r\n\r\n        Object.keys(save_data.activities).forEach(function(activity) {\r\n            if(activities[activity]) {\r\n                activities[activity].is_unlocked = save_data.activities[activity].is_unlocked || false;\r\n            } else if(activity === \"plowing the fields\") { //old compatibility patch\r\n                activities[\"fieldwork\"].is_unlocked = save_data.activities[activity].is_unlocked || false;\r\n            } else {\r\n                console.warn(`Activity \"${activity}\" couldn't be found!`);\r\n                any_warnings = true;\r\n            }\r\n        });\r\n\r\n        if(is_a_older_than_b(save_data[\"game version\"], \"v0.5\")) {\r\n            //save from before v0.5: \r\n            // - split sold count equally between traders\r\n            // - add an \"Old shovel\"\r\n            const loot_count = {};\r\n            const divisor = Object.keys(market_region_mapping).length;\r\n            Object.keys(save_data.loot_sold_count).forEach(loot_key => {\r\n                const count = save_data.loot_sold_count[loot_key];\r\n                Object.keys(market_region_mapping).forEach(region_key => {\r\n                    if(!loot_count[region_key]) {\r\n                        loot_count[region_key] = {};\r\n                    }\r\n                    \r\n                    loot_count[region_key][loot_key] = [{sold: 0, recovered: 0}];\r\n                    loot_count[region_key][loot_key][0].sold = Math.floor(count.sold/divisor);\r\n                    loot_count[region_key][loot_key][0].recovered = Math.floor(count.recovered/divisor);\r\n                });\r\n            });\r\n            set_loot_sold_count(loot_count);\r\n            \r\n            if(dialogues[\"old craftsman\"].textlines[\"learn\"].is_finished) {\r\n                add_to_character_inventory([{item_id: \"Old shovel\"}]);\r\n            }\r\n        } else if(is_a_older_than_b(save_data[\"game version\"], \"v0.5.0.22\") && is_a_older_than_b(\"v0.5\", save_data[\"game version\"])) {\r\n            //save between 0.5 and trickle rate fix\r\n            const loot_count = {};\r\n            \r\n            Object.keys(save_data.loot_sold_count).forEach(region_key => {\r\n                loot_count[region_key] = {};\r\n                Object.keys(save_data.loot_sold_count[region_key]).forEach(trade_key => {\r\n                    loot_count[region_key][trade_key] = [];\r\n                    for(let i = 0; i < save_data.loot_sold_count[region_key][trade_key].length; i++) {\r\n                        if(save_data.loot_sold_count[region_key][trade_key][i].sold > capped_at) {\r\n                            console.warn(`Encountered a large sold count (${save_data.loot_sold_count[region_key][trade_key][i].sold}) of a trade group \"${trade_key}\" at tier ${i}. Due to the save being from a game version where a certain bug`\r\n                                    + ` could make these values keep growing by themselves, it was reduced to ${capped_at}, and it's recovered_count was lowered proportionally.`);\r\n\r\n                            const ratio = save_data.loot_sold_count[region_key][trade_key][i].recovered/save_data.loot_sold_count[region_key][trade_key][i].sold;\r\n                            save_data.loot_sold_count[region_key][trade_key][i].sold = capped_at;\r\n                            save_data.loot_sold_count[region_key][trade_key][i].recovered = capped_at*ratio;\r\n                        }\r\n\r\n                        loot_count[region_key][trade_key].push({sold: save_data.loot_sold_count[region_key][trade_key][i].sold, recovered: save_data.loot_sold_count[region_key][trade_key][i].recovered});\r\n                    }\r\n                });\r\n            });\r\n\r\n            set_loot_sold_count(loot_count);\r\n        } else {\r\n            //set it normally\r\n            set_loot_sold_count(save_data.loot_sold_count || {});\r\n        }\r\n\r\n        //load active effects if save is not from before their rework\r\n        if(compare_game_version(save_data[\"game version\"], \"v0.4.4\") >= 0){\r\n            Object.keys(save_data.active_effects).forEach(function(effect) {\r\n                active_effects[effect] =  new ActiveEffect({...effect_templates[effect], duration: save_data.active_effects[effect].duration});\r\n            });\r\n            character.stats.add_active_effect_bonus();\r\n        }\r\n\r\n        set_loading_screen_progress(\"Hiding from the vet\");\r\n\r\n        if(save_data.character.hp_to_full == null || save_data.character.hp_to_full >= character.stats.full.max_health) {\r\n            character.stats.full.health = 1;\r\n        } else {\r\n            character.stats.full.health = character.stats.full.max_health - save_data.character.hp_to_full;\r\n        }\r\n        \r\n        //if missing hp is null (save got corrupted) or its more than max_health, set health to minimum allowed (which is 1)\r\n        //otherwise just do simple substraction\r\n        //then same with stamina below\r\n        if(save_data.character.stamina_to_full == null || save_data.character.stamina_to_full >= character.stats.full.max_stamina) {\r\n            character.stats.full.stamina = 0;\r\n        } else {\r\n            character.stats.full.stamina = character.stats.full.max_stamina - save_data.character.stamina_to_full;\r\n        }\r\n\r\n        set_loading_screen_progress(\"Hiding rats in your walls (again!)\");\r\n\r\n        if(save_data[\"enemy_killcount\"]) {\r\n            Object.keys(save_data[\"enemy_killcount\"]).forEach(enemy_name => {\r\n                enemy_killcount[enemy_name] = save_data[\"enemy_killcount\"][enemy_name];\r\n                create_new_bestiary_entry(enemy_name);\r\n            });\r\n        }\r\n\r\n        set_loading_screen_progress(\"Looking for things that can be done tomorrow instead\");\r\n\r\n        if(save_data[\"quests\"]) {\r\n            Object.keys(save_data[\"quests\"]).forEach(quest => {\r\n\r\n                if(save_data[\"quests\"][quest].is_finished) {\r\n                    //finished => all tasks are also finished, don't care about their specifics\r\n                    for(let i = 0; i < quests[quest].quest_tasks.length; i++) {\r\n                        quests[quest].quest_tasks[i].is_finished = true;\r\n                    }\r\n                    questManager.startQuest({quest_id: quest, should_inform: false});\r\n                    questManager.finishQuest({quest_id: quest, should_inform: false, only_unlocks: true, is_from_loading: true});\r\n\r\n                } else if(save_data[\"quests\"][quest].is_active) {\r\n                    questManager.startQuest({quest_id: quest, should_inform: false});\r\n                    //active => at least 1 task is unfinished and its specifics matter\r\n                    for(let i = 0; i < save_data[\"quests\"][quest].task_status.length-1; i++) {\r\n                        //set all but last to finished\r\n                        quests[quest].quest_tasks[i].is_finished = true;\r\n                    }\r\n\r\n                    //set progress of the first unfinished task\r\n                    const unfinished_index = save_data[\"quests\"][quest].task_status.length-1;\r\n                    const first_unfinished_task = save_data[\"quests\"][quest].task_status[unfinished_index].progress;\r\n\r\n\r\n                    Object.keys(first_unfinished_task || {}).forEach(task_group => {\r\n                        if(!quests[quest].quest_tasks[unfinished_index].task_condition[task_group]) {\r\n                            console.warn(`Skipped loading progress for quest \"${quest}\", no such task group as \"${task_group}\" was present.`);\r\n                            any_warnings = true;\r\n                            return;\r\n                        }\r\n                        Object.keys(first_unfinished_task[task_group]).forEach(task_type =>{\r\n                            if(!quests[quest].quest_tasks[unfinished_index].task_condition[task_group][task_type]) {\r\n                                console.warn(`Skipped loading progress for quest \"${quest}\", no such task type as \"${task_type}\" was present.`);\r\n                                any_warnings = true;\r\n                                return;\r\n                            }\r\n                            Object.keys(first_unfinished_task[task_group][task_type]).forEach(task_target_id => {\r\n                                if(!quests[quest].quest_tasks[unfinished_index].task_condition[task_group][task_type][task_target_id]) {\r\n                                    console.warn(`Skipped loading progress for quest \"${quest}\", no such task target as \"${task_target_id}\" was present.`);\r\n                                    any_warnings = true;\r\n                                    return;\r\n                                }\r\n                                quests[quest].quest_tasks[unfinished_index].task_condition[task_group][task_type][task_target_id].current = first_unfinished_task[task_group][task_type][task_target_id].current;\r\n                            });\r\n                        });\r\n                    });\r\n                    if(!quests[quest].is_hidden) {\r\n                        update_displayed_quest(quest);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        //save from before quests, need to manually setup story quests\r\n        if(is_a_older_than_b(save_data[\"game version\"], \"v0.5.0\")){\r\n            \r\n            //memory line\r\n            questManager.startQuest({quest_id: \"Lost memory\", should_inform: false});\r\n            if(dialogues[\"village elder\"].textlines[\"what happened\"].is_finished) {\r\n                questManager.finishQuestTask({quest_id: \"Lost memory\", task_index: 0, skip_message: true});\r\n\r\n                if(dialogues[\"village elder\"].textlines[\"need to\"].is_finished) {\r\n                    questManager.finishQuestTask({quest_id: \"Lost memory\", task_index: 1, skip_message: true});\r\n\r\n                    if(dialogues[\"village elder\"].textlines[\"cleared cave\"].is_finished) {\r\n                        questManager.finishQuestTask({quest_id: \"Lost memory\", task_index: 2, skip_message: true});\r\n    \r\n                        if(dialogues[\"suspicious man\"].textlines[\"defeated\"].is_finished) {\r\n                            questManager.finishQuestTask({quest_id: \"Lost memory\", task_index: 3, skip_message: true});\r\n                        }\r\n                    }\r\n                }\r\n                \r\n            }\r\n\r\n            //rat saga line\r\n            if(locations[\"Suspicious wall\"].is_finished) {\r\n                questManager.startQuest({quest_id: \"The Infinite Rat Saga\", should_inform: false});\r\n\r\n                if(locations[\"Mysterious gate\"].enemy_groups_killed >= locations[\"Mysterious gate\"].enemy_count) {\r\n                    questManager.finishQuestTask({quest_id: \"The Infinite Rat Saga\", task_index: 0, skip_message: true});\r\n\r\n                    if(locations[\"Nearby cave\"].actions[\"open the gate\"].is_finished) {\r\n                        questManager.finishQuestTask({quest_id: \"The Infinite Rat Saga\", task_index: 1, skip_message: true});\r\n\r\n                        if(locations[\"Writhing tunnel\"].enemy_groups_killed >= locations[\"Writhing tunnel\"].enemy_count) {\r\n                            questManager.finishQuestTask({quest_id: \"The Infinite Rat Saga\", task_index: 2, skip_message: true});\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            //slums line\r\n            if(dialogues[\"suspicious man\"].textlines[\"gang\"].is_finished) {\r\n                questManager.startQuest({quest_id: \"Light in the darkness\", should_inform: false});\r\n                questManager.finishQuestTask({quest_id: \"Light in the darkness\", task_index: 0, skip_message: true});\r\n\r\n                if(locations[\"Gang hideout\"].is_finished) {\r\n                    questManager.finishQuestTask({quest_id: \"Light in the darkness\", task_index: 1, skip_message: true});\r\n                }\r\n            }\r\n\r\n            //town farm quest\r\n            if(dialogues[\"farm supervisor\"].textlines[\"fight0\"].is_finished || dialogues[\"farm supervisor\"].textlines[\"fight\"].is_finished) {\r\n                questManager.startQuest({quest_id: \"Ploughs to swords\", should_inform: false});\r\n\r\n                if(dialogues[\"farm supervisor\"].textlines[\"fight\"].is_finished) {\r\n                    questManager.finishQuestTask({quest_id: \"Ploughs to swords\", task_index: 0, skip_message: true});\r\n                    \r\n                    if(dialogues[\"farm supervisor\"].textlines[\"defeated boars\"].is_finished) {\r\n                        questManager.finishQuestTask({quest_id: \"Ploughs to swords\", task_index: 1, skip_message: true});\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        //reposted because \"fight\" textline was originally not included, causing issues\r\n        if(is_a_older_than_b(save_data[\"game version\"], \"v0.5.0.7\") && is_a_older_than_b(\"v0.5.0\", save_data[\"game version\"])){ \r\n             if(dialogues[\"farm supervisor\"].textlines[\"fight0\"].is_finished || dialogues[\"farm supervisor\"].textlines[\"fight\"].is_finished) {\r\n                questManager.startQuest({quest_id: \"Ploughs to swords\", should_inform: false});\r\n\r\n                if(dialogues[\"farm supervisor\"].textlines[\"fight\"].is_finished) {\r\n                    questManager.finishQuestTask({quest_id: \"Ploughs to swords\", task_index: 0, skip_message: true});\r\n                    \r\n                    if(dialogues[\"farm supervisor\"].textlines[\"defeated boars\"].is_finished) {\r\n                        questManager.finishQuestTask({quest_id: \"Ploughs to swords\", task_index: 1, skip_message: true});\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        //continuation for compatibility as there was no good place in dialogues to put it in...\r\n        if(dialogues[\"farm supervisor\"].textlines[\"defeated boars\"].is_finished) {\r\n            dialogues[\"farm supervisor\"].textlines[\"troubled\"].is_unlocked = true;\r\n        }\r\n        \r\n        set_loading_screen_progress(\"Mixing catnip with more catnip\");\r\n\r\n        if(save_data[\"recipes\"]) {\r\n            Object.keys(save_data[\"recipes\"]).forEach(category => {\r\n                Object.keys(save_data[\"recipes\"][category]).forEach(subcategory => {\r\n                    Object.keys(save_data[\"recipes\"][category][subcategory]).forEach(recipe_id => {\r\n                        if(!recipes[category][subcategory][recipe_id]) {\r\n                            if(is_a_older_than_b(save_data[\"game version\"], \"v0.5.0\")){\r\n                                if(\r\n                                    (\r\n                                        category === \"crafting\" \r\n                                        && subcategory === \"items\" \r\n                                        && (recipes[\"butchering\"][\"items\"][recipe_id] || recipes[\"woodworking\"][\"items\"][recipe_id])\r\n                                    )\r\n                                    || recipe_id === \"Shield base\" \r\n                                    || recipe_id === \"Shield handle\"\r\n                                ) {\r\n                                    //don't warn as they were moved to different category\r\n                                    return;\r\n                                }\r\n                            }\r\n\r\n                            console.warn(`Could not find recipe \"${category}\"->\"${subcategory}\"->\"${recipe_id}\". It might have been removed.`);\r\n                            any_warnings = true;\r\n                            return;\r\n                        }\r\n                        if(save_data[\"recipes\"][category][subcategory][recipe_id].is_unlocked) {\r\n                            recipes[category][subcategory][recipe_id].is_unlocked = true;\r\n                        }\r\n                        if(save_data[\"recipes\"][category][subcategory][recipe_id].is_finished) {\r\n                            recipes[category][subcategory][recipe_id].is_finished = true;\r\n                        }\r\n                    });\r\n                });\r\n            });\r\n        }\r\n\r\n        set_loading_screen_progress(\"Doing some finishing pats\");\r\n\r\n        if(save_data.favourite_locations) {\r\n            Object.keys(save_data.favourite_locations).forEach(location_key => {\r\n                if(locations[location_key]) {\r\n                    favourite_locations[location_key] = true;\r\n                } else {\r\n                    console.warn(`Saved favourite locations included \"${location_key}\", which is not a valid location id`);\r\n                    any_warnings = true;\r\n                }\r\n            });\r\n        }\r\n\r\n        if(save_data.skill_list_state) {\r\n            Object.keys(save_data.skill_list_state).forEach(index => {\r\n                if (skill_list.childElementCount > 0 && save_data.skill_list_state[index]) {\r\n                    skill_list.children[index].classList.add(\"skill_category_expanded\");\r\n                }\r\n            })\r\n        }\r\n\r\n        update_character_stats();\r\n        update_displayed_character_inventory();\r\n\r\n        update_displayed_health();\r\n        //load current health\r\n        \r\n        update_displayed_effects();\r\n        \r\n        create_displayed_crafting_recipes();\r\n        change_location({location_id: save_data[\"current location\"], skip_travel_time: true, do_quest_events: false, skip_combat: true});\r\n\r\n        //temperature is location dependent so display setting is loaded after location is set\r\n        options.use_uncivilised_temperature_scale = save_data.options?.use_uncivilised_temperature_scale;\r\n        option_use_uncivilised_temperature_scale(options.use_uncivilised_temperature_scale);\r\n\r\n        //set activity if any saved\r\n        if(save_data.current_activity) {\r\n            //search for it in location from save_data\r\n            const activity_id = save_data.current_activity.activity_id;\r\n            if(typeof activity_id !== \"undefined\" && current_location.activities[activity_id] && activities[current_location.activities[activity_id].activity_name]) {\r\n                \r\n                start_activity(activity_id);\r\n                if(activities[current_location.activities[activity_id].activity_name].type === \"JOB\") {\r\n                    current_activity.working_time = save_data.current_activity.working_time;\r\n                    current_activity.earnings = save_data.current_activity.earnings * ((is_from_before_eco_rework == 1)*10 || 1);\r\n                    document.getElementById(\"action_end_earnings\").innerHTML = `(earnings: ${format_money(current_activity.earnings)})`;\r\n                } else if(activities[current_location.activities[activity_id].activity_name].type === \"GATHERING\") {\r\n                    current_activity.gathered_materials = save_data.current_activity.gathered_materials || {};\r\n                }\r\n\r\n                current_activity.gathering_time = save_data.current_activity.gathering_time;\r\n                \r\n            } else {\r\n                console.warn(`Couldn't find saved activity \"${activity_id}\"! It might have been removed`);\r\n                any_warnings = true;\r\n            }\r\n        }\r\n\r\n        if(save_data.is_sleeping) {\r\n            start_sleeping();\r\n        }\r\n        if(save_data.is_reading) {\r\n            start_reading(save_data.is_reading);\r\n        }\r\n\r\n        if(any_warnings) {\r\n            set_loading_screen_warnings_warning();\r\n        }\r\n\r\n        update_displayed_time();\r\n        set_loading_screen_versions(save_data[\"game version\"]);\r\n    } catch(error) {\r\n        set_loading_screen_versions(save_data[\"game version\"]);\r\n        throw error;\r\n    }\r\n} \r\n\r\n/**\r\n * called from index.html;\r\n * loads game from file by resetting everything that needs to be reset and then calling main loading method with same parameter;\r\n * @param {String} save_string \r\n */\r\nfunction load_from_file(save_string) {\r\n    try{\r\n        if(is_on_dev()) {\r\n            localStorage.setItem(dev_save_key, atob(save_string));\r\n        } else {\r\n            localStorage.setItem(save_key, atob(save_string));\r\n        }        \r\n        window.location.reload(false);\r\n    } catch (error) {\r\n        console.error(\"Something went wrong on preparing to load from file!\");\r\n        console.error(error);\r\n    }\r\n} \r\n\r\n/**\r\n * loads the game from localStorage\r\n * it's called when page is refreshed, so there's no need for it to reset anything\r\n */\r\nfunction load_from_localstorage() {\r\n    try{\r\n        if(is_on_dev()) {\r\n            if(localStorage.getItem(dev_save_key)){\r\n                load(JSON.parse(localStorage.getItem(dev_save_key)));\r\n                log_message(\"Loaded dev save. If you want to use save from live version, import it through options panel or manually\");\r\n            } else {\r\n                //no need to check if it should import or do a fresh start (in case it's a result of hard reset), as that's already handled elsewhere\r\n                load(JSON.parse(localStorage.getItem(save_key)));\r\n                log_message(\"Dev save was not found. Loaded live version save.\");\r\n            }\r\n        } else {\r\n            load(JSON.parse(localStorage.getItem(save_key)));\r\n        }\r\n    } catch(error) {\r\n        is_loading_error = true;\r\n        set_loading_screen_progress(\"Something went wrong \uD83D\uDE2D\");\r\n        set_loading_screen_errors_warning();\r\n        console.error(\"Something went wrong on loading from localStorage!\");\r\n        console.error(error);\r\n    }\r\n}\r\n\r\nfunction load_backup() {\r\n    try{\r\n        if(is_on_dev()) {\r\n            if(localStorage.getItem(dev_backup_key)){\r\n                localStorage.setItem(dev_save_key, localStorage.getItem(dev_backup_key));\r\n                window.location.reload(false);\r\n            } else {\r\n                console.log(\"Can't load backup as there is none yet.\");\r\n                log_message(\"Can't load backup as there is none yet.\");\r\n            }\r\n        } else {\r\n            if(localStorage.getItem(backup_key)){\r\n                localStorage.setItem(save_key, localStorage.getItem(backup_key));\r\n                window.location.reload(false);\r\n            } else {\r\n                console.log(\"Can't load backup as there is none yet.\")\r\n                log_message(\"Can't load backup as there is none yet.\");\r\n            }\r\n        }\r\n    } catch(error) {\r\n        console.error(\"Something went wrong on loading from localStorage!\");\r\n        console.error(error);\r\n    }\r\n}\r\n\r\nfunction load_other_release_save() {\r\n    try{\r\n        if(is_on_dev()) {\r\n            if(localStorage.getItem(save_key)){\r\n                localStorage.setItem(dev_save_key, localStorage.getItem(save_key));\r\n                window.location.reload(false);\r\n            } else {\r\n                console.log(\"There are no saves on the other release.\")\r\n                log_message(\"There are no saves on the other release.\");\r\n            }\r\n        } else {\r\n            if(localStorage.getItem(dev_save_key)){\r\n                localStorage.setItem(save_key, localStorage.getItem(dev_save_key));\r\n                window.location.reload(false);\r\n            } else {\r\n                console.log(\"There are no saves on the other release.\");\r\n                log_message(\"There are no saves on the other release.\");\r\n            }\r\n        }\r\n    } catch(error) {\r\n        console.error(\"Something went wrong on loading from localStorage!\");\r\n        console.error(error);\r\n    }\r\n}\r\n\r\nfunction hard_reset() {\r\n    let confirmation = prompt(`This will erase all your progress and you will have to start from the very beginning. If you are sure this is what you want, type \"reset\" below`);\r\n\r\n    if(confirmation === \"reset\" || confirmation === `\"reset\"`) {\r\n        if(is_on_dev()) {\r\n            localStorage.removeItem(dev_save_key);\r\n            localStorage.setItem(\"skip_live_import\", \"true\");\r\n        } else {\r\n            localStorage.removeItem(save_key);\r\n        }\r\n        window.location.reload();\r\n        return false;\r\n    } else {\r\n        console.log(\"Hard reset was cancelled.\");\r\n    }\r\n}\r\n\r\n//update game time\r\nfunction update_timer(time_in_minutes) {\r\n    const was_night = is_night(current_game_time);\r\n    current_game_time.goUp(time_in_minutes || (is_sleeping ? 6 : 1));\r\n\r\n    //update_character_stats(); //done every second, probably only used for day-night cycle at this point\r\n    const daynight_change = was_night !== is_night(current_game_time);\r\n    if(daynight_change) {\r\n        update_character_stats();\r\n    }\r\n    \r\n    update_displayed_time();\r\n}\r\n\r\nfunction progress_time({value = 0, source}) {\r\n    update_timer(value);\r\n\r\n    update_effect_durations({time_in_minutes: value, is_sleep: is_sleeping, is_travel: source===\"travel\"});\r\n}\r\n\r\n/**\r\n * \r\n * @param {Object} param0\r\n * @param {String} param0.source skipped -> assume it's normal game ticks\r\n */\r\nfunction update_effect_durations({time_in_minutes = 1, is_travel}) {\r\n    let were_stats_updated = false;\r\n    Object.keys(active_effects).forEach(key => {\r\n        if(!is_travel || is_travel && active_effects[key].affected_by_travel) {\r\n\r\n            active_effects[key].duration-= time_in_minutes;\r\n            if(active_effects[key].duration <= 0) {\r\n                //duration ended - remove effect\r\n                delete active_effects[key];\r\n                character.stats.add_active_effect_bonus();\r\n                update_character_stats();\r\n                were_stats_updated = true; //only for use later, as skipping update in here would be bad\r\n            }\r\n        }\r\n    });\r\n\r\n    return were_stats_updated;\r\n}\r\n\r\nfunction update() {\r\n    setTimeout(() => {\r\n        end_date = Date.now(); \r\n        //basically when previous tick ends, used for timer smoothing\r\n\r\n        time_variance_accumulator += ((end_date - start_date) - 1000/tickrate);\r\n        //duration of previous tick, minus time it was supposed to take\r\n        //important to keep it between setting end_date and start_date, so they are 2 completely separate values\r\n\r\n        start_date = Date.now();\r\n        /*\r\n        basically when current tick starts\r\n        so before this assignment, start_date is when previous tick started\r\n        and end_date is when previous_tick ended\r\n        */\r\n\r\n        let were_stats_updated = false;\r\n        const prev_day = current_game_time.day;\r\n        update_timer();\r\n\r\n        if(start_date - last_rewarded_export > time_between_export_rewards) {\r\n            document.getElementById(\"save_to_file_button\").classList.add(\"export_button_with_reward\");\r\n        } else {\r\n            document.getElementById(\"save_to_file_button\").classList.remove(\"export_button_with_reward\");\r\n        }\r\n\r\n        update_export_button_tooltip(start_date - last_rewarded_export, time_between_export_rewards);\r\n\r\n        const curr_day = current_game_time.day;\r\n        if(curr_day > prev_day) {\r\n            recover_item_prices(trade_price_recovery_flat, trade_price_recovery_ratio);\r\n            trickle_market_saturations(market_saturation_trickle_rate);\r\n            if(is_in_trade()) {\r\n                //update displayed prices due to recovery\r\n                update_displayed_character_inventory({is_trade: true});\r\n                update_displayed_trader_inventory();\r\n            }\r\n        }\r\n\r\n        //update effect durations and displays;\r\n        were_stats_updated = were_stats_updated || update_effect_durations({time_in_minutes: 1});\r\n        update_displayed_effect_durations();\r\n        update_displayed_effects();\r\n\r\n        const new_temperature = get_current_temperature_smoothed();\r\n\r\n        if(!current_location.is_under_roof) {\r\n            //not under roof, background animations can happen\r\n            if(is_raining()) {\r\n                if(rain_counter >= time_until_wet) {\r\n                //been in rain long enough, add wet even if present\r\n                    add_active_effect(\"Wet\",30);\r\n                } else {\r\n                    //haven't been in rain long enough, increase the counter\r\n\r\n                    if(new_temperature < 0)\r\n                        //snowing, doesn't soak the player as much the rain\r\n                        rain_counter += 0.25\r\n                    else \r\n                        rain_counter++;\r\n                }\r\n\r\n                if(!was_raining && options.do_background_animations) {\r\n\r\n                    window.removeEventListener(\"resize\", start_stars_animation);\r\n\r\n                    if(new_temperature >= 0) {\r\n                        window.addEventListener(\"resize\", start_rain_animation);\r\n                        window.removeEventListener(\"resize\", start_snow_animation);\r\n                        start_rain_animation();\r\n                    } else {\r\n                        window.addEventListener(\"resize\", start_snow_animation);\r\n                        window.removeEventListener(\"resize\", start_rain_animation);\r\n                        start_snow_animation();\r\n                    }\r\n                }\r\n\r\n                was_raining = true && options.do_background_animations;\r\n            } else {\r\n                //not raining\r\n\r\n                if(rain_counter > 0) {\r\n                    //not in rain -> reduce rain counter\r\n                    rain_counter--;\r\n                }\r\n                was_raining = false;\r\n\r\n                //not in rain -> sky visible\r\n                if(!was_starry && is_night()) {\r\n\r\n                    if(options.do_background_animations) {\r\n                        window.addEventListener(\"resize\", start_stars_animation);\r\n                        window.removeEventListener(\"resize\", start_snow_animation);\r\n                        window.removeEventListener(\"resize\", start_rain_animation);\r\n                        start_stars_animation();\r\n                    }\r\n                    was_starry = true && options.do_background_animations;\r\n                } else if(was_starry && !is_night()) {\r\n                    stop_background_animation();\r\n                    window.removeEventListener(\"resize\", start_stars_animation);\r\n                }\r\n            }\r\n        } else {\r\n            //under roof\r\n            if(was_raining || was_starry) {\r\n                //was animation - stop doing that\r\n                stop_background_animation();\r\n                window.removeEventListener(\"resize\", start_stars_animation);\r\n                window.removeEventListener(\"resize\", start_snow_animation);\r\n                window.removeEventListener(\"resize\", start_rain_animation);\r\n            }\r\n            was_raining = false;\r\n            was_starry = false;\r\n        }\r\n\r\n        //temperature changed => update stats if needed\r\n        if(current_temperature !== new_temperature) {\r\n            if(!were_stats_updated) {\r\n                update_character_stats();\r\n            }\r\n        }\r\n        //update temperature display every tick, it's just easiest this way\r\n        update_displayed_temperature();\r\n\r\n        current_temperature = new_temperature;\r\n\r\n        //add cold status if applicable\r\n        let was_effect_added = false;\r\n        for(let i = cold_status_temperatures.length - 1; i >= 0; i--) {\r\n            if(current_temperature + get_character_cold_tolerance() <= cold_status_temperatures[i]) {\r\n                if((active_effects[\"Wet\"] && cold_status_counters[i] >= time_until_cold_when_wet) || (cold_status_counters[i] >= time_until_cold)) {\r\n                    if(was_effect_added) {\r\n                        continue;\r\n                    }\r\n                    add_active_effect(cold_status_effects[i],60);\r\n                } else {\r\n                    cold_status_counters[i]++;\r\n                }\r\n\r\n                add_xp_to_skill({skill: skills[\"Cold resistance\"], xp_to_add: 0.2});\r\n            } else {\r\n                if(cold_status_counters[i] > 0) {\r\n                    cold_status_counters[i]--;\r\n                }\r\n            }\r\n        }\r\n\r\n        if(\"parent_location\" in current_location){ //if it's a combat_zone\r\n\r\n            //use consumables if their longest effect ran out\r\n            //remove them from list if there are no more in inventory\r\n            Object.keys(favourite_consumables).forEach(item_id => {\r\n                const inv_key = item_templates[item_id].getInventoryKey();\r\n                if(!character.inventory[inv_key]) {\r\n                    //if out of item, remove it from auto-consume\r\n                    remove_consumable_from_favourites(item_id);\r\n                    return;\r\n                }\r\n\r\n                const effects = item_templates[item_id].effects.sort((a,b) => {\r\n                    if(options.auto_use_when_longest_runs_out) {\r\n                        return b.duration-a.duration;\r\n                    } else {\r\n                         return a.duration-b.duration;\r\n                    }\r\n                });\r\n\r\n                //if effect not active, use item and return\r\n                if(!active_effects[effects[0].effect]) {\r\n                    use_item(inv_key);\r\n                    //use will call 'remove item' which will call 'remove consumable from favs', so nothing more to do here\r\n                    return;\r\n                }\r\n            });\r\n\r\n\r\n            //go through location's types, check if any of them applie active effects, if so then add them\r\n            for(let i = 0; i < current_location.types.length; i++) {\r\n                const effect_key = current_location.types[i].type;\r\n                const stage = current_location.types[i].stage;\r\n                if(location_types[effect_key].stages[stage].applied_effects) {\r\n                    for(let j = 0; j < location_types[effect_key].stages[stage].applied_effects.length; j++) {\r\n                        add_active_effect(location_types[effect_key].stages[stage].applied_effects[j].effect, location_types[effect_key].stages[stage].applied_effects[j].duration);\r\n                    }\r\n                }\r\n            }\r\n\r\n            add_xp_to_skill({skill: skills[\"Breathing\"], xp_to_add: 0.1});\r\n        } else { //everything other than combat\r\n            if(is_sleeping) {\r\n                do_sleeping();\r\n                add_xp_to_skill({skill: skills[\"Sleeping\"], xp_to_add: current_location.housing?.sleeping_xp_per_tick});\r\n            }\r\n            else {\r\n                if(is_resting) {\r\n                    do_resting();\r\n                }\r\n                if(is_reading) {\r\n                    do_reading();\r\n                }\r\n            } \r\n\r\n            if(selected_stance.id !== current_stance.id) {\r\n                change_stance({stance_id: selected_stance.id});\r\n            }\r\n\r\n            if(current_activity) { //in activity\r\n\r\n                //if effects: add them\r\n                if(current_activity.applied_effects) {\r\n                    for(let i = 0; i < current_activity.applied_effects.length; i++) {\r\n                        add_active_effect(current_activity.applied_effects[i].effect, current_activity.applied_effects[i].duration);\r\n                    }\r\n                }\r\n\r\n                //add xp to all related skills\r\n                if(activities[current_activity.activity_name].type !== \"GATHERING\"){\r\n                    for(let i = 0; i < activities[current_activity.activity_name].base_skills_names?.length; i++) {\r\n                        add_xp_to_skill({skill: skills[activities[current_activity.activity_name].base_skills_names[i]], xp_to_add: current_activity.skill_xp_per_tick});\r\n                    }\r\n                }\r\n\r\n                if(activities[current_activity.activity_name].type === \"TRAINING\") {\r\n                    add_xp_to_skill({skill: skills[\"Breathing\"], xp_to_add: 0.5});\r\n                } else {\r\n                    add_xp_to_skill({skill: skills[\"Breathing\"], xp_to_add: 0.1});\r\n                }\r\n\r\n                current_activity.gathering_time += 1;\r\n                if(current_activity.gained_resources && current_activity.gathering_time >= current_activity.gathering_time_needed) { \r\n                    const {gathering_time_needed, gained_resources} = current_activity.getActivityEfficiency();\r\n\r\n                    current_activity.gathering_time_needed = gathering_time_needed;\r\n\r\n                    const items = [];\r\n\r\n                    for(let i = 0; i < gained_resources.length; i++) {\r\n                        if(Math.random() > (1-gained_resources[i].chance)) {\r\n                            const count = Math.floor(Math.random()*(gained_resources[i].count[1]-gained_resources[i].count[0]+1))+gained_resources[i].count[0];\r\n\r\n                            items.push({item_key: item_templates[gained_resources[i].name].getInventoryKey(), count: count});\r\n\r\n                            gathered_materials[gained_resources[i].name] = (gathered_materials[gained_resources[i].name] || 0) + count;\r\n                        }\r\n                    }\r\n\r\n                    if(items.length > 0) {\r\n                        if(options.log_every_gathering_period) {\r\n                            log_loot({loot_list: items});\r\n                        }\r\n\r\n                        for(let i = 0; i < items.length; i++) {\r\n                            current_activity.gathered_materials[items[i].item_key] = (current_activity.gathered_materials[items[i].item_key] + items[i].count || items[i].count);\r\n                        }\r\n                        \r\n                        add_to_character_inventory(items);\r\n                    }\r\n\r\n                    let leveled = false;\r\n                    if(activities[current_activity.activity_name].type === \"GATHERING\"){\r\n                        for(let i = 0; i < activities[current_activity.activity_name].base_skills_names?.length; i++) {\r\n                            leveled = add_xp_to_skill({skill: skills[activities[current_activity.activity_name].base_skills_names[i]], xp_to_add: current_activity.skill_xp_per_tick}) || leveled;\r\n                        }\r\n                        \r\n                        //if(leveled) {\r\n                            update_gathering_tooltip(current_activity);\r\n                        //}\r\n                    }\r\n\r\n                    current_activity.gathering_time = 0;\r\n                }\r\n\r\n                //if job: payment\r\n                if(activities[current_activity.activity_name].type === \"JOB\") {\r\n                    current_activity.working_time += 1;\r\n\r\n                    if(current_activity.working_time % current_activity.working_period == 0) { \r\n                        //finished working period, add money\r\n                        current_activity.earnings += current_activity.get_payment();\r\n                    }\r\n\r\n                    update_displayed_ongoing_activity(current_activity, true);\r\n                }\r\n                if(activities[current_activity.activity_name].type !== \"JOB\") {\r\n                    update_displayed_ongoing_activity(current_activity, false);\r\n                }\r\n    \r\n                if(!can_work(current_activity)) {\r\n                    end_activity();\r\n                }\r\n                \r\n            } else {\r\n                //no current activity\r\n\r\n                add_xp_to_skill({skill: skills[\"Breathing\"], xp_to_add: 0.1});\r\n                const divs = document.getElementsByClassName(\"activity_div\");\r\n                //go through all displayed activities, if they are of proper type check if they are available and if there's a change, modify their display\r\n                for(let i = 0; i < divs.length; i++) {\r\n                    const activity = current_location.activities[divs[i].getAttribute(\"data-activity\")];\r\n\r\n                    if(activities[activity.activity_name].type === \"JOB\" || activities[activity.activity_name].type === \"TRAINING\") {\r\n                        if(can_work(activity)) {\r\n                            divs[i].classList.remove(\"activity_unavailable\");\r\n                            divs[i].classList.add(\"start_activity\");\r\n                        } else {\r\n                            divs[i].classList.remove(\"start_activity\");\r\n                            divs[i].classList.add(\"activity_unavailable\");\r\n                        }\r\n                        \r\n                    }\r\n                }\r\n            }\r\n\r\n            let sounds = current_location.getBackgroundNoises();\r\n            if(sounds.length > 0){\r\n                if(Math.random() < 1/600) {\r\n                    log_message(`\"${sounds[Math.floor(Math.random()*sounds.length)]}\"`, \"background\");\r\n                }\r\n            }\r\n            if (current_activity && Math.random() < 1/100) {\r\n                sounds = activities[current_activity.activity_name].getBackgroundNoises();\r\n                if(sounds.length > 0){\r\n                    log_message(`\"${sounds[Math.floor(Math.random()*sounds.length)]}\"`, \"background\");\r\n                }\r\n            }\r\n        }\r\n\r\n        let health_to_add = 0;\r\n        let health_to_subtract = 0\r\n        //health regen\r\n        if(character.stats.full.health_regeneration_flat) {\r\n            health_to_add += character.stats.full.health_regeneration_flat;\r\n        }\r\n        if(character.stats.full.health_regeneration_percent) {\r\n            health_to_add += character.stats.full.max_health * character.stats.full.health_regeneration_percent/100;\r\n        }\r\n        //health loss\r\n        if(character.stats.full.health_loss_flat) {\r\n            health_to_subtract -= character.stats.full.health_loss_flat;\r\n        }\r\n        if(character.stats.full.health_loss_percent) {\r\n            health_to_subtract += character.stats.full.max_health * character.stats.full.health_loss_percent/100;\r\n        }\r\n\r\n        update_health({ammount_to_restore: health_to_add, ammount_to_loose: health_to_subtract});\r\n\r\n        //stamina regen\r\n        if(character.stats.full.stamina_regeneration_flat) {\r\n            character.stats.full.stamina += character.stats.full.stamina_regeneration_flat;\r\n        }\r\n        if(character.stats.full.stamina_regeneration_percent) {\r\n            character.stats.full.stamina += character.stats.full.max_stamina * character.stats.full.stamina_regeneration_percent/100;\r\n        }\r\n        //mana regen\r\n        if(character.stats.full.mana_regeneration_flat) {\r\n            character.stats.full.mana += character.stats.full.mana_regeneration_flat\r\n        }\r\n        if(character.stats.full.mana_regeneration_percent) {\r\n            character.stats.full.mana += character.stats.full.max_mana * character.stats.full.mana_regeneration_percent/100;\r\n        }\r\n\r\n        if(character.stats.full.stamina > character.stats.full.max_stamina) {\r\n            character.stats.full.stamina = character.stats.full.max_stamina\r\n        }\r\n\r\n        if(character.stats.full.stamina_regeneration_flat || character.stats.full.stamina_regeneration_percent) {\r\n            update_displayed_stamina();\r\n        }\r\n        \r\n        save_counter += 1;\r\n        if(save_counter >= save_period*tickrate) {\r\n            save_counter = 0;\r\n            if(is_on_dev()) {\r\n                save_to_localStorage({key: dev_save_key});\r\n            } else {\r\n                save_to_localStorage({key: save_key});\r\n            }\r\n            console.log(\"Auto-saved the game!\");\r\n        } //save in regular intervals, irl time independent from tickrate\r\n\r\n        backup_counter += 1;\r\n        if(backup_counter >= backup_period*tickrate) {\r\n            backup_counter = 0;\r\n            let saved_at;\r\n            if(is_on_dev()) {\r\n                saved_at = save_to_localStorage({key: dev_backup_key});\r\n            } else {\r\n                saved_at = save_to_localStorage({key: backup_key});\r\n            }\r\n\r\n            if(saved_at) {\r\n                update_backup_load_button(saved_at);\r\n            }\r\n            console.log(\"Created an automatic backup!\");\r\n        }\r\n\r\n        if(!is_sleeping && current_location && current_location.light_level === \"normal\" && is_night()) {\r\n            add_xp_to_skill({skill: skills[\"Night vision\"], xp_to_add: 1});\r\n        }\r\n\r\n        //add xp to proper skills based on location types\r\n        if(current_location) {\r\n            const skills = current_location.gained_skills;\r\n            let leveled = false;\r\n            for(let i = 0; i < skills?.length; i++) {\r\n                leveled = add_xp_to_skill({skill: current_location.gained_skills[i].skill, xp_to_add: current_location.gained_skills[i].xp}) || leveled;\r\n            }\r\n            if(leveled){\r\n                update_displayed_location_types(current_location);\r\n            }\r\n        }\r\n\r\n        //limiting maximum adjustment, to avoid any absurd results;\r\n        if(time_variance_accumulator <= 100/tickrate && time_variance_accumulator >= -100/tickrate) {\r\n            time_adjustment = time_variance_accumulator;\r\n        }\r\n        else {\r\n            if(time_variance_accumulator > 100/tickrate) {\r\n                time_adjustment = 100/tickrate;\r\n            }\r\n            else {\r\n                if(time_variance_accumulator < -100/tickrate) {\r\n                    time_adjustment = -100/tickrate;\r\n                }\r\n            }\r\n        }\r\n\r\n        total_playtime += 1/tickrate;\r\n        update();\r\n    }, 1000/tickrate - time_adjustment);\r\n    //uses time_adjustment based on time_variance_accumulator for more precise overall stabilization\r\n    //(instead of only stabilizing relative to previous tick, it stabilizes relative to sum of deviations)\r\n    //probably completely unnecessary lol, but hey, it sounds cool\r\n}\r\n\r\nfunction run() {\r\n    if(typeof current_location === \"undefined\") {\r\n        change_location({location_id: \"Village\", skip_travel_time: true});\r\n    } \r\n\r\n    if(current_location.parent_location) {\r\n        start_combat();\r\n    }\r\n    \r\n    update_displayed_health();\r\n        \r\n    start_date = Date.now();\r\n    update();\r\n}\r\n\r\nwindow.equip_item = character_equip_item;\r\nwindow.unequip_item = character_unequip_item;\r\n\r\nwindow.change_location = change_location;\r\nwindow.reload_normal_location = reload_normal_location;\r\nwindow.handleLocationIconClick = handle_location_icon_click;\r\nwindow.remove_location_from_favourites = remove_location_from_favourites;\r\n\r\nwindow.start_dialogue = start_dialogue;\r\nwindow.end_dialogue = end_dialogue;\r\nwindow.start_textline = start_textline;\r\n\r\nwindow.remove_fast_travel_choice = remove_fast_travel_choice;\r\n\r\nwindow.start_activity = start_activity;\r\nwindow.end_activity = end_activity;\r\n\r\nwindow.start_game_action = start_game_action;\r\nwindow.end_game_action = end_game_action;\r\n\r\nwindow.start_sleeping = start_sleeping;\r\nwindow.end_sleeping = end_sleeping;\r\n\r\nwindow.start_reading = start_reading;\r\nwindow.end_reading = end_reading;\r\n\r\nwindow.start_trade = start_trade;\r\nwindow.exit_trade = exit_trade;\r\nwindow.add_to_buying_list = add_to_buying_list;\r\nwindow.remove_from_buying_list = remove_from_buying_list;\r\nwindow.add_to_selling_list = add_to_selling_list;\r\nwindow.remove_from_selling_list = remove_from_selling_list;\r\nwindow.cancel_trade = cancel_trade;\r\nwindow.accept_trade = accept_trade;\r\nwindow.is_in_trade = is_in_trade;\r\nwindow.update_displayed_total_price = update_displayed_total_price;\r\n\r\nwindow.open_storage = open_storage;\r\nwindow.exit_storage = close_storage;\r\nwindow.move_item_to_storage = move_item_to_storage;\r\nwindow.remove_item_from_storage = remove_item_from_storage;\r\nwindow.is_storage_open = is_storage_open;\r\n\r\nwindow.format_money = format_money;\r\nwindow.get_character_money = character.get_character_money;\r\n\r\nwindow.use_item = use_item;\r\nwindow.change_consumable_favourite_status = change_consumable_favourite_status;\r\nwindow.change_item_favourite_status = change_item_favourite_status;\r\nwindow.update_fav_display = update_fav_display;\r\n\r\nwindow.do_enemy_combat_action = do_enemy_combat_action;\r\n\r\nwindow.sort_displayed_inventory = sort_displayed_inventory;\r\nwindow.update_displayed_character_inventory = update_displayed_character_inventory;\r\nwindow.update_displayed_trader_inventory = update_displayed_trader_inventory;\r\nwindow.update_displayed_storage_inventory = update_displayed_storage_inventory;\r\n\r\nwindow.sort_displayed_skills = sort_displayed_skills;\r\n\r\nwindow.change_stance = change_stance;\r\nwindow.fav_stance = fav_stance;\r\n\r\nwindow.openCraftingWindow = open_crafting_window;\r\nwindow.closeCraftingWindow = close_crafting_window;\r\nwindow.switchCraftingRecipesPage = switch_crafting_recipes_page;\r\nwindow.switchCraftingRecipesSubpage = switch_crafting_recipes_subpage;\r\nwindow.useRecipe = use_recipe;\r\nwindow.updateDisplayedComponentChoice = update_displayed_component_choice;\r\nwindow.updateDisplayedMaterialChoice = update_displayed_material_choice;\r\nwindow.updateRecipeTooltip = update_recipe_tooltip;\r\n\r\nwindow.remove_from_content_stack = remove_from_content_stack;\r\n\r\nwindow.option_uniform_textsize = option_uniform_textsize;\r\nwindow.option_bed_return = option_bed_return;\r\nwindow.option_combat_autoswitch = option_combat_autoswitch;\r\nwindow.option_remember_filters = option_remember_filters;\r\nwindow.option_log_all_gathering = option_log_all_gathering;\r\nwindow.option_log_gathering_result = option_log_gathering_result;\r\nwindow.option_use_uncivilised_temperature_scale = option_use_uncivilised_temperature_scale;\r\nwindow.option_do_background_animations = option_do_background_animations;\r\nwindow.option_skip_play_button = option_skip_play_button;\r\nwindow.option_mofu_mofu_mode = option_mofu_mofu_mode;\r\nwindow.option_do_enemy_onhit_animations = option_do_enemy_onhit_animations;\r\nwindow.option_expo_threshold = option_expo_threshold;\r\nwindow.option_hide_max_level_skills = option_hide_max_level_skills;\r\n\r\nwindow.change_completed_quest_visibility = change_completed_quest_visibility;\r\n\r\nwindow.getDate = get_date;\r\n\r\nwindow.isOnDev = is_on_dev;\r\n\r\nwindow.saveProgress = save_progress;\r\nwindow.save_to_file = save_to_file;\r\nwindow.load_progress = load_from_file;\r\nwindow.loadBackup = load_backup;\r\nwindow.importOtherReleaseSave = load_other_release_save;\r\nwindow.hardReset = hard_reset;\r\nwindow.get_game_version = get_game_version;\r\n\r\nwindow.run = run;\r\n\r\n//Verify_Game_Objects();\r\nwindow.Verify_Game_Objects = Verify_Game_Objects;\r\n\r\nset_loading_screen_progress(\"Waking up from a nyap...\");\r\n\r\nplay_button.addEventListener(\"click\", run);\r\nplay_button.addEventListener(\"click\", hide_loading_screen);\r\n\r\n\r\n//check if there's an existing save file, otherwise just do some initial setup\r\nif(!is_on_dev() && save_key in localStorage || is_on_dev() && (dev_save_key in localStorage || !(\"skip_live_import\" in localStorage) && save_key in localStorage )) {\r\n    load_from_localstorage();\r\n    update_character_stats();\r\n    update_displayed_xp_bonuses();\r\n} else {\r\n    set_loading_screen_versions();\r\n    add_to_character_inventory([{item_id: \"Cheap iron sword\", quality: 40},\r\n                                {item_id: \"Cheap leather pants\", quality: 40},\r\n                                {item_id: \"Stale bread\", count: 5},\r\n                            ]);\r\n\r\n    add_xp_to_character(0);\r\n    character.money = 102;\r\n    update_displayed_money();\r\n    update_character_stats();\r\n\r\n    update_displayed_stance_list(stances, current_stance, faved_stances);\r\n    change_stance({stance_id: \"normal\"});\r\n    create_displayed_crafting_recipes();\r\n    change_location({location_id: \"Village\", skip_travel_time: true});\r\n    questManager.startQuest({quest_id: \"Lost memory\"});\r\n\r\n    last_rewarded_export = Date.now() - 1000*60*60*16; //reduces timer by 16 hours, making first reward export appear in 4 hours from starting\r\n}\r\n\r\n\r\n\r\nif(!is_loading_error) {\r\n    set_loading_screen_progress(\"Waiting for you to click 'PLAY'\");\r\n    hide_loading_text();\r\n    show_play_button();\r\n} else {\r\n    hide_loading_text();\r\n    set_play_button_text(\"Play...?\");\r\n    show_play_button();\r\n}\r\n\r\n\r\nfunction add_stuff_for_testing() {\r\n    const items = [];\r\n    for(let i = 1; i < 250; i++) {\r\n        items.push({item_id: \"Iron sword\", quality:i});\r\n        items.push({item_id: \"Cheap iron sword\", quality:i});\r\n    }\r\n    add_to_character_inventory(items);\r\n}\r\n\r\nfunction add_all_stuff_to_inventory(count = 10){\r\n    Object.keys(item_templates).forEach(item => {\r\n        add_to_character_inventory([\r\n            {item_id: item, count: count},\r\n        ]);\r\n    })\r\n}\r\n\r\nfunction add_all_active_effects(duration){\r\n    Object.keys(effect_templates).forEach(effect_key => {\r\n        active_effects[effect_key] = new ActiveEffect({...effect_templates[effect_key], duration});\r\n    });\r\n    character.stats.add_active_effect_bonus();\r\n    update_displayed_effects();\r\n}\r\n\r\n//add_to_character_inventory([{item_id: \"Iron sword\", count: 20, quality: 100}]);\r\n//add_to_character_inventory([{item_id: \"Iron sword\", count: 20, quality: 120}]);\r\n//add_to_character_inventory([{item_id: \"Camping supplies\", count: 20}]);\r\n\r\n//add_stuff_for_testing();\r\n//add_all_stuff_to_inventory();\r\n//add_all_active_effects(120);\r\n//add_consumable_to_favourites(\"Stale bread\");\r\n\r\nupdate_displayed_equipment();\r\nsort_displayed_inventory({sort_by: \"name\", target: \"character\"});\r\n\r\nif(options.skip_play_button) {\r\n    play_button.click();\r\n}\r\n\r\nif(is_on_dev()) {\r\n    log_message(\"It looks like you are playing on the dev release. It is recommended to keep the developer console open (in Chrome/Firefox/Edge it's at F12 => 'Console' tab) in case of any errors/warnings appearing in there.\", \"notification\");\r\n\r\n    if(localStorage[dev_backup_key]) {\r\n        update_backup_load_button(JSON.parse(localStorage[dev_backup_key]).saved_at);\r\n    } else {\r\n        update_backup_load_button();\r\n    }\r\n\r\n    if(localStorage[save_key]) {\r\n        update_other_save_load_button(JSON.parse(localStorage[save_key]).saved_at || \"\", true);\r\n    } else {\r\n        update_other_save_load_button(null, true);\r\n    }\r\n} else {\r\n    if(localStorage[backup_key]) {\r\n        update_backup_load_button(JSON.parse(localStorage[backup_key]).saved_at);\r\n    } else {\r\n        update_backup_load_button();\r\n    }\r\n\r\n    if(localStorage[dev_save_key]) {\r\n        update_other_save_load_button(JSON.parse(localStorage[dev_save_key]).saved_at || \"\");\r\n    } else {\r\n        update_other_save_load_button();\r\n    }\r\n}\r\n\r\nexport { current_enemies, \r\n        current_location, \r\n        can_work, active_effects, \r\n        enough_time_for_earnings, add_xp_to_skill, \r\n        get_current_book, \r\n        last_location_with_bed, \r\n        last_combat_location, \r\n        current_stance, selected_stance,\r\n        faved_stances, options,\r\n        global_flags,\r\n        character_equip_item,\r\n        unlocked_beds,\r\n        favourite_consumables,\r\n        remove_consumable_from_favourites,\r\n        process_rewards,\r\n        travel_times,\r\n        language,\r\n        add_active_effect,\r\n        favourite_items\r\n};"],
  "mappings": "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",
  "names": ["Game_Time", "new_time", "how_much", "m", "h", "d", "y", "day_count", "month", "seasons", "date_string", "format_time", "time", "long_names", "round", "formatted_time", "used_term", "is_night", "current_game_time", "stat_names", "task_type_names", "skill_consumable_tags", "crafting_tags_to_skills", "expo", "number", "precision", "options", "round_item_price", "price", "format_reading_time", "time", "format_working_time", "formatted", "hours", "minutes", "get_hit_chance", "attack_points", "evasion_points", "result", "compare_game_version", "version_a", "version_b", "a", "b", "i", "temp", "is_a_older_than_b", "version1", "version2", "celsius_to_fahrenheit", "num", "hex_to_rgb", "hex", "calculate_luminance", "r", "g", "v", "calculate_contrast", "color_a", "color_b", "luminance_1", "luminance_2", "brightest", "darkest", "select_outline_class", "color_hex", "black_outline_class", "white_outline_class", "contrast_with_black", "contrast_with_white", "loot_sold_count", "group_key_prefix", "market_regions", "market_region_mapping", "capped_at", "item_saturation_cap", "item_saturation_param", "equipment_capped_at", "equipment_saturation_cap", "equipment_saturation_param", "region", "i", "fill_market_regions", "set_loot_sold_count", "data", "market_region_key", "item_key", "recovered", "recover_item_prices", "flat_recovery", "ratio_recovery", "region_key", "item_group_key", "trickle_market_saturations", "trickle_rate", "new_sold_count", "trade_region", "connections_count", "connected_region", "group_key", "group_tier", "saturation_level", "total_value_to_move", "value_to_move", "get_loot_price_modifier", "is_group", "value", "how_many_sold", "modifier", "modifier_caps_at", "param", "get_total_tier_saturation", "sold_by_tier", "cap", "calculate_total_saturation", "target_tier", "count", "get_loot_price_multiple", "start_count", "how_many_to_trade", "is_selling", "stop_multiplier_at", "sum", "round_item_price", "get_item_value_with_market_saturation", "add_to_sold", "remove_from_sold", "InventoryHaver", "items", "anything_new", "i", "item_key", "item", "getItem", "item_templates", "getItemFromKey", "crafting_recipes", "cooking_recipes", "smelting_recipes", "forging_recipes", "alchemy_recipes", "butchering_recipes", "woodworking_recipes", "get_crafting_quality_caps", "skill_name", "get_total_skill_level", "Recipe", "name", "id", "is_unlocked", "recipe_type", "result", "getResult", "recipe_level", "recipe_skill", "ItemRecipe", "materials", "success_chance", "station_tier", "level", "skill_modifier", "ammount", "i", "key", "item_templates", "character", "mats", "a", "b", "ComponentRecipe", "component_type", "item_type", "material", "x", "quality", "Armor", "ArmorComponent", "WeaponComponent", "ShieldComponent", "tier", "skill", "skills", "quality_range", "ComponentlessEquipRecipe", "Cape", "EquipmentRecipe", "components", "component_1", "component_2", "comp_quality_weighted", "Weapon", "Shield", "component_quality", "get_recipe_xp_value", "category", "subcategory", "recipe_id", "material_count", "result_tier", "selected_components", "rarity_multiplier", "exp_value", "selected_recipe", "recipes", "skill_level", "result_level", "recipe_category", "recipe_subcategory", "recipe_key", "skills", "skill_categories", "weapon_type_to_skill", "skill_category_crafting", "skill_xp_gains_cap", "crafting_skill_xp_gains_cap", "unknown_skill_name", "which_skills_affect_skill", "Skill", "skill_id", "names", "description", "flavour_text", "max_level", "max_level_coefficient", "max_level_bonus", "base_xp_cost", "visibility_treshold", "get_effect_description", "parent_skill", "milestones", "xp_scaling", "is_unlocked", "category", "get_stat_modifiers", "keys", "rank_name", "xp_to_add", "skill_name", "level_after_xp", "unlocks", "total_xp_to_previous_lvl", "gains", "message", "stat", "stat_names", "xp_multiplier", "name", "level", "stats", "xp_multipliers", "i", "multiplier_key", "scaling_type", "skill_level", "get_unlocked_skill_rewards", "unlocked_rewards", "skill", "format_skill_rewards", "get_next_skill_milestone", "milestone", "formatted", "temp", "unlocked_skills", "phrasing", "get_total_skill_coefficient", "get_total_level_bonus", "get_total_skill_level", "value", "get_crafting_quality_caps", "id", "traders", "inventory_templates", "Trader", "InventoryHaver", "name", "display_name", "trade_text", "unlock_message", "location_name", "refresh_time", "refresh_shift", "inventory_template", "profit_margin", "is_unlocked", "current_game_time", "inventory", "i", "item_count", "quality", "item", "getItem", "item_templates", "region", "skill_multi", "get_total_level_bonus", "rep_multi", "character", "TradeItem", "item_name", "chance", "count", "current_trader", "to_sell", "to_buy", "TradeGroupContent", "group_tier", "start_trade", "trader_key", "traders", "current_trader", "update_displayed_trader", "update_displayed_character_inventory", "cancel_trade", "to_buy", "to_sell", "update_displayed_trader_inventory", "accept_trade", "new_balance", "character", "item_list", "to_remove", "trade_item", "item", "getItemFromKey", "group_key", "group_tier", "remove_from_sold", "current_location", "add_to_character_inventory", "remove_from_trader_inventory", "i", "add_to_sold", "add_to_trader_inventory", "remove_from_character_inventory", "add_xp_to_skill", "skills", "update_displayed_money", "exit_trade", "exit_displayed_trade", "add_to_buying_list", "selected_item", "present_item", "a", "actual_number_to_add", "item_count_in_trader", "x", "TradeGroupContent", "calculate_total_values", "remove_from_buying_list", "actual_number_to_remove", "is_in_trade", "add_to_selling_list", "item_count_in_player", "remove_from_selling_list", "items", "traded_groups", "traded_group_key", "b", "sort_traded_items", "trade_cap", "group_key_prefix", "equipment_capped_at", "capped_at", "sold_saturation", "calculate_total_saturation", "bought_saturation", "sort_traded_items", "a", "b", "item_a", "getItemFromKey", "item_b", "tier_a", "tier_b", "process_conditions", "conditions", "character", "met", "skill_id", "get_total_skill_level", "item_id", "found", "item_key", "id", "stat_key", "current_game_time", "i", "rep_region", "global_flags", "GameAction", "starting_text", "action_id", "action_name", "description", "action_text", "success_text", "failure_texts", "required", "display_conditions", "conditions", "rewards", "attempt_duration", "success_chances", "keep_progress", "is_unlocked", "repeatable", "check_conditions_on_finish", "unlock_text", "character", "process_conditions", "dialogues", "Dialogue", "name", "getName", "id", "starting_text", "getStartingText", "ending_text", "is_unlocked", "is_finished", "textlines", "actions", "description", "getDescription", "location_name", "Textline", "text", "getText", "is_branch_only", "rewards", "branches_into", "locks_lines", "otherUnlocks", "required_flags", "display_conditions", "DialogueAction", "GameAction", "data", "context", "dialogue_key", "dial", "textline_key", "textline", "activities", "Activity", "name", "description", "action_text", "base_skills_names", "is_unlocked", "getBackgroundNoises", "Job", "activity_data", "Training", "Gathering", "required_tool_type", "enemy_templates", "enemy_killcount", "enemy_sizes", "droprate_modifier_skills_for_tags", "enemy_tag_to_skill_mapping", "tags_for_droprate_modifier_skills", "tag", "Enemy", "name", "id", "description", "xp_value", "stats", "rank", "loot_list", "size", "add_to_bestiary", "tags", "on_hit", "character", "on_damaged", "on_death", "i", "drop_chance_modifier", "loot", "item", "item_count", "droprate_modifier", "get_total_skill_coefficient", "enemy_abilites", "duration", "statuses", "add_active_effect", "roll", "log_message", "enemy_key", "locations", "location_types", "favourite_locations", "Location", "name", "id", "description", "connected_locations", "is_unlocked", "is_finished", "dialogues", "traders", "market_region", "types", "housing", "light_level", "getDescription", "background_noises", "getBackgroundNoises", "crafting", "tags", "is_temperature_static", "static_temperature", "reverse_day_night_temperatures", "temperature_range_modifier", "temperature_modifier", "is_under_roof", "entrance_rewards", "market_regions", "Combat_zone", "enemy_groups_list", "is_enemy_groups_list_random", "predefined_lineup_on_nth_group", "enemies_list", "enemy_group_size", "enemy_count", "enemy_stat_variation", "parent_location", "leave_text", "first_reward", "repeatable_reward", "rewards_with_clear_requirement", "otherUnlocks", "unlock_text", "is_challenge", "type", "skills", "skill", "temp_types", "enemies", "enemy_group", "index", "group_size", "i", "enemy", "enemy_templates", "newEnemy", "variation", "base", "vary", "Enemy", "effects", "hero_effects", "stat", "get_location_type_penalty", "Challenge_zone", "data", "LocationActivity", "activity_name", "starting_text", "get_payment", "working_period", "infinite", "availability_time", "availability_seasons", "skill_xp_per_tick", "gained_resources", "require_tool", "applied_effects", "__publicField", "skill_modifier", "skill_level_sum", "activities", "get_total_skill_level", "gathering_time_needed", "chance", "min", "max", "LocationType", "related_skill", "scaling_lvl", "stages", "stage", "category", "noises", "current_game_time", "is_rat", "global_flags", "GameAction", "location_key", "activity_key", "fill_market_regions", "effect_templates", "ActiveEffect", "name", "id", "description", "duration", "effects", "tags", "potency", "group_tags", "affected_by_travel", "effect_key", "player_storage", "InventoryHaver", "storage_open", "add_to_storage", "items", "update_displayed_storage", "remove_from_storage", "open_storage", "close_storage", "exit_displayed_storage", "move_item_to_storage", "item", "count", "character", "remove_from_character_inventory", "remove_item_from_storage", "add_to_character_inventory", "is_storage_open", "quests", "active_quests", "QuestTask", "task_description", "task_condition", "task_rewards", "is_hidden", "is_finished", "task_group", "task_type", "task_target_id", "Quest", "quest_name", "quest_id", "quest_description", "questline", "quest_tasks", "quest_condition", "quest_rewards", "display_priority", "is_repeatable", "getQuestName", "getQuestDescription", "task", "questManager", "should_inform", "quest", "add_quest_to_display", "log_message", "only_unlocks", "is_from_loading", "skip_rewards", "update_displayed_quest", "process_rewards", "task_index", "skip_warning", "allowed_to_finish_quest", "skip_message", "remaining_tasks", "quest_event_type", "quest_event_target", "quest_event_count", "additional_quest_tags", "active_quest_id", "current_task_index", "current_task", "is_any_met", "is_all_met", "requirements_met", "requirements", "requirement", "restrictions", "restriction", "update_displayed_quest_task", "completed_tasks", "base_temperature", "previous_temperature_modifier", "seasonal_temperature_modifiers", "daytime_temperature_modifiers", "daycount_temperature_modifier", "rain_cycle", "get_temperature_peak_time", "time", "get_nonlocational_temperature_modifier", "get_current_temperature_smoothed", "current_location", "previous_temperature_modifier", "get_nonlocational_temperature_modifier", "current_game_time", "prev_temperature_time", "next_temperature_time", "total_minutes_betwen_changes", "minutes_passed", "ratio", "next_temperature_modifier", "Game_Time", "location_modifier", "base_temperature", "is_raining", "rain_cycle", "BackgroundParticle", "canvas", "size", "RainParticle", "SnowParticle", "PointyStarParticle", "BackgroundParticle", "canvas", "size", "degrees", "game_version", "get_game_version", "translationManager", "language", "text_id", "translations", "activity_anim", "location_choice_divs", "action_div", "trade_div", "storage_div", "location_name_span", "location_icon_span", "location_types_div", "location_tooltip", "canvas", "context", "background_animation", "background_animation_timeout", "background_animation_particles", "inventory_div", "item_divs", "trader_item_divs", "storage_item_divs", "item_buying_divs", "item_selling_divs", "trader_inventory_div", "storage_inventory_div", "message_log", "combat_div", "enemies_div", "enemy_count_div", "clear_count_div", "onhitAnimation", "onhitAnimationTiming", "onstartAnimation", "onstartAnimationTiming", "enemy_animations", "current_health_value_div", "current_health_bar", "health_tooltip_div", "current_stamina_value_div", "current_stamina_bar", "stamina_tooltip_div", "character_xp_div", "character_level_div", "xp_bar_tooltip_div", "active_effects_tooltip", "active_effect_count", "time_field", "weather_field", "skill_bar_divs", "skill_list", "skill_category_order", "stance_bar_divs", "stance_list", "booklist_entry_divs", "booklist_list", "bestiary_entry_divs", "bestiary_list", "combat_switch", "inventory_switch", "quest_entry_divs", "quest_list", "quest_hiding_button", "data_entry_divs", "skill_sorting", "skill_sorting_direction", "trader_inventory_sorting", "trader_inventory_sorting_direction", "storage_sorting", "storage_sorting_direction", "character_inventory_sorting", "character_inventory_sorting_direction", "message_count", "stats_divs", "other_combat_divs", "effect_divs", "character_attack_bar", "equipment_slots_divs", "rarity_colors", "rarity_outlines", "rarity", "select_outline_class", "crafting_pages", "selected_crafting_category", "selected_crafting_subcategory", "loading_progress_div", "backup_load_button", "other_save_load_button", "export_button_tooltip", "default_dialogue_return_text", "capitalize_first_letter", "some_string", "create_floating_effect", "text", "pos", "effect_elem", "timer", "anim_interval", "clear_action_div", "action_div", "location_choice_divs", "create_item_tooltip", "item", "options", "is_trade", "item_tooltip", "create_item_tooltip_content", "value_function", "quality", "outline_class_1", "rarity_outlines", "outline_class_2", "rarity_colors", "outline_class", "component_description", "components", "item_templates", "character", "equip_stats_0", "equip_stats_1", "effect_key", "capitalize_first_letter", "equip_stats", "equip_bonus_skill_levels", "skill_key", "skills", "i", "create_effect_tooltip", "book_stats", "format_book_bonuses", "format_money", "round_item_price", "current_location", "traders", "current_trader", "effect_name", "duration", "add_bonus", "effect", "effect_templates", "tooltip", "name_span", "duration_span", "format_time", "top_div", "description_p", "effects_div", "effects", "get_effect_with_bonuses", "key", "stat_value", "stat_names", "flat", "sign", "xp_multipliers", "name", "end_activity_animation", "remove", "activity_anim", "div", "log_message", "message_to_add", "message_type", "message", "class_to_add", "group_to_add", "message_count", "message_log", "button_id", "bonuses", "formatted", "stats", "multipliers", "log_loot", "loot_list", "is_combat", "is_a_summary", "item", "item_templates", "getItemFromKey", "message", "message_type", "i", "log_message", "start_activity_animation", "settings", "end_activity_animation", "activity_anim", "action_status_div", "end", "format_reading_time", "update_displayed_trader", "action_div", "trade_div", "traders", "current_trader", "current_location", "update_displayed_trader_inventory", "update_displayed_storage", "storage_div", "update_displayed_storage_inventory", "update_displayed_money", "format_money", "character", "update_displayed_total_price", "total_price", "create_trade_buttons", "trade_buttons", "trade_button_5", "trade_button_10", "trade_button_max", "sort_displayed_inventory", "sort_by", "target", "change_direction", "plus", "minus", "trader_inventory_sorting", "trader_inventory_sorting_direction", "trader_inventory_div", "character_inventory_sorting", "character_inventory_sorting_direction", "inventory_div", "storage_sorting", "storage_sorting_direction", "storage_inventory_div", "a", "b", "slot_a", "slot_b", "equipment_slots_divs", "item_template_a", "item_template_b", "name_a", "name_b", "value_a", "value_b", "node", "item_key", "trader_sorting", "sorting_direction", "was_anything_new_added", "trader", "trader_item_divs", "div_key", "item_selling_divs", "to_sell", "x", "item_count", "item_div", "create_inventory_item_div", "inventory_key", "to_buy", "div_count", "create_item_tooltip", "price_span", "round_item_price", "key", "update_displayed_character_inventory", "equip_slot", "character_sorting", "is_trade", "skip_sorting", "item_divs", "item_buying_divs", "eq_slot", "storage_item_divs", "player_storage", "exit_displayed_storage", "is_equipped", "trade_index", "item_control_div", "item_name_div", "item_additional", "target_item", "target_class_name", "item_class", "options", "price_multiplier", "book_stats", "get_current_book", "item_faving_div", "icon", "favourite_items", "item_use_button", "item_auto_use_button", "favourite_consumables", "item_read_button", "item_unequip_div", "item_equip_span", "item_value_span", "update_displayed_equipment", "eq_tooltip", "update_fav_display", "is_fav", "update_displayed_book", "book_id", "book", "book_key", "update_displayed_enemies", "current_enemies", "enemies_div", "disp_speed", "hero_hit_chance_modifier", "enemy", "hero_evasion_chance_modifier", "enemy_tag", "enemy_tag_to_skill_mapping", "skill", "skills", "modifier_to_hit_chance", "modifier_to_evasion", "evasion_chance", "get_hit_chance", "hit_chance", "update_displayed_health_of_enemies", "update_displayed_normal_location", "location", "clear_action_div", "location_types_div", "combat_div", "location_tooltip", "enemy_count_div", "clear_count_div", "inventory_switch", "combat_switch", "location_name_span", "update_location_icon", "global_flags", "crafting_button", "start_sleeping_div", "open_storage_div", "dialogue", "dialogues", "lines_available", "line", "location_choice_divs", "create_location_choice_dropdown", "create_location_choices", "activity", "activities", "action", "loc", "favourite_locations", "unlocked_beds", "locations", "last_combat_location", "location_icon_span", "name", "class_name", "elem", "event", "category", "choice_list", "dialogue_div", "trader_div", "activity_div", "can_work", "job_tooltip", "unavailable_seasons", "seasons", "format_working_time", "activity_tooltip", "create_gathering_tooltip", "travel_time", "format_time", "travel_times", "travel_time_text", "last_location_with_bed", "last_bed", "available_challenges", "location_action_div", "create_location_action_tooltip", "create_fast_travel_choices", "available_fast_travel", "removal_button", "remove_fast_travel_choice", "location_id", "element", "update_displayed_combat_location", "create_location_types_display", "update_location_kill_count", "type_div", "type_tooltip", "location_types", "type", "stage", "effects", "stat", "base", "actual", "get_location_type_penalty", "stat_names", "update_displayed_location_types", "open_crafting_window", "selected_crafting_category", "selected_crafting_subcategory", "switch_crafting_recipes_page", "update_displayed_crafting_recipes", "close_crafting_window", "elements", "recipes", "unexpand_displayed_recipes", "switch_crafting_recipes_subpage", "subcategory", "classes", "j", "get_recipe_page", "crafting_pages", "new_category", "create_displayed_crafting_recipes", "recipe_category", "recipe_subcategory", "recipe", "add_crafting_recipe_to_display", "update_item_recipe_visibility", "recipe_id", "recipe_div", "recipe_name_span", "craft_ammount_buttons", "button_5", "button_10", "button_all", "create_recipe_tooltip", "material_selection", "toggle_exclusive_class", "remove_class_from_all", "component_selection_1", "component_1_list", "component_selection_2", "component_2_list", "component_selections", "update_recipe_tooltip", "is_element_above_x", "accept_recipe_button", "update_displayed_crafting_recipe", "material", "components", "tooltip", "create_recipe_tooltip_content", "update_item_recipe_tooltips", "material_selections_div", "material_key", "id", "material_recipe", "station_tier", "success_chance", "mats", "any_available", "mat_list", "xp_val_1", "get_recipe_xp_value", "create_item_tooltip_content", "quality_range", "rarity_multipliers", "getItemRarity", "xp_val_2", "Weapon", "Armor", "Shield", "update_displayed_component_choice", "component_keys", "component_selections_div", "component_1_key", "component_2_key", "update_displayed_material_choice", "refreshing", "materials", "name_span", "location_action", "action_tooltip", "location_activity", "gathering_tooltip", "gathering_time_needed", "gained_resources", "skill_names", "update_gathering_tooltip", "parent", "update_displayed_health", "current_health_value_div", "current_health_bar", "update_displayed_stamina", "current_stamina_value_div", "current_stamina_bar", "update_displayed_stats", "stats_divs", "update_stat_description", "attack_stats", "ap", "other_combat_divs", "dp", "ep", "update_bar_tooltips", "atk", "create_stat_breakdown", "update_health_bar_tooltip", "update_stamina_bar_tooltip", "update_xp_bar_tooltip", "html_content", "health_recovery_balance", "health_tooltip_div", "stamina_tooltip_div", "create_xp_bonus_breakdown", "get_hero_xp_gain", "get_skills_overall_xp_gain", "xp_bar_tooltip_div", "html_string", "stat_type", "sign", "capitalize_first_letter", "bonus", "include_multipliers", "xp_bonus_value", "get_skill_xp_gain_bonus", "bonus_type", "update_displayed_effects", "effect_count", "active_effects", "active_effect_count", "active_effects_tooltip", "effect_divs", "eff", "effect", "create_effect_tooltip", "update_displayed_effect_durations", "update_displayed_time", "time_of_the_day", "current_game_time", "time_field", "update_displayed_temperature", "temperature", "get_current_temperature_smoothed", "displayed_temperature", "celsius_to_fahrenheit", "temperature_unit", "is_cold", "cold_status_temperatures", "get_character_cold_tolerance", "temperature_class", "weather_field", "is_raining", "create_temperature_tooltip", "lowest_tolerable_temperature", "num", "value", "update_displayed_character_xp", "did_level", "character_xp_div", "expo", "character_level_div", "update_displayed_xp_bonuses", "update_displayed_stamina_efficiency", "update_displayed_reputation", "data_entry_divs", "reputation_region", "rep_div", "rep_name_span", "rep_value_span", "update_displayed_dialogue", "dialogue_key", "textlines", "origin", "dialogue_name_div", "dialogue_answer_div", "process_conditions", "textline_div", "translationManager", "language", "backstep_dialogue_div", "default_dialogue_return_text", "dialogue_action_div", "end_dialogue_div", "update_displayed_textline_answer", "text", "is_description", "exit_displayed_trade", "start_activity_display", "current_activity", "action_xp_div", "percent_xp", "get_total_skill_level", "curr_xp", "needed_xp", "time_needed", "get_skill_xp_gain", "action_end_div", "action_end_text", "action_end_earnings", "action_progress_bar_max", "action_progress_bar", "time_info_div", "enough_time_for_earnings", "update_displayed_ongoing_activity", "is_job", "start_game_action_display", "action_key", "update_game_action_progress_bar", "percent", "set_game_action_finish_text", "update_game_action_finish_button", "fill_action_box", "content_type", "data", "start_sleeping_display", "start_reading_display", "title", "create_new_skill_bar", "skill_bar_divs", "skill_category_div", "btn_up", "idx", "skill_category_order", "sort_displayed_skill_categories", "update_skill_category_order", "btn_down", "skill_category_skills", "skill_list", "skill_bar_max", "skill_bar_current", "skill_bar_text", "skill_bar_name", "skill_bar_xp", "skill_tooltip", "tooltip_xp", "tooltip_xp_gain", "tooltip_desc", "tooltip_effect", "tooltip_milestones", "tooltip_next", "sort_displayed_skills", "update_displayed_skill_xp_gain", "update_displayed_skill_bar", "leveled_up", "update_displayed_skill_level", "get_unlocked_skill_rewards", "get_next_skill_milestone", "skill_sorting", "update_displayed_skill_description", "xp_gain", "update_all_displayed_skills_xp_gain", "skill_id", "skill_sorting_direction", "elem_a", "elem_b", "pos_a", "pos_b", "update_displayed_stance_list", "stances", "current_stance", "fav_stances", "stance_list", "stance_bar_divs", "bar", "stance", "fav_selection", "stance_selection", "stance_info", "stance_tooltip_row", "create_stance_tooltip", "stance_a", "stance_b", "update_displayed_stance", "update_displayed_faved_stances", "tooltip_div", "create_stance_tooltip_stats", "target_count", "desc", "stats", "update_stance_tooltip", "selection", "faved_stances", "list", "selected_stance", "create_new_bestiary_entry", "enemy_name", "enemy_templates", "bestiary_entry_divs", "create_bestiary_entry_content", "bestiary_list", "rank_a", "rank_b", "entry_div", "name_div", "kill_counter", "enemy_killcount", "create_bestiary_entry_tooltip", "bestiary_tooltip", "tooltip_tags", "tag", "tooltip_stats", "stat_line_0", "create_bestiary_stat_entry", "stat_line_2", "stat_line_4", "tooltip_drops", "create_bestiary_loot_line", "update_bestiary_entry_tooltip", "update_bestiary_entry_killcount", "enemy_name", "bestiary_entry_divs", "enemy_killcount", "create_bestiary_loot_line", "enemy", "loot", "loot_line", "loot_name", "loot_chance", "loot_chance_base", "loot_chance_current", "create_bestiary_stat_entry", "stat_name", "stat_entry", "stat_name_div", "stat_value_div", "create_new_booklist_entry", "book_name", "booklist_entry_divs", "book", "item_templates", "name_div", "tooltip", "create_item_tooltip", "booklist_list", "a", "b", "node", "update_booklist_entry", "read", "create_item_tooltip_content", "update_enemy_attack_bar", "enemy_id", "num", "enemies_div", "do_enemy_onhit_animation", "enemy_div", "enemy_animations", "onhitAnimation", "onhitAnimationTiming", "remove_enemy_onhit_animation", "do_enemy_onstart_animation", "onstartAnimation", "onstartAnimationTiming", "update_character_attack_bar", "character_attack_bar", "add_quest_to_display", "quest_id", "quest_entry_divs", "quests", "quest", "quest_div", "create_displayed_quest_content", "quest_list", "sort_displayed_quests", "update_displayed_quest", "quest_name_div", "quest_description_div", "update_displayed_quest_tasks", "a", "b", "quest_a", "quest_b", "node", "create_displayed_quest_tasks_content", "event", "quest_tasks_div", "unfinished_index", "x", "i", "create_displayed_quest_task", "task_index", "task", "task_div", "task_status_icon_span", "task_desc_div", "task_conditions_div", "total_tasks", "task_group", "task_condition_div", "task_type", "task_type_div", "task_type_names", "task_target_id", "task_target_div", "divs", "update_displayed_quest_task", "quest_task_list_div", "tasks_div", "change_completed_quest_visibility", "quest_hiding_button", "start_rain_animation", "start_background_animation", "start_snow_animation", "start_stars_animation", "type", "stop_background_animation", "particle_class", "SnowParticle", "canvas", "RainParticle", "PointyStarParticle", "context", "background_animation_particles", "do_background_animation", "background_animation", "background_animation_timeout", "update_export_button_tooltip", "time_passed", "time_until_reward", "export_button_tooltip", "time_needed", "seconds", "minutes", "hours", "update_backup_load_button", "date_string", "backup_load_button", "update_other_save_load_button", "is_dev", "other_save_load_button", "hide_loading_screen", "set_loading_screen_versions", "save_version", "loading_screen", "current_version", "get_game_version", "is_a_older_than_b", "set_loading_screen_progress", "message", "loading_progress_div", "hide_loading_text", "set_loading_screen_errors_warning", "loading_screen_errors_field", "set_loading_screen_warnings_warning", "show_play_button", "play_button", "set_play_button_text", "text", "toggle_exclusive_class", "element", "siblings_only", "class_name", "elems", "has_class", "remove_class_from_all", "is_element_above_x", "rect", "rect2", "base_block_chance", "base_xp_cost", "is_rat", "character", "time_until_wet", "time_until_cold", "time_until_cold_when_wet", "cold_status_temperatures", "lowest_tolerable_temperature", "cold_status_effects", "Hero", "InventoryHaver", "base_xp_cost", "xp_to_add", "use_bonus", "level_after_xp", "total_xp_to_previous_lvl", "gains", "level", "gained_hp", "gained_stamina", "gained_str", "gained_agi", "gained_dex", "gained_int", "gained_skill_xp_multiplier", "total_skill_xp_multiplier", "i", "stats", "xp_multipliers", "stat", "skills", "skill", "skill_categories", "category", "cat", "multipliers", "active_effects", "effect_key", "multiplier", "effects", "get_effect_with_bonuses", "key", "value", "slot", "bonuses", "bonus", "get_total_skill_coefficient", "weapon_type_to_skill", "get_total_level_bonus", "get_total_skill_level", "current_stance", "light_modifier", "current_location", "is_night", "current_game_time", "effect", "missing_health", "missing_stamina", "missing_mana", "stat_sum", "stat_mult", "base_block_chance", "piece", "bonus_target", "update_all_displayed_skills_xp_gain", "update_displayed_skill_xp_gain", "update_displayed_xp_bonuses", "update_displayed_skill_level", "damage_values", "can_faint", "give_skill_xp", "defense_modifier", "fainted", "val", "damage_taken", "a", "b", "add_to_character_inventory", "items", "was_anything_new_added", "update_displayed_character_inventory", "remove_from_character_inventory", "id", "item_templates", "favourite_consumables", "remove_consumable_from_favourites", "equip_item", "item", "skip_sorting", "prev_item", "unequip_item", "update_displayed_equipment", "update_character_stats", "manage_changed_skill_bonuses", "equip_item_from_inventory", "item_key", "item_slot", "already_calculated", "bonus_skill_levels", "get_character_cold_tolerance", "character", "update_character_stats", "character", "update_displayed_stats", "update_displayed_health", "update_displayed_stamina", "update_displayed_stamina_efficiency", "get_skill_xp_gain", "skill_name", "get_skill_xp_gain_bonus", "category", "skills", "get_skills_overall_xp_gain", "get_hero_xp_gain", "get_total_skill_level", "skill_id", "get_total_level_bonus", "get_total_skill_coefficient", "scaling_type", "get_effect_with_bonuses", "active_effect", "multiplier", "skill_consumable_tags", "boosted", "key", "value", "rarity_multipliers", "item_templates", "getArmorSlot", "internal", "equip_slot", "getItemRarity", "quality", "rarity", "getEquipmentValue", "components", "value", "component", "round_item_price", "Item", "name", "description", "tags", "market_saturation_group", "saturates_market", "material_type", "id", "getName", "group_key_prefix", "key", "multiplier", "region", "group_key", "group_tier", "get_item_value_with_market_saturation", "additional_traded_count", "count", "price_multiplier", "is_selling", "stop_multiplier_at", "val", "multi_value", "get_loot_price_multiple", "get_total_tier_saturation", "OtherItem", "item_data", "Material", "ItemComponent", "WeaponComponent", "ShieldComponent", "ArmorComponent", "UsableItem", "Equippable", "tier", "component_key", "stats", "comp", "i", "stat", "used_stats", "skill_bonus", "skill", "used_bonus", "Artifact", "Tool", "Shield", "Armor", "Weapon", "Cape", "Amulet", "Ring", "BookData", "required_time", "required_skills", "literacy_xp_rate", "finish_reward", "bonuses", "rewards", "book_stats", "Book", "time", "getItem", "getItemFromKey", "head", "handle", "shield_base", "external", "is_rat", "stances", "Stance", "name", "id", "related_skill", "target_count", "randomize_target_count", "is_unlocked", "stat_multipliers", "stamina_cost", "description", "__publicField", "skills", "multipliers", "stat", "get_total_skill_level", "trc", "Verify_Game_Objects", "results", "overall_start_time", "start_time", "item_results", "key", "item", "item_templates", "has_issue", "i", "effect_templates", "stat_key", "character", "stat_type_key", "end_time", "skill_results", "skill", "skills", "milestone", "milestone_reward_type_key", "unlock_key", "stat_type", "skill_key", "skill_categories", "location_results", "location", "locations", "dialogues", "market_region_mapping", "traders", "activity_key", "activities", "enemy_templates", "j", "verify_rewards", "enemy_results", "enemy", "market_region_results", "is_present", "dialogue_results", "value", "textline_key", "textline", "translations", "action_key", "action", "recipes_results", "recipes", "recipe_category", "recipe_subcategory", "overall_end_time", "result_message", "rewards", "source_type", "source_key", "subsource_key", "is_correct", "reward_type", "create_reward_error_message", "skill_id", "quests", "ReputationManager", "reputation", "region", "character", "speed_modifiers_from_skills", "default_travel_skill", "default_travel_time", "max_modifier_from_skill", "PriorityQueue", "location_element", "a", "b", "Pathfinder", "loc1", "loc2", "travel_time", "skill_id", "skills", "used_skills", "skill_modifier", "j", "locations", "location", "travel_time_to_here", "x", "i", "starting_location", "priority_queue", "distance", "weight", "target", "save_key", "dev_save_key", "backup_key", "dev_backup_key", "global_flags", "flag_unlock_texts", "play_button", "languages", "language", "is_loading_error", "total_playtime", "total_deaths", "total_crafting_attempts", "total_crafting_successes", "total_kills", "total_crits_done", "total_crits_taken", "total_hits_done", "total_hits_taken", "strongest_hit", "gathered_materials", "trade_price_recovery_flat", "trade_price_recovery_ratio", "market_saturation_trickle_rate", "last_rewarded_export", "time_between_export_rewards", "current_temperature", "rain_counter", "cold_status_counters", "was_raining", "was_starry", "current_enemies", "enemy_attack_loops", "enemy_attack_cooldowns", "enemy_timer_variance_accumulator", "enemy_timer_adjustment", "enemy_timers", "character_attack_loop", "character_timer_variance_accumulator", "character_timer_adjustment", "character_timers", "maximum_time_correction", "current_location", "current_activity", "game_action_interval", "current_game_action", "travel_times", "pathfinder", "unlocked_beds", "is_resting", "is_sleeping", "last_location_with_bed", "last_combat_location", "is_reading", "save_period", "save_counter", "backup_period", "backup_counter", "time_variance_accumulator", "time_adjustment", "start_date", "end_date", "current_dialogue", "active_effects", "selected_stance", "stances", "current_stance", "faved_stances", "favourite_consumables", "favourite_items", "tickrate", "global_xp_multiplier", "options", "message_log_filters", "enemy_crit_chance", "enemy_crit_damage", "content_stack", "content_stack_removal_options", "name_field", "character", "time_field", "current_game_time", "skills", "skill", "skill_categories", "category", "option_uniform_textsize", "option", "checkbox", "option_bed_return", "option_remember_filters", "option_combat_autoswitch", "option_log_all_gathering", "option_log_gathering_result", "option_expo_threshold", "input", "option_use_uncivilised_temperature_scale", "update_displayed_temperature", "option_do_background_animations", "stop_background_animation", "start_snow_animation", "start_rain_animation", "start_stars_animation", "option_skip_play_button", "option_mofu_mofu_mode", "option_do_enemy_onhit_animations", "option_hide_max_level_skills", "change_location", "location_id", "event", "skip_travel_time", "do_quest_events", "skip_combat", "previous_location", "location", "locations", "clear_all_enemy_attack_loops", "clear_character_attack_loop", "clear_enemies", "do_quest_event", "log_message", "update_displayed_crafting_recipes", "Pathfinder", "progress_time", "update_character_stats", "update_displayed_normal_location", "update_displayed_combat_location", "start_combat", "process_rewards", "handle_location_icon_click", "favourite_locations", "remove_location_from_favourites", "add_location_to_favourites", "start_activity", "selected_activity", "activities", "can_work", "add_to_content_stack", "end_activity", "format_money", "add_money_to_character", "loot", "mat_key", "log_loot", "end_activity_animation", "remove_from_content_stack", "start_game_action", "action_key", "game_action", "dialogues", "conditions_status", "finish_game_action", "random_effect", "create_floating_effect", "current_iterations", "total_iterations", "update_game_action_progress_bar", "dialogue_key", "action", "result_message", "action_result", "get_game_action_result", "is_won", "lock_action", "item_id", "remove_from_character_inventory", "item_templates", "update_game_action_finish_button", "pass_data_down_the_content_stack", "set_game_action_finish_text", "end_game_action", "unlock_global_activity", "activity_id", "message", "unlock_activity", "activity_data", "unlock_action", "action_data", "location_key", "money_num", "update_displayed_money", "update_health", "ammount_to_restore", "ammount_to_loose", "add_xp", "actual_health_change", "actual_healing_done", "update_displayed_health", "add_xp_to_skill", "kill_player", "do_resting", "resting_heal_ammount", "get_total_skill_level", "resting_stamina_ammount", "update_displayed_stamina", "do_sleeping", "sleeping_heal_ammount", "sleeping_stamina_ammount", "start_sleeping", "start_sleeping_display", "end_sleeping", "start_reading", "book_key", "book_id", "is_JSON", "end_reading", "book_stats", "start_reading_display", "update_displayed_book", "do_reading", "book", "update_booklist_entry", "get_current_book", "enough_time_for_earnings", "selected_job", "start_dialogue", "end_dialogue", "reload_normal_location", "start_textline", "textline_key", "textline", "text", "get_textline_answer", "is_rat", "words", "index", "fill_action_box", "unlock_combat_stance", "stance_id", "update_displayed_stance_list", "change_stance", "is_temporary", "update_displayed_stance", "reset_combat_loops", "fav_stance", "update_displayed_faved_stances", "set_new_combat", "enemies", "i", "remove_enemy_onhit_animation", "character_attack_cooldown", "x", "fastest_cooldown", "b", "cooldown_multiplier", "do_enemy_onstart_animation", "do_enemy_attack_loop", "set_character_attack_loop", "update_displayed_enemies", "update_displayed_health_of_enemies", "skip_persistence_xp_for_stance_change", "enemy_id", "count", "is_new", "update_enemy_attack_bar", "do_enemy_combat_action", "clear_enemy_attack_loop", "base_cooldown", "target_count", "targets", "alive_targets", "enemy", "use_stamina", "actual_cooldown", "attack_power", "do_character_attack_loop", "update_character_attack_bar", "leveled", "do_character_combat_action", "sum", "update_stance_tooltip", "get_location_rewards", "update_location_kill_count", "key", "enemy_count_xp_mod", "attacker", "evasion_chance_modifier", "defense_modifier", "enemy_tag", "enemy_tag_to_skill_mapping", "modifier_to_evasion", "modifier_to_defense", "enemy_base_damage", "damages_dealt", "critted", "partially_blocked", "a", "blocked", "val", "get_hit_chance", "xp_to_add", "damage_taken", "fainted", "hit_count_msg", "target", "hero_base_damage", "groupsize_xp_multiplier", "damage_dealt", "hit_chance_modifier", "damage_modifier", "modifier_to_damage", "modifier_to_hit_chance", "weapon_type_to_skill", "do_enemy_onhit_animation", "xp_reward", "add_xp_to_character", "add_to_character_inventory", "kill_enemy", "enemy_killcount", "update_bestiary_entry_killcount", "create_new_bestiary_entry", "tag", "is_combat", "add_active_effect", "stamina_to_use", "cold_status_effects", "update_displayed_stats", "should_info", "use_bonus", "add_to_parent", "cap_gained_xp", "is_from_loading", "get_skill_xp_gain", "skill_xp_gains_cap", "prev_name", "was_hidden", "gains", "unlocks", "new_name", "xp_for_parent", "is_visible", "create_new_skill_bar", "update_displayed_skill_bar", "which_skills_affect_skill", "booklist_entry_divs", "inv_key", "item", "getItemFromKey", "effects", "effect_templates", "update_displayed_character_inventory", "eq_slot", "update_displayed_equipment", "update_displayed_skill_description", "update_all_displayed_skills_xp_gain", "update_displayed_skill_xp_gain", "update_displayed_stamina_efficiency", "activity_key", "update_gathering_tooltip", "update_displayed_effects", "speed_modifiers_from_skills", "tags_for_droprate_modifier_skills", "enemy_templates", "update_bestiary_entry_tooltip", "level_up", "update_displayed_character_xp", "should_return", "lock_location", "rewards", "source_type", "source_name", "is_first_clear", "inform_overall", "inform_textline", "only_unlocks", "was_any_location_availability_changed", "skill_key", "unlock_location", "flag", "any_unlocked", "j", "dialogue", "trader", "traders", "recipes", "questManager", "quest_id", "task_index", "quests", "region", "ReputationManager", "update_displayed_reputation", "skip_message", "was_unlocked", "challenge_self_lock", "was_locked", "remove_fast_travel_choice", "update_location_icon", "update_choices", "use_recipe", "ammount_wanted_to_craft", "subcategory", "recipe_id", "station_tier", "selected_recipe", "recipe_div", "result", "available_ammount", "materials", "ammount_that_can_be_crafted", "attempted_crafting_ammount", "successful_crafting_ammount", "success_chance", "result_id", "recipe_skill", "needed_xp", "xp_per_craft", "crafting_skill_xp_gains_cap", "get_recipe_xp_value", "estimated_xp_per_craft", "needed_crafts", "variable_craft", "current_gained_xp", "success", "fail", "mat_type", "mat", "msg", "skill_id", "crafting_tags_to_skills", "item_key", "update_item_recipe_visibility", "update_item_recipe_tooltips", "material_div", "material_1_key", "id", "recipe_material", "accumulated_xp", "crafted_items", "crafted_count", "all_crafted", "quality", "result_tier", "rarity_multipliers", "getItemRarity", "highest_qual", "result_key", "parsed_key", "crafted_qualities", "to_add", "new_key", "update_displayed_material_choice", "component_1_key", "component_2_key", "comp_1", "comp_2", "comp_quality_weighted", "comp_tier_max", "component_keys", "update_displayed_component_choice", "content_type", "data", "what_to_remove", "switch_action_box_content", "character_equip_item", "equip_item_from_inventory", "character_unequip_item", "item_slot", "unequip_item", "use_item", "item_effects", "used", "duration", "ActiveEffect", "recovered", "recoverable", "skill_consumable_tags", "add_consumable_to_favourites", "remove_consumable_from_favourites", "change_consumable_favourite_status", "add_item_to_favourites", "remove_item_from_favourites", "change_item_favourite_status", "update_fav_display", "effect_key", "do_not_apply_because_stronger_is_active", "effect", "group_tag", "quest_event_type", "quest_event_target", "quest_event_count", "give_export_reward", "get_date", "date", "year", "month_num", "month", "day", "hour", "minute", "second", "is_on_dev", "str", "create_save", "save_data", "game_version", "player_storage", "skill_category_order", "activity", "temp_inventory", "active_quests", "loot_sold_count", "stance", "skill_list", "error", "save_to_file", "save_progress", "save_to_localStorage", "is_manual", "save", "load", "any_warnings", "filter", "change_completed_quest_visibility", "is_from_before_eco_rework", "compare_game_version", "set_loading_screen_progress", "elem", "idx", "total_book_xp", "literacy_xp", "quality_mult", "equip_slot", "components", "head", "handle", "getItem", "equip_item", "shield_base", "item_list", "is_a_older_than_b", "internal", "external", "getArmorSlot", "storage_item_list", "trader_item_list", "add_to_trader_inventory", "loot_count", "divisor", "market_region_mapping", "loot_key", "region_key", "set_loot_sold_count", "trade_key", "capped_at", "ratio", "enemy_name", "quest", "unfinished_index", "first_unfinished_task", "task_group", "task_type", "task_target_id", "update_displayed_quest", "create_displayed_crafting_recipes", "set_loading_screen_warnings_warning", "update_displayed_time", "set_loading_screen_versions", "load_from_file", "save_string", "load_from_localstorage", "set_loading_screen_errors_warning", "load_backup", "load_other_release_save", "hard_reset", "confirmation", "update_timer", "time_in_minutes", "was_night", "is_night", "value", "source", "update_effect_durations", "is_travel", "were_stats_updated", "update", "prev_day", "update_export_button_tooltip", "recover_item_prices", "trickle_market_saturations", "is_in_trade", "update_displayed_trader_inventory", "update_displayed_effect_durations", "new_temperature", "get_current_temperature_smoothed", "is_raining", "time_until_wet", "was_effect_added", "cold_status_temperatures", "get_character_cold_tolerance", "time_until_cold_when_wet", "time_until_cold", "stage", "location_types", "gathering_time_needed", "gained_resources", "items", "update_displayed_ongoing_activity", "divs", "sounds", "health_to_add", "health_to_subtract", "saved_at", "update_backup_load_button", "update_displayed_location_types", "run", "start_trade", "exit_trade", "add_to_buying_list", "remove_from_buying_list", "add_to_selling_list", "remove_from_selling_list", "cancel_trade", "accept_trade", "update_displayed_total_price", "open_storage", "close_storage", "move_item_to_storage", "remove_item_from_storage", "is_storage_open", "sort_displayed_inventory", "update_displayed_storage_inventory", "sort_displayed_skills", "open_crafting_window", "close_crafting_window", "switch_crafting_recipes_page", "switch_crafting_recipes_subpage", "update_recipe_tooltip", "get_game_version", "Verify_Game_Objects", "hide_loading_screen", "update_displayed_xp_bonuses", "hide_loading_text", "set_play_button_text", "show_play_button", "update_displayed_equipment", "sort_displayed_inventory", "options", "play_button", "is_on_dev", "log_message", "dev_backup_key", "update_backup_load_button", "save_key", "update_other_save_load_button", "backup_key", "dev_save_key"]
}
